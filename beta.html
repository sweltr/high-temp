<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.646">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Reproducible workflow for assessing community dissimilarity across temperature treatments.">
<title>SWELTR - 6. Beta Diversity &amp; Dispersion Estimates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./da.html" rel="next">
<link href="./alpha.html" rel="prev">
<link href="./assets/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>
    .quarto-title-block .quarto-title-banner {
      background: #113858;
    }
    </style>
<script src="site_libs/font-awesome-5.13.0/js/script.js"></script><script src="site_libs/core-js-2.5.3/shim.min.js"></script><script src="site_libs/react-17.0.0/react.min.js"></script><script src="site_libs/react-17.0.0/react-dom.min.js"></script><script src="site_libs/reactwidget-1.0.0/react-tools.js"></script><script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="site_libs/reactable-binding-0.2.3.9000/reactable.js"></script><link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <img src="./assets/icon.png" alt=""></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item compact">
    <a class="nav-link" href="./index.html"><i class="bi bi-home" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-a.-processing" role="button" data-bs-toggle="dropdown" aria-expanded="false">A. Processing</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-a.-processing">
<li class="dropdown-header">Workflows</li>
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="./dada2.html">
 <span class="dropdown-text">1. DADA2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./data-prep.html">
 <span class="dropdown-text">2. Data Set Prep</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./filtering.html">
 <span class="dropdown-text">3. Filtering</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-b.-diversity" role="button" data-bs-toggle="dropdown" aria-expanded="false">B. Diversity</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-b.-diversity">
<li class="dropdown-header">Workflows</li>
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="./taxa.html">
 <span class="dropdown-text">4. Taxonomic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./alpha.html">
 <span class="dropdown-text">5. Alpha Diversity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./beta.html">
 <span class="dropdown-text">6. Beta Diversity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./da.html">
 <span class="dropdown-text">7. DA ASVs &amp; Taxa</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./metadata.html">
 <span class="dropdown-text">8. Metadata</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link active" href="./data-availability.html" aria-current="page">DATA</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./pub.html">PAPER</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./som.html">SOM</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sweltr/high-temp/"><i class="bi bi-github" role="img" aria-label="Agua Salud GitHub">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="./about.html"><i class="bi bi-question" role="img">
</i> 
 </a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">6. Beta Diversity &amp; Dispersion Estimates</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">6. Beta Diversity &amp; Dispersion Estimates</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
                  <div>
        <div class="description">
          <p>Reproducible workflow for assessing community dissimilarity across temperature treatments.</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">A. Processing</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dada2.html" class="sidebar-item-text sidebar-link">1. DADA2 Workflow</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-prep.html" class="sidebar-item-text sidebar-link">2. Data Set Preparation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./filtering.html" class="sidebar-item-text sidebar-link">3. Filtering</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">B. Diversity</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./taxa.html" class="sidebar-item-text sidebar-link">4. Taxonomic Diversity</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./alpha.html" class="sidebar-item-text sidebar-link">5. Alpha Diversity Estimates</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./beta.html" class="sidebar-item-text sidebar-link active">6. Beta Diversity &amp; Dispersion Estimates</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./da.html" class="sidebar-item-text sidebar-link">7. Differentially Abundant ASVs &amp; Taxa</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metadata.html" class="sidebar-item-text sidebar-link">8. Metadata Analysis</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">More</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-availability.html" class="sidebar-item-text sidebar-link">Data Availability</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./som.html" class="sidebar-item-text sidebar-link">Electronic Supplementary Material</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">Website Contruction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pub.html" class="sidebar-item-text sidebar-link">Code for Publication Figures</a>
  </div>
</li>
    </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#synopsis" id="toc-synopsis" class="nav-link active" data-scroll-target="#synopsis">Synopsis</a>
  <ul class="collapse">
<li><a href="#workflow-input" id="toc-workflow-input" class="nav-link" data-scroll-target="#workflow-input">Workflow Input</a></li>
  </ul>
</li>
  <li>
<a href="#s-rrna" id="toc-s-rrna" class="nav-link" data-scroll-target="#s-rrna">16s rRNA</a>
  <ul class="collapse">
<li><a href="#beta-dispersion" id="toc-beta-dispersion" class="nav-link" data-scroll-target="#beta-dispersion">Beta Dispersion</a></li>
  <li><a href="#significance-tests" id="toc-significance-tests" class="nav-link" data-scroll-target="#significance-tests">Significance Tests</a></li>
  <li><a href="#summaries" id="toc-summaries" class="nav-link" data-scroll-target="#summaries">Summaries</a></li>
  </ul>
</li>
  <li>
<a href="#its" id="toc-its" class="nav-link" data-scroll-target="#its">ITS</a>
  <ul class="collapse">
<li><a href="#beta-dispersion-1" id="toc-beta-dispersion-1" class="nav-link" data-scroll-target="#beta-dispersion-1">Beta Dispersion</a></li>
  <li><a href="#significance-tests-1" id="toc-significance-tests-1" class="nav-link" data-scroll-target="#significance-tests-1">Significance Tests</a></li>
  <li><a href="#summaries-1" id="toc-summaries-1" class="nav-link" data-scroll-target="#summaries-1">Summaries</a></li>
  </ul>
</li>
  <li>
<a href="#ordinations" id="toc-ordinations" class="nav-link" data-scroll-target="#ordinations">Ordinations</a>
  <ul class="collapse">
<li><a href="#s-rrna-1" id="toc-s-rrna-1" class="nav-link" data-scroll-target="#s-rrna-1">16S rRNA</a></li>
  <li><a href="#its-1" id="toc-its-1" class="nav-link" data-scroll-target="#its-1">ITS</a></li>
  </ul>
</li>
  <li>
<a href="#within-between-group-distances" id="toc-within-between-group-distances" class="nav-link" data-scroll-target="#within-between-group-distances">Within &amp; Between Group Distances</a>
  <ul class="collapse">
<li><a href="#s-rrna-2" id="toc-s-rrna-2" class="nav-link" data-scroll-target="#s-rrna-2">16S rRNA</a></li>
  <li><a href="#its-2" id="toc-its-2" class="nav-link" data-scroll-target="#its-2">ITS</a></li>
  </ul>
</li>
  <li><a href="#workflow-output" id="toc-workflow-output" class="nav-link" data-scroll-target="#workflow-output">Workflow Output</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/sweltr/high-temp/edit/main/beta.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/sweltr/high-temp/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><details><summary><strong>Click here</strong> for setup information.
</summary><div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span>, eval <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">119</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217">phyloseq</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"phyloseq"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biostrings">Biostrings</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"Biostrings"</span><span class="op">)</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, 
               <span class="va">microbiome</span>, <span class="va">phytools</span>, <span class="va">phangorn</span>, <span class="va">reactable</span>, <span class="va">Matrix</span>, 
               <span class="va">pairwiseAdonis</span>, <span class="va">naniar</span>, <span class="va">downloadthis</span>,
               <span class="va">labdsv</span>, <span class="va">patchwork</span>, <span class="va">agricolae</span>, <span class="va">captioner</span>, <span class="va">microeco</span>,
               install <span class="op">=</span> <span class="cn">FALSE</span>, update <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co">#pacman::p_depends(agricolae, local = TRUE)  </span>
<span class="co">#pacman::p_depends_reverse(agricolae, local = TRUE)  </span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_current</a></span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span>
  <span class="st">"cache"</span>,
  <span class="st">"cache.path"</span>,
  <span class="st">"cache.rebuild"</span>,
  <span class="st">"dependson"</span>,
  <span class="st">"autodep"</span>
<span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details><div class="cell">

</div>
<div class="cell">

</div>
<section id="synopsis" class="level1"><h1>Synopsis</h1>
<p>This workflow contains beta diversity assessments for the high temperature data sets. In order to run the workflow, you either need to first run the <a href="dada2.html">DADA2 Workflow for 2018 High Temp samples</a>, the <a href="data-prep.html">Data Preparation workflow</a>, and the <a href="alpha.html">Alpha diversity workflow</a> <strong>or</strong> download the files linked below. See the <a href="data-availability.html">Data Availability</a> page for complete details.</p>
<section id="workflow-input" class="level2"><h2 class="anchored" data-anchor-id="workflow-input">Workflow Input</h2>
<p>Files needed to run this workflow can be downloaded from figshare.</p>
<iframe src="https://widgets.figshare.com/articles/16826779/embed?show_title=1" width="100%" height="251" allowfullscreen="" frameborder="0">
</iframe>
</section></section><section id="s-rrna" class="level1 page-columns page-full"><h1>16s rRNA</h1>
<div class="cell">

</div>
<p>In order to test for significance between sample groups, we must perform the following steps:</p>
<ol type="1">
<li>Transform sample counts to relative abundance.</li>
<li>Create distance matrices based on some metrics, for example <code>wunifrac</code>, <code>unifrac</code>, and <code>jsd</code>. For this we use the function <code><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">phyloseq::distance</a></code>.</li>
<li>Next, calculate beta dispersion using the <code>betadisper</code> function from the <code>vegan</code> package <span class="citation" data-cites="oksanen2013community">(<a href="#ref-oksanen2013community" role="doc-biblioref">Oksanen et al. 2012</a>)</span>.</li>
<li>Then, use the function <code>permutest</code> to run a Permutation test for homogeneity of multivariate dispersions.</li>
<li>If the beta dispersion tests are not significant we will run a PERMANOVA using <code>adonis</code> (since PERMANOVA assumes equal dispersion), otherwise we will use Analysis of Similarity (ANOSIM), both available in the <code>vegan</code> package <span class="citation" data-cites="oksanen2013community">(<a href="#ref-oksanen2013community" role="doc-biblioref">Oksanen et al. 2012</a>)</span>.</li>
</ol>
<p>Steps 2–4 are combined in a <code>for</code> loop that tests all three distance metrics.</p>
<p>Before we begin, we need to first transform sample counts to relative abundance and generate some new trees.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu_samp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, 
             <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">ssu_samp_ps</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_prop"</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transformcounts.html">transform_sample_counts</a></span><span class="op">(</span><span class="va">tmp_get</span>, <span class="kw">function</span><span class="op">(</span><span class="va">otu</span><span class="op">)</span> 
                                          <span class="fl">1e5</span> <span class="op">*</span> <span class="va">otu</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">otu</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_ps</span><span class="op">@</span><span class="va">phy_tree</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/prune_samples-methods.html">prune_samples</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_sums.html">sample_sums</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">tmp_ps</span><span class="op">)</span>
     <span class="va">tmp_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>, 
                       tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">tmp_ps</span>, <span class="va">sample_data</span>, <span class="va">tmp_tree</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tmp_name</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_ps</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="beta-dispersion" class="level2"><h2 class="anchored" data-anchor-id="beta-dispersion">Beta Dispersion</h2>
<p>Here we create distance matrices for each metric, calculate the beta dispersion, and run a permutation test for homogeneity of multivariate dispersions.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"jsd"</span>, <span class="st">"unifrac"</span>, <span class="st">"wunifrac"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">ssu_samp_ps</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="va">ssu_dist</span><span class="op">)</span><span class="op">{</span>
       <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_prop"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
       <span class="va">tmp_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_get</span><span class="op">)</span><span class="op">)</span>
       <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">tmp_get</span>, method <span class="op">=</span> <span class="va">d</span><span class="op">)</span>
       <span class="va">tmp_df_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_beta_dist_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_df_name</span>, <span class="va">tmp_df</span><span class="op">)</span>
       <span class="va">tmp_df2</span> <span class="op">&lt;-</span> <span class="fu">betadisper</span><span class="op">(</span><span class="va">tmp_df</span>, <span class="va">tmp_samp</span><span class="op">$</span><span class="va">TEMP</span>, bias.adjust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
       <span class="va">tmp_df_name2</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_beta_dispersion_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_df_name2</span>, <span class="va">tmp_df2</span><span class="op">)</span>
       <span class="va">tmp_df3</span> <span class="op">&lt;-</span> <span class="fu">permutest</span><span class="op">(</span><span class="va">tmp_df2</span>, pairwise <span class="op">=</span> <span class="cn">TRUE</span>,
                            permutations <span class="op">=</span> <span class="fl">1000</span>, binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
       <span class="va">tmp_df_name3</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_permutest_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_df_name3</span>, <span class="va">tmp_df3</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details><summary><strong>Detailed results</strong> of Beta Dispersion &amp; Permutation tests
</summary><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
#################################################### 
BETA DISPERSION significance test jsd distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.018639 0.0093195 2.9882   1000 0.1089
Residuals 12 0.037425 0.0031188                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3      8
0          0.465534 0.1638
3 0.412469          0.0599
8 0.159005 0.075347       

#################################################### 
BETA DISPERSION significance test unifrac distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df    Sum Sq    Mean Sq      F N.Perm  Pr(&gt;F)   
Groups     2 0.0062292 0.00311458 5.3484   1000 0.00999 **
Residuals 12 0.0069881 0.00058234                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3     8
0          0.831169 0.012
3 0.727926          0.032
8 0.033203 0.048150      

#################################################### 
BETA DISPERSION significance test wunifrac distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm   Pr(&gt;F)   
Groups     2 0.018783 0.0093917 7.3178   1000 0.005994 **
Residuals 12 0.015401 0.0012834                          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3     8
0          0.957043 0.015
3 0.938214          0.004
8 0.024555 0.019472      </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
#################################################### 
BETA DISPERSION significance test jsd distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm  Pr(&gt;F)  
Groups     2 0.019867 0.0099333 3.0824   1000 0.08891 .
Residuals 12 0.038671 0.0032226                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3      8
0          0.854146 0.0859
3 0.843567          0.0869
8 0.112793 0.090799       

#################################################### 
BETA DISPERSION significance test unifrac distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm   Pr(&gt;F)   
Groups     2 0.025430 0.0127152 7.0788   1000 0.005994 **
Residuals 12 0.021555 0.0017962                          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3     8
0          0.583417 0.011
3 0.568432          0.018
8 0.018174 0.023627      

#################################################### 
BETA DISPERSION significance test wunifrac distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm   Pr(&gt;F)   
Groups     2 0.023408 0.0117041 6.7591   1000 0.004995 **
Residuals 12 0.020779 0.0017316                          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3     8
0          0.565435 0.008
3 0.528192          0.013
8 0.023244 0.032852      </code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
#################################################### 
BETA DISPERSION significance test jsd distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm  Pr(&gt;F)  
Groups     2 0.027097 0.0135487 4.5971   1000 0.02098 *
Residuals 12 0.035367 0.0029472                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3     8
0          0.778222 0.044
3 0.771551          0.027
8 0.061934 0.045555      

#################################################### 
BETA DISPERSION significance test unifrac distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm   Pr(&gt;F)   
Groups     2 0.034618 0.0173088 9.4781   1000 0.003996 **
Residuals 12 0.021914 0.0018262                          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
          0         3     8
0           0.5684316 0.008
3 0.5529721           0.008
8 0.0088715 0.0096445      

#################################################### 
BETA DISPERSION significance test wunifrac distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm   Pr(&gt;F)   
Groups     2 0.020738 0.0103692 7.5898   1000 0.002997 **
Residuals 12 0.016395 0.0013662                          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3     8
0          0.547453 0.005
3 0.516927          0.003
8 0.027061 0.017081      </code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
#################################################### 
BETA DISPERSION significance test jsd distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.007284 0.0036418 0.9199   1000 0.4356
Residuals 12 0.047509 0.0039591                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.84515 0.3876
3 0.82435         0.3407
8 0.37620 0.31969       

#################################################### 
BETA DISPERSION significance test unifrac distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.016868 0.0084341 1.4936   1000 0.2398
Residuals 12 0.067761 0.0056468                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.97902 0.2617
3 0.97444         0.2058
8 0.24180 0.21934       

#################################################### 
BETA DISPERSION significance test wunifrac distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm   Pr(&gt;F)   
Groups     2 0.025802 0.0129010 8.6861   1000 0.008991 **
Residuals 12 0.017823 0.0014852                          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3     8
0          0.982018 0.006
3 0.982289          0.004
8 0.015248 0.014089      </code></pre>
</div>
</div>
</div>
</div>
</div>
</details><p>Remember, if the beta dispersion p-value is greater than <code>0.05</code> we use PERMANOVA, otherwise we use ANOSIM.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 1 | Summary of Beta Dispersion Tests for unfiltered &amp; filtered data sets against various distance metrics. The <code>test</code> column shows the method chosen (based on the test results) to assess differences in beta diversity. If p-values are significant (red, p-value &lt; 0.05) we used ANOSIM, otherwise we used PERMANOVA (blue, p-value &gt; 0.05).</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,ZGF0YXNldCxkaXN0LHB2YWwsdGVzdApGVUxMLEplbnNlbuKAk1NoYW5ub24gZGl2ZXJnZW5jZSwwLjEwODksQURPTklTCkZVTEwsdW53ZWlnaHRlZCBVbmlGcmFjLDAuMDEsQU5PU0lNCkZVTEwsd2VpZ2h0ZWQgVW5pRnJhYywwLjAwNixBTk9TSU0KRklMVCxKZW5zZW7igJNTaGFubm9uIGRpdmVyZ2VuY2UsMC4wODg5LEFET05JUwpGSUxULHVud2VpZ2h0ZWQgVW5pRnJhYywwLjAwNixBTk9TSU0KRklMVCx3ZWlnaHRlZCBVbmlGcmFjLDAuMDA1LEFOT1NJTQpQRVJmZWN0LEplbnNlbuKAk1NoYW5ub24gZGl2ZXJnZW5jZSwwLjAyMSxBTk9TSU0KUEVSZmVjdCx1bndlaWdodGVkIFVuaUZyYWMsMC4wMDQsQU5PU0lNClBFUmZlY3Qsd2VpZ2h0ZWQgVW5pRnJhYywwLjAwMyxBTk9TSU0KUElNRSxKZW5zZW7igJNTaGFubm9uIGRpdmVyZ2VuY2UsMC40MzU2LEFET05JUwpQSU1FLHVud2VpZ2h0ZWQgVW5pRnJhYywwLjIzOTgsQURPTklTClBJTUUsd2VpZ2h0ZWQgVW5pRnJhYywwLjAwOSxBTk9TSU0K').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_beta_disp_tests.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-31a3b0c40f02f5187ab1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-31a3b0c40f02f5187ab1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"dataset":["FULL","FULL","FULL","FILT","FILT","FILT","PERfect","PERfect","PERfect","PIME","PIME","PIME"],"dist":["Jensen–Shannon divergence","unweighted UniFrac","weighted UniFrac","Jensen–Shannon divergence","unweighted UniFrac","weighted UniFrac","Jensen–Shannon divergence","unweighted UniFrac","weighted UniFrac","Jensen–Shannon divergence","unweighted UniFrac","weighted UniFrac"],"pval":[0.1089,0.01,0.006,0.0889,0.006,0.005,0.021,0.004,0.003,0.4356,0.2398,0.009],"test":["ADONIS","ANOSIM","ANOSIM","ADONIS","ANOSIM","ANOSIM","ANOSIM","ANOSIM","ANOSIM","ADONIS","ADONIS","ANOSIM"]},"columns":[{"accessor":"dataset","name":"Dataset","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["FULL","FULL","FULL","FILT","FILT","FILT","PERfect","PERfect","PERfect","PIME","PIME","PIME"],"header":"Dataset","minWidth":50,"align":"left","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"dist","name":"distance","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["Jensen–Shannon divergence","unweighted UniFrac","weighted UniFrac","Jensen–Shannon divergence","unweighted UniFrac","weighted UniFrac","Jensen–Shannon divergence","unweighted UniFrac","weighted UniFrac","Jensen–Shannon divergence","unweighted UniFrac","weighted UniFrac"],"header":"distance","minWidth":100,"align":"left","headerVAlign":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"pval","name":"p-value","type":"numeric","sortable":true,"resizable":false,"filterable":true,"cell":["0.1089","0.0100","0.0060","0.0889","0.0060","0.0050","0.0210","0.0040","0.0030","0.4356","0.2398","0.0090"],"header":"p-value","minWidth":100,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}]},{"accessor":"test","name":"test","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["ADONIS","ANOSIM","ANOSIM","ADONIS","ANOSIM","ANOSIM","ANOSIM","ANOSIM","ANOSIM","ADONIS","ADONIS","ANOSIM"],"header":"test","minWidth":100,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":12,"showPageSizeOptions":true,"pageSizeOptions":[5,10,12],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"125489211532ae68fedb7a51e9633aab"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Now we to create sample data frames for each data set.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">ssu_samp_ps</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_prop"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_get</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_sampledf"</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_samp</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"_sampledf"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="significance-tests" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="significance-tests">Significance Tests</h2>
<p>Depending on the test, we need different data structures. For <code>adonis</code> we use the sample metadata and for <code>anosim</code> we will start with a phyloseq object. So for each data set we create two variables: <code>adonis_sampledf</code> and <code>anosim_data</code></p>
<div class="column-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">

</div>
<div class="cell">

</div>
<p>Is the p-value of the jsd distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_work_adonis_jsd</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">ssu18_ps_work_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">ssu18_ps_work_adonis2_jsd</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">ssu18_ps_work_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the unifrac distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_work_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_ps_work_anosim_unifrac</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">ssu18_ps_work_prop</span>, <span class="st">"unifrac"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">ssu18_ps_work_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the wunifrac distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_work_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_ps_work_anosim_wunifrac</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">ssu18_ps_work_prop</span>, <span class="st">"wunifrac"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">ssu18_ps_work_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">

</div>
<div class="cell">

</div>
<p>Is the p-value of the jsd distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_filt_adonis_jsd</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">ssu18_ps_filt_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">ssu18_ps_filt_adonis2_jsd</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">ssu18_ps_filt_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the unifrac distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_filt_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_ps_filt_anosim_unifrac</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">ssu18_ps_filt_prop</span>, <span class="st">"unifrac"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">ssu18_ps_filt_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the wunifrac distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_filt_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_ps_filt_anosim_wunifrac</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">ssu18_ps_filt_prop</span>, <span class="st">"wunifrac"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">ssu18_ps_filt_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">

</div>
<div class="cell">

</div>
<p>Is the p-value of the jsd distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_perfect_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_ps_perfect_anosim_jsd</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">ssu18_ps_perfect_prop</span>, <span class="st">"jsd"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">ssu18_ps_perfect_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the unifrac distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_perfect_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_ps_perfect_anosim_unifrac</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">ssu18_ps_perfect_prop</span>, <span class="st">"unifrac"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">ssu18_ps_perfect_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the wunifrac distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_perfect_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_ps_perfect_anosim_wunifrac</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">ssu18_ps_perfect_prop</span>, <span class="st">"wunifrac"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">ssu18_ps_perfect_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">

</div>
<div class="cell">

</div>
<p>Is the p-value of the jsd distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_pime_adonis_jsd</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">ssu18_ps_pime_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">ssu18_ps_pime_adonis2_jsd</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">ssu18_ps_pime_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the unifrac distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_pime_adonis_unifrac</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">ssu18_ps_pime_beta_dist_unifrac</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                     data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">ssu18_ps_pime_adonis2_unifrac</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">ssu18_ps_pime_beta_dist_unifrac</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                      data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the wunifrac distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_pime_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_ps_pime_anosim_wunifrac</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">ssu18_ps_pime_prop</span>, <span class="st">"wunifrac"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">ssu18_ps_pime_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<details><summary><strong>Detailed results</strong> of Significance tests
</summary><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Jensen-Shannon Divergence, `jsd`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = ssu18_ps_work_beta_dist_jsd ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs      R2      F   Pr(&gt;F)   
TEMP      2  0.21809 0.23826 1.8767 0.003996 **
Residual 12  0.69727 0.76174                   
Total    14  0.91536 1.00000                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Unweighted UniFrac distance, `unifrac`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(ssu18_ps_work_prop, "unifrac"),      grouping = ssu18_ps_work_groups) 
Dissimilarity: 

ANOSIM statistic R: 0.2356 
      Significance: 0.003 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
   90%    95%  97.5%    99% 
0.0873 0.1130 0.1396 0.1725 

Dissimilarity ranks between and within classes:
        0%   25%  50%   75% 100%  N
Between  1 32.50 58.0 81.00  103 75
0        2 10.25 17.5 33.25   56 10
3        4 14.75 26.5 41.00   65 10
8       39 69.75 85.5 94.25  105 10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Weighted-UniFrac distance, `wunifrac`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(ssu18_ps_work_prop, "wunifrac"),      grouping = ssu18_ps_work_groups) 
Dissimilarity: 

ANOSIM statistic R: 0.3218 
      Significance: 0.001 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.090 0.120 0.149 0.176 

Dissimilarity ranks between and within classes:
        0%   25%  50%    75% 100%  N
Between  2 36.50 59.0  81.50  102 75
0        3  9.75 20.5  35.00   50 10
3        1 14.50 19.0  27.75   48 10
8       17 66.75 80.5 102.00  105 10</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Jensen-Shannon Divergence, `jsd`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = ssu18_ps_filt_beta_dist_jsd ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs      R2      F  Pr(&gt;F)   
TEMP      2  0.15050 0.29049 2.4566 0.00999 **
Residual 12  0.36758 0.70951                  
Total    14  0.51808 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Unweighted UniFrac distance, `unifrac`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(ssu18_ps_filt_prop, "unifrac"),      grouping = ssu18_ps_filt_groups) 
Dissimilarity: 

ANOSIM statistic R: 0.2427 
      Significance: 0.009 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.109 0.136 0.169 0.225 

Dissimilarity ranks between and within classes:
        0%   25%  50%   75% 100%  N
Between  2 35.00 58.0 81.50  102 75
0        1  7.75 17.5 34.75   59 10
3       13 23.00 28.5 34.50   57 10
8       11 66.50 81.5 99.50  105 10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Weighted-UniFrac distance, `wunifrac`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(ssu18_ps_filt_prop, "wunifrac"),      grouping = ssu18_ps_filt_groups) 
Dissimilarity: 

ANOSIM statistic R: 0.3618 
      Significance: 0.001 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.103 0.140 0.173 0.216 

Dissimilarity ranks between and within classes:
        0%   25% 50%   75% 100%  N
Between  3 37.50  61 82.50  104 75
0        1  7.25  14 27.25   36 10
3        2 13.00  27 37.75   43 10
8       23 59.25  76 99.00  105 10</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Jensen-Shannon Divergence, `jsd`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(ssu18_ps_perfect_prop, "jsd"),      grouping = ssu18_ps_perfect_groups) 
Dissimilarity: 

ANOSIM statistic R: 0.2996 
      Significance: 0.001 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
   90%    95%  97.5%    99% 
0.0999 0.1450 0.1770 0.2081 

Dissimilarity ranks between and within classes:
        0%  25%  50%   75% 100%  N
Between  2 33.5 61.0 83.50  104 75
0        5 15.5 19.5 44.75   59 10
3        1  9.5 23.0 29.75   57 10
8       39 53.5 75.0 95.50  105 10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Unweighted UniFrac distance, `unifrac`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(ssu18_ps_perfect_prop, "unifrac"),      grouping = ssu18_ps_perfect_groups) 
Dissimilarity: 

ANOSIM statistic R: 0.2053 
      Significance: 0.007 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
   90%    95%  97.5%    99% 
0.0908 0.1191 0.1441 0.1814 

Dissimilarity ranks between and within classes:
        0%   25% 50%    75% 100%  N
Between  5 31.00  59  81.50  102 75
0        1  4.75  14  36.25   56 10
3        4 21.75  34  43.50   53 10
8       52 70.50  80 100.00  105 10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Weighted-UniFrac distance, `wunifrac`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(ssu18_ps_perfect_prop, "wunifrac"),      grouping = ssu18_ps_perfect_groups) 
Dissimilarity: 

ANOSIM statistic R: 0.3378 
      Significance: 0.001 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
   90%    95%  97.5%    99% 
0.0942 0.1213 0.1538 0.1831 

Dissimilarity ranks between and within classes:
        0%   25%  50%   75% 100%  N
Between  2 36.00 61.0 80.50  105 75
0        1 20.00 26.5 35.50   40 10
3        3  6.25 15.5 20.75   42 10
8       14 61.00 92.5 99.25  104 10</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Jensen-Shannon Divergence, `jsd`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = ssu18_ps_pime_beta_dist_jsd ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs      R2      F   Pr(&gt;F)    
TEMP      2  0.23994 0.59595 8.8496 0.000999 ***
Residual 12  0.16268 0.40405                    
Total    14  0.40262 1.00000                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Unweighted UniFrac distance, `unifrac`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = ssu18_ps_pime_beta_dist_unifrac ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs      R2      F   Pr(&gt;F)    
TEMP      2  0.78789 0.64853 11.071 0.000999 ***
Residual 12  0.42699 0.35147                    
Total    14  1.21488 1.00000                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Weighted-UniFrac distance, `wunifrac`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(ssu18_ps_pime_prop, "wunifrac"),      grouping = ssu18_ps_pime_groups) 
Dissimilarity: 

ANOSIM statistic R: 0.5316 
      Significance: 0.001 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.114 0.157 0.207 0.262 

Dissimilarity ranks between and within classes:
        0%   25% 50%  75% 100%  N
Between  9 41.00  62 85.5  105 75
0        1  8.75  17 28.5   37 10
3        2  5.50  17 26.5   39 10
8        4 50.50  73 81.0   97 10</code></pre>
</div>
</div>
</div>
</div>
</div>
</details></section><section id="summaries" class="level2"><h2 class="anchored" data-anchor-id="summaries">Summaries</h2>
<p>Here is a quick summary of significance tests for the data sets against three distance matrices.</p>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 2 | Summary of significant tests for the unfiltered &amp; filtered data sets. P-values in red indicate significant differences (p-value &lt; 0.05).</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,ZGlzdGFuY2UgbWV0cmljLEZVTEwsRklMVCxQRVJmZWN0LFBJTUUKSmVuc2VuLVNoYW5ub24gRGl2ZXJnZW5jZSwwLjAwNiwwLjAxLDAuMDAxLDAuMDAxCnVud2VpZ2h0ZWQgVW5pRnJhYywwLjAwMywwLjAwOSwwLjAwNywwLjAwMQp3ZWlnaHRlZCBVbmlGcmFjLDAuMDAxLDAuMDAxLDAuMDAxLDAuMDAxCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_sign_tests.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-c3ea03c924b74986196c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c3ea03c924b74986196c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"distance metric":["Jensen-Shannon Divergence","unweighted UniFrac","weighted UniFrac"],"FULL":[0.006,0.003,0.001],"FILT":[0.01,0.009,0.001],"PERfect":[0.001,0.007,0.001],"PIME":[0.001,0.001,0.001]},"columns":[{"accessor":"distance metric","name":"Distance metric","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["Jensen-Shannon Divergence","unweighted UniFrac","weighted UniFrac"],"header":"Distance metric","minWidth":200,"align":"left","headerVAlign":"center","style":{"borderRight":"1px solid #eee"},"footerStyle":{"fontWeight":"bold"},"sticky":"left","headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"FULL","name":"FULL","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.006","0.003","0.001"],"header":"FULL","minWidth":100,"align":"center","headerVAlign":"center","style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}],"footerStyle":{"fontWeight":"bold"}},{"accessor":"FILT","name":"FILT","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.010","0.009","0.001"],"header":"FILT","minWidth":100,"align":"center","headerVAlign":"center","style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}],"footerStyle":{"fontWeight":"bold"}},{"accessor":"PERfect","name":"PERfect","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","0.007","0.001"],"header":"PERfect","minWidth":100,"align":"center","headerVAlign":"center","style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}],"footerStyle":{"fontWeight":"bold"}},{"accessor":"PIME","name":"PIME","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","0.001","0.001"],"header":"PIME","minWidth":100,"align":"center","headerVAlign":"center","style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}],"footerStyle":{"fontWeight":"bold"}}],"columnGroups":[{"name":"p-values","headerStyle":{"fontSize":"1.3em"},"columns":["FULL","FILT","PERfect","PIME"]}],"defaultPageSize":12,"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"theme":{"style":{"fontSize":"0.9em"}},"dataKey":"bd26b561fb9059d6b0e32a959b06d95c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section id="its" class="level1 page-columns page-full"><h1>ITS</h1>
<div class="cell">

</div>
<p>In order to test for significance between sample groups, we must perform the following steps:</p>
<ol type="1">
<li>Transform sample counts to relative abundance.</li>
<li>Create distance matrices based on some metrics, for example <code>gower</code>, <code>bray</code>, and <code>jsd</code>. For this we use the function <code><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">phyloseq::distance</a></code>.</li>
<li>Next, calculate beta dispersion using the <code>betadisper</code> function from the <code>vegan</code> package <span class="citation" data-cites="oksanen2013community">(<a href="#ref-oksanen2013community" role="doc-biblioref">Oksanen et al. 2012</a>)</span>.</li>
<li>Then, use the function <code>permutest</code> to run a Permutation test for homogeneity of multivariate dispersions.</li>
<li>If the beta dispersion tests are not significant we will run a PERMANOVA using <code>adonis</code> (since PERMANOVA aitsmes equal dispersion), otherwise we will use Analysis of Similarity (ANOSIM), both available in the <code>vegan</code> package <span class="citation" data-cites="oksanen2013community">(<a href="#ref-oksanen2013community" role="doc-biblioref">Oksanen et al. 2012</a>)</span>.</li>
</ol>
<p>Steps 2–4 are combined in a <code>for</code> loop that tests all three distance metrics.</p>
<p>Before we begin, we need to first transform sample counts to relative abundance and generate some new trees.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its_samp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, 
             <span class="st">"its18_ps_perfect"</span>, <span class="st">"its18_ps_pime"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">its_samp_ps</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_prop"</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transformcounts.html">transform_sample_counts</a></span><span class="op">(</span><span class="va">tmp_get</span>, <span class="kw">function</span><span class="op">(</span><span class="va">otu</span><span class="op">)</span> 
                                          <span class="fl">1e5</span> <span class="op">*</span> <span class="va">otu</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">otu</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_ps</span><span class="op">@</span><span class="va">phy_tree</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/prune_samples-methods.html">prune_samples</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_sums.html">sample_sums</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">tmp_ps</span><span class="op">)</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">tmp_ps</span>, <span class="va">sample_data</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tmp_name</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_ps</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="beta-dispersion-1" class="level3"><h3 class="anchored" data-anchor-id="beta-dispersion-1">Beta Dispersion</h3>
<p>Here we create distance matrices for each metric, calculate the beta dispersion, and run a permutation test for homogeneity of multivariate dispersions.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"jsd"</span>, <span class="st">"bray"</span>, <span class="st">"gower"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">its_samp_ps</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="va">its_dist</span><span class="op">)</span><span class="op">{</span>
       <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_prop"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
       <span class="va">tmp_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_get</span><span class="op">)</span><span class="op">)</span>
       <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">tmp_get</span>, method <span class="op">=</span> <span class="va">d</span><span class="op">)</span>
       <span class="va">tmp_df_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_beta_dist_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_df_name</span>, <span class="va">tmp_df</span><span class="op">)</span>
       <span class="va">tmp_df2</span> <span class="op">&lt;-</span> <span class="fu">betadisper</span><span class="op">(</span><span class="va">tmp_df</span>, <span class="va">tmp_samp</span><span class="op">$</span><span class="va">TEMP</span>, bias.adjust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
       <span class="va">tmp_df_name2</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_beta_dispersion_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_df_name2</span>, <span class="va">tmp_df2</span><span class="op">)</span>
       <span class="va">tmp_df3</span> <span class="op">&lt;-</span> <span class="fu">permutest</span><span class="op">(</span><span class="va">tmp_df2</span>, pairwise <span class="op">=</span> <span class="cn">TRUE</span>,
                            permutations <span class="op">=</span> <span class="fl">1000</span>, binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
       <span class="va">tmp_df_name3</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"_permutest_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_df_name3</span>, <span class="va">tmp_df3</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details><summary><strong>Detailed results</strong> of Beta Dispersion &amp; Permutation tests
</summary><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
#################################################### 
BETA DISPERSION significance test jsd distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df    Sum Sq   Mean Sq     F N.Perm Pr(&gt;F)
Groups     2 0.0016626 0.0008313 0.272   1000 0.7522
Residuals 10 0.0305600 0.0030560                    

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.65734 0.7612
3 0.65549         0.4925
8 0.75785 0.49503       

#################################################### 
BETA DISPERSION significance test bray distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.002828 0.0014140 0.3342   1000 0.7093
Residuals 10 0.042306 0.0042306                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.51548 0.8501
3 0.53577         0.4525
8 0.85014 0.48472       

#################################################### 
BETA DISPERSION significance test gower distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df    Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.0029899 0.0014950 1.3038   1000 0.3247
Residuals 10 0.0114662 0.0011466                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.78921 0.2058
3 0.75923         0.3506
8 0.22060 0.33265       </code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
#################################################### 
BETA DISPERSION significance test jsd distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.001023 0.0005116 0.0745   1000 0.9101
Residuals 10 0.068640 0.0068640                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.68831 0.9301
3 0.67472         0.8062
8 0.92769 0.81555       

#################################################### 
BETA DISPERSION significance test bray distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.002408 0.001204 0.1338   1000 0.8801
Residuals 10 0.090000 0.009000                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.58042 0.9061
3 0.58847         0.7582
8 0.90501 0.75350       

#################################################### 
BETA DISPERSION significance test gower distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df    Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.0058376 0.0029188 2.2494   1000 0.1419
Residuals 10 0.0129758 0.0012976                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3      8
0          0.061938 0.4555
3 0.074044          0.2847
8 0.464903 0.264060       </code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
#################################################### 
BETA DISPERSION significance test jsd distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.001059 0.0005293 0.1168   1000 0.8831
Residuals 10 0.045317 0.0045317                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.69231 0.9131
3 0.71118         0.6683
8 0.92002 0.67220       

#################################################### 
BETA DISPERSION significance test bray distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.002522 0.0012611 0.2056   1000 0.8062
Residuals 10 0.061340 0.0061340                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.57443 0.9950
3 0.58316         0.6224
8 0.99819 0.62424       

#################################################### 
BETA DISPERSION significance test gower distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df    Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.0023433 0.0011716 2.0201   1000 0.2138
Residuals 10 0.0058000 0.0005800                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
         0        3      8
0          0.868132 0.1029
3 0.869601          0.2677
8 0.091826 0.229457       </code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
#################################################### 
BETA DISPERSION significance test jsd distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.007678 0.0038389 0.3436   1000 0.7163
Residuals 10 0.111712 0.0111712                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.47253 0.4805
3 0.49362         0.9760
8 0.47799 0.97911       

#################################################### 
BETA DISPERSION significance test bray distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df   Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     2 0.008276 0.0041378 0.2627   1000 0.7602
Residuals 10 0.157522 0.0157522                     

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
        0       3      8
0         0.46753 0.5874
3 0.51164         0.8821
8 0.58541 0.88566       

#################################################### 
BETA DISPERSION significance test gower distance 
####################################################

Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 1000

Response: Distances
          Df    Sum Sq   Mean Sq      F N.Perm   Pr(&gt;F)   
Groups     2 0.0165873 0.0082936 15.047   1000 0.001998 **
Residuals 10 0.0055118 0.0005512                          
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Pairwise comparisons:
(Observed p-value below diagonal, permuted p-value above diagonal)
           0          3     8
0            0.05594406 0.002
3 0.04179289            0.040
8 0.00072543 0.03074504      </code></pre>
</div>
</div>
</div>
</div>
</div>
</details><p>Remember, if the beta dispersion p-value is greater than <code>0.05</code> we use PERMANOVA, otherwise we use ANOSIM.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 1 | Summary of Beta Dispersion Tests for unfiltered &amp; filtered data sets against various distance metrics. The <code>test</code> column shows the method chosen (based on the test results) to assess differences in beta diversity. If p-values are significant (red, p-value &lt; 0.05) we used ANOSIM, otherwise we used PERMANOVA (blue, p-value &gt; 0.05).</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,ZGF0YXNldCxkaXN0LHB2YWwsdGVzdApGVUxMLEplbnNlbuKAk1NoYW5ub24gZGl2ZXJnZW5jZSwwLjc1MjIsQURPTklTCkZVTEwsQnJheS1DdXJ0aXMgZGlzc2ltaWxhcml0eSwwLjcwOTMsQURPTklTCkZVTEwsR293ZXIgZGlzdGFuY2UsMC4zMjQ3LEFET05JUwpGSUxULEplbnNlbuKAk1NoYW5ub24gZGl2ZXJnZW5jZSwwLjkxMDEsQURPTklTCkZJTFQsQnJheS1DdXJ0aXMgZGlzc2ltaWxhcml0eSwwLjg4MDEsQURPTklTCkZJTFQsR293ZXIgZGlzdGFuY2UsMC4xNDE5LEFET05JUwpQRVJmZWN0LEplbnNlbuKAk1NoYW5ub24gZGl2ZXJnZW5jZSwwLjg4MzEsQURPTklTClBFUmZlY3QsQnJheS1DdXJ0aXMgZGlzc2ltaWxhcml0eSwwLjgwNjIsQURPTklTClBFUmZlY3QsR293ZXIgZGlzdGFuY2UsMC4yMTM4LEFET05JUwpQSU1FLEplbnNlbuKAk1NoYW5ub24gZGl2ZXJnZW5jZSwwLjcxNjMsQURPTklTClBJTUUsQnJheS1DdXJ0aXMgZGlzc2ltaWxhcml0eSwwLjc2MDIsQURPTklTClBJTUUsR293ZXIgZGlzdGFuY2UsMC4wMDIsQU5PU0lNCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_beta_disp_tests.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-c6a553b98f7a91c4574d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c6a553b98f7a91c4574d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"dataset":["FULL","FULL","FULL","FILT","FILT","FILT","PERfect","PERfect","PERfect","PIME","PIME","PIME"],"dist":["Jensen–Shannon divergence","Bray-Curtis dissimilarity","Gower distance","Jensen–Shannon divergence","Bray-Curtis dissimilarity","Gower distance","Jensen–Shannon divergence","Bray-Curtis dissimilarity","Gower distance","Jensen–Shannon divergence","Bray-Curtis dissimilarity","Gower distance"],"pval":[0.7522,0.7093,0.3247,0.9101,0.8801,0.1419,0.8831,0.8062,0.2138,0.7163,0.7602,0.002],"test":["ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ANOSIM"]},"columns":[{"accessor":"dataset","name":"Dataset","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["FULL","FULL","FULL","FILT","FILT","FILT","PERfect","PERfect","PERfect","PIME","PIME","PIME"],"header":"Dataset","minWidth":50,"align":"left","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"dist","name":"distance","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["Jensen–Shannon divergence","Bray-Curtis dissimilarity","Gower distance","Jensen–Shannon divergence","Bray-Curtis dissimilarity","Gower distance","Jensen–Shannon divergence","Bray-Curtis dissimilarity","Gower distance","Jensen–Shannon divergence","Bray-Curtis dissimilarity","Gower distance"],"header":"distance","minWidth":100,"align":"left","headerVAlign":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"pval","name":"p-value","type":"numeric","sortable":true,"resizable":false,"filterable":true,"cell":["0.7522","0.7093","0.3247","0.9101","0.8801","0.1419","0.8831","0.8062","0.2138","0.7163","0.7602","0.0020"],"header":"p-value","minWidth":100,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}]},{"accessor":"test","name":"test","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ADONIS","ANOSIM"],"header":"test","minWidth":100,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":12,"showPageSizeOptions":true,"pageSizeOptions":[5,10,12],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"0e627cd3ad28b39af93d6fd48b0e16b6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Now we to create sample data frames for each data set.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">its_samp_ps</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_prop"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_get</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_sampledf"</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_samp</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"_sampledf"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="significance-tests-1" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="significance-tests-1">Significance Tests</h2>
<p>Depending on the test, we need different data structures. For <code>adonis</code> we use the sample metadata and for <code>anosim</code> we will start with a phyloseq object. So for each data set we create two variables: <code>adonis_sampledf</code> and <code>anosim_data</code></p>
<div class="column-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">

</div>
<div class="cell">

</div>
<p>Is the p-value of the jsd distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_work_adonis_jsd</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_work_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_work_adonis2_jsd</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_work_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the bray distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_work_adonis_bray</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_work_beta_dist_bray</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_work_adonis2_bray</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_work_beta_dist_bray</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the gower distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_work_adonis_gower</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_work_beta_dist_gower</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_work_adonis2_gower</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_work_beta_dist_gower</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">

</div>
<div class="cell">

</div>
<p>Is the p-value of the jsd distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_filt_adonis_jsd</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_filt_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_filt_adonis2_jsd</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_filt_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the bray distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_filt_adonis_bray</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_filt_beta_dist_bray</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_filt_adonis2_bray</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_filt_beta_dist_bray</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the gower distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_filt_adonis_gower</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_filt_beta_dist_gower</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_filt_adonis2_gower</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_filt_beta_dist_gower</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">

</div>
<div class="cell">

</div>
<p>Is the p-value of the jsd distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_perfect_adonis_jsd</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_perfect_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_perfect_adonis2_jsd</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_perfect_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the bray distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_perfect_adonis_bray</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_perfect_beta_dist_bray</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_perfect_adonis2_bray</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_perfect_beta_dist_bray</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the gower distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_perfect_adonis_gower</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_perfect_beta_dist_gower</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_perfect_adonis2_gower</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_perfect_beta_dist_gower</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">

</div>
<div class="cell">

</div>
<p>Is the p-value of the jsd distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_pime_adonis_jsd</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_pime_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_pime_adonis2_jsd</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_pime_beta_dist_jsd</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the bray distance metric less than <code>0.05</code>? FALSE.<br>
Then we use <strong>ADONIS</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_pime_adonis_bray</span> <span class="op">&lt;-</span>  <span class="fu">adonis</span><span class="op">(</span><span class="va">its18_ps_pime_beta_dist_bray</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                 data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">its18_ps_pime_adonis2_bray</span> <span class="op">&lt;-</span> <span class="fu">adonis2</span><span class="op">(</span><span class="va">its18_ps_pime_beta_dist_bray</span> <span class="op">~</span> <span class="va">TEMP</span>,
                                  data <span class="op">=</span> <span class="va">adonis_sampledf</span>, permutations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Is the p-value of the gower distance metric less than <code>0.05</code>? TRUE.<br>
Then we use <strong>ANOSIM</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_pime_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/get_variable.html">get_variable</a></span><span class="op">(</span><span class="va">anosim_data</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">its18_ps_pime_anosim_gower</span> <span class="op">&lt;-</span>
  <span class="fu">anosim</span><span class="op">(</span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="va">its18_ps_pime_prop</span>, <span class="st">"gower"</span><span class="op">)</span>,
         grouping <span class="op">=</span> <span class="va">its18_ps_pime_groups</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<details><summary><strong>Detailed results</strong> of Significance tests.
</summary><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Jensen-Shannon Divergence, `jsd`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = its18_ps_work_beta_dist_jsd ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs     R2      F  Pr(&gt;F)  
TEMP      2  0.38087 0.2287 1.4826 0.03796 *
Residual 10  1.28448 0.7713                 
Total    12  1.66534 1.0000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Bray-Curtis dissimilarity, `bray`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Df        SumOfSqs            R2               F        
 Min.   : 2   Min.   :0.9003   Min.   :0.2070   Min.   :1.305  
 1st Qu.: 6   1st Qu.:2.1744   1st Qu.:0.5000   1st Qu.:1.305  
 Median :10   Median :3.4484   Median :0.7930   Median :1.305  
 Mean   : 8   Mean   :2.8992   Mean   :0.6667   Mean   :1.305  
 3rd Qu.:11   3rd Qu.:3.8986   3rd Qu.:0.8965   3rd Qu.:1.305  
 Max.   :12   Max.   :4.3488   Max.   :1.0000   Max.   :1.305  
                                                NA's   :2      
     Pr(&gt;F)       
 Min.   :0.05095  
 1st Qu.:0.05095  
 Median :0.05095  
 Mean   :0.05095  
 3rd Qu.:0.05095  
 Max.   :0.05095  
 NA's   :2        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Gower distance, `gower`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Df        SumOfSqs             R2               F        
 Min.   : 2   Min.   :0.05219   Min.   :0.2016   Min.   :1.263  
 1st Qu.: 6   1st Qu.:0.12941   1st Qu.:0.5000   1st Qu.:1.263  
 Median :10   Median :0.20664   Median :0.7984   Median :1.263  
 Mean   : 8   Mean   :0.17255   Mean   :0.6667   Mean   :1.263  
 3rd Qu.:11   3rd Qu.:0.23273   3rd Qu.:0.8992   3rd Qu.:1.263  
 Max.   :12   Max.   :0.25882   Max.   :1.0000   Max.   :1.263  
                                                 NA's   :2      
     Pr(&gt;F)       
 Min.   :0.00999  
 1st Qu.:0.00999  
 Median :0.00999  
 Mean   :0.00999  
 3rd Qu.:0.00999  
 Max.   :0.00999  
 NA's   :2        </code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Jensen-Shannon Divergence, `jsd`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = its18_ps_filt_beta_dist_jsd ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs      R2      F  Pr(&gt;F)  
TEMP      2  0.36598 0.25398 1.7022 0.02498 *
Residual 10  1.07499 0.74602                 
Total    12  1.44097 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Bray-Curtis dissimilarity, `bray`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Df        SumOfSqs            R2               F        
 Min.   : 2   Min.   :0.8899   Min.   :0.2216   Min.   :1.423  
 1st Qu.: 6   1st Qu.:2.0078   1st Qu.:0.5000   1st Qu.:1.423  
 Median :10   Median :3.1257   Median :0.7784   Median :1.423  
 Mean   : 8   Mean   :2.6770   Mean   :0.6667   Mean   :1.423  
 3rd Qu.:11   3rd Qu.:3.5706   3rd Qu.:0.8892   3rd Qu.:1.423  
 Max.   :12   Max.   :4.0155   Max.   :1.0000   Max.   :1.423  
                                                NA's   :2      
     Pr(&gt;F)       
 Min.   :0.03996  
 1st Qu.:0.03996  
 Median :0.03996  
 Mean   :0.03996  
 3rd Qu.:0.03996  
 Max.   :0.03996  
 NA's   :2        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Gower distance, `gower`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Df        SumOfSqs            R2               F        
 Min.   : 2   Min.   :0.1076   Min.   :0.2416   Min.   :1.593  
 1st Qu.: 6   1st Qu.:0.2225   1st Qu.:0.5000   1st Qu.:1.593  
 Median :10   Median :0.3375   Median :0.7584   Median :1.593  
 Mean   : 8   Mean   :0.2967   Mean   :0.6667   Mean   :1.593  
 3rd Qu.:11   3rd Qu.:0.3913   3rd Qu.:0.8792   3rd Qu.:1.593  
 Max.   :12   Max.   :0.4451   Max.   :1.0000   Max.   :1.593  
                                                NA's   :2      
     Pr(&gt;F)        
 Min.   :0.006993  
 1st Qu.:0.006993  
 Median :0.006993  
 Mean   :0.006993  
 3rd Qu.:0.006993  
 Max.   :0.006993  
 NA's   :2         </code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Jensen-Shannon Divergence, `jsd`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = its18_ps_perfect_beta_dist_jsd ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs      R2      F  Pr(&gt;F)  
TEMP      2  0.38311 0.23194 1.5099 0.04296 *
Residual 10  1.26864 0.76806                 
Total    12  1.65176 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Bray-Curtis dissimilarity, `bray`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Df        SumOfSqs            R2               F        
 Min.   : 2   Min.   :0.8938   Min.   :0.2056   Min.   :1.294  
 1st Qu.: 6   1st Qu.:2.1734   1st Qu.:0.5000   1st Qu.:1.294  
 Median :10   Median :3.4530   Median :0.7944   Median :1.294  
 Mean   : 8   Mean   :2.8978   Mean   :0.6667   Mean   :1.294  
 3rd Qu.:11   3rd Qu.:3.8999   3rd Qu.:0.8972   3rd Qu.:1.294  
 Max.   :12   Max.   :4.3468   Max.   :1.0000   Max.   :1.294  
                                                NA's   :2      
     Pr(&gt;F)       
 Min.   :0.07293  
 1st Qu.:0.07293  
 Median :0.07293  
 Mean   :0.07293  
 3rd Qu.:0.07293  
 Max.   :0.07293  
 NA's   :2        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Gower distance, `gower`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Df        SumOfSqs            R2               F        
 Min.   : 2   Min.   :0.0647   Min.   :0.2319   Min.   :1.509  
 1st Qu.: 6   1st Qu.:0.1395   1st Qu.:0.5000   1st Qu.:1.509  
 Median :10   Median :0.2143   Median :0.7681   Median :1.509  
 Mean   : 8   Mean   :0.1860   Mean   :0.6667   Mean   :1.509  
 3rd Qu.:11   3rd Qu.:0.2466   3rd Qu.:0.8841   3rd Qu.:1.509  
 Max.   :12   Max.   :0.2790   Max.   :1.0000   Max.   :1.509  
                                                NA's   :2      
     Pr(&gt;F)        
 Min.   :0.001998  
 1st Qu.:0.001998  
 Median :0.001998  
 Mean   :0.001998  
 3rd Qu.:0.001998  
 Max.   :0.001998  
 NA's   :2         </code></pre>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Jensen-Shannon Divergence, `jsd`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = its18_ps_pime_beta_dist_jsd ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs     R2      F   Pr(&gt;F)    
TEMP      2  0.54824 0.4002 3.3361 0.000999 ***
Residual 10  0.82167 0.5998                    
Total    12  1.36991 1.0000                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***PERMANOVA for Bray-Curtis dissimilarity, `bray`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 1000

adonis2(formula = its18_ps_pime_beta_dist_bray ~ TEMP, data = adonis_sampledf, permutations = 1000)
         Df SumOfSqs      R2     F   Pr(&gt;F)    
TEMP      2   1.1998 0.30872 2.233 0.000999 ***
Residual 10   2.6865 0.69128                   
Total    12   3.8862 1.00000                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ***ANOSIM for Gower distance, `gower`*** </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = phyloseq::distance(its18_ps_pime_prop, "gower"), grouping = its18_ps_pime_groups) 
Dissimilarity: gower 

ANOSIM statistic R: 0.6542 
      Significance: 0.001 

Permutation: free
Number of permutations: 999

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.151 0.221 0.265 0.346 

Dissimilarity ranks between and within classes:
        0%   25%  50%   75% 100%  N
Between  4 31.50 48.5 64.25   78 56
0       22 25.00 34.5 40.75   57 10
3        8 12.75 15.5 16.75   19  6
8        1  2.25  4.0  5.75    7  6</code></pre>
</div>
</div>
</div>
</div>
</div>
</details></section><section id="summaries-1" class="level2"><h2 class="anchored" data-anchor-id="summaries-1">Summaries</h2>
<p>Here is a quick summary of significance tests for the data sets against three distance matrices.</p>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 2 | Summary of significant tests for the unfiltered &amp; filtered data sets. P-values in red indicate significant differences (p-value &lt; 0.05).</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,ZGlzdGFuY2UgbWV0cmljLEZVTEwsRklMVCxQRVJmZWN0LFBJTUUKSmVuc2VuLVNoYW5ub24gRGl2ZXJnZW5jZSwwLjA0LDAuMDM3LDAuMDU5OSwwLjAwMQpCcmF5LUN1cnRpcyBkaXNzaW1pbGFyaXR5LDAuMDQ2LDAuMDMzLDAuMDgxOSwwLjAwMQpHb3dlciBkaXN0YW5jZSwwLjAxNCwwLjAwOCwwLjAwMiwwLjAwMQo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_sign_tests.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-2ac455e502bb0f6a9e1a" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2ac455e502bb0f6a9e1a">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"distance metric":["Jensen-Shannon Divergence","Bray-Curtis dissimilarity","Gower distance"],"FULL":[0.04,0.046,0.014],"FILT":[0.037,0.033,0.008],"PERfect":[0.0599,0.0819,0.002],"PIME":[0.001,0.001,0.001]},"columns":[{"accessor":"distance metric","name":"Distance metric","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["Jensen-Shannon Divergence","Bray-Curtis dissimilarity","Gower distance"],"header":"Distance metric","minWidth":200,"align":"left","headerVAlign":"center","style":{"borderRight":"1px solid #eee"},"footerStyle":{"fontWeight":"bold"},"sticky":"left","headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"FULL","name":"FULL","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.040","0.046","0.014"],"header":"FULL","minWidth":100,"align":"center","headerVAlign":"center","style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}],"footerStyle":{"fontWeight":"bold"}},{"accessor":"FILT","name":"FILT","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.037","0.033","0.008"],"header":"FILT","minWidth":100,"align":"center","headerVAlign":"center","style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}],"footerStyle":{"fontWeight":"bold"}},{"accessor":"PERfect","name":"PERfect","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.0599","0.0819","0.002"],"header":"PERfect","minWidth":100,"align":"center","headerVAlign":"center","style":[{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}],"footerStyle":{"fontWeight":"bold"}},{"accessor":"PIME","name":"PIME","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","0.001","0.001"],"header":"PIME","minWidth":100,"align":"center","headerVAlign":"center","style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}],"footerStyle":{"fontWeight":"bold"}}],"columnGroups":[{"name":"p-values","headerStyle":{"fontSize":"1.3em"},"columns":["FULL","FILT","PERfect","PIME"]}],"defaultPageSize":12,"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"theme":{"style":{"fontSize":"0.9em"}},"dataKey":"079db4e6c2e9ed19842eac9085e5d884"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">

</div>
</section></section><section id="ordinations" class="level1 page-columns page-full"><h1>Ordinations</h1>
<div class="cell">

</div>
<div class="cell">

</div>
<p>Now we can visualize the <strong>Jensen-Shannon Divergence</strong>, <strong>unweighted-UniFrac</strong>, and <strong>weighted-UniFrac</strong> distance matrices to access dissimilarity among sample. Here we ordinate using Principal Coordinate Analysis (PCoA) but we could also test other methods like NMDS, CCA, etc. We will also test the whether there are any differences in ordination between the <code>phyloseq</code> package and the <a href="https://github.com/ChiLiubio/microeco"><code>microeco</code> package</a>.</p>
<section id="plot-code" class="level4"><h4 class="anchored" data-anchor-id="plot-code">Plot Code</h4>
<details><summary><strong>Code to reproduce plots</strong>
</summary><p><strong>We begin with the code for the 16S rRNA data.</strong></p>
<p>First the code for ordination implementation in <code>phyloseq</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_data_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span><span class="op">)</span>
<span class="va">ssu_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"jsd"</span>, <span class="st">"unifrac"</span>, <span class="st">"wunifrac"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">samp_ps</span> <span class="kw">in</span> <span class="va">ssu18_data_sets</span><span class="op">)</span> <span class="op">{</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="va">ssu_dist</span><span class="op">)</span><span class="op">{</span>
     <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_prop"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">ord_meths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"NMDS"</span>, <span class="st">"PCoA"</span>, <span class="st">"CCA"</span>, <span class="st">"DCA"</span><span class="op">)</span> <span class="co"># MDS = PCoA, "CCA", "DCA", "DPCoA", "RDA"</span>
     <span class="va">tmp_plist</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/llply.html">llply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.list.html">as.list</a></span><span class="op">(</span><span class="va">ord_meths</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">physeq</span>, <span class="va">d</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">ordi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">physeq</span>, method <span class="op">=</span> <span class="va">i</span>, distance <span class="op">=</span> <span class="va">d</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/plot_ordination.html">plot_ordination</a></span><span class="op">(</span><span class="va">physeq</span>, <span class="va">ordi</span>, <span class="st">"samples"</span>, color <span class="op">=</span> <span class="st">"TEMP"</span><span class="op">)</span>
   <span class="op">}</span>, <span class="va">tmp_get</span>, <span class="va">d</span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_plist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ord_meths</span>

  <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ldply.html">ldply</a></span><span class="op">(</span><span class="va">tmp_plist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
      <span class="va">df</span> <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
      <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"Axis_1"</span>, <span class="st">"Axis_2"</span><span class="op">)</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_df</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"method"</span>
  
  <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">tmp_df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">Axis_1</span>, <span class="va">Axis_2</span>, color <span class="op">=</span> <span class="va">TEMP</span>, shape <span class="op">=</span> <span class="va">TEMP</span>, fill <span class="op">=</span> <span class="va">TEMP</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_plot</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
  <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_plot</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">method</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span>
  <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_plot</span> <span class="op">+</span> <span class="fu">scale_colour_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">swel_col</span><span class="op">)</span>
  
  <span class="va">tmp_df_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="st">"_dist_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_plist_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="st">"_"</span>, <span class="va">.</span>, <span class="st">"_plist"</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_plot_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="st">"_dist_"</span>, <span class="va">.</span>, <span class="st">"_plot"</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"tmp_df_name"</span> <span class="op">=</span> <span class="va">tmp_df</span>, tmp_plist_name <span class="op">=</span> <span class="va">tmp_plist</span>, tmp_plot_name <span class="op">=</span> <span class="va">tmp_plot</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="st">"_"</span>,  <span class="va">d</span>, <span class="st">"_ord_results"</span><span class="op">)</span>, <span class="va">tmp_list</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_tmp"</span><span class="op">)</span><span class="op">)</span>
 <span class="op">}</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">plist_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"_ord_results"</span><span class="op">)</span>
<span class="va">plot_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">plist_name</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">plot_num</span><span class="op">)</span> <span class="op">{</span>
       <span class="va">tmp_get_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">$</span><span class="va">tmp_plist_name</span>
       <span class="va">tmp_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_get_i</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>
       <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"ord_results"</span>, <span class="va">tmp_ord</span><span class="op">)</span>
       <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_get_i</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">scale_colour_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">swel_col</span><span class="op">)</span>
       <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_plot</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, <span class="fu">aes</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">TEMP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
         <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
       <span class="va">tmp_plot</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="st">"TEMP"</span>
       <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_plot</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now the code for ordination implementation in <code>microeco</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">microeco_path</span> <span class="op">&lt;-</span> <span class="st">"files/beta/microeco/"</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">ssu18_data_sets</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_me"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_dataset</span><span class="op">$</span><span class="fu">cal_betadiv</span><span class="op">(</span>unifrac <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#### CODE TO ADD JSD DISTANCE ####  </span>
  <span class="va">tmp_jsd</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"jsd"</span><span class="op">)</span> 
  <span class="va">tmp_jsd</span> <span class="op">&lt;-</span> <span class="fu">forceSymmetric</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tmp_jsd</span><span class="op">)</span>, uplo <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span>
  <span class="va">tmp_jsd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tmp_jsd</span><span class="op">)</span>
  <span class="va">tmp_dataset</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">$</span><span class="va">jsd</span> <span class="op">&lt;-</span> <span class="va">tmp_jsd</span>
<span class="co">#### #### #### #### #### #### #### ####  </span>
  <span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">microeco_path</span>, <span class="va">i</span>, <span class="st">"/metrics/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">tmp_dataset</span><span class="op">$</span><span class="fu">save_betadiv</span><span class="op">(</span>dirpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">microeco_path</span>, <span class="va">i</span>, <span class="st">"/metrics/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ssu18_ps_perfect_me</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ssu18_ps_perfect_me</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Length Class  Mode   
bray          225    -none- numeric
jaccard       225    -none- numeric
wei_unifrac   225    -none- numeric
unwei_unifrac 225    -none- numeric
jsd           225    -none- numeric</code></pre>
</div>
</div>
<p>Here I made a custom “function” to run the analysis, plot the graphs, save graph objects, and save plots (as <code>.png</code> and <code>.pdf</code> files). I am sure an actual programmer would be shocked, but it works.</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">microeco_beta_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">choose_input</span>, <span class="va">choose_metric</span>, <span class="va">choose_ord</span><span class="op">)</span> <span class="op">{</span>  
  <span class="va">tmp_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">choose_input</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_me"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_t1</span> <span class="op">&lt;-</span> <span class="va">trans_beta</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">tmp_dataset</span>, group <span class="op">=</span> <span class="st">"TEMP"</span>, measure <span class="op">=</span> <span class="va">choose_metric</span><span class="op">)</span>
  <span class="va">tmp_t1</span><span class="op">$</span><span class="fu">cal_ordination</span><span class="op">(</span>ordination <span class="op">=</span> <span class="va">choose_ord</span><span class="op">)</span>
  <span class="va">tmp_t1_ord_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_t1</span><span class="op">$</span><span class="fu">plot_ordination</span><span class="op">(</span>plot_color <span class="op">=</span> <span class="st">"TEMP"</span>, 
                                            plot_shape <span class="op">=</span> <span class="st">"TEMP"</span>, 
                                            plot_group_ellipse <span class="op">=</span> <span class="cn">FALSE</span>, 
                                            color_values <span class="op">=</span> <span class="va">swel_col</span>, 
                                            shape_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
                       <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
  <span class="va">tmp_t1</span><span class="op">$</span><span class="fu">cal_group_distance</span><span class="op">(</span><span class="op">)</span>
  <span class="va">tmp_t1_within_group_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_t1</span><span class="op">$</span><span class="fu">plot_group_distance</span><span class="op">(</span>distance_pair_stat <span class="op">=</span> <span class="cn">TRUE</span>, color_values <span class="op">=</span> <span class="va">swel_col</span><span class="op">)</span>
  <span class="va">tmp_t1</span><span class="op">$</span><span class="va">res_group_distance</span>
  <span class="va">tmp_t1</span><span class="op">$</span><span class="fu">cal_group_distance</span><span class="op">(</span>within_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="va">tmp_t1_btwn_group_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_t1</span><span class="op">$</span><span class="fu">plot_group_distance</span><span class="op">(</span>distance_pair_stat <span class="op">=</span> <span class="cn">TRUE</span>, color_values <span class="op">=</span> <span class="va">swel_col</span><span class="op">)</span> 

<span class="co">###### SET names</span>
  <span class="va">tmp_name_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">choose_input</span>, <span class="st">"_me_"</span>, <span class="va">choose_metric</span>, <span class="st">"_"</span>, <span class="va">choose_ord</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="va">tmp_name_wg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">choose_input</span>, <span class="st">"_me_wg_"</span>, <span class="va">choose_metric</span>, <span class="st">"_"</span>, <span class="va">choose_ord</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="va">tmp_name_bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">choose_input</span>, <span class="st">"_me_bg_"</span>, <span class="va">choose_metric</span>, <span class="st">"_"</span>, <span class="va">choose_ord</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name_ord</span>, <span class="va">tmp_t1_ord_plot</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html">parent.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name_wg</span>, <span class="va">tmp_t1_within_group_plot</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html">parent.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name_bg</span>, <span class="va">tmp_t1_btwn_group_plot</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html">parent.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span>
<span class="co">###### SET paths</span>
  <span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">microeco_path</span>, <span class="va">choose_input</span>, <span class="st">"/ordination/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">tmp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">microeco_path</span>, <span class="va">choose_input</span>, <span class="st">"/ordination/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="va">tmp_path_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path</span>, <span class="st">"ord_plots/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="va">tmp_path_wg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path</span>, <span class="st">"within_group/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="va">tmp_path_bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path</span>, <span class="st">"between_group/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="co">###### SAVE plots  </span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggsave.html">ggsave</a></span><span class="op">(</span><span class="va">tmp_t1_ord_plot</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path_ord</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tmp_name_ord</span>, <span class="st">".png"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggsave.html">ggsave</a></span><span class="op">(</span><span class="va">tmp_t1_ord_plot</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path_ord</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tmp_name_ord</span>, <span class="st">".pdf"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>                    
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggsave.html">ggsave</a></span><span class="op">(</span><span class="va">tmp_t1_within_group_plot</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path_wg</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tmp_name_wg</span>, <span class="st">".png"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggsave.html">ggsave</a></span><span class="op">(</span><span class="va">tmp_t1_within_group_plot</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path_wg</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tmp_name_wg</span>, <span class="st">".pdf"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>                  
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggsave.html">ggsave</a></span><span class="op">(</span><span class="va">tmp_t1_btwn_group_plot</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path_bg</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tmp_name_bg</span>, <span class="st">".png"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggsave.html">ggsave</a></span><span class="op">(</span><span class="va">tmp_t1_btwn_group_plot</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path_bg</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">tmp_name_bg</span>, <span class="st">".pdf"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>                  
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And then run it like so:</p>
<div class="cell">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"ssu18_ps_pime"</span>, choose_metric <span class="op">=</span> <span class="st">"bray"</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It would be super cool to have a function that looped through a bunch of data sets, distance metrics, and ordination methods.</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_ps_work"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_ps_work"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"ssu18_ps_work"</span>, choose_metric <span class="op">=</span> <span class="va">tmp_metric</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_ps_filt"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_ps_filt"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"ssu18_ps_filt"</span>, choose_metric <span class="op">=</span> <span class="va">tmp_metric</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_ps_perfect"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_ps_perfect"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"ssu18_ps_perfect"</span>, choose_metric <span class="op">=</span> <span class="va">tmp_metric</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_ps_pime"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_ps_pime"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"ssu18_ps_pime"</span>, choose_metric <span class="op">=</span> <span class="va">tmp_metric</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong>And now the ITS code.</strong></p>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_data_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, <span class="st">"its18_ps_perfect"</span>, <span class="st">"its18_ps_pime"</span><span class="op">)</span>
<span class="va">its_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"jsd"</span>, <span class="st">"bray"</span>, <span class="st">"gower"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">samp_ps</span> <span class="kw">in</span> <span class="va">its18_data_sets</span><span class="op">)</span> <span class="op">{</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="va">its_dist</span><span class="op">)</span><span class="op">{</span>
     <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_prop"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">ord_meths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"NMDS"</span>, <span class="st">"PCoA"</span>, <span class="st">"CCA"</span>, <span class="st">"DCA"</span><span class="op">)</span> <span class="co"># MDS = PCoA, "CCA", "DCA", "DPCoA", "RDA"</span>
     <span class="va">tmp_plist</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/llply.html">llply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.list.html">as.list</a></span><span class="op">(</span><span class="va">ord_meths</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">physeq</span>, <span class="va">d</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">ordi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ordinate.html">ordinate</a></span><span class="op">(</span><span class="va">physeq</span>, method <span class="op">=</span> <span class="va">i</span>, distance <span class="op">=</span> <span class="va">d</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/plot_ordination.html">plot_ordination</a></span><span class="op">(</span><span class="va">physeq</span>, <span class="va">ordi</span>, <span class="st">"samples"</span>, color <span class="op">=</span> <span class="st">"TEMP"</span><span class="op">)</span>
   <span class="op">}</span>, <span class="va">tmp_get</span>, <span class="va">d</span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_plist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ord_meths</span>

  <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ldply.html">ldply</a></span><span class="op">(</span><span class="va">tmp_plist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
      <span class="va">df</span> <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
      <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"Axis_1"</span>, <span class="st">"Axis_2"</span><span class="op">)</span>
      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_df</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"method"</span>
  
  <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">tmp_df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">Axis_1</span>, <span class="va">Axis_2</span>, color <span class="op">=</span> <span class="va">TEMP</span>, shape <span class="op">=</span> <span class="va">TEMP</span>, fill <span class="op">=</span> <span class="va">TEMP</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_plot</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
  <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_plot</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">method</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span>
  <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_plot</span> <span class="op">+</span> <span class="fu">scale_colour_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">swel_col</span><span class="op">)</span>
  
  <span class="va">tmp_df_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="st">"_dist_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_plist_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="st">"_"</span>, <span class="va">.</span>, <span class="st">"_plist"</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_plot_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">d</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="st">"_dist_"</span>, <span class="va">.</span>, <span class="st">"_plot"</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"tmp_df_name"</span> <span class="op">=</span> <span class="va">tmp_df</span>, tmp_plist_name <span class="op">=</span> <span class="va">tmp_plist</span>, tmp_plot_name <span class="op">=</span> <span class="va">tmp_plot</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">samp_ps</span>, <span class="st">"_"</span>,  <span class="va">d</span>, <span class="st">"_ord_results"</span><span class="op">)</span>, <span class="va">tmp_list</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_tmp"</span><span class="op">)</span><span class="op">)</span>
 <span class="op">}</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">plist_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"_ord_results"</span><span class="op">)</span>
<span class="va">plot_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">plist_name</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">plot_num</span><span class="op">)</span> <span class="op">{</span>
       <span class="va">tmp_get_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">$</span><span class="va">tmp_plist_name</span>
       <span class="va">tmp_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_get_i</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>
       <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">"ord_results"</span>, <span class="va">tmp_ord</span><span class="op">)</span>
       <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_get_i</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">scale_colour_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">swel_col</span><span class="op">)</span>
       <span class="va">tmp_plot</span> <span class="op">&lt;-</span> <span class="va">tmp_plot</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, <span class="fu">aes</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">TEMP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
         <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
       <span class="va">tmp_plot</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="st">"TEMP"</span>
       <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_plot</span><span class="op">)</span>
       <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now the code for ordination implementation in <code>microeco</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">microeco_path</span> <span class="op">&lt;-</span> <span class="st">"files/beta/microeco/"</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">its18_data_sets</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_me"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_dataset</span><span class="op">$</span><span class="fu">cal_betadiv</span><span class="op">(</span>unifrac <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#### CODE TO ADD JSD DISTANCE ####  </span>
  <span class="va">tmp_jsd</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"jsd"</span><span class="op">)</span> 
  <span class="va">tmp_jsd</span> <span class="op">&lt;-</span> <span class="fu">forceSymmetric</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tmp_jsd</span><span class="op">)</span>, uplo <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span>
  <span class="va">tmp_jsd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tmp_jsd</span><span class="op">)</span>
  <span class="va">tmp_dataset</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">$</span><span class="va">jsd</span> <span class="op">&lt;-</span> <span class="va">tmp_jsd</span>
<span class="co">#### CODE TO ADD GOWER DISTANCE ####  </span>
  <span class="va">tmp_gower</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/distance.html">distance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gower"</span><span class="op">)</span> 
  <span class="va">tmp_gower</span> <span class="op">&lt;-</span> <span class="fu">forceSymmetric</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tmp_gower</span><span class="op">)</span>, uplo <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span>
  <span class="va">tmp_gower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tmp_gower</span><span class="op">)</span>
  <span class="va">tmp_dataset</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">$</span><span class="va">gower</span> <span class="op">&lt;-</span> <span class="va">tmp_gower</span>
<span class="co">#### #### #### #### #### #### #### ####  </span>
  <span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">microeco_path</span>, <span class="va">i</span>, <span class="st">"/metrics/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">tmp_dataset</span><span class="op">$</span><span class="fu">save_betadiv</span><span class="op">(</span>dirpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">microeco_path</span>, <span class="va">i</span>, <span class="st">"/metrics/"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">its18_ps_perfect_me</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">its18_ps_perfect_me</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Length Class  Mode   
bray    169    -none- numeric
jaccard 169    -none- numeric
jsd     169    -none- numeric
gower   169    -none- numeric</code></pre>
</div>
</div>
<p>Here we call the custom function described above.</p>
<div class="cell">
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_ps_work"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_ps_work"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"its18_ps_work"</span>, choose_metric <span class="op">=</span> <span class="va">tmp_metric</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_ps_filt"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_ps_filt"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"its18_ps_filt"</span>, choose_metric <span class="op">=</span> <span class="va">tmp_metric</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_ps_perfect"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_ps_perfect"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"its18_ps_perfect"</span>, choose_metric <span class="op">=</span> <span class="va">tmp_metric</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_ps_pime"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_ps_pime"</span>, <span class="st">"_me"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">beta_diversity</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
  <span class="fu">microeco_beta_plot</span><span class="op">(</span>choose_input <span class="op">=</span> <span class="st">"its18_ps_pime"</span>, choose_metric <span class="op">=</span> <span class="va">tmp_metric</span>, choose_ord <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
</details><p><br></p>
</section><section id="s-rrna-1" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="s-rrna-1">16S rRNA</h2>
<div class="column-body-outset">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/ssu18_ps_work_beta_div_ord_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 1 | PCoA ordination plots of the FULL data set. Top = phyloseq, bottom = microeco; Left = Jensen-Shannon Divergence, middle = UniFrac (unwieghted), right = UniFrac (wieghted).</strong></small></p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/ssu18_ps_filt_beta_div_ord_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 2 | PCoA ordination plots of the Arbitrary filtered data set. Top = phyloseq, bottom = microeco; Left = Jensen-Shannon Divergence, middle = UniFrac (unwieghted), right = UniFrac (wieghted).</strong></small></p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/ssu18_ps_perfect_beta_div_ord_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 3 | PCoA ordination plots of the PERfect filtered data set. Top = phyloseq, bottom = microeco; Left = Jensen-Shannon Divergence, middle = UniFrac (unwieghted), right = UniFrac (wieghted).</strong></small></p>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/ssu18_ps_pime_beta_div_ord_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 4 | PCoA ordination plots of the PIME filtered data set. Top = phyloseq, bottom = microeco; Left = Jensen-Shannon Divergence, middle = UniFrac (unwieghted), right = UniFrac (wieghted).</strong></small></p>
</div>
</div>
</div>
</div>
</section><section id="its-1" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="its-1">ITS</h2>
<div class="column-body-outset">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">FILT</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/its18_ps_work_beta_div_ord_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 1 | PCoA ordination plots of the FULL data set. Top = phyloseq, bottom = microeco; Left = Jensen-Shannon Divergence, middle = Bray-Curtis dissimilarity, right = Gower distance.</strong></small></p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/its18_ps_filt_beta_div_ord_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 2 | PCoA ordination plots of the Arbitrary filtered data set. Top = phyloseq, bottom = microeco; Left = Jensen-Shannon Divergence, middle = Bray-Curtis dissimilarity, right = Gower distance.</strong></small></p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/its18_ps_perfect_beta_div_ord_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 3 | PCoA ordination plots of the PERfect filtered data set. Top = phyloseq, bottom = microeco; Left = Jensen-Shannon Divergence, middle = Bray-Curtis dissimilarity, right = Gower distance.</strong></small></p>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/its18_ps_pime_beta_div_ord_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 4 | PCoA ordination plots of the PIME filtered data set. Top = phyloseq, bottom = microeco; Left = Jensen-Shannon Divergence, middle = Bray-Curtis dissimilarity, right = Gower distance.</strong></small></p>
</div>
</div>
</div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
</section></section><section id="within-between-group-distances" class="level1 page-columns page-full"><h1>Within &amp; Between Group Distances</h1>
<p>Above we calculated the sample distances within groups. Let’s see what those plots look like.</p>
<section id="s-rrna-2" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="s-rrna-2">16S rRNA</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="column-body-outset">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/ssu18_ps_work_variation_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 5 | Within (top) and between (bottom) group variation plots of the FULL data set. Left = Jensen-Shannon Divergence, middle = UniFrac (unwieghted), right = UniFrac (wieghted). Significant differences denoted by asterisks (* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001). ns = not significant. </strong></small></p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/ssu18_ps_filt_variation_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 6 | Within (top) and between (bottom) group variation plots of the Arbitrary filtered data set. Left = Jensen-Shannon Divergence, middle = UniFrac (unwieghted), right = UniFrac (wieghted). Significant differences denoted by asterisks (* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001). ns = not significant. </strong></small></p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/ssu18_ps_perfect_variation_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 7 | Within (top) and between (bottom) group variation plots of the PERfect filtered data set. Left = Jensen-Shannon Divergence, middle = UniFrac (unwieghted), right = UniFrac (wieghted). Significant differences denoted by asterisks (* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001). ns = not significant. </strong></small></p>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/ssu18_ps_pime_variation_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 8 | Within (top) and between (bottom) group variation plots of the PIME filtered data set. Left = Jensen-Shannon Divergence, middle = UniFrac (unwieghted), right = UniFrac (wieghted). Significant differences denoted by asterisks (* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001). ns = not significant. </strong></small></p>
</div>
</div>
</div>
</div>
</section><section id="its-2" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="its-2">ITS</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="column-body-outset">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">FULL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Arbitrary</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">PERfect</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">PIME</a></li>
</ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/its18_ps_work_variation_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 5 | Within (top) and between (bottom) group variation plots of the FULL data set. Left = Jensen-Shannon Divergence, middle = Bray-Curtis dissimilarity, right = Gower distance. Significant differences denoted by asterisks (* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001). ns = not significant. </strong></small></p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/its18_ps_filt_variation_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 6 | Within (top) and between (bottom) group variation plots of the Arbitrary filtered data set. Left = Jensen-Shannon Divergence, middle = Bray-Curtis dissimilarity, right = Gower distance. Significant differences denoted by asterisks (* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001). ns = not significant. </strong></small></p>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/its18_ps_perfect_variation_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 7 | Within (top) and between (bottom) group variation plots of the PERfect filtered data set. Left = Jensen-Shannon Divergence, middle = Bray-Curtis dissimilarity, right = Gower distance. Significant differences denoted by asterisks (* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001). ns = not significant. </strong></small></p>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="include/beta/its18_ps_pime_variation_plots.png" class="img-fluid" width="4252"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 8 | Within (top) and between (bottom) group variation plots of the PIME filtered data set. Left = Jensen-Shannon Divergence, middle = Bray-Curtis dissimilarity, right = Gower distance. Significant differences denoted by asterisks (* p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001). ns = not significant. </strong></small></p>
</div>
</div>
</div>
</div>
<div class="cell">

</div>
</section></section><section id="workflow-output" class="level1"><h1>Workflow Output</h1>
<p>Data products generated in this workflow can be downloaded from figshare.</p>
<iframe src="https://widgets.figshare.com/articles/16828063/embed?show_title=1" width="100%" height="251" allowfullscreen="" frameborder="0">
</iframe>
<p></p>
<p><a href="da.html" class="btnnav button_round" style="float: right;">Next workflow: <br> 7. Differentially Abundant ASVs &amp; Taxa</a> <a href="alpha.html" class="btnnav button_round" style="float: left;">Previous workflow: <br> 5. Alpha Diversity Estimates</a><br><br></p>
<div class="cell">

</div>
</section><div id="quarto-appendix" class="default"><section id="source-code" class="level4 appendix"><h2 class="quarto-appendix-heading">Source Code</h2><div class="quarto-appendix-contents">
<p>The source code for this page can be accessed on GitHub <svg aria-hidden="true" role="img" viewbox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> by <a href="https://github.com/sweltr/high-temp/blob/main/beta.qmd">clicking this link</a>.</p>
</div></section><section id="data-availability" class="level4 appendix"><h2 class="quarto-appendix-heading">Data Availability</h2><div class="quarto-appendix-contents">
<p>Data generated in this workflow and the Rdata need to run the workflow can be accessed on figshare at <a href="https://doi.org/10.25573/data.16828063">10.25573/data.16828063</a>.</p>
</div></section><section id="last-updated-on" class="level4 appendix"><h2 class="quarto-appendix-heading">Last updated on</h2><div class="quarto-appendix-contents">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022-07-07 07:25:14 EST"</code></pre>
</div>
</div>


<!-- -->


</div></section><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-oksanen2013community" class="csl-entry" role="doc-biblioentry">
Oksanen, Jari, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre, Peter R. Minchin, R. B. O’Hara, Gavin L. Simpson, Peter Sólymos, M. Henry H. Stevens, and Helene Wagner. 2012. <span>“Vegan: Community Ecology Package.”</span> <em>R Package Version</em> 2 (0). <a href="https://cran.r-project.org/web/packages/vegan/index.html">https://cran.r-project.org/web/packages/vegan/index.html</a>.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./alpha.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">5. Alpha Diversity Estimates</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./da.html" class="pagination-link">
        <span class="nav-page-text">7. Differentially Abundant ASVs &amp; Taxa</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb107" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "6. Beta Diversity &amp; Dispersion Estimates"</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Reproducible workflow for assessing community dissimilarity across temperature treatments.</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;&lt;strong&gt;</span>Click here<span class="kw">&lt;/strong&gt;</span> for setup information.<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">eval =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq); <span class="fu">packageVersion</span>(<span class="st">"phyloseq"</span>)</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biostrings); <span class="fu">packageVersion</span>(<span class="st">"Biostrings"</span>)</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, </span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>               microbiome, phytools, phangorn, reactable, Matrix, </span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>               pairwiseAdonis, naniar, downloadthis,</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>               labdsv, patchwork, agricolae, captioner, microeco,</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">install =</span> <span class="cn">FALSE</span>, <span class="at">update =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_depends(agricolae, local = TRUE)  </span></span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_depends_reverse(agricolae, local = TRUE)  </span></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_current<span class="sc">$</span><span class="fu">get</span>(<span class="fu">c</span>(</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache"</span>,</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache.path"</span>,</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache.rebuild"</span>,</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dependson"</span>,</span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"autodep"</span></span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span> </span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Load to build page only #2</span></span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"page_build/beta_wf_part_1.rdata"</span>)</span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-54"><a href="#cb107-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-57"><a href="#cb107-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-58"><a href="#cb107-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-59"><a href="#cb107-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-60"><a href="#cb107-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb107-61"><a href="#cb107-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the caption(s) with captioner</span></span>
<span id="cb107-62"><a href="#cb107-62" aria-hidden="true" tabindex="-1"></a>caption_tab_ssu <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(16S rRNA) Table"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb107-63"><a href="#cb107-63" aria-hidden="true" tabindex="-1"></a>caption_fig_ssu <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(16S rRNA) Figure"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb107-64"><a href="#cb107-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-65"><a href="#cb107-65" aria-hidden="true" tabindex="-1"></a>caption_tab_its <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(ITS) Table"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb107-66"><a href="#cb107-66" aria-hidden="true" tabindex="-1"></a>caption_fig_its <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(ITS) Figure"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb107-67"><a href="#cb107-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function for referring to the tables in text</span></span>
<span id="cb107-68"><a href="#cb107-68" aria-hidden="true" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">str_extract</span>(x, <span class="st">"[^|]*"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-69"><a href="#cb107-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trimws</span>(<span class="at">which =</span> <span class="st">"right"</span>, <span class="at">whitespace =</span> <span class="st">"[ ]"</span>)</span>
<span id="cb107-70"><a href="#cb107-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-71"><a href="#cb107-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-74"><a href="#cb107-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-75"><a href="#cb107-75" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-76"><a href="#cb107-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-77"><a href="#cb107-77" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"assets/captions/captions_beta.R"</span>)</span>
<span id="cb107-78"><a href="#cb107-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-79"><a href="#cb107-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-80"><a href="#cb107-80" aria-hidden="true" tabindex="-1"></a><span class="fu"># Synopsis</span></span>
<span id="cb107-81"><a href="#cb107-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-82"><a href="#cb107-82" aria-hidden="true" tabindex="-1"></a>This workflow contains beta diversity assessments for the high temperature data sets. In order to run the workflow, you either need to first run the  <span class="co">[</span><span class="ot">DADA2 Workflow for 2018 High Temp samples</span><span class="co">](dada2.html)</span>, the <span class="co">[</span><span class="ot">Data Preparation workflow</span><span class="co">](data-prep.html)</span>, and the <span class="co">[</span><span class="ot">Alpha diversity workflow</span><span class="co">](alpha.html)</span> **or** download the files linked below. See the <span class="co">[</span><span class="ot">Data Availability</span><span class="co">](data-availability.html)</span> page for complete details.</span>
<span id="cb107-83"><a href="#cb107-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-84"><a href="#cb107-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workflow Input</span></span>
<span id="cb107-85"><a href="#cb107-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-86"><a href="#cb107-86" aria-hidden="true" tabindex="-1"></a>Files needed to run this workflow can be downloaded from figshare. </span>
<span id="cb107-87"><a href="#cb107-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-88"><a href="#cb107-88" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://widgets.figshare.com/articles/16826779/embed?show_title=1"</span> <span class="er">width</span><span class="ot">=</span><span class="st">"100%"</span> <span class="er">height</span><span class="ot">=</span><span class="st">"251"</span> <span class="er">allowfullscreen</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">"0"</span><span class="kw">&gt;&lt;/iframe&gt;</span></span>
<span id="cb107-89"><a href="#cb107-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-90"><a href="#cb107-90" aria-hidden="true" tabindex="-1"></a><span class="fu"># 16s rRNA</span></span>
<span id="cb107-91"><a href="#cb107-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-94"><a href="#cb107-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-95"><a href="#cb107-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb107-96"><a href="#cb107-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb107-97"><a href="#cb107-97" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial Load for  ANALYSIS #1</span></span>
<span id="cb107-98"><a href="#cb107-98" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb107-99"><a href="#cb107-99" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_work.rds"</span>)</span>
<span id="cb107-100"><a href="#cb107-100" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_filt.rds"</span>)</span>
<span id="cb107-101"><a href="#cb107-101" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_perfect.rds"</span>)</span>
<span id="cb107-102"><a href="#cb107-102" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_pime.rds"</span>)</span>
<span id="cb107-103"><a href="#cb107-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-104"><a href="#cb107-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-107"><a href="#cb107-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-108"><a href="#cb107-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-109"><a href="#cb107-109" aria-hidden="true" tabindex="-1"></a>swel_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2271B2"</span>, <span class="st">"#71B222"</span>, <span class="st">"#B22271"</span>)</span>
<span id="cb107-110"><a href="#cb107-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-111"><a href="#cb107-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-112"><a href="#cb107-112" aria-hidden="true" tabindex="-1"></a>In order to test for significance between sample groups, we must perform the following steps:</span>
<span id="cb107-113"><a href="#cb107-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-114"><a href="#cb107-114" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Transform sample counts to relative abundance.</span>
<span id="cb107-115"><a href="#cb107-115" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Create distance matrices based on some metrics, for example <span class="in">`wunifrac`</span>, <span class="in">`unifrac`</span>, and <span class="in">`jsd`</span>. For this we use the function <span class="in">`phyloseq::distance`</span>.</span>
<span id="cb107-116"><a href="#cb107-116" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Next, calculate beta dispersion using the <span class="in">`betadisper`</span> function from the <span class="in">`vegan`</span> package <span class="co">[</span><span class="ot">@oksanen2013community</span><span class="co">]</span>.</span>
<span id="cb107-117"><a href="#cb107-117" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Then, use the function <span class="in">`permutest`</span> to run a Permutation test for homogeneity of multivariate dispersions.</span>
<span id="cb107-118"><a href="#cb107-118" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>If the beta dispersion tests are not significant we will run a PERMANOVA using <span class="in">`adonis`</span> (since PERMANOVA assumes equal dispersion), otherwise we will use Analysis of Similarity (ANOSIM), both available in the <span class="in">`vegan`</span> package <span class="co">[</span><span class="ot">@oksanen2013community</span><span class="co">]</span>.</span>
<span id="cb107-119"><a href="#cb107-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-120"><a href="#cb107-120" aria-hidden="true" tabindex="-1"></a>Steps 2--4 are combined in a <span class="in">`for`</span> loop that tests all three distance metrics.</span>
<span id="cb107-121"><a href="#cb107-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-122"><a href="#cb107-122" aria-hidden="true" tabindex="-1"></a>Before we begin, we need to first transform sample counts to relative abundance and generate some new trees.</span>
<span id="cb107-123"><a href="#cb107-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-126"><a href="#cb107-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-127"><a href="#cb107-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb107-128"><a href="#cb107-128" aria-hidden="true" tabindex="-1"></a>ssu_samp_ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, </span>
<span id="cb107-129"><a href="#cb107-129" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb107-130"><a href="#cb107-130" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_samp_ps) {</span>
<span id="cb107-131"><a href="#cb107-131" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_prop"</span>))</span>
<span id="cb107-132"><a href="#cb107-132" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb107-133"><a href="#cb107-133" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(tmp_get, <span class="cf">function</span>(otu) </span>
<span id="cb107-134"><a href="#cb107-134" aria-hidden="true" tabindex="-1"></a>                                          <span class="fl">1e5</span> <span class="sc">*</span> otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb107-135"><a href="#cb107-135" aria-hidden="true" tabindex="-1"></a>     tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb107-136"><a href="#cb107-136" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">prune_samples</span>(<span class="fu">sample_sums</span>(tmp_ps) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_ps)</span>
<span id="cb107-137"><a href="#cb107-137" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-138"><a href="#cb107-138" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb107-139"><a href="#cb107-139" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb107-140"><a href="#cb107-140" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb107-141"><a href="#cb107-141" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_ps)</span>
<span id="cb107-142"><a href="#cb107-142" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-143"><a href="#cb107-143" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-144"><a href="#cb107-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-145"><a href="#cb107-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-146"><a href="#cb107-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## Beta Dispersion</span></span>
<span id="cb107-147"><a href="#cb107-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-148"><a href="#cb107-148" aria-hidden="true" tabindex="-1"></a>Here we create distance matrices for each metric, calculate the beta dispersion, and run a permutation test for homogeneity of multivariate dispersions. </span>
<span id="cb107-149"><a href="#cb107-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-152"><a href="#cb107-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-153"><a href="#cb107-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb107-154"><a href="#cb107-154" aria-hidden="true" tabindex="-1"></a>ssu_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"jsd"</span>, <span class="st">"unifrac"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb107-155"><a href="#cb107-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_samp_ps) {</span>
<span id="cb107-156"><a href="#cb107-156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> ssu_dist){</span>
<span id="cb107-157"><a href="#cb107-157" aria-hidden="true" tabindex="-1"></a>       tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_prop"</span>)))</span>
<span id="cb107-158"><a href="#cb107-158" aria-hidden="true" tabindex="-1"></a>       tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_get))</span>
<span id="cb107-159"><a href="#cb107-159" aria-hidden="true" tabindex="-1"></a>       tmp_df <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">distance</span>(tmp_get, <span class="at">method =</span> d)</span>
<span id="cb107-160"><a href="#cb107-160" aria-hidden="true" tabindex="-1"></a>       tmp_df_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_beta_dist_"</span>, .))</span>
<span id="cb107-161"><a href="#cb107-161" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_df_name, tmp_df)</span>
<span id="cb107-162"><a href="#cb107-162" aria-hidden="true" tabindex="-1"></a>       tmp_df2 <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(tmp_df, tmp_samp<span class="sc">$</span>TEMP, <span class="at">bias.adjust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-163"><a href="#cb107-163" aria-hidden="true" tabindex="-1"></a>       tmp_df_name2 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_beta_dispersion_"</span>, .))</span>
<span id="cb107-164"><a href="#cb107-164" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_df_name2, tmp_df2)</span>
<span id="cb107-165"><a href="#cb107-165" aria-hidden="true" tabindex="-1"></a>       tmp_df3 <span class="ot">&lt;-</span> <span class="fu">permutest</span>(tmp_df2, <span class="at">pairwise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-166"><a href="#cb107-166" aria-hidden="true" tabindex="-1"></a>                            <span class="at">permutations =</span> <span class="dv">1000</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-167"><a href="#cb107-167" aria-hidden="true" tabindex="-1"></a>       tmp_df_name3 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, .))</span>
<span id="cb107-168"><a href="#cb107-168" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_df_name3, tmp_df3)</span>
<span id="cb107-169"><a href="#cb107-169" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-170"><a href="#cb107-170" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-171"><a href="#cb107-171" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-172"><a href="#cb107-172" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb107-173"><a href="#cb107-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-174"><a href="#cb107-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-175"><a href="#cb107-175" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb107-176"><a href="#cb107-176" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;&lt;strong&gt;</span>Detailed results<span class="kw">&lt;/strong&gt;</span> of Beta Dispersion &amp; Permutation tests<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb107-177"><a href="#cb107-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-178"><a href="#cb107-178" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-179"><a href="#cb107-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-182"><a href="#cb107-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-183"><a href="#cb107-183" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-184"><a href="#cb107-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-185"><a href="#cb107-185" aria-hidden="true" tabindex="-1"></a>ssu_samp_ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb107-186"><a href="#cb107-186" aria-hidden="true" tabindex="-1"></a>ssu_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"jsd"</span>, <span class="st">"unifrac"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb107-187"><a href="#cb107-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-188"><a href="#cb107-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-189"><a href="#cb107-189" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL</span></span>
<span id="cb107-190"><a href="#cb107-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-193"><a href="#cb107-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-194"><a href="#cb107-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-195"><a href="#cb107-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-196"><a href="#cb107-196" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_samp_ps[<span class="dv">1</span>]) {</span>
<span id="cb107-197"><a href="#cb107-197" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cat("\n", "           *****", i, "*****", "\n")</span></span>
<span id="cb107-198"><a href="#cb107-198" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> ssu_dist){</span>
<span id="cb107-199"><a href="#cb107-199" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-200"><a href="#cb107-200" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-201"><a href="#cb107-201" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-202"><a href="#cb107-202" aria-hidden="true" tabindex="-1"></a>          tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BETA DISPERSION significance test"</span>, d, <span class="st">"distance"</span>)</span>
<span id="cb107-203"><a href="#cb107-203" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(tmp_print, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-204"><a href="#cb107-204" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>)</span>
<span id="cb107-205"><a href="#cb107-205" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-206"><a href="#cb107-206" aria-hidden="true" tabindex="-1"></a>          <span class="fu">print</span>(tmp_get)</span>
<span id="cb107-207"><a href="#cb107-207" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-208"><a href="#cb107-208" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-209"><a href="#cb107-209" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-210"><a href="#cb107-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-211"><a href="#cb107-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-212"><a href="#cb107-212" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary</span></span>
<span id="cb107-213"><a href="#cb107-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-216"><a href="#cb107-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-217"><a href="#cb107-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-218"><a href="#cb107-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-219"><a href="#cb107-219" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_samp_ps[<span class="dv">2</span>]) {</span>
<span id="cb107-220"><a href="#cb107-220" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cat("\n", "           *****", i, "*****", "\n")</span></span>
<span id="cb107-221"><a href="#cb107-221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> ssu_dist){</span>
<span id="cb107-222"><a href="#cb107-222" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-223"><a href="#cb107-223" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-224"><a href="#cb107-224" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-225"><a href="#cb107-225" aria-hidden="true" tabindex="-1"></a>          tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BETA DISPERSION significance test"</span>, d, <span class="st">"distance"</span>)</span>
<span id="cb107-226"><a href="#cb107-226" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(tmp_print, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-227"><a href="#cb107-227" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>)</span>
<span id="cb107-228"><a href="#cb107-228" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-229"><a href="#cb107-229" aria-hidden="true" tabindex="-1"></a>          <span class="fu">print</span>(tmp_get)</span>
<span id="cb107-230"><a href="#cb107-230" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-231"><a href="#cb107-231" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-232"><a href="#cb107-232" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-233"><a href="#cb107-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-234"><a href="#cb107-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-235"><a href="#cb107-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-236"><a href="#cb107-236" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-237"><a href="#cb107-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-240"><a href="#cb107-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-241"><a href="#cb107-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-242"><a href="#cb107-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-243"><a href="#cb107-243" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_samp_ps[<span class="dv">3</span>]) {</span>
<span id="cb107-244"><a href="#cb107-244" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cat("\n", "           *****", i, "*****", "\n")</span></span>
<span id="cb107-245"><a href="#cb107-245" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> ssu_dist){</span>
<span id="cb107-246"><a href="#cb107-246" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-247"><a href="#cb107-247" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-248"><a href="#cb107-248" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-249"><a href="#cb107-249" aria-hidden="true" tabindex="-1"></a>          tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BETA DISPERSION significance test"</span>, d, <span class="st">"distance"</span>)</span>
<span id="cb107-250"><a href="#cb107-250" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(tmp_print, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-251"><a href="#cb107-251" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>)</span>
<span id="cb107-252"><a href="#cb107-252" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-253"><a href="#cb107-253" aria-hidden="true" tabindex="-1"></a>          <span class="fu">print</span>(tmp_get)</span>
<span id="cb107-254"><a href="#cb107-254" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-255"><a href="#cb107-255" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-256"><a href="#cb107-256" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-257"><a href="#cb107-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-258"><a href="#cb107-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-259"><a href="#cb107-259" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-260"><a href="#cb107-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-263"><a href="#cb107-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-264"><a href="#cb107-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-265"><a href="#cb107-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-266"><a href="#cb107-266" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_samp_ps[<span class="dv">4</span>]) {</span>
<span id="cb107-267"><a href="#cb107-267" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cat("\n", "           *****", i, "*****", "\n")</span></span>
<span id="cb107-268"><a href="#cb107-268" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> ssu_dist){</span>
<span id="cb107-269"><a href="#cb107-269" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-270"><a href="#cb107-270" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-271"><a href="#cb107-271" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-272"><a href="#cb107-272" aria-hidden="true" tabindex="-1"></a>          tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BETA DISPERSION significance test"</span>, d, <span class="st">"distance"</span>)</span>
<span id="cb107-273"><a href="#cb107-273" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(tmp_print, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-274"><a href="#cb107-274" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>)</span>
<span id="cb107-275"><a href="#cb107-275" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-276"><a href="#cb107-276" aria-hidden="true" tabindex="-1"></a>          <span class="fu">print</span>(tmp_get)</span>
<span id="cb107-277"><a href="#cb107-277" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-278"><a href="#cb107-278" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-279"><a href="#cb107-279" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-280"><a href="#cb107-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-281"><a href="#cb107-281" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-282"><a href="#cb107-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-283"><a href="#cb107-283" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb107-284"><a href="#cb107-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-285"><a href="#cb107-285" aria-hidden="true" tabindex="-1"></a>Remember, if the beta dispersion p-value is greater than <span class="in">`0.05`</span> we use PERMANOVA, otherwise we use ANOSIM.</span>
<span id="cb107-286"><a href="#cb107-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-289"><a href="#cb107-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-290"><a href="#cb107-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-291"><a href="#cb107-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-292"><a href="#cb107-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: markup</span></span>
<span id="cb107-293"><a href="#cb107-293" aria-hidden="true" tabindex="-1"></a>ssu18_perm_pvalues <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb107-294"><a href="#cb107-294" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_samp_ps) {</span>
<span id="cb107-295"><a href="#cb107-295" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> ssu_dist){</span>
<span id="cb107-296"><a href="#cb107-296" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-297"><a href="#cb107-297" aria-hidden="true" tabindex="-1"></a>          tmp_pv <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]</span>
<span id="cb107-298"><a href="#cb107-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-299"><a href="#cb107-299" aria-hidden="true" tabindex="-1"></a>          tmp_test <span class="ot">&lt;-</span> <span class="cf">if</span>(tmp_pv <span class="sc">&lt;</span> <span class="fl">0.05</span>){</span>
<span id="cb107-300"><a href="#cb107-300" aria-hidden="true" tabindex="-1"></a>            tmp_test <span class="ot">&lt;-</span> <span class="st">"ANOSIM"</span></span>
<span id="cb107-301"><a href="#cb107-301" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb107-302"><a href="#cb107-302" aria-hidden="true" tabindex="-1"></a>            tmp_test <span class="ot">&lt;-</span> <span class="st">"ADONIS"</span></span>
<span id="cb107-303"><a href="#cb107-303" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb107-304"><a href="#cb107-304" aria-hidden="true" tabindex="-1"></a>          tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(i, d, tmp_pv, tmp_test)</span>
<span id="cb107-305"><a href="#cb107-305" aria-hidden="true" tabindex="-1"></a>          ssu18_perm_pvalues <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(ssu18_perm_pvalues, tmp_df)</span>
<span id="cb107-306"><a href="#cb107-306" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-307"><a href="#cb107-307" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-308"><a href="#cb107-308" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-309"><a href="#cb107-309" aria-hidden="true" tabindex="-1"></a>ssu18_perm_pvalues <span class="ot">&lt;-</span> ssu18_perm_pvalues <span class="sc">%&gt;%</span> </span>
<span id="cb107-310"><a href="#cb107-310" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"data_set"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"dist"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"pval"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="dv">4</span>))</span>
<span id="cb107-311"><a href="#cb107-311" aria-hidden="true" tabindex="-1"></a>ssu18_perm_pvalues <span class="ot">&lt;-</span> ssu18_perm_pvalues <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb107-312"><a href="#cb107-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-313"><a href="#cb107-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-314"><a href="#cb107-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-317"><a href="#cb107-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-318"><a href="#cb107-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-319"><a href="#cb107-319" aria-hidden="true" tabindex="-1"></a>ssu18_perm_summary <span class="ot">&lt;-</span> ssu18_perm_pvalues</span>
<span id="cb107-320"><a href="#cb107-320" aria-hidden="true" tabindex="-1"></a>ssu18_perm_summary <span class="ot">&lt;-</span> ssu18_perm_summary <span class="sc">%&gt;%</span> <span class="fu">separate</span>(<span class="at">col =</span> <span class="dv">1</span>, </span>
<span id="cb107-321"><a href="#cb107-321" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"dummy"</span>, <span class="st">"metric"</span>, <span class="st">"dataset"</span>), </span>
<span id="cb107-322"><a href="#cb107-322" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-323"><a href="#cb107-323" aria-hidden="true" tabindex="-1"></a>ssu18_perm_summary[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb107-324"><a href="#cb107-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-325"><a href="#cb107-325" aria-hidden="true" tabindex="-1"></a>ssu18_perm_summary<span class="sc">$</span>dataset <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(ssu18_perm_summary<span class="sc">$</span>dataset, <span class="st">"work"</span>, <span class="st">"FULL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-326"><a href="#cb107-326" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"filt"</span>, <span class="st">"FILT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-327"><a href="#cb107-327" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"pime"</span>, <span class="st">"PIME"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-328"><a href="#cb107-328" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"perfect"</span>, <span class="st">"PERfect"</span>)</span>
<span id="cb107-329"><a href="#cb107-329" aria-hidden="true" tabindex="-1"></a>ssu18_perm_summary<span class="sc">$</span>dist <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(ssu18_perm_summary<span class="sc">$</span>dist, <span class="st">"jsd"</span>, <span class="st">"Jensen–Shannon divergence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-330"><a href="#cb107-330" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"wunifrac"</span>, <span class="st">"weighted UniFrac"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-331"><a href="#cb107-331" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"unifrac"</span>, <span class="st">"unweighted UniFrac"</span>)</span>
<span id="cb107-332"><a href="#cb107-332" aria-hidden="true" tabindex="-1"></a>ssu18_perm_summary<span class="sc">$</span>pval <span class="ot">&lt;-</span> <span class="fu">round</span>(ssu18_perm_summary[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb107-333"><a href="#cb107-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-334"><a href="#cb107-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-335"><a href="#cb107-335" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_beta_disp_tests")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-336"><a href="#cb107-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-339"><a href="#cb107-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-340"><a href="#cb107-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-341"><a href="#cb107-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-342"><a href="#cb107-342" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_perm_summary</span>
<span id="cb107-343"><a href="#cb107-343" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb107-344"><a href="#cb107-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb107-345"><a href="#cb107-345" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_beta_disp_tests"</span>,</span>
<span id="cb107-346"><a href="#cb107-346" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb107-347"><a href="#cb107-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb107-348"><a href="#cb107-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb107-349"><a href="#cb107-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-350"><a href="#cb107-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-351"><a href="#cb107-351" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb107-352"><a href="#cb107-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-353"><a href="#cb107-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-356"><a href="#cb107-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-357"><a href="#cb107-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-358"><a href="#cb107-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-359"><a href="#cb107-359" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb107-360"><a href="#cb107-360" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb107-361"><a href="#cb107-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb107-362"><a href="#cb107-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">4</span>),</span>
<span id="cb107-363"><a href="#cb107-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-364"><a href="#cb107-364" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">headerVAlign =</span> <span class="st">"center"</span></span>
<span id="cb107-365"><a href="#cb107-365" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb107-366"><a href="#cb107-366" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb107-367"><a href="#cb107-367" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Dataset"</span>, </span>
<span id="cb107-368"><a href="#cb107-368" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb107-369"><a href="#cb107-369" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb107-370"><a href="#cb107-370" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb107-371"><a href="#cb107-371" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb107-372"><a href="#cb107-372" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">50</span>),</span>
<span id="cb107-373"><a href="#cb107-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"distance"</span>, <span class="at">align =</span> <span class="st">"left"</span>),</span>
<span id="cb107-374"><a href="#cb107-374" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">pval</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value"</span>, <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-375"><a href="#cb107-375" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb107-376"><a href="#cb107-376" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb107-377"><a href="#cb107-377" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span></span>
<span id="cb107-378"><a href="#cb107-378" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb107-379"><a href="#cb107-379" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span></span>
<span id="cb107-380"><a href="#cb107-380" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb107-381"><a href="#cb107-381" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb107-382"><a href="#cb107-382" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb107-383"><a href="#cb107-383" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb107-384"><a href="#cb107-384" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb107-385"><a href="#cb107-385" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb107-386"><a href="#cb107-386" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">12</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-387"><a href="#cb107-387" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb107-388"><a href="#cb107-388" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-389"><a href="#cb107-389" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-390"><a href="#cb107-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">TRUE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-391"><a href="#cb107-391" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb107-392"><a href="#cb107-392" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb107-393"><a href="#cb107-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-394"><a href="#cb107-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-395"><a href="#cb107-395" aria-hidden="true" tabindex="-1"></a>Now we to create sample data frames for each data set. </span>
<span id="cb107-396"><a href="#cb107-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-399"><a href="#cb107-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-400"><a href="#cb107-400" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb107-401"><a href="#cb107-401" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_samp_ps) {</span>
<span id="cb107-402"><a href="#cb107-402" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_prop"</span>)))</span>
<span id="cb107-403"><a href="#cb107-403" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_get))</span>
<span id="cb107-404"><a href="#cb107-404" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_sampledf"</span>))</span>
<span id="cb107-405"><a href="#cb107-405" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_samp)</span>
<span id="cb107-406"><a href="#cb107-406" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-407"><a href="#cb107-407" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-408"><a href="#cb107-408" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">"_sampledf"</span>)</span>
<span id="cb107-409"><a href="#cb107-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-410"><a href="#cb107-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-411"><a href="#cb107-411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Significance Tests </span></span>
<span id="cb107-412"><a href="#cb107-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-413"><a href="#cb107-413" aria-hidden="true" tabindex="-1"></a>Depending on the test, we need different data structures. For <span class="in">`adonis`</span> we use the sample metadata and for <span class="in">`anosim`</span> we will start with a phyloseq object. So for each data set we create two variables: <span class="in">`adonis_sampledf`</span> and <span class="in">`anosim_data`</span></span>
<span id="cb107-414"><a href="#cb107-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-415"><a href="#cb107-415" aria-hidden="true" tabindex="-1"></a>::: {.column-body}</span>
<span id="cb107-416"><a href="#cb107-416" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-417"><a href="#cb107-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-418"><a href="#cb107-418" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL</span></span>
<span id="cb107-419"><a href="#cb107-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-422"><a href="#cb107-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-423"><a href="#cb107-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-424"><a href="#cb107-424" aria-hidden="true" tabindex="-1"></a>adonis_sampledf <span class="ot">&lt;-</span> ssu18_ps_work_sampledf</span>
<span id="cb107-425"><a href="#cb107-425" aria-hidden="true" tabindex="-1"></a>anosim_data <span class="ot">&lt;-</span> ssu18_ps_work</span>
<span id="cb107-426"><a href="#cb107-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-427"><a href="#cb107-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-430"><a href="#cb107-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-431"><a href="#cb107-431" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-432"><a href="#cb107-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-433"><a href="#cb107-433" aria-hidden="true" tabindex="-1"></a>tmp_perm_tests <span class="ot">&lt;-</span> ssu18_perm_pvalues[ssu18_perm_pvalues<span class="sc">$</span>data_set <span class="sc">==</span> <span class="st">'ssu18_ps_work'</span>,]</span>
<span id="cb107-434"><a href="#cb107-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-435"><a href="#cb107-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-436"><a href="#cb107-436" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r ssu18_perm_pvalues$dist[1]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[1] &lt; 0.05))`</span>.  </span>
<span id="cb107-437"><a href="#cb107-437" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[1]`**.</span>
<span id="cb107-438"><a href="#cb107-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-441"><a href="#cb107-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-442"><a href="#cb107-442" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_adonis_jsd <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(ssu18_ps_work_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-443"><a href="#cb107-443" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-444"><a href="#cb107-444" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_adonis2_jsd <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(ssu18_ps_work_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-445"><a href="#cb107-445" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-446"><a href="#cb107-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-447"><a href="#cb107-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-448"><a href="#cb107-448" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[2]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[2] &lt; 0.05))`</span>.  </span>
<span id="cb107-449"><a href="#cb107-449" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[2]`**.</span>
<span id="cb107-450"><a href="#cb107-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-453"><a href="#cb107-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-454"><a href="#cb107-454" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-455"><a href="#cb107-455" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_anosim_unifrac <span class="ot">&lt;-</span></span>
<span id="cb107-456"><a href="#cb107-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(ssu18_ps_work_prop, <span class="st">"unifrac"</span>),</span>
<span id="cb107-457"><a href="#cb107-457" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> ssu18_ps_work_groups)</span>
<span id="cb107-458"><a href="#cb107-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-459"><a href="#cb107-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-460"><a href="#cb107-460" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[3]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[3] &lt; 0.05))`</span>.  </span>
<span id="cb107-461"><a href="#cb107-461" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[3]`**.</span>
<span id="cb107-462"><a href="#cb107-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-465"><a href="#cb107-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-466"><a href="#cb107-466" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-467"><a href="#cb107-467" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_anosim_wunifrac <span class="ot">&lt;-</span></span>
<span id="cb107-468"><a href="#cb107-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(ssu18_ps_work_prop, <span class="st">"wunifrac"</span>),</span>
<span id="cb107-469"><a href="#cb107-469" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> ssu18_ps_work_groups)</span>
<span id="cb107-470"><a href="#cb107-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-471"><a href="#cb107-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-472"><a href="#cb107-472" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary</span></span>
<span id="cb107-473"><a href="#cb107-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-476"><a href="#cb107-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-477"><a href="#cb107-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-478"><a href="#cb107-478" aria-hidden="true" tabindex="-1"></a>adonis_sampledf <span class="ot">&lt;-</span> ssu18_ps_filt_sampledf</span>
<span id="cb107-479"><a href="#cb107-479" aria-hidden="true" tabindex="-1"></a>anosim_data <span class="ot">&lt;-</span> ssu18_ps_filt</span>
<span id="cb107-480"><a href="#cb107-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-481"><a href="#cb107-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-484"><a href="#cb107-484" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-485"><a href="#cb107-485" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-486"><a href="#cb107-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-487"><a href="#cb107-487" aria-hidden="true" tabindex="-1"></a>tmp_perm_tests <span class="ot">&lt;-</span> ssu18_perm_pvalues[ssu18_perm_pvalues<span class="sc">$</span>data_set <span class="sc">==</span> <span class="st">'ssu18_ps_filt'</span>,]</span>
<span id="cb107-488"><a href="#cb107-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-489"><a href="#cb107-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-490"><a href="#cb107-490" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r ssu18_perm_pvalues$dist[1]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[1] &lt; 0.05))`</span>.  </span>
<span id="cb107-491"><a href="#cb107-491" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[1]`**.</span>
<span id="cb107-492"><a href="#cb107-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-495"><a href="#cb107-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-496"><a href="#cb107-496" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_adonis_jsd <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(ssu18_ps_filt_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-497"><a href="#cb107-497" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-498"><a href="#cb107-498" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_adonis2_jsd <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(ssu18_ps_filt_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-499"><a href="#cb107-499" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-500"><a href="#cb107-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-501"><a href="#cb107-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-502"><a href="#cb107-502" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[2]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[2] &lt; 0.05))`</span>.  </span>
<span id="cb107-503"><a href="#cb107-503" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[2]`**.</span>
<span id="cb107-504"><a href="#cb107-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-507"><a href="#cb107-507" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-508"><a href="#cb107-508" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-509"><a href="#cb107-509" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_anosim_unifrac <span class="ot">&lt;-</span></span>
<span id="cb107-510"><a href="#cb107-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(ssu18_ps_filt_prop, <span class="st">"unifrac"</span>),</span>
<span id="cb107-511"><a href="#cb107-511" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> ssu18_ps_filt_groups)</span>
<span id="cb107-512"><a href="#cb107-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-513"><a href="#cb107-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-514"><a href="#cb107-514" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[3]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[3] &lt; 0.05))`</span>.  </span>
<span id="cb107-515"><a href="#cb107-515" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[3]`**.</span>
<span id="cb107-516"><a href="#cb107-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-519"><a href="#cb107-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-520"><a href="#cb107-520" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-521"><a href="#cb107-521" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_anosim_wunifrac <span class="ot">&lt;-</span></span>
<span id="cb107-522"><a href="#cb107-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(ssu18_ps_filt_prop, <span class="st">"wunifrac"</span>),</span>
<span id="cb107-523"><a href="#cb107-523" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> ssu18_ps_filt_groups)</span>
<span id="cb107-524"><a href="#cb107-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-525"><a href="#cb107-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-526"><a href="#cb107-526" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-527"><a href="#cb107-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-530"><a href="#cb107-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-531"><a href="#cb107-531" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-532"><a href="#cb107-532" aria-hidden="true" tabindex="-1"></a>adonis_sampledf <span class="ot">&lt;-</span> ssu18_ps_perfect_sampledf</span>
<span id="cb107-533"><a href="#cb107-533" aria-hidden="true" tabindex="-1"></a>anosim_data <span class="ot">&lt;-</span> ssu18_ps_perfect</span>
<span id="cb107-534"><a href="#cb107-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-535"><a href="#cb107-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-538"><a href="#cb107-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-539"><a href="#cb107-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-540"><a href="#cb107-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-541"><a href="#cb107-541" aria-hidden="true" tabindex="-1"></a>tmp_perm_tests <span class="ot">&lt;-</span> ssu18_perm_pvalues[ssu18_perm_pvalues<span class="sc">$</span>data_set <span class="sc">==</span> <span class="st">'ssu18_ps_perfect'</span>,]</span>
<span id="cb107-542"><a href="#cb107-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-543"><a href="#cb107-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-544"><a href="#cb107-544" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r ssu18_perm_pvalues$dist[1]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[1] &lt; 0.05))`</span>.  </span>
<span id="cb107-545"><a href="#cb107-545" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[1]`**.</span>
<span id="cb107-546"><a href="#cb107-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-549"><a href="#cb107-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-550"><a href="#cb107-550" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-551"><a href="#cb107-551" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_anosim_jsd <span class="ot">&lt;-</span></span>
<span id="cb107-552"><a href="#cb107-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(ssu18_ps_perfect_prop, <span class="st">"jsd"</span>),</span>
<span id="cb107-553"><a href="#cb107-553" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> ssu18_ps_perfect_groups)</span>
<span id="cb107-554"><a href="#cb107-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-555"><a href="#cb107-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-556"><a href="#cb107-556" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[2]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[2] &lt; 0.05))`</span>.  </span>
<span id="cb107-557"><a href="#cb107-557" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[2]`**.</span>
<span id="cb107-558"><a href="#cb107-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-561"><a href="#cb107-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-562"><a href="#cb107-562" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-563"><a href="#cb107-563" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_anosim_unifrac <span class="ot">&lt;-</span></span>
<span id="cb107-564"><a href="#cb107-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(ssu18_ps_perfect_prop, <span class="st">"unifrac"</span>),</span>
<span id="cb107-565"><a href="#cb107-565" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> ssu18_ps_perfect_groups)</span>
<span id="cb107-566"><a href="#cb107-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-567"><a href="#cb107-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-568"><a href="#cb107-568" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[3]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[3] &lt; 0.05))`</span>.  </span>
<span id="cb107-569"><a href="#cb107-569" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[3]`**.</span>
<span id="cb107-570"><a href="#cb107-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-573"><a href="#cb107-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-574"><a href="#cb107-574" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-575"><a href="#cb107-575" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_anosim_wunifrac <span class="ot">&lt;-</span></span>
<span id="cb107-576"><a href="#cb107-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(ssu18_ps_perfect_prop, <span class="st">"wunifrac"</span>),</span>
<span id="cb107-577"><a href="#cb107-577" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> ssu18_ps_perfect_groups)</span>
<span id="cb107-578"><a href="#cb107-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-579"><a href="#cb107-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-580"><a href="#cb107-580" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-581"><a href="#cb107-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-584"><a href="#cb107-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-585"><a href="#cb107-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-586"><a href="#cb107-586" aria-hidden="true" tabindex="-1"></a>adonis_sampledf <span class="ot">&lt;-</span> ssu18_ps_pime_sampledf</span>
<span id="cb107-587"><a href="#cb107-587" aria-hidden="true" tabindex="-1"></a>anosim_data <span class="ot">&lt;-</span> ssu18_ps_pime</span>
<span id="cb107-588"><a href="#cb107-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-589"><a href="#cb107-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-592"><a href="#cb107-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-593"><a href="#cb107-593" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-594"><a href="#cb107-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-595"><a href="#cb107-595" aria-hidden="true" tabindex="-1"></a>tmp_perm_tests <span class="ot">&lt;-</span> ssu18_perm_pvalues[ssu18_perm_pvalues<span class="sc">$</span>data_set <span class="sc">==</span> <span class="st">'ssu18_ps_pime'</span>,]</span>
<span id="cb107-596"><a href="#cb107-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-597"><a href="#cb107-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-598"><a href="#cb107-598" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r ssu18_perm_pvalues$dist[1]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[1] &lt; 0.05))`</span>.  </span>
<span id="cb107-599"><a href="#cb107-599" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[1]`**.</span>
<span id="cb107-600"><a href="#cb107-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-603"><a href="#cb107-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-604"><a href="#cb107-604" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_adonis_jsd <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(ssu18_ps_pime_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-605"><a href="#cb107-605" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-606"><a href="#cb107-606" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_adonis2_jsd <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(ssu18_ps_pime_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-607"><a href="#cb107-607" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-608"><a href="#cb107-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-609"><a href="#cb107-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-610"><a href="#cb107-610" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[2]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[2] &lt; 0.05))`</span>.  </span>
<span id="cb107-611"><a href="#cb107-611" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[2]`**.</span>
<span id="cb107-612"><a href="#cb107-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-615"><a href="#cb107-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-616"><a href="#cb107-616" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_adonis_unifrac <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(ssu18_ps_pime_beta_dist_unifrac <span class="sc">~</span> TEMP,</span>
<span id="cb107-617"><a href="#cb107-617" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-618"><a href="#cb107-618" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_adonis2_unifrac <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(ssu18_ps_pime_beta_dist_unifrac <span class="sc">~</span> TEMP,</span>
<span id="cb107-619"><a href="#cb107-619" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-620"><a href="#cb107-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-621"><a href="#cb107-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-622"><a href="#cb107-622" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[3]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[3] &lt; 0.05))`</span>.  </span>
<span id="cb107-623"><a href="#cb107-623" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[3]`**.</span>
<span id="cb107-624"><a href="#cb107-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-627"><a href="#cb107-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-628"><a href="#cb107-628" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-629"><a href="#cb107-629" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_anosim_wunifrac <span class="ot">&lt;-</span></span>
<span id="cb107-630"><a href="#cb107-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(ssu18_ps_pime_prop, <span class="st">"wunifrac"</span>),</span>
<span id="cb107-631"><a href="#cb107-631" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> ssu18_ps_pime_groups)</span>
<span id="cb107-632"><a href="#cb107-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-633"><a href="#cb107-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-634"><a href="#cb107-634" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-635"><a href="#cb107-635" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-636"><a href="#cb107-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-637"><a href="#cb107-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-638"><a href="#cb107-638" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb107-639"><a href="#cb107-639" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;&lt;strong&gt;</span>Detailed results<span class="kw">&lt;/strong&gt;</span> of Significance tests<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb107-640"><a href="#cb107-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-641"><a href="#cb107-641" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-642"><a href="#cb107-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-643"><a href="#cb107-643" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL</span></span>
<span id="cb107-644"><a href="#cb107-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-647"><a href="#cb107-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-648"><a href="#cb107-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-649"><a href="#cb107-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-650"><a href="#cb107-650" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Jensen-Shannon Divergence, `jsd`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-651"><a href="#cb107-651" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_adonis2_jsd</span>
<span id="cb107-652"><a href="#cb107-652" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-653"><a href="#cb107-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-654"><a href="#cb107-654" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Unweighted UniFrac distance, `unifrac`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-655"><a href="#cb107-655" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_work_anosim_unifrac)</span>
<span id="cb107-656"><a href="#cb107-656" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-657"><a href="#cb107-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-658"><a href="#cb107-658" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Weighted-UniFrac distance, `wunifrac`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-659"><a href="#cb107-659" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_work_anosim_wunifrac)</span>
<span id="cb107-660"><a href="#cb107-660" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-661"><a href="#cb107-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-662"><a href="#cb107-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-663"><a href="#cb107-663" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary</span></span>
<span id="cb107-664"><a href="#cb107-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-667"><a href="#cb107-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-668"><a href="#cb107-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-669"><a href="#cb107-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-670"><a href="#cb107-670" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Jensen-Shannon Divergence, `jsd`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-671"><a href="#cb107-671" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_adonis2_jsd</span>
<span id="cb107-672"><a href="#cb107-672" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-673"><a href="#cb107-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-674"><a href="#cb107-674" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Unweighted UniFrac distance, `unifrac`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-675"><a href="#cb107-675" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_filt_anosim_unifrac)</span>
<span id="cb107-676"><a href="#cb107-676" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-677"><a href="#cb107-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-678"><a href="#cb107-678" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Weighted-UniFrac distance, `wunifrac`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-679"><a href="#cb107-679" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_filt_anosim_wunifrac)</span>
<span id="cb107-680"><a href="#cb107-680" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-681"><a href="#cb107-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-682"><a href="#cb107-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-683"><a href="#cb107-683" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-684"><a href="#cb107-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-687"><a href="#cb107-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-688"><a href="#cb107-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-689"><a href="#cb107-689" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-690"><a href="#cb107-690" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Jensen-Shannon Divergence, `jsd`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-691"><a href="#cb107-691" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_perfect_anosim_jsd)</span>
<span id="cb107-692"><a href="#cb107-692" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-693"><a href="#cb107-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-694"><a href="#cb107-694" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Unweighted UniFrac distance, `unifrac`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-695"><a href="#cb107-695" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_perfect_anosim_unifrac)</span>
<span id="cb107-696"><a href="#cb107-696" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-697"><a href="#cb107-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-698"><a href="#cb107-698" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Weighted-UniFrac distance, `wunifrac`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-699"><a href="#cb107-699" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_perfect_anosim_wunifrac)</span>
<span id="cb107-700"><a href="#cb107-700" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-701"><a href="#cb107-701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-702"><a href="#cb107-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-703"><a href="#cb107-703" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-704"><a href="#cb107-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-707"><a href="#cb107-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-708"><a href="#cb107-708" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-709"><a href="#cb107-709" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-710"><a href="#cb107-710" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Jensen-Shannon Divergence, `jsd`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-711"><a href="#cb107-711" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_adonis2_jsd</span>
<span id="cb107-712"><a href="#cb107-712" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-713"><a href="#cb107-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-714"><a href="#cb107-714" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Unweighted UniFrac distance, `unifrac`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-715"><a href="#cb107-715" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_adonis2_unifrac</span>
<span id="cb107-716"><a href="#cb107-716" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-717"><a href="#cb107-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-718"><a href="#cb107-718" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Weighted-UniFrac distance, `wunifrac`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-719"><a href="#cb107-719" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_pime_anosim_wunifrac)</span>
<span id="cb107-720"><a href="#cb107-720" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-721"><a href="#cb107-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-722"><a href="#cb107-722" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-723"><a href="#cb107-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-724"><a href="#cb107-724" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb107-725"><a href="#cb107-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-726"><a href="#cb107-726" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summaries </span></span>
<span id="cb107-727"><a href="#cb107-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-728"><a href="#cb107-728" aria-hidden="true" tabindex="-1"></a>Here is a quick summary of significance tests for the data sets against three distance matrices.</span>
<span id="cb107-729"><a href="#cb107-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-732"><a href="#cb107-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-733"><a href="#cb107-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-734"><a href="#cb107-734" aria-hidden="true" tabindex="-1"></a>data_set <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"FULL"</span>, <span class="st">"FILT"</span>, <span class="st">"PERfect"</span>, <span class="st">"PIME"</span>))</span>
<span id="cb107-735"><a href="#cb107-735" aria-hidden="true" tabindex="-1"></a>ssu_dist_metric <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"Jensen-Shannon Divergence"</span>, <span class="st">"unweighted UniFrac"</span>, <span class="st">"weighted UniFrac"</span>))</span>
<span id="cb107-736"><a href="#cb107-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-737"><a href="#cb107-737" aria-hidden="true" tabindex="-1"></a>tmp_p_value_full <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ssu18_ps_work_adonis_jsd<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-738"><a href="#cb107-738" aria-hidden="true" tabindex="-1"></a>                                 ssu18_ps_work_anosim_unifrac<span class="sc">$</span>signif,</span>
<span id="cb107-739"><a href="#cb107-739" aria-hidden="true" tabindex="-1"></a>                                 ssu18_ps_work_anosim_wunifrac<span class="sc">$</span>signif))</span>
<span id="cb107-740"><a href="#cb107-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-741"><a href="#cb107-741" aria-hidden="true" tabindex="-1"></a>tmp_p_value_perfect <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ssu18_ps_perfect_anosim_jsd<span class="sc">$</span>signif,</span>
<span id="cb107-742"><a href="#cb107-742" aria-hidden="true" tabindex="-1"></a>                                    ssu18_ps_perfect_anosim_unifrac<span class="sc">$</span>signif,</span>
<span id="cb107-743"><a href="#cb107-743" aria-hidden="true" tabindex="-1"></a>                                    ssu18_ps_perfect_anosim_wunifrac<span class="sc">$</span>signif))</span>
<span id="cb107-744"><a href="#cb107-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-745"><a href="#cb107-745" aria-hidden="true" tabindex="-1"></a>tmp_p_value_filt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ssu18_ps_filt_adonis_jsd<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-746"><a href="#cb107-746" aria-hidden="true" tabindex="-1"></a>                                 ssu18_ps_filt_anosim_unifrac<span class="sc">$</span>signif,</span>
<span id="cb107-747"><a href="#cb107-747" aria-hidden="true" tabindex="-1"></a>                                 ssu18_ps_filt_anosim_wunifrac<span class="sc">$</span>signif))</span>
<span id="cb107-748"><a href="#cb107-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-749"><a href="#cb107-749" aria-hidden="true" tabindex="-1"></a>tmp_p_value_pime <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ssu18_ps_pime_adonis_jsd<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-750"><a href="#cb107-750" aria-hidden="true" tabindex="-1"></a>                                 ssu18_ps_pime_adonis_unifrac<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-751"><a href="#cb107-751" aria-hidden="true" tabindex="-1"></a>                                 ssu18_ps_pime_anosim_wunifrac<span class="sc">$</span>signif))</span>
<span id="cb107-752"><a href="#cb107-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-753"><a href="#cb107-753" aria-hidden="true" tabindex="-1"></a>ssu18_tab_sig_test <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(ssu_dist_metric, tmp_p_value_full) <span class="sc">%&gt;%</span></span>
<span id="cb107-754"><a href="#cb107-754" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_p_value_filt) <span class="sc">%&gt;%</span></span>
<span id="cb107-755"><a href="#cb107-755" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_p_value_perfect) <span class="sc">%&gt;%</span></span>
<span id="cb107-756"><a href="#cb107-756" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_p_value_pime)  <span class="sc">%&gt;%</span></span>
<span id="cb107-757"><a href="#cb107-757" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"distance metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"FULL"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"FILT"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"PERfect"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"PIME"</span> <span class="ot">=</span> <span class="dv">5</span>) </span>
<span id="cb107-758"><a href="#cb107-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-759"><a href="#cb107-759" aria-hidden="true" tabindex="-1"></a>ssu18_tab_sig_test <span class="ot">&lt;-</span> ssu18_tab_sig_test <span class="sc">%&gt;%</span>  </span>
<span id="cb107-760"><a href="#cb107-760" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(ssu18_tab_sig_test)), round, <span class="at">digits =</span> <span class="dv">4</span>))</span>
<span id="cb107-761"><a href="#cb107-761" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-762"><a href="#cb107-762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-763"><a href="#cb107-763" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_sign_tests")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-764"><a href="#cb107-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-767"><a href="#cb107-767" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-768"><a href="#cb107-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-769"><a href="#cb107-769" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-770"><a href="#cb107-770" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_tab_sig_test</span>
<span id="cb107-771"><a href="#cb107-771" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb107-772"><a href="#cb107-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb107-773"><a href="#cb107-773" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_sign_tests"</span>,</span>
<span id="cb107-774"><a href="#cb107-774" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb107-775"><a href="#cb107-775" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb107-776"><a href="#cb107-776" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb107-777"><a href="#cb107-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-778"><a href="#cb107-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-779"><a href="#cb107-779" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb107-780"><a href="#cb107-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-781"><a href="#cb107-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-784"><a href="#cb107-784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-785"><a href="#cb107-785" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-786"><a href="#cb107-786" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-787"><a href="#cb107-787" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb107-788"><a href="#cb107-788" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb107-789"><a href="#cb107-789" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb107-790"><a href="#cb107-790" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">3</span>),</span>
<span id="cb107-791"><a href="#cb107-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">FALSE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-792"><a href="#cb107-792" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">headerVAlign =</span> <span class="st">"center"</span>,</span>
<span id="cb107-793"><a href="#cb107-793" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb107-794"><a href="#cb107-794" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb107-795"><a href="#cb107-795" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span></span>
<span id="cb107-796"><a href="#cb107-796" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb107-797"><a href="#cb107-797" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span></span>
<span id="cb107-798"><a href="#cb107-798" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb107-799"><a href="#cb107-799" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb107-800"><a href="#cb107-800" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb107-801"><a href="#cb107-801" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb107-802"><a href="#cb107-802" aria-hidden="true" tabindex="-1"></a>                            }</span>
<span id="cb107-803"><a href="#cb107-803" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb107-804"><a href="#cb107-804" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb107-805"><a href="#cb107-805" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">distance metric</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Distance metric"</span>, </span>
<span id="cb107-806"><a href="#cb107-806" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb107-807"><a href="#cb107-807" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb107-808"><a href="#cb107-808" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb107-809"><a href="#cb107-809" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb107-810"><a href="#cb107-810" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>),</span>
<span id="cb107-811"><a href="#cb107-811" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"distance"</span>, <span class="at">align =</span> <span class="st">"left"</span>)</span>
<span id="cb107-812"><a href="#cb107-812" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb107-813"><a href="#cb107-813" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(<span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"p-values"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"FULL"</span>, <span class="st">"FILT"</span>, <span class="st">"PERfect"</span>, <span class="st">"PIME"</span>),</span>
<span id="cb107-814"><a href="#cb107-814" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"1.3em"</span>))</span>
<span id="cb107-815"><a href="#cb107-815" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb107-816"><a href="#cb107-816" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">12</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-817"><a href="#cb107-817" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb107-818"><a href="#cb107-818" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">FALSE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-819"><a href="#cb107-819" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-820"><a href="#cb107-820" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">TRUE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-821"><a href="#cb107-821" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.9em"</span>)))</span>
<span id="cb107-822"><a href="#cb107-822" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb107-823"><a href="#cb107-823" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-824"><a href="#cb107-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-825"><a href="#cb107-825" aria-hidden="true" tabindex="-1"></a><span class="fu"># ITS</span></span>
<span id="cb107-826"><a href="#cb107-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-829"><a href="#cb107-829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-830"><a href="#cb107-830" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb107-831"><a href="#cb107-831" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb107-832"><a href="#cb107-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-833"><a href="#cb107-833" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial Load for  ANALYSIS #1</span></span>
<span id="cb107-834"><a href="#cb107-834" aria-hidden="true" tabindex="-1"></a><span class="co">#remove(list = ls())</span></span>
<span id="cb107-835"><a href="#cb107-835" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(119)</span></span>
<span id="cb107-836"><a href="#cb107-836" aria-hidden="true" tabindex="-1"></a>its18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/its18_ps_work.rds"</span>)</span>
<span id="cb107-837"><a href="#cb107-837" aria-hidden="true" tabindex="-1"></a>its18_ps_filt <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/its18_ps_filt.rds"</span>)</span>
<span id="cb107-838"><a href="#cb107-838" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/its18_ps_perfect.rds"</span>)</span>
<span id="cb107-839"><a href="#cb107-839" aria-hidden="true" tabindex="-1"></a>its18_ps_pime <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/its18_ps_pime.rds"</span>)</span>
<span id="cb107-840"><a href="#cb107-840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-841"><a href="#cb107-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-844"><a href="#cb107-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-845"><a href="#cb107-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-846"><a href="#cb107-846" aria-hidden="true" tabindex="-1"></a>swel_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2271B2"</span>, <span class="st">"#71B222"</span>, <span class="st">"#B22271"</span>)</span>
<span id="cb107-847"><a href="#cb107-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-848"><a href="#cb107-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-849"><a href="#cb107-849" aria-hidden="true" tabindex="-1"></a>In order to test for significance between sample groups, we must perform the following steps:</span>
<span id="cb107-850"><a href="#cb107-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-851"><a href="#cb107-851" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Transform sample counts to relative abundance.</span>
<span id="cb107-852"><a href="#cb107-852" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Create distance matrices based on some metrics, for example <span class="in">`gower`</span>, <span class="in">`bray`</span>, and <span class="in">`jsd`</span>. For this we use the function <span class="in">`phyloseq::distance`</span>.</span>
<span id="cb107-853"><a href="#cb107-853" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Next, calculate beta dispersion using the <span class="in">`betadisper`</span> function from the <span class="in">`vegan`</span> package <span class="co">[</span><span class="ot">@oksanen2013community</span><span class="co">]</span>.</span>
<span id="cb107-854"><a href="#cb107-854" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Then, use the function <span class="in">`permutest`</span> to run a Permutation test for homogeneity of multivariate dispersions.</span>
<span id="cb107-855"><a href="#cb107-855" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>If the beta dispersion tests are not significant we will run a PERMANOVA using <span class="in">`adonis`</span> (since PERMANOVA aitsmes equal dispersion), otherwise we will use Analysis of Similarity (ANOSIM), both available in the <span class="in">`vegan`</span> package <span class="co">[</span><span class="ot">@oksanen2013community</span><span class="co">]</span>.</span>
<span id="cb107-856"><a href="#cb107-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-857"><a href="#cb107-857" aria-hidden="true" tabindex="-1"></a>Steps 2--4 are combined in a <span class="in">`for`</span> loop that tests all three distance metrics.</span>
<span id="cb107-858"><a href="#cb107-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-859"><a href="#cb107-859" aria-hidden="true" tabindex="-1"></a>Before we begin, we need to first transform sample counts to relative abundance and generate some new trees.</span>
<span id="cb107-860"><a href="#cb107-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-863"><a href="#cb107-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-864"><a href="#cb107-864" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb107-865"><a href="#cb107-865" aria-hidden="true" tabindex="-1"></a>its_samp_ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, </span>
<span id="cb107-866"><a href="#cb107-866" aria-hidden="true" tabindex="-1"></a>             <span class="st">"its18_ps_perfect"</span>, <span class="st">"its18_ps_pime"</span>)</span>
<span id="cb107-867"><a href="#cb107-867" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its_samp_ps) {</span>
<span id="cb107-868"><a href="#cb107-868" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_prop"</span>))</span>
<span id="cb107-869"><a href="#cb107-869" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb107-870"><a href="#cb107-870" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(tmp_get, <span class="cf">function</span>(otu) </span>
<span id="cb107-871"><a href="#cb107-871" aria-hidden="true" tabindex="-1"></a>                                          <span class="fl">1e5</span> <span class="sc">*</span> otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb107-872"><a href="#cb107-872" aria-hidden="true" tabindex="-1"></a>     tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb107-873"><a href="#cb107-873" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">prune_samples</span>(<span class="fu">sample_sums</span>(tmp_ps) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_ps)</span>
<span id="cb107-874"><a href="#cb107-874" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data)</span>
<span id="cb107-875"><a href="#cb107-875" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb107-876"><a href="#cb107-876" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_ps)</span>
<span id="cb107-877"><a href="#cb107-877" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-878"><a href="#cb107-878" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-879"><a href="#cb107-879" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-880"><a href="#cb107-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-881"><a href="#cb107-881" aria-hidden="true" tabindex="-1"></a><span class="fu">### Beta Dispersion</span></span>
<span id="cb107-882"><a href="#cb107-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-883"><a href="#cb107-883" aria-hidden="true" tabindex="-1"></a>Here we create distance matrices for each metric, calculate the beta dispersion, and run a permutation test for homogeneity of multivariate dispersions. </span>
<span id="cb107-884"><a href="#cb107-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-887"><a href="#cb107-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-888"><a href="#cb107-888" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb107-889"><a href="#cb107-889" aria-hidden="true" tabindex="-1"></a>its_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"jsd"</span>, <span class="st">"bray"</span>, <span class="st">"gower"</span>)</span>
<span id="cb107-890"><a href="#cb107-890" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its_samp_ps) {</span>
<span id="cb107-891"><a href="#cb107-891" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> its_dist){</span>
<span id="cb107-892"><a href="#cb107-892" aria-hidden="true" tabindex="-1"></a>       tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_prop"</span>)))</span>
<span id="cb107-893"><a href="#cb107-893" aria-hidden="true" tabindex="-1"></a>       tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_get))</span>
<span id="cb107-894"><a href="#cb107-894" aria-hidden="true" tabindex="-1"></a>       tmp_df <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">distance</span>(tmp_get, <span class="at">method =</span> d)</span>
<span id="cb107-895"><a href="#cb107-895" aria-hidden="true" tabindex="-1"></a>       tmp_df_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_beta_dist_"</span>, .))</span>
<span id="cb107-896"><a href="#cb107-896" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_df_name, tmp_df)</span>
<span id="cb107-897"><a href="#cb107-897" aria-hidden="true" tabindex="-1"></a>       tmp_df2 <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(tmp_df, tmp_samp<span class="sc">$</span>TEMP, <span class="at">bias.adjust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-898"><a href="#cb107-898" aria-hidden="true" tabindex="-1"></a>       tmp_df_name2 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_beta_dispersion_"</span>, .))</span>
<span id="cb107-899"><a href="#cb107-899" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_df_name2, tmp_df2)</span>
<span id="cb107-900"><a href="#cb107-900" aria-hidden="true" tabindex="-1"></a>       tmp_df3 <span class="ot">&lt;-</span> <span class="fu">permutest</span>(tmp_df2, <span class="at">pairwise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-901"><a href="#cb107-901" aria-hidden="true" tabindex="-1"></a>                            <span class="at">permutations =</span> <span class="dv">1000</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-902"><a href="#cb107-902" aria-hidden="true" tabindex="-1"></a>       tmp_df_name3 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, .))</span>
<span id="cb107-903"><a href="#cb107-903" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_df_name3, tmp_df3)</span>
<span id="cb107-904"><a href="#cb107-904" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-905"><a href="#cb107-905" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-906"><a href="#cb107-906" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-907"><a href="#cb107-907" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb107-908"><a href="#cb107-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-909"><a href="#cb107-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-910"><a href="#cb107-910" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb107-911"><a href="#cb107-911" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;&lt;strong&gt;</span>Detailed results<span class="kw">&lt;/strong&gt;</span> of Beta Dispersion &amp; Permutation tests<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb107-912"><a href="#cb107-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-913"><a href="#cb107-913" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-914"><a href="#cb107-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-917"><a href="#cb107-917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-918"><a href="#cb107-918" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-919"><a href="#cb107-919" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-920"><a href="#cb107-920" aria-hidden="true" tabindex="-1"></a>its_samp_ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, <span class="st">"its18_ps_perfect"</span>, <span class="st">"its18_ps_pime"</span>)</span>
<span id="cb107-921"><a href="#cb107-921" aria-hidden="true" tabindex="-1"></a>its_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"jsd"</span>, <span class="st">"bray"</span>, <span class="st">"gower"</span>)</span>
<span id="cb107-922"><a href="#cb107-922" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-923"><a href="#cb107-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-924"><a href="#cb107-924" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL</span></span>
<span id="cb107-925"><a href="#cb107-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-928"><a href="#cb107-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-929"><a href="#cb107-929" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-930"><a href="#cb107-930" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-931"><a href="#cb107-931" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its_samp_ps[<span class="dv">1</span>]) {</span>
<span id="cb107-932"><a href="#cb107-932" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cat("\n", "           *****", i, "*****", "\n")</span></span>
<span id="cb107-933"><a href="#cb107-933" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> its_dist){</span>
<span id="cb107-934"><a href="#cb107-934" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-935"><a href="#cb107-935" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-936"><a href="#cb107-936" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-937"><a href="#cb107-937" aria-hidden="true" tabindex="-1"></a>          tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BETA DISPERSION significance test"</span>, d, <span class="st">"distance"</span>)</span>
<span id="cb107-938"><a href="#cb107-938" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(tmp_print, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-939"><a href="#cb107-939" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>)</span>
<span id="cb107-940"><a href="#cb107-940" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-941"><a href="#cb107-941" aria-hidden="true" tabindex="-1"></a>          <span class="fu">print</span>(tmp_get)</span>
<span id="cb107-942"><a href="#cb107-942" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-943"><a href="#cb107-943" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-944"><a href="#cb107-944" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-945"><a href="#cb107-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-946"><a href="#cb107-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-947"><a href="#cb107-947" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary</span></span>
<span id="cb107-948"><a href="#cb107-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-951"><a href="#cb107-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-952"><a href="#cb107-952" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-953"><a href="#cb107-953" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-954"><a href="#cb107-954" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its_samp_ps[<span class="dv">2</span>]) {</span>
<span id="cb107-955"><a href="#cb107-955" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cat("\n", "           *****", i, "*****", "\n")</span></span>
<span id="cb107-956"><a href="#cb107-956" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> its_dist){</span>
<span id="cb107-957"><a href="#cb107-957" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-958"><a href="#cb107-958" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-959"><a href="#cb107-959" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-960"><a href="#cb107-960" aria-hidden="true" tabindex="-1"></a>          tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BETA DISPERSION significance test"</span>, d, <span class="st">"distance"</span>)</span>
<span id="cb107-961"><a href="#cb107-961" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(tmp_print, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-962"><a href="#cb107-962" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>)</span>
<span id="cb107-963"><a href="#cb107-963" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-964"><a href="#cb107-964" aria-hidden="true" tabindex="-1"></a>          <span class="fu">print</span>(tmp_get)</span>
<span id="cb107-965"><a href="#cb107-965" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-966"><a href="#cb107-966" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-967"><a href="#cb107-967" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-968"><a href="#cb107-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-969"><a href="#cb107-969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-970"><a href="#cb107-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-971"><a href="#cb107-971" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-972"><a href="#cb107-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-975"><a href="#cb107-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-976"><a href="#cb107-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-977"><a href="#cb107-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-978"><a href="#cb107-978" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its_samp_ps[<span class="dv">3</span>]) {</span>
<span id="cb107-979"><a href="#cb107-979" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cat("\n", "           *****", i, "*****", "\n")</span></span>
<span id="cb107-980"><a href="#cb107-980" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> its_dist){</span>
<span id="cb107-981"><a href="#cb107-981" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-982"><a href="#cb107-982" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-983"><a href="#cb107-983" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-984"><a href="#cb107-984" aria-hidden="true" tabindex="-1"></a>          tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BETA DISPERSION significance test"</span>, d, <span class="st">"distance"</span>)</span>
<span id="cb107-985"><a href="#cb107-985" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(tmp_print, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-986"><a href="#cb107-986" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>)</span>
<span id="cb107-987"><a href="#cb107-987" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-988"><a href="#cb107-988" aria-hidden="true" tabindex="-1"></a>          <span class="fu">print</span>(tmp_get)</span>
<span id="cb107-989"><a href="#cb107-989" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-990"><a href="#cb107-990" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-991"><a href="#cb107-991" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-992"><a href="#cb107-992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-993"><a href="#cb107-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-994"><a href="#cb107-994" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-995"><a href="#cb107-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-998"><a href="#cb107-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-999"><a href="#cb107-999" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1000"><a href="#cb107-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1001"><a href="#cb107-1001" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its_samp_ps[<span class="dv">4</span>]) {</span>
<span id="cb107-1002"><a href="#cb107-1002" aria-hidden="true" tabindex="-1"></a>  <span class="co">#cat("\n", "           *****", i, "*****", "\n")</span></span>
<span id="cb107-1003"><a href="#cb107-1003" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> its_dist){</span>
<span id="cb107-1004"><a href="#cb107-1004" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-1005"><a href="#cb107-1005" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1006"><a href="#cb107-1006" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1007"><a href="#cb107-1007" aria-hidden="true" tabindex="-1"></a>          tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BETA DISPERSION significance test"</span>, d, <span class="st">"distance"</span>)</span>
<span id="cb107-1008"><a href="#cb107-1008" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(tmp_print, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1009"><a href="#cb107-1009" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"####################################################"</span>)</span>
<span id="cb107-1010"><a href="#cb107-1010" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1011"><a href="#cb107-1011" aria-hidden="true" tabindex="-1"></a>          <span class="fu">print</span>(tmp_get)</span>
<span id="cb107-1012"><a href="#cb107-1012" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1013"><a href="#cb107-1013" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-1014"><a href="#cb107-1014" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1015"><a href="#cb107-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1016"><a href="#cb107-1016" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-1017"><a href="#cb107-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1018"><a href="#cb107-1018" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb107-1019"><a href="#cb107-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1020"><a href="#cb107-1020" aria-hidden="true" tabindex="-1"></a>Remember, if the beta dispersion p-value is greater than <span class="in">`0.05`</span> we use PERMANOVA, otherwise we use ANOSIM.</span>
<span id="cb107-1021"><a href="#cb107-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1024"><a href="#cb107-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1025"><a href="#cb107-1025" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1026"><a href="#cb107-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1027"><a href="#cb107-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: markup</span></span>
<span id="cb107-1028"><a href="#cb107-1028" aria-hidden="true" tabindex="-1"></a>its18_perm_pvalues <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb107-1029"><a href="#cb107-1029" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its_samp_ps) {</span>
<span id="cb107-1030"><a href="#cb107-1030" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (d <span class="cf">in</span> its_dist){</span>
<span id="cb107-1031"><a href="#cb107-1031" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_permutest_"</span>, d)))</span>
<span id="cb107-1032"><a href="#cb107-1032" aria-hidden="true" tabindex="-1"></a>          tmp_pv <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]</span>
<span id="cb107-1033"><a href="#cb107-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1034"><a href="#cb107-1034" aria-hidden="true" tabindex="-1"></a>          tmp_test <span class="ot">&lt;-</span> <span class="cf">if</span>(tmp_pv <span class="sc">&lt;</span> <span class="fl">0.05</span>){</span>
<span id="cb107-1035"><a href="#cb107-1035" aria-hidden="true" tabindex="-1"></a>            tmp_test <span class="ot">&lt;-</span> <span class="st">"ANOSIM"</span></span>
<span id="cb107-1036"><a href="#cb107-1036" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb107-1037"><a href="#cb107-1037" aria-hidden="true" tabindex="-1"></a>            tmp_test <span class="ot">&lt;-</span> <span class="st">"ADONIS"</span></span>
<span id="cb107-1038"><a href="#cb107-1038" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb107-1039"><a href="#cb107-1039" aria-hidden="true" tabindex="-1"></a>          tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(i, d, tmp_pv, tmp_test)</span>
<span id="cb107-1040"><a href="#cb107-1040" aria-hidden="true" tabindex="-1"></a>          its18_perm_pvalues <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(its18_perm_pvalues, tmp_df)</span>
<span id="cb107-1041"><a href="#cb107-1041" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1042"><a href="#cb107-1042" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-1043"><a href="#cb107-1043" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1044"><a href="#cb107-1044" aria-hidden="true" tabindex="-1"></a>its18_perm_pvalues <span class="ot">&lt;-</span> its18_perm_pvalues <span class="sc">%&gt;%</span> </span>
<span id="cb107-1045"><a href="#cb107-1045" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"data_set"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"dist"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"pval"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"test"</span> <span class="ot">=</span> <span class="dv">4</span>))</span>
<span id="cb107-1046"><a href="#cb107-1046" aria-hidden="true" tabindex="-1"></a>its18_perm_pvalues <span class="ot">&lt;-</span> its18_perm_pvalues <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb107-1047"><a href="#cb107-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1048"><a href="#cb107-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1049"><a href="#cb107-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1052"><a href="#cb107-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1053"><a href="#cb107-1053" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1054"><a href="#cb107-1054" aria-hidden="true" tabindex="-1"></a>its18_perm_summary <span class="ot">&lt;-</span> its18_perm_pvalues</span>
<span id="cb107-1055"><a href="#cb107-1055" aria-hidden="true" tabindex="-1"></a>its18_perm_summary <span class="ot">&lt;-</span> its18_perm_summary <span class="sc">%&gt;%</span> <span class="fu">separate</span>(<span class="at">col =</span> <span class="dv">1</span>, </span>
<span id="cb107-1056"><a href="#cb107-1056" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"dummy"</span>, <span class="st">"metric"</span>, <span class="st">"dataset"</span>), </span>
<span id="cb107-1057"><a href="#cb107-1057" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-1058"><a href="#cb107-1058" aria-hidden="true" tabindex="-1"></a>its18_perm_summary[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb107-1059"><a href="#cb107-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1060"><a href="#cb107-1060" aria-hidden="true" tabindex="-1"></a>its18_perm_summary<span class="sc">$</span>dataset <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(its18_perm_summary<span class="sc">$</span>dataset, <span class="st">"work"</span>, <span class="st">"FULL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-1061"><a href="#cb107-1061" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"filt"</span>, <span class="st">"FILT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-1062"><a href="#cb107-1062" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"pime"</span>, <span class="st">"PIME"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-1063"><a href="#cb107-1063" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"perfect"</span>, <span class="st">"PERfect"</span>)</span>
<span id="cb107-1064"><a href="#cb107-1064" aria-hidden="true" tabindex="-1"></a>its18_perm_summary<span class="sc">$</span>dist <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(its18_perm_summary<span class="sc">$</span>dist, <span class="st">"jsd"</span>, <span class="st">"Jensen–Shannon divergence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-1065"><a href="#cb107-1065" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"gower"</span>, <span class="st">"Gower distance"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-1066"><a href="#cb107-1066" aria-hidden="true" tabindex="-1"></a>                              stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"bray"</span>, <span class="st">"Bray-Curtis dissimilarity"</span>)</span>
<span id="cb107-1067"><a href="#cb107-1067" aria-hidden="true" tabindex="-1"></a>its18_perm_summary<span class="sc">$</span>pval <span class="ot">&lt;-</span> <span class="fu">round</span>(its18_perm_summary[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb107-1068"><a href="#cb107-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1069"><a href="#cb107-1069" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_beta_disp_tests")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-1070"><a href="#cb107-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1073"><a href="#cb107-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1074"><a href="#cb107-1074" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1075"><a href="#cb107-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1076"><a href="#cb107-1076" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_perm_summary</span>
<span id="cb107-1077"><a href="#cb107-1077" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb107-1078"><a href="#cb107-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb107-1079"><a href="#cb107-1079" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_beta_disp_tests"</span>,</span>
<span id="cb107-1080"><a href="#cb107-1080" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb107-1081"><a href="#cb107-1081" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb107-1082"><a href="#cb107-1082" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb107-1083"><a href="#cb107-1083" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-1084"><a href="#cb107-1084" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-1085"><a href="#cb107-1085" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb107-1086"><a href="#cb107-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1087"><a href="#cb107-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1090"><a href="#cb107-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1091"><a href="#cb107-1091" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1092"><a href="#cb107-1092" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1093"><a href="#cb107-1093" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb107-1094"><a href="#cb107-1094" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb107-1095"><a href="#cb107-1095" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb107-1096"><a href="#cb107-1096" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">4</span>),</span>
<span id="cb107-1097"><a href="#cb107-1097" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-1098"><a href="#cb107-1098" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">headerVAlign =</span> <span class="st">"center"</span></span>
<span id="cb107-1099"><a href="#cb107-1099" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb107-1100"><a href="#cb107-1100" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb107-1101"><a href="#cb107-1101" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Dataset"</span>, </span>
<span id="cb107-1102"><a href="#cb107-1102" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb107-1103"><a href="#cb107-1103" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb107-1104"><a href="#cb107-1104" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb107-1105"><a href="#cb107-1105" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb107-1106"><a href="#cb107-1106" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">50</span>),</span>
<span id="cb107-1107"><a href="#cb107-1107" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"distance"</span>, <span class="at">align =</span> <span class="st">"left"</span>),</span>
<span id="cb107-1108"><a href="#cb107-1108" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">pval</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value"</span>, <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-1109"><a href="#cb107-1109" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb107-1110"><a href="#cb107-1110" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb107-1111"><a href="#cb107-1111" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span></span>
<span id="cb107-1112"><a href="#cb107-1112" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb107-1113"><a href="#cb107-1113" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span></span>
<span id="cb107-1114"><a href="#cb107-1114" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb107-1115"><a href="#cb107-1115" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb107-1116"><a href="#cb107-1116" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb107-1117"><a href="#cb107-1117" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb107-1118"><a href="#cb107-1118" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb107-1119"><a href="#cb107-1119" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb107-1120"><a href="#cb107-1120" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">12</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-1121"><a href="#cb107-1121" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb107-1122"><a href="#cb107-1122" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-1123"><a href="#cb107-1123" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-1124"><a href="#cb107-1124" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">TRUE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-1125"><a href="#cb107-1125" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb107-1126"><a href="#cb107-1126" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb107-1127"><a href="#cb107-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1128"><a href="#cb107-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1129"><a href="#cb107-1129" aria-hidden="true" tabindex="-1"></a>Now we to create sample data frames for each data set. </span>
<span id="cb107-1130"><a href="#cb107-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1133"><a href="#cb107-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1134"><a href="#cb107-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb107-1135"><a href="#cb107-1135" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its_samp_ps) {</span>
<span id="cb107-1136"><a href="#cb107-1136" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_prop"</span>)))</span>
<span id="cb107-1137"><a href="#cb107-1137" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_get))</span>
<span id="cb107-1138"><a href="#cb107-1138" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_sampledf"</span>))</span>
<span id="cb107-1139"><a href="#cb107-1139" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_samp)</span>
<span id="cb107-1140"><a href="#cb107-1140" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1141"><a href="#cb107-1141" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1142"><a href="#cb107-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">"_sampledf"</span>)</span>
<span id="cb107-1143"><a href="#cb107-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1144"><a href="#cb107-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1145"><a href="#cb107-1145" aria-hidden="true" tabindex="-1"></a><span class="fu">## Significance Tests </span></span>
<span id="cb107-1146"><a href="#cb107-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1147"><a href="#cb107-1147" aria-hidden="true" tabindex="-1"></a>Depending on the test, we need different data structures. For <span class="in">`adonis`</span> we use the sample metadata and for <span class="in">`anosim`</span> we will start with a phyloseq object. So for each data set we create two variables: <span class="in">`adonis_sampledf`</span> and <span class="in">`anosim_data`</span></span>
<span id="cb107-1148"><a href="#cb107-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1149"><a href="#cb107-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1150"><a href="#cb107-1150" aria-hidden="true" tabindex="-1"></a>::: {.column-body}</span>
<span id="cb107-1151"><a href="#cb107-1151" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-1152"><a href="#cb107-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1153"><a href="#cb107-1153" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL</span></span>
<span id="cb107-1154"><a href="#cb107-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1157"><a href="#cb107-1157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1158"><a href="#cb107-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1159"><a href="#cb107-1159" aria-hidden="true" tabindex="-1"></a>adonis_sampledf <span class="ot">&lt;-</span> its18_ps_work_sampledf</span>
<span id="cb107-1160"><a href="#cb107-1160" aria-hidden="true" tabindex="-1"></a>anosim_data <span class="ot">&lt;-</span> its18_ps_work</span>
<span id="cb107-1161"><a href="#cb107-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1162"><a href="#cb107-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1165"><a href="#cb107-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1166"><a href="#cb107-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1167"><a href="#cb107-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1168"><a href="#cb107-1168" aria-hidden="true" tabindex="-1"></a>tmp_perm_tests <span class="ot">&lt;-</span> its18_perm_pvalues[its18_perm_pvalues<span class="sc">$</span>data_set <span class="sc">==</span> <span class="st">'its18_ps_work'</span>,]</span>
<span id="cb107-1169"><a href="#cb107-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1170"><a href="#cb107-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1171"><a href="#cb107-1171" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r its18_perm_pvalues$dist[1]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[1] &lt; 0.05))`</span>.  </span>
<span id="cb107-1172"><a href="#cb107-1172" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[1]`**.</span>
<span id="cb107-1173"><a href="#cb107-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1176"><a href="#cb107-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1177"><a href="#cb107-1177" aria-hidden="true" tabindex="-1"></a>its18_ps_work_adonis_jsd <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_work_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-1178"><a href="#cb107-1178" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1179"><a href="#cb107-1179" aria-hidden="true" tabindex="-1"></a>its18_ps_work_adonis2_jsd <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_work_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-1180"><a href="#cb107-1180" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1181"><a href="#cb107-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1182"><a href="#cb107-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1183"><a href="#cb107-1183" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[2]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[2] &lt; 0.05))`</span>.  </span>
<span id="cb107-1184"><a href="#cb107-1184" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[2]`**.</span>
<span id="cb107-1185"><a href="#cb107-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1188"><a href="#cb107-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1189"><a href="#cb107-1189" aria-hidden="true" tabindex="-1"></a>its18_ps_work_adonis_bray <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_work_beta_dist_bray <span class="sc">~</span> TEMP,</span>
<span id="cb107-1190"><a href="#cb107-1190" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1191"><a href="#cb107-1191" aria-hidden="true" tabindex="-1"></a>its18_ps_work_adonis2_bray <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_work_beta_dist_bray <span class="sc">~</span> TEMP,</span>
<span id="cb107-1192"><a href="#cb107-1192" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1193"><a href="#cb107-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1194"><a href="#cb107-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1195"><a href="#cb107-1195" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[3]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[3] &lt; 0.05))`</span>.  </span>
<span id="cb107-1196"><a href="#cb107-1196" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[3]`**.</span>
<span id="cb107-1197"><a href="#cb107-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1200"><a href="#cb107-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1201"><a href="#cb107-1201" aria-hidden="true" tabindex="-1"></a>its18_ps_work_adonis_gower <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_work_beta_dist_gower <span class="sc">~</span> TEMP,</span>
<span id="cb107-1202"><a href="#cb107-1202" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1203"><a href="#cb107-1203" aria-hidden="true" tabindex="-1"></a>its18_ps_work_adonis2_gower <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_work_beta_dist_gower <span class="sc">~</span> TEMP,</span>
<span id="cb107-1204"><a href="#cb107-1204" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1205"><a href="#cb107-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1206"><a href="#cb107-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1207"><a href="#cb107-1207" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary</span></span>
<span id="cb107-1208"><a href="#cb107-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1211"><a href="#cb107-1211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1212"><a href="#cb107-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1213"><a href="#cb107-1213" aria-hidden="true" tabindex="-1"></a>adonis_sampledf <span class="ot">&lt;-</span> its18_ps_filt_sampledf</span>
<span id="cb107-1214"><a href="#cb107-1214" aria-hidden="true" tabindex="-1"></a>anosim_data <span class="ot">&lt;-</span> its18_ps_filt</span>
<span id="cb107-1215"><a href="#cb107-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1216"><a href="#cb107-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1219"><a href="#cb107-1219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1220"><a href="#cb107-1220" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1221"><a href="#cb107-1221" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1222"><a href="#cb107-1222" aria-hidden="true" tabindex="-1"></a>tmp_perm_tests <span class="ot">&lt;-</span> its18_perm_pvalues[its18_perm_pvalues<span class="sc">$</span>data_set <span class="sc">==</span> <span class="st">'its18_ps_filt'</span>,]</span>
<span id="cb107-1223"><a href="#cb107-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1224"><a href="#cb107-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1225"><a href="#cb107-1225" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r its18_perm_pvalues$dist[1]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[1] &lt; 0.05))`</span>.  </span>
<span id="cb107-1226"><a href="#cb107-1226" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[1]`**.</span>
<span id="cb107-1227"><a href="#cb107-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1230"><a href="#cb107-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1231"><a href="#cb107-1231" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_adonis_jsd <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_filt_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-1232"><a href="#cb107-1232" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1233"><a href="#cb107-1233" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_adonis2_jsd <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_filt_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-1234"><a href="#cb107-1234" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1235"><a href="#cb107-1235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1236"><a href="#cb107-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1237"><a href="#cb107-1237" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[2]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[2] &lt; 0.05))`</span>.  </span>
<span id="cb107-1238"><a href="#cb107-1238" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[2]`**.</span>
<span id="cb107-1239"><a href="#cb107-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1242"><a href="#cb107-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1243"><a href="#cb107-1243" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_adonis_bray <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_filt_beta_dist_bray <span class="sc">~</span> TEMP,</span>
<span id="cb107-1244"><a href="#cb107-1244" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1245"><a href="#cb107-1245" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_adonis2_bray <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_filt_beta_dist_bray <span class="sc">~</span> TEMP,</span>
<span id="cb107-1246"><a href="#cb107-1246" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1247"><a href="#cb107-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1248"><a href="#cb107-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1249"><a href="#cb107-1249" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[3]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[3] &lt; 0.05))`</span>.  </span>
<span id="cb107-1250"><a href="#cb107-1250" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[3]`**.</span>
<span id="cb107-1251"><a href="#cb107-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1254"><a href="#cb107-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1255"><a href="#cb107-1255" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_adonis_gower <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_filt_beta_dist_gower <span class="sc">~</span> TEMP,</span>
<span id="cb107-1256"><a href="#cb107-1256" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1257"><a href="#cb107-1257" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_adonis2_gower <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_filt_beta_dist_gower <span class="sc">~</span> TEMP,</span>
<span id="cb107-1258"><a href="#cb107-1258" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1259"><a href="#cb107-1259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1260"><a href="#cb107-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1261"><a href="#cb107-1261" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-1262"><a href="#cb107-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1265"><a href="#cb107-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1266"><a href="#cb107-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1267"><a href="#cb107-1267" aria-hidden="true" tabindex="-1"></a>adonis_sampledf <span class="ot">&lt;-</span> its18_ps_perfect_sampledf</span>
<span id="cb107-1268"><a href="#cb107-1268" aria-hidden="true" tabindex="-1"></a>anosim_data <span class="ot">&lt;-</span> its18_ps_perfect</span>
<span id="cb107-1269"><a href="#cb107-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1270"><a href="#cb107-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1273"><a href="#cb107-1273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1274"><a href="#cb107-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1275"><a href="#cb107-1275" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1276"><a href="#cb107-1276" aria-hidden="true" tabindex="-1"></a>tmp_perm_tests <span class="ot">&lt;-</span> its18_perm_pvalues[its18_perm_pvalues<span class="sc">$</span>data_set <span class="sc">==</span> <span class="st">'its18_ps_perfect'</span>,]</span>
<span id="cb107-1277"><a href="#cb107-1277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1278"><a href="#cb107-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1279"><a href="#cb107-1279" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r its18_perm_pvalues$dist[1]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[1] &lt; 0.05))`</span>.  </span>
<span id="cb107-1280"><a href="#cb107-1280" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[1]`**.</span>
<span id="cb107-1281"><a href="#cb107-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1284"><a href="#cb107-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1285"><a href="#cb107-1285" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_adonis_jsd <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_perfect_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-1286"><a href="#cb107-1286" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1287"><a href="#cb107-1287" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_adonis2_jsd <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_perfect_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-1288"><a href="#cb107-1288" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1289"><a href="#cb107-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1290"><a href="#cb107-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1291"><a href="#cb107-1291" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[2]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[2] &lt; 0.05))`</span>.  </span>
<span id="cb107-1292"><a href="#cb107-1292" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[2]`**.</span>
<span id="cb107-1293"><a href="#cb107-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1296"><a href="#cb107-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1297"><a href="#cb107-1297" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_adonis_bray <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_perfect_beta_dist_bray <span class="sc">~</span> TEMP,</span>
<span id="cb107-1298"><a href="#cb107-1298" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1299"><a href="#cb107-1299" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_adonis2_bray <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_perfect_beta_dist_bray <span class="sc">~</span> TEMP,</span>
<span id="cb107-1300"><a href="#cb107-1300" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1301"><a href="#cb107-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1302"><a href="#cb107-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1303"><a href="#cb107-1303" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[3]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[3] &lt; 0.05))`</span>.  </span>
<span id="cb107-1304"><a href="#cb107-1304" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[3]`**.</span>
<span id="cb107-1305"><a href="#cb107-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1308"><a href="#cb107-1308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1309"><a href="#cb107-1309" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_adonis_gower <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_perfect_beta_dist_gower <span class="sc">~</span> TEMP,</span>
<span id="cb107-1310"><a href="#cb107-1310" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1311"><a href="#cb107-1311" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_adonis2_gower <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_perfect_beta_dist_gower <span class="sc">~</span> TEMP,</span>
<span id="cb107-1312"><a href="#cb107-1312" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1313"><a href="#cb107-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1314"><a href="#cb107-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1315"><a href="#cb107-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-1316"><a href="#cb107-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1319"><a href="#cb107-1319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1320"><a href="#cb107-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1321"><a href="#cb107-1321" aria-hidden="true" tabindex="-1"></a>adonis_sampledf <span class="ot">&lt;-</span> its18_ps_pime_sampledf</span>
<span id="cb107-1322"><a href="#cb107-1322" aria-hidden="true" tabindex="-1"></a>anosim_data <span class="ot">&lt;-</span> its18_ps_pime</span>
<span id="cb107-1323"><a href="#cb107-1323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1324"><a href="#cb107-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1327"><a href="#cb107-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1328"><a href="#cb107-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1329"><a href="#cb107-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1330"><a href="#cb107-1330" aria-hidden="true" tabindex="-1"></a>tmp_perm_tests <span class="ot">&lt;-</span> its18_perm_pvalues[its18_perm_pvalues<span class="sc">$</span>data_set <span class="sc">==</span> <span class="st">'its18_ps_pime'</span>,]</span>
<span id="cb107-1331"><a href="#cb107-1331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1332"><a href="#cb107-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1333"><a href="#cb107-1333" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r its18_perm_pvalues$dist[1]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[1] &lt; 0.05))`</span>.  </span>
<span id="cb107-1334"><a href="#cb107-1334" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[1]`**.</span>
<span id="cb107-1335"><a href="#cb107-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1338"><a href="#cb107-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1339"><a href="#cb107-1339" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_adonis_jsd <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_pime_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-1340"><a href="#cb107-1340" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1341"><a href="#cb107-1341" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_adonis2_jsd <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_pime_beta_dist_jsd <span class="sc">~</span> TEMP,</span>
<span id="cb107-1342"><a href="#cb107-1342" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1343"><a href="#cb107-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1344"><a href="#cb107-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1345"><a href="#cb107-1345" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[2]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[2] &lt; 0.05))`</span>.  </span>
<span id="cb107-1346"><a href="#cb107-1346" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[2]`**.</span>
<span id="cb107-1347"><a href="#cb107-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1350"><a href="#cb107-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1351"><a href="#cb107-1351" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_adonis_bray <span class="ot">&lt;-</span>  <span class="fu">adonis</span>(its18_ps_pime_beta_dist_bray <span class="sc">~</span> TEMP,</span>
<span id="cb107-1352"><a href="#cb107-1352" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1353"><a href="#cb107-1353" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_adonis2_bray <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(its18_ps_pime_beta_dist_bray <span class="sc">~</span> TEMP,</span>
<span id="cb107-1354"><a href="#cb107-1354" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> adonis_sampledf, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb107-1355"><a href="#cb107-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1356"><a href="#cb107-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1357"><a href="#cb107-1357" aria-hidden="true" tabindex="-1"></a>Is the p-value of the <span class="in">`r tmp_perm_tests$dist[3]`</span> distance metric less than <span class="in">`0.05`</span>?  <span class="in">`r eval(isTRUE(tmp_perm_tests$pval[3] &lt; 0.05))`</span>.  </span>
<span id="cb107-1358"><a href="#cb107-1358" aria-hidden="true" tabindex="-1"></a>Then we use **`r tmp_perm_tests$test[3]`**.</span>
<span id="cb107-1359"><a href="#cb107-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1362"><a href="#cb107-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1363"><a href="#cb107-1363" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_groups <span class="ot">&lt;-</span> <span class="fu">get_variable</span>(anosim_data, <span class="st">"TEMP"</span>)</span>
<span id="cb107-1364"><a href="#cb107-1364" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_anosim_gower <span class="ot">&lt;-</span></span>
<span id="cb107-1365"><a href="#cb107-1365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anosim</span>(phyloseq<span class="sc">::</span><span class="fu">distance</span>(its18_ps_pime_prop, <span class="st">"gower"</span>),</span>
<span id="cb107-1366"><a href="#cb107-1366" aria-hidden="true" tabindex="-1"></a>         <span class="at">grouping =</span> its18_ps_pime_groups)</span>
<span id="cb107-1367"><a href="#cb107-1367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1368"><a href="#cb107-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1369"><a href="#cb107-1369" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-1370"><a href="#cb107-1370" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-1371"><a href="#cb107-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1372"><a href="#cb107-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1373"><a href="#cb107-1373" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb107-1374"><a href="#cb107-1374" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;&lt;strong&gt;</span>Detailed results<span class="kw">&lt;/strong&gt;</span> of Significance tests.<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb107-1375"><a href="#cb107-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1376"><a href="#cb107-1376" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-1377"><a href="#cb107-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1378"><a href="#cb107-1378" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL</span></span>
<span id="cb107-1379"><a href="#cb107-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1382"><a href="#cb107-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1383"><a href="#cb107-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1384"><a href="#cb107-1384" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1385"><a href="#cb107-1385" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Jensen-Shannon Divergence, `jsd`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1386"><a href="#cb107-1386" aria-hidden="true" tabindex="-1"></a>its18_ps_work_adonis2_jsd</span>
<span id="cb107-1387"><a href="#cb107-1387" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1388"><a href="#cb107-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1389"><a href="#cb107-1389" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Bray-Curtis dissimilarity, `bray`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1390"><a href="#cb107-1390" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(its18_ps_work_adonis2_bray)</span>
<span id="cb107-1391"><a href="#cb107-1391" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1392"><a href="#cb107-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1393"><a href="#cb107-1393" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Gower distance, `gower`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1394"><a href="#cb107-1394" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(its18_ps_work_adonis2_gower)</span>
<span id="cb107-1395"><a href="#cb107-1395" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1396"><a href="#cb107-1396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1397"><a href="#cb107-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1398"><a href="#cb107-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1399"><a href="#cb107-1399" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary</span></span>
<span id="cb107-1400"><a href="#cb107-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1403"><a href="#cb107-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1404"><a href="#cb107-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1405"><a href="#cb107-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1406"><a href="#cb107-1406" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Jensen-Shannon Divergence, `jsd`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1407"><a href="#cb107-1407" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_adonis2_jsd</span>
<span id="cb107-1408"><a href="#cb107-1408" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1409"><a href="#cb107-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1410"><a href="#cb107-1410" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Bray-Curtis dissimilarity, `bray`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1411"><a href="#cb107-1411" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(its18_ps_filt_adonis2_bray)</span>
<span id="cb107-1412"><a href="#cb107-1412" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1413"><a href="#cb107-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1414"><a href="#cb107-1414" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Gower distance, `gower`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1415"><a href="#cb107-1415" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(its18_ps_filt_adonis2_gower)</span>
<span id="cb107-1416"><a href="#cb107-1416" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1417"><a href="#cb107-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1418"><a href="#cb107-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1419"><a href="#cb107-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1420"><a href="#cb107-1420" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-1421"><a href="#cb107-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1424"><a href="#cb107-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1425"><a href="#cb107-1425" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1426"><a href="#cb107-1426" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1427"><a href="#cb107-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Jensen-Shannon Divergence, `jsd`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1428"><a href="#cb107-1428" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_adonis2_jsd</span>
<span id="cb107-1429"><a href="#cb107-1429" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1430"><a href="#cb107-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1431"><a href="#cb107-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Bray-Curtis dissimilarity, `bray`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1432"><a href="#cb107-1432" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(its18_ps_perfect_adonis2_bray)</span>
<span id="cb107-1433"><a href="#cb107-1433" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1434"><a href="#cb107-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1435"><a href="#cb107-1435" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Gower distance, `gower`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1436"><a href="#cb107-1436" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(its18_ps_perfect_adonis2_gower)</span>
<span id="cb107-1437"><a href="#cb107-1437" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1438"><a href="#cb107-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1439"><a href="#cb107-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1440"><a href="#cb107-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1441"><a href="#cb107-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-1442"><a href="#cb107-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1445"><a href="#cb107-1445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1446"><a href="#cb107-1446" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1447"><a href="#cb107-1447" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1448"><a href="#cb107-1448" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Jensen-Shannon Divergence, `jsd`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1449"><a href="#cb107-1449" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_adonis2_jsd</span>
<span id="cb107-1450"><a href="#cb107-1450" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1451"><a href="#cb107-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1452"><a href="#cb107-1452" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***PERMANOVA for Bray-Curtis dissimilarity, `bray`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1453"><a href="#cb107-1453" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_adonis2_bray</span>
<span id="cb107-1454"><a href="#cb107-1454" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1455"><a href="#cb107-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1456"><a href="#cb107-1456" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"***ANOSIM for Gower distance, `gower`***"</span>, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb107-1457"><a href="#cb107-1457" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(its18_ps_pime_anosim_gower)</span>
<span id="cb107-1458"><a href="#cb107-1458" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-1459"><a href="#cb107-1459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1460"><a href="#cb107-1460" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-1461"><a href="#cb107-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1462"><a href="#cb107-1462" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb107-1463"><a href="#cb107-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1464"><a href="#cb107-1464" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summaries </span></span>
<span id="cb107-1465"><a href="#cb107-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1466"><a href="#cb107-1466" aria-hidden="true" tabindex="-1"></a>Here is a quick summary of significance tests for the data sets against three distance matrices.</span>
<span id="cb107-1467"><a href="#cb107-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1470"><a href="#cb107-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1471"><a href="#cb107-1471" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1472"><a href="#cb107-1472" aria-hidden="true" tabindex="-1"></a>data_set <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"FULL"</span>, <span class="st">"FILT"</span>, <span class="st">"PERfect"</span>, <span class="st">"PIME"</span>))</span>
<span id="cb107-1473"><a href="#cb107-1473" aria-hidden="true" tabindex="-1"></a>its_dist_metric <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"Jensen-Shannon Divergence"</span>, <span class="st">"Bray-Curtis dissimilarity"</span>, <span class="st">"Gower distance"</span>))</span>
<span id="cb107-1474"><a href="#cb107-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1475"><a href="#cb107-1475" aria-hidden="true" tabindex="-1"></a>tmp_p_value_work <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(its18_ps_work_adonis_jsd<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-1476"><a href="#cb107-1476" aria-hidden="true" tabindex="-1"></a>                                 its18_ps_work_adonis_bray<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-1477"><a href="#cb107-1477" aria-hidden="true" tabindex="-1"></a>                                 its18_ps_work_adonis_gower<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]))</span>
<span id="cb107-1478"><a href="#cb107-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1479"><a href="#cb107-1479" aria-hidden="true" tabindex="-1"></a>tmp_p_value_filt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(its18_ps_filt_adonis_jsd<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-1480"><a href="#cb107-1480" aria-hidden="true" tabindex="-1"></a>                                 its18_ps_filt_adonis_bray<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-1481"><a href="#cb107-1481" aria-hidden="true" tabindex="-1"></a>                                 its18_ps_filt_adonis_gower<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]))</span>
<span id="cb107-1482"><a href="#cb107-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1483"><a href="#cb107-1483" aria-hidden="true" tabindex="-1"></a>tmp_p_value_perfect <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(its18_ps_perfect_adonis_jsd<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-1484"><a href="#cb107-1484" aria-hidden="true" tabindex="-1"></a>                                 its18_ps_perfect_adonis_bray<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-1485"><a href="#cb107-1485" aria-hidden="true" tabindex="-1"></a>                                 its18_ps_perfect_adonis_gower<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>]))</span>
<span id="cb107-1486"><a href="#cb107-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1487"><a href="#cb107-1487" aria-hidden="true" tabindex="-1"></a>tmp_p_value_pime <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(its18_ps_pime_adonis_jsd<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-1488"><a href="#cb107-1488" aria-hidden="true" tabindex="-1"></a>                                 its18_ps_pime_adonis_bray<span class="sc">$</span>aov.tab<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>],</span>
<span id="cb107-1489"><a href="#cb107-1489" aria-hidden="true" tabindex="-1"></a>                                 its18_ps_pime_anosim_gower<span class="sc">$</span>signif))</span>
<span id="cb107-1490"><a href="#cb107-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1491"><a href="#cb107-1491" aria-hidden="true" tabindex="-1"></a>its18_tab_sig_test <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(its_dist_metric, tmp_p_value_work) <span class="sc">%&gt;%</span></span>
<span id="cb107-1492"><a href="#cb107-1492" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_p_value_filt) <span class="sc">%&gt;%</span></span>
<span id="cb107-1493"><a href="#cb107-1493" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_p_value_perfect) <span class="sc">%&gt;%</span></span>
<span id="cb107-1494"><a href="#cb107-1494" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_p_value_pime)  <span class="sc">%&gt;%</span></span>
<span id="cb107-1495"><a href="#cb107-1495" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"distance metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"FULL"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"FILT"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"PERfect"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"PIME"</span> <span class="ot">=</span> <span class="dv">5</span>) </span>
<span id="cb107-1496"><a href="#cb107-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1497"><a href="#cb107-1497" aria-hidden="true" tabindex="-1"></a>its18_tab_sig_test <span class="ot">&lt;-</span> its18_tab_sig_test <span class="sc">%&gt;%</span>  </span>
<span id="cb107-1498"><a href="#cb107-1498" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(its18_tab_sig_test)), round, <span class="at">digits =</span> <span class="dv">4</span>))</span>
<span id="cb107-1499"><a href="#cb107-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1500"><a href="#cb107-1500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1501"><a href="#cb107-1501" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_sign_tests")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-1502"><a href="#cb107-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1505"><a href="#cb107-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1506"><a href="#cb107-1506" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1507"><a href="#cb107-1507" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1508"><a href="#cb107-1508" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_tab_sig_test</span>
<span id="cb107-1509"><a href="#cb107-1509" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb107-1510"><a href="#cb107-1510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb107-1511"><a href="#cb107-1511" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_sign_tests"</span>,</span>
<span id="cb107-1512"><a href="#cb107-1512" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb107-1513"><a href="#cb107-1513" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb107-1514"><a href="#cb107-1514" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb107-1515"><a href="#cb107-1515" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-1516"><a href="#cb107-1516" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-1517"><a href="#cb107-1517" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb107-1518"><a href="#cb107-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1519"><a href="#cb107-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1522"><a href="#cb107-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1523"><a href="#cb107-1523" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1524"><a href="#cb107-1524" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1525"><a href="#cb107-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb107-1526"><a href="#cb107-1526" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb107-1527"><a href="#cb107-1527" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb107-1528"><a href="#cb107-1528" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">3</span>),</span>
<span id="cb107-1529"><a href="#cb107-1529" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">FALSE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-1530"><a href="#cb107-1530" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">headerVAlign =</span> <span class="st">"center"</span>,</span>
<span id="cb107-1531"><a href="#cb107-1531" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb107-1532"><a href="#cb107-1532" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb107-1533"><a href="#cb107-1533" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span></span>
<span id="cb107-1534"><a href="#cb107-1534" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb107-1535"><a href="#cb107-1535" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span></span>
<span id="cb107-1536"><a href="#cb107-1536" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb107-1537"><a href="#cb107-1537" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb107-1538"><a href="#cb107-1538" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb107-1539"><a href="#cb107-1539" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb107-1540"><a href="#cb107-1540" aria-hidden="true" tabindex="-1"></a>                            }</span>
<span id="cb107-1541"><a href="#cb107-1541" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb107-1542"><a href="#cb107-1542" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb107-1543"><a href="#cb107-1543" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">distance metric</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Distance metric"</span>, </span>
<span id="cb107-1544"><a href="#cb107-1544" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb107-1545"><a href="#cb107-1545" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb107-1546"><a href="#cb107-1546" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb107-1547"><a href="#cb107-1547" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb107-1548"><a href="#cb107-1548" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>),</span>
<span id="cb107-1549"><a href="#cb107-1549" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"distance"</span>, <span class="at">align =</span> <span class="st">"left"</span>)</span>
<span id="cb107-1550"><a href="#cb107-1550" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb107-1551"><a href="#cb107-1551" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(<span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"p-values"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"FULL"</span>, <span class="st">"FILT"</span>, <span class="st">"PERfect"</span>, <span class="st">"PIME"</span>),</span>
<span id="cb107-1552"><a href="#cb107-1552" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"1.3em"</span>))</span>
<span id="cb107-1553"><a href="#cb107-1553" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb107-1554"><a href="#cb107-1554" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">12</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb107-1555"><a href="#cb107-1555" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb107-1556"><a href="#cb107-1556" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">FALSE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-1557"><a href="#cb107-1557" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-1558"><a href="#cb107-1558" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">TRUE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-1559"><a href="#cb107-1559" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.9em"</span>)))</span>
<span id="cb107-1560"><a href="#cb107-1560" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb107-1561"><a href="#cb107-1561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1562"><a href="#cb107-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1563"><a href="#cb107-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1566"><a href="#cb107-1566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1567"><a href="#cb107-1567" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1568"><a href="#cb107-1568" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"page_build/beta_wf_part_1.rdata"</span>)</span>
<span id="cb107-1569"><a href="#cb107-1569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1570"><a href="#cb107-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1571"><a href="#cb107-1571" aria-hidden="true" tabindex="-1"></a><span class="fu"># Ordinations</span></span>
<span id="cb107-1572"><a href="#cb107-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1575"><a href="#cb107-1575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1576"><a href="#cb107-1576" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1577"><a href="#cb107-1577" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1578"><a href="#cb107-1578" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"page_build/beta_wf_part_2.rdata"</span>)</span>
<span id="cb107-1579"><a href="#cb107-1579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1580"><a href="#cb107-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1583"><a href="#cb107-1583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1584"><a href="#cb107-1584" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1585"><a href="#cb107-1585" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb107-1586"><a href="#cb107-1586" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"page_build/beta_wf_part_1.rdata"</span>)</span>
<span id="cb107-1587"><a href="#cb107-1587" aria-hidden="true" tabindex="-1"></a>gdata<span class="sc">::</span><span class="fu">keep</span>(ssu18_ps_work, ssu18_ps_filt, ssu18_ps_pime, ssu18_ps_perfect, </span>
<span id="cb107-1588"><a href="#cb107-1588" aria-hidden="true" tabindex="-1"></a>            ssu18_ps_work_prop, ssu18_ps_filt_prop, ssu18_ps_pime_prop, ssu18_ps_perfect_prop, </span>
<span id="cb107-1589"><a href="#cb107-1589" aria-hidden="true" tabindex="-1"></a>            its18_ps_work, its18_ps_filt, its18_ps_pime, its18_ps_perfect, </span>
<span id="cb107-1590"><a href="#cb107-1590" aria-hidden="true" tabindex="-1"></a>            its18_ps_work_prop, its18_ps_filt_prop, its18_ps_pime_prop, its18_ps_perfect_prop, </span>
<span id="cb107-1591"><a href="#cb107-1591" aria-hidden="true" tabindex="-1"></a>            swel_col, <span class="at">sure =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-1592"><a href="#cb107-1592" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_me <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/taxa/rdata/ssu18_ps_work_me.rds"</span>)</span>
<span id="cb107-1593"><a href="#cb107-1593" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_me <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/taxa/rdata/ssu18_ps_filt_me.rds"</span>)</span>
<span id="cb107-1594"><a href="#cb107-1594" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_me <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/taxa/rdata/ssu18_ps_perfect_me.rds"</span>)</span>
<span id="cb107-1595"><a href="#cb107-1595" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_me <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/taxa/rdata/ssu18_ps_pime_me.rds"</span>)</span>
<span id="cb107-1596"><a href="#cb107-1596" aria-hidden="true" tabindex="-1"></a>its18_ps_work_me <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/taxa/rdata/its18_ps_work_me.rds"</span>)</span>
<span id="cb107-1597"><a href="#cb107-1597" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_me <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/taxa/rdata/its18_ps_filt_me.rds"</span>)</span>
<span id="cb107-1598"><a href="#cb107-1598" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_me <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/taxa/rdata/its18_ps_perfect_me.rds"</span>)</span>
<span id="cb107-1599"><a href="#cb107-1599" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_me <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/taxa/rdata/its18_ps_pime_me.rds"</span>)</span>
<span id="cb107-1600"><a href="#cb107-1600" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb107-1601"><a href="#cb107-1601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1602"><a href="#cb107-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1603"><a href="#cb107-1603" aria-hidden="true" tabindex="-1"></a>Now we can visualize the **Jensen-Shannon Divergence**, **unweighted-UniFrac**,  and **weighted-UniFrac** distance matrices to access dissimilarity among sample. Here we ordinate using Principal Coordinate Analysis (PCoA) but we could also test other methods like NMDS, CCA, etc. We will also test the whether there are any differences in ordination between the <span class="in">`phyloseq`</span> package and the <span class="co">[</span><span class="ot">`microeco` package</span><span class="co">](https://github.com/ChiLiubio/microeco)</span>.</span>
<span id="cb107-1604"><a href="#cb107-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1605"><a href="#cb107-1605" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot Code</span></span>
<span id="cb107-1606"><a href="#cb107-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1607"><a href="#cb107-1607" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb107-1608"><a href="#cb107-1608" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;&lt;strong&gt;</span>Code to reproduce plots<span class="kw">&lt;/strong&gt;&lt;/summary&gt;</span></span>
<span id="cb107-1609"><a href="#cb107-1609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1610"><a href="#cb107-1610" aria-hidden="true" tabindex="-1"></a>**We begin with the code for the 16S rRNA data.**</span>
<span id="cb107-1611"><a href="#cb107-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1612"><a href="#cb107-1612" aria-hidden="true" tabindex="-1"></a>First the code for ordination implementation in <span class="in">`phyloseq`</span>. </span>
<span id="cb107-1613"><a href="#cb107-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1616"><a href="#cb107-1616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1617"><a href="#cb107-1617" aria-hidden="true" tabindex="-1"></a>ssu18_data_sets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb107-1618"><a href="#cb107-1618" aria-hidden="true" tabindex="-1"></a>ssu_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"jsd"</span>, <span class="st">"unifrac"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb107-1619"><a href="#cb107-1619" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (samp_ps <span class="cf">in</span> ssu18_data_sets) {</span>
<span id="cb107-1620"><a href="#cb107-1620" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> ssu_dist){</span>
<span id="cb107-1621"><a href="#cb107-1621" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_prop"</span>)))</span>
<span id="cb107-1622"><a href="#cb107-1622" aria-hidden="true" tabindex="-1"></a>     ord_meths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"NMDS"</span>, <span class="st">"PCoA"</span>, <span class="st">"CCA"</span>, <span class="st">"DCA"</span>) <span class="co"># MDS = PCoA, "CCA", "DCA", "DPCoA", "RDA"</span></span>
<span id="cb107-1623"><a href="#cb107-1623" aria-hidden="true" tabindex="-1"></a>     tmp_plist <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">llply</span>(<span class="fu">as.list</span>(ord_meths), <span class="cf">function</span>(i, physeq, d) {</span>
<span id="cb107-1624"><a href="#cb107-1624" aria-hidden="true" tabindex="-1"></a>        ordi <span class="ot">=</span> <span class="fu">ordinate</span>(physeq, <span class="at">method =</span> i, <span class="at">distance =</span> d)</span>
<span id="cb107-1625"><a href="#cb107-1625" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot_ordination</span>(physeq, ordi, <span class="st">"samples"</span>, <span class="at">color =</span> <span class="st">"TEMP"</span>)</span>
<span id="cb107-1626"><a href="#cb107-1626" aria-hidden="true" tabindex="-1"></a>   }, tmp_get, d)</span>
<span id="cb107-1627"><a href="#cb107-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1628"><a href="#cb107-1628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(tmp_plist) <span class="ot">&lt;-</span> ord_meths</span>
<span id="cb107-1629"><a href="#cb107-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1630"><a href="#cb107-1630" aria-hidden="true" tabindex="-1"></a>  tmp_df <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">ldply</span>(tmp_plist, <span class="cf">function</span>(x){</span>
<span id="cb107-1631"><a href="#cb107-1631" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">=</span> x<span class="sc">$</span>data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb107-1632"><a href="#cb107-1632" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(df) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Axis_1"</span>, <span class="st">"Axis_2"</span>)</span>
<span id="cb107-1633"><a href="#cb107-1633" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">cbind</span>(df, x<span class="sc">$</span>data))})</span>
<span id="cb107-1634"><a href="#cb107-1634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(tmp_df)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">"method"</span></span>
<span id="cb107-1635"><a href="#cb107-1635" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-1636"><a href="#cb107-1636" aria-hidden="true" tabindex="-1"></a>  tmp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tmp_df, <span class="fu">aes</span>(Axis_1, Axis_2, <span class="at">color =</span> TEMP, <span class="at">shape =</span> TEMP, <span class="at">fill =</span> TEMP))</span>
<span id="cb107-1637"><a href="#cb107-1637" aria-hidden="true" tabindex="-1"></a>  tmp_plot <span class="ot">&lt;-</span> tmp_plot <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb107-1638"><a href="#cb107-1638" aria-hidden="true" tabindex="-1"></a>  tmp_plot <span class="ot">&lt;-</span> tmp_plot <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb107-1639"><a href="#cb107-1639" aria-hidden="true" tabindex="-1"></a>  tmp_plot <span class="ot">&lt;-</span> tmp_plot <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span>
<span id="cb107-1640"><a href="#cb107-1640" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-1641"><a href="#cb107-1641" aria-hidden="true" tabindex="-1"></a>  tmp_df_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(samp_ps, <span class="st">"_dist_"</span>, .))</span>
<span id="cb107-1642"><a href="#cb107-1642" aria-hidden="true" tabindex="-1"></a>  tmp_plist_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(samp_ps, <span class="st">"_"</span>, ., <span class="st">"_plist"</span>))</span>
<span id="cb107-1643"><a href="#cb107-1643" aria-hidden="true" tabindex="-1"></a>  tmp_plot_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(samp_ps, <span class="st">"_dist_"</span>, ., <span class="st">"_plot"</span>))</span>
<span id="cb107-1644"><a href="#cb107-1644" aria-hidden="true" tabindex="-1"></a>  tmp_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"tmp_df_name"</span> <span class="ot">=</span> tmp_df, <span class="at">tmp_plist_name =</span> tmp_plist, <span class="at">tmp_plot_name =</span> tmp_plot)</span>
<span id="cb107-1645"><a href="#cb107-1645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(samp_ps, <span class="st">"_"</span>,  d, <span class="st">"_ord_results"</span>), tmp_list)</span>
<span id="cb107-1646"><a href="#cb107-1646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"_tmp"</span>))</span>
<span id="cb107-1647"><a href="#cb107-1647" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb107-1648"><a href="#cb107-1648" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1649"><a href="#cb107-1649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1650"><a href="#cb107-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1653"><a href="#cb107-1653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1654"><a href="#cb107-1654" aria-hidden="true" tabindex="-1"></a>plist_name <span class="ot">&lt;-</span> <span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">"_ord_results"</span>)</span>
<span id="cb107-1655"><a href="#cb107-1655" aria-hidden="true" tabindex="-1"></a>plot_num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb107-1656"><a href="#cb107-1656" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> plist_name) {</span>
<span id="cb107-1657"><a href="#cb107-1657" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> plot_num) {</span>
<span id="cb107-1658"><a href="#cb107-1658" aria-hidden="true" tabindex="-1"></a>       tmp_get_i <span class="ot">&lt;-</span> <span class="fu">get</span>(i)<span class="sc">$</span>tmp_plist_name</span>
<span id="cb107-1659"><a href="#cb107-1659" aria-hidden="true" tabindex="-1"></a>       tmp_ord <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp_get_i)[j]</span>
<span id="cb107-1660"><a href="#cb107-1660" aria-hidden="true" tabindex="-1"></a>       tmp_name <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(i, <span class="st">"ord_results"</span>, tmp_ord)</span>
<span id="cb107-1661"><a href="#cb107-1661" aria-hidden="true" tabindex="-1"></a>       tmp_plot <span class="ot">&lt;-</span> tmp_get_i[[j]] <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span>
<span id="cb107-1662"><a href="#cb107-1662" aria-hidden="true" tabindex="-1"></a>       tmp_plot <span class="ot">&lt;-</span> tmp_plot <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb107-1663"><a href="#cb107-1663" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb107-1664"><a href="#cb107-1664" aria-hidden="true" tabindex="-1"></a>       tmp_plot<span class="sc">$</span>labels<span class="sc">$</span>shape <span class="ot">&lt;-</span> <span class="st">"TEMP"</span></span>
<span id="cb107-1665"><a href="#cb107-1665" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_name, tmp_plot)</span>
<span id="cb107-1666"><a href="#cb107-1666" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1667"><a href="#cb107-1667" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-1668"><a href="#cb107-1668" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1669"><a href="#cb107-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1670"><a href="#cb107-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1671"><a href="#cb107-1671" aria-hidden="true" tabindex="-1"></a>And now the code for ordination implementation in <span class="in">`microeco`</span>. </span>
<span id="cb107-1672"><a href="#cb107-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1675"><a href="#cb107-1675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1676"><a href="#cb107-1676" aria-hidden="true" tabindex="-1"></a>microeco_path <span class="ot">&lt;-</span> <span class="st">"files/beta/microeco/"</span></span>
<span id="cb107-1677"><a href="#cb107-1677" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_data_sets) {</span>
<span id="cb107-1678"><a href="#cb107-1678" aria-hidden="true" tabindex="-1"></a>  tmp_dataset <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span><span class="fu">paste0</span>(., <span class="st">"_me"</span>)))</span>
<span id="cb107-1679"><a href="#cb107-1679" aria-hidden="true" tabindex="-1"></a>  tmp_dataset<span class="sc">$</span><span class="fu">cal_betadiv</span>(<span class="at">unifrac =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-1680"><a href="#cb107-1680" aria-hidden="true" tabindex="-1"></a><span class="do">#### CODE TO ADD JSD DISTANCE ####  </span></span>
<span id="cb107-1681"><a href="#cb107-1681" aria-hidden="true" tabindex="-1"></a>  tmp_jsd <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">distance</span>(<span class="fu">get</span>(i), <span class="at">method =</span> <span class="st">"jsd"</span>) </span>
<span id="cb107-1682"><a href="#cb107-1682" aria-hidden="true" tabindex="-1"></a>  tmp_jsd <span class="ot">&lt;-</span> <span class="fu">forceSymmetric</span>(<span class="fu">as.matrix</span>(tmp_jsd), <span class="at">uplo =</span> <span class="st">"L"</span>)</span>
<span id="cb107-1683"><a href="#cb107-1683" aria-hidden="true" tabindex="-1"></a>  tmp_jsd <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_jsd)</span>
<span id="cb107-1684"><a href="#cb107-1684" aria-hidden="true" tabindex="-1"></a>  tmp_dataset<span class="sc">$</span>beta_diversity<span class="sc">$</span>jsd <span class="ot">&lt;-</span> tmp_jsd</span>
<span id="cb107-1685"><a href="#cb107-1685" aria-hidden="true" tabindex="-1"></a><span class="do">#### #### #### #### #### #### #### ####  </span></span>
<span id="cb107-1686"><a href="#cb107-1686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(microeco_path, i, <span class="st">"/metrics/"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-1687"><a href="#cb107-1687" aria-hidden="true" tabindex="-1"></a>  tmp_dataset<span class="sc">$</span><span class="fu">save_betadiv</span>(<span class="at">dirpath =</span> <span class="fu">paste</span>(microeco_path, i, <span class="st">"/metrics/"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb107-1688"><a href="#cb107-1688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1689"><a href="#cb107-1689" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1690"><a href="#cb107-1690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1691"><a href="#cb107-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1694"><a href="#cb107-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1695"><a href="#cb107-1695" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb107-1696"><a href="#cb107-1696" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1697"><a href="#cb107-1697" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ssu18_ps_perfect_me<span class="sc">$</span>beta_diversity)</span>
<span id="cb107-1698"><a href="#cb107-1698" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ssu18_ps_perfect_me<span class="sc">$</span>beta_diversity)</span>
<span id="cb107-1699"><a href="#cb107-1699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1700"><a href="#cb107-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1701"><a href="#cb107-1701" aria-hidden="true" tabindex="-1"></a>Here I made a custom "function" to run the analysis, plot the graphs, save graph objects, and save plots (as <span class="in">`.png`</span> and <span class="in">`.pdf`</span> files). I am sure an actual programmer would be shocked, but it works. </span>
<span id="cb107-1702"><a href="#cb107-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1705"><a href="#cb107-1705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1706"><a href="#cb107-1706" aria-hidden="true" tabindex="-1"></a>microeco_beta_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(choose_input, choose_metric, choose_ord) {  </span>
<span id="cb107-1707"><a href="#cb107-1707" aria-hidden="true" tabindex="-1"></a>  tmp_dataset <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(choose_input, <span class="sc">~</span><span class="fu">paste0</span>(., <span class="st">"_me"</span>)))</span>
<span id="cb107-1708"><a href="#cb107-1708" aria-hidden="true" tabindex="-1"></a>  tmp_t1 <span class="ot">&lt;-</span> trans_beta<span class="sc">$</span><span class="fu">new</span>(<span class="at">dataset =</span> tmp_dataset, <span class="at">group =</span> <span class="st">"TEMP"</span>, <span class="at">measure =</span> choose_metric)</span>
<span id="cb107-1709"><a href="#cb107-1709" aria-hidden="true" tabindex="-1"></a>  tmp_t1<span class="sc">$</span><span class="fu">cal_ordination</span>(<span class="at">ordination =</span> choose_ord)</span>
<span id="cb107-1710"><a href="#cb107-1710" aria-hidden="true" tabindex="-1"></a>  tmp_t1_ord_plot <span class="ot">&lt;-</span> tmp_t1<span class="sc">$</span><span class="fu">plot_ordination</span>(<span class="at">plot_color =</span> <span class="st">"TEMP"</span>, </span>
<span id="cb107-1711"><a href="#cb107-1711" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">plot_shape =</span> <span class="st">"TEMP"</span>, </span>
<span id="cb107-1712"><a href="#cb107-1712" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">plot_group_ellipse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb107-1713"><a href="#cb107-1713" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color_values =</span> swel_col, </span>
<span id="cb107-1714"><a href="#cb107-1714" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">shape_values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb107-1715"><a href="#cb107-1715" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb107-1716"><a href="#cb107-1716" aria-hidden="true" tabindex="-1"></a>  tmp_t1<span class="sc">$</span><span class="fu">cal_group_distance</span>()</span>
<span id="cb107-1717"><a href="#cb107-1717" aria-hidden="true" tabindex="-1"></a>  tmp_t1_within_group_plot <span class="ot">&lt;-</span> tmp_t1<span class="sc">$</span><span class="fu">plot_group_distance</span>(<span class="at">distance_pair_stat =</span> <span class="cn">TRUE</span>, <span class="at">color_values =</span> swel_col)</span>
<span id="cb107-1718"><a href="#cb107-1718" aria-hidden="true" tabindex="-1"></a>  tmp_t1<span class="sc">$</span>res_group_distance</span>
<span id="cb107-1719"><a href="#cb107-1719" aria-hidden="true" tabindex="-1"></a>  tmp_t1<span class="sc">$</span><span class="fu">cal_group_distance</span>(<span class="at">within_group =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-1720"><a href="#cb107-1720" aria-hidden="true" tabindex="-1"></a>  tmp_t1_btwn_group_plot <span class="ot">&lt;-</span> tmp_t1<span class="sc">$</span><span class="fu">plot_group_distance</span>(<span class="at">distance_pair_stat =</span> <span class="cn">TRUE</span>, <span class="at">color_values =</span> swel_col) </span>
<span id="cb107-1721"><a href="#cb107-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1722"><a href="#cb107-1722" aria-hidden="true" tabindex="-1"></a><span class="do">###### SET names</span></span>
<span id="cb107-1723"><a href="#cb107-1723" aria-hidden="true" tabindex="-1"></a>  tmp_name_ord <span class="ot">&lt;-</span> <span class="fu">paste</span>(choose_input, <span class="st">"_me_"</span>, choose_metric, <span class="st">"_"</span>, choose_ord, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1724"><a href="#cb107-1724" aria-hidden="true" tabindex="-1"></a>  tmp_name_wg <span class="ot">&lt;-</span> <span class="fu">paste</span>(choose_input, <span class="st">"_me_wg_"</span>, choose_metric, <span class="st">"_"</span>, choose_ord, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1725"><a href="#cb107-1725" aria-hidden="true" tabindex="-1"></a>  tmp_name_bg <span class="ot">&lt;-</span> <span class="fu">paste</span>(choose_input, <span class="st">"_me_bg_"</span>, choose_metric, <span class="st">"_"</span>, choose_ord, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1726"><a href="#cb107-1726" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-1727"><a href="#cb107-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name_ord, tmp_t1_ord_plot, <span class="at">envir =</span> <span class="fu">parent.frame</span>() )</span>
<span id="cb107-1728"><a href="#cb107-1728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name_wg, tmp_t1_within_group_plot, <span class="at">envir =</span> <span class="fu">parent.frame</span>() )</span>
<span id="cb107-1729"><a href="#cb107-1729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name_bg, tmp_t1_btwn_group_plot, <span class="at">envir =</span> <span class="fu">parent.frame</span>() )</span>
<span id="cb107-1730"><a href="#cb107-1730" aria-hidden="true" tabindex="-1"></a><span class="do">###### SET paths</span></span>
<span id="cb107-1731"><a href="#cb107-1731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(microeco_path, choose_input, <span class="st">"/ordination/"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-1732"><a href="#cb107-1732" aria-hidden="true" tabindex="-1"></a>  tmp_path <span class="ot">&lt;-</span> <span class="fu">paste</span>(microeco_path, choose_input, <span class="st">"/ordination/"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1733"><a href="#cb107-1733" aria-hidden="true" tabindex="-1"></a>  tmp_path_ord <span class="ot">&lt;-</span> <span class="fu">paste</span>(tmp_path, <span class="st">"ord_plots/"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1734"><a href="#cb107-1734" aria-hidden="true" tabindex="-1"></a>  tmp_path_wg <span class="ot">&lt;-</span> <span class="fu">paste</span>(tmp_path, <span class="st">"within_group/"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1735"><a href="#cb107-1735" aria-hidden="true" tabindex="-1"></a>  tmp_path_bg <span class="ot">&lt;-</span> <span class="fu">paste</span>(tmp_path, <span class="st">"between_group/"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1736"><a href="#cb107-1736" aria-hidden="true" tabindex="-1"></a><span class="do">###### SAVE plots  </span></span>
<span id="cb107-1737"><a href="#cb107-1737" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_t1_ord_plot, <span class="at">path =</span> <span class="fu">paste</span>(tmp_path_ord, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">filename =</span> <span class="fu">paste0</span>(tmp_name_ord, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb107-1738"><a href="#cb107-1738" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_t1_ord_plot, <span class="at">path =</span> <span class="fu">paste</span>(tmp_path_ord, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">filename =</span> <span class="fu">paste0</span>(tmp_name_ord, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>))                    </span>
<span id="cb107-1739"><a href="#cb107-1739" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_t1_within_group_plot, <span class="at">path =</span> <span class="fu">paste</span>(tmp_path_wg, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">filename =</span> <span class="fu">paste0</span>(tmp_name_wg, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb107-1740"><a href="#cb107-1740" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_t1_within_group_plot, <span class="at">path =</span> <span class="fu">paste</span>(tmp_path_wg, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">filename =</span> <span class="fu">paste0</span>(tmp_name_wg, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>))                  </span>
<span id="cb107-1741"><a href="#cb107-1741" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_t1_btwn_group_plot, <span class="at">path =</span> <span class="fu">paste</span>(tmp_path_bg, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">filename =</span> <span class="fu">paste0</span>(tmp_name_bg, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb107-1742"><a href="#cb107-1742" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_t1_btwn_group_plot, <span class="at">path =</span> <span class="fu">paste</span>(tmp_path_bg, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">filename =</span> <span class="fu">paste0</span>(tmp_name_bg, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>))                  </span>
<span id="cb107-1743"><a href="#cb107-1743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1744"><a href="#cb107-1744" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1745"><a href="#cb107-1745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1746"><a href="#cb107-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1747"><a href="#cb107-1747" aria-hidden="true" tabindex="-1"></a>And then run it like so:</span>
<span id="cb107-1748"><a href="#cb107-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1751"><a href="#cb107-1751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1752"><a href="#cb107-1752" aria-hidden="true" tabindex="-1"></a><span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"ssu18_ps_pime"</span>, <span class="at">choose_metric =</span> <span class="st">"bray"</span>, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1753"><a href="#cb107-1753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1754"><a href="#cb107-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1755"><a href="#cb107-1755" aria-hidden="true" tabindex="-1"></a>It would be super cool to have a function that looped through a bunch of data sets, distance metrics, and ordination methods. </span>
<span id="cb107-1756"><a href="#cb107-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1759"><a href="#cb107-1759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1760"><a href="#cb107-1760" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity)) {</span>
<span id="cb107-1761"><a href="#cb107-1761" aria-hidden="true" tabindex="-1"></a>  tmp_metric <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity[j])</span>
<span id="cb107-1762"><a href="#cb107-1762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"ssu18_ps_work"</span>, <span class="at">choose_metric =</span> tmp_metric, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1763"><a href="#cb107-1763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1764"><a href="#cb107-1764" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1765"><a href="#cb107-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1766"><a href="#cb107-1766" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"ssu18_ps_filt"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity)) {</span>
<span id="cb107-1767"><a href="#cb107-1767" aria-hidden="true" tabindex="-1"></a>  tmp_metric <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"ssu18_ps_filt"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity[j])</span>
<span id="cb107-1768"><a href="#cb107-1768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"ssu18_ps_filt"</span>, <span class="at">choose_metric =</span> tmp_metric, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1769"><a href="#cb107-1769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1770"><a href="#cb107-1770" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1771"><a href="#cb107-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1772"><a href="#cb107-1772" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"ssu18_ps_perfect"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity)) {</span>
<span id="cb107-1773"><a href="#cb107-1773" aria-hidden="true" tabindex="-1"></a>  tmp_metric <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"ssu18_ps_perfect"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity[j])</span>
<span id="cb107-1774"><a href="#cb107-1774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"ssu18_ps_perfect"</span>, <span class="at">choose_metric =</span> tmp_metric, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1775"><a href="#cb107-1775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1776"><a href="#cb107-1776" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1777"><a href="#cb107-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1778"><a href="#cb107-1778" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"ssu18_ps_pime"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity)) {</span>
<span id="cb107-1779"><a href="#cb107-1779" aria-hidden="true" tabindex="-1"></a>  tmp_metric <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"ssu18_ps_pime"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity[j])</span>
<span id="cb107-1780"><a href="#cb107-1780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"ssu18_ps_pime"</span>, <span class="at">choose_metric =</span> tmp_metric, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1781"><a href="#cb107-1781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1782"><a href="#cb107-1782" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1783"><a href="#cb107-1783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1784"><a href="#cb107-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1785"><a href="#cb107-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1788"><a href="#cb107-1788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1789"><a href="#cb107-1789" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1790"><a href="#cb107-1790" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_title <span class="ot">&lt;-</span> <span class="st">"FULL Ordination Plots"</span></span>
<span id="cb107-1791"><a href="#cb107-1791" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_title <span class="ot">&lt;-</span> <span class="st">"Arbitrary Ordination Plots"</span></span>
<span id="cb107-1792"><a href="#cb107-1792" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_title <span class="ot">&lt;-</span> <span class="st">"PERfect Ordination Plots"</span></span>
<span id="cb107-1793"><a href="#cb107-1793" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_title <span class="ot">&lt;-</span> <span class="st">"PIME Ordination Plots"</span></span>
<span id="cb107-1794"><a href="#cb107-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1795"><a href="#cb107-1795" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (samp_ps <span class="cf">in</span> ssu18_data_sets) {</span>
<span id="cb107-1796"><a href="#cb107-1796" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot <span class="ot">&lt;-</span> (</span>
<span id="cb107-1797"><a href="#cb107-1797" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_jsd_PCoA"</span>))) <span class="sc">+</span></span>
<span id="cb107-1798"><a href="#cb107-1798" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_unifrac_PCoA"</span>))) <span class="sc">+</span></span>
<span id="cb107-1799"><a href="#cb107-1799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_wunifrac_PCoA"</span>))) </span>
<span id="cb107-1800"><a href="#cb107-1800" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">/</span></span>
<span id="cb107-1801"><a href="#cb107-1801" aria-hidden="true" tabindex="-1"></a>                    (</span>
<span id="cb107-1802"><a href="#cb107-1802" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me"</span>,  <span class="st">"_jsd_PCoA"</span>))) <span class="sc">+</span></span>
<span id="cb107-1803"><a href="#cb107-1803" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me"</span>, <span class="st">"_unwei_unifrac_PCoA"</span>))) <span class="sc">+</span></span>
<span id="cb107-1804"><a href="#cb107-1804" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me"</span>, <span class="st">"_wei_unifrac_PCoA"</span>)))</span>
<span id="cb107-1805"><a href="#cb107-1805" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb107-1806"><a href="#cb107-1806" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-1807"><a href="#cb107-1807" aria-hidden="true" tabindex="-1"></a>  tmp_title <span class="ot">&lt;-</span> <span class="fu">paste</span>(samp_ps, <span class="st">"_title"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1808"><a href="#cb107-1808" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot <span class="ot">&lt;-</span>  tmp_combo_plot <span class="sc">+</span></span>
<span id="cb107-1809"><a href="#cb107-1809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="fu">get</span>(tmp_title),</span>
<span id="cb107-1810"><a href="#cb107-1810" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Comparisons of three distance metrics. Implemented in phyloseq (top) and microeco (bottom).'</span>) <span class="sc">+</span></span>
<span id="cb107-1811"><a href="#cb107-1811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb107-1812"><a href="#cb107-1812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb107-1813"><a href="#cb107-1813" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb107-1814"><a href="#cb107-1814" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb107-1815"><a href="#cb107-1815" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb107-1816"><a href="#cb107-1816" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb107-1817"><a href="#cb107-1817" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb107-1818"><a href="#cb107-1818" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb107-1819"><a href="#cb107-1819" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.75</span>)),</span>
<span id="cb107-1820"><a href="#cb107-1820" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>)))</span>
<span id="cb107-1821"><a href="#cb107-1821" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_plots"</span>))</span>
<span id="cb107-1822"><a href="#cb107-1822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_combo_plot_name, tmp_combo_plot)</span>
<span id="cb107-1823"><a href="#cb107-1823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1824"><a href="#cb107-1824" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1825"><a href="#cb107-1825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1826"><a href="#cb107-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1829"><a href="#cb107-1829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1830"><a href="#cb107-1830" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1831"><a href="#cb107-1831" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_data_sets) {</span>
<span id="cb107-1832"><a href="#cb107-1832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(<span class="st">"files/beta/figures/combo_plots"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-1833"><a href="#cb107-1833" aria-hidden="true" tabindex="-1"></a>  tmp_path <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"files/beta/figures/combo_plots"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1834"><a href="#cb107-1834" aria-hidden="true" tabindex="-1"></a>  tmp_filename <span class="ot">&lt;-</span> <span class="fu">paste</span>(i, <span class="st">"_beta_div_ord_plots"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb107-1835"><a href="#cb107-1835" aria-hidden="true" tabindex="-1"></a>  tmp_get_plot <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_plots"</span>)))</span>
<span id="cb107-1836"><a href="#cb107-1836" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_plot, <span class="at">path =</span> tmp_path, <span class="at">filename =</span> <span class="fu">paste</span>(tmp_filename, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">height =</span> <span class="dv">28</span>, <span class="at">width =</span> <span class="dv">36</span>,</span>
<span id="cb107-1837"><a href="#cb107-1837" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb107-1838"><a href="#cb107-1838" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_plot, <span class="at">path =</span> tmp_path, <span class="at">filename =</span> <span class="fu">paste</span>(tmp_filename, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">12</span>)</span>
<span id="cb107-1839"><a href="#cb107-1839" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb107-1840"><a href="#cb107-1840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1841"><a href="#cb107-1841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1844"><a href="#cb107-1844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1845"><a href="#cb107-1845" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1846"><a href="#cb107-1846" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/ssu18_ps_work_beta_div_ord_plots.png include/beta/ssu18_ps_work_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-1847"><a href="#cb107-1847" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/ssu18_ps_filt_beta_div_ord_plots.png include/beta/ssu18_ps_filt_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-1848"><a href="#cb107-1848" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/ssu18_ps_perfect_beta_div_ord_plots.png include/beta/ssu18_ps_perfect_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-1849"><a href="#cb107-1849" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/ssu18_ps_pime_beta_div_ord_plots.png include/beta/ssu18_ps_pime_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-1850"><a href="#cb107-1850" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1851"><a href="#cb107-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1852"><a href="#cb107-1852" aria-hidden="true" tabindex="-1"></a>**And now the ITS code.**</span>
<span id="cb107-1853"><a href="#cb107-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1856"><a href="#cb107-1856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1857"><a href="#cb107-1857" aria-hidden="true" tabindex="-1"></a>its18_data_sets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, <span class="st">"its18_ps_perfect"</span>, <span class="st">"its18_ps_pime"</span>)</span>
<span id="cb107-1858"><a href="#cb107-1858" aria-hidden="true" tabindex="-1"></a>its_dist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"jsd"</span>, <span class="st">"bray"</span>, <span class="st">"gower"</span>)</span>
<span id="cb107-1859"><a href="#cb107-1859" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (samp_ps <span class="cf">in</span> its18_data_sets) {</span>
<span id="cb107-1860"><a href="#cb107-1860" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> its_dist){</span>
<span id="cb107-1861"><a href="#cb107-1861" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_prop"</span>)))</span>
<span id="cb107-1862"><a href="#cb107-1862" aria-hidden="true" tabindex="-1"></a>     ord_meths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"NMDS"</span>, <span class="st">"PCoA"</span>, <span class="st">"CCA"</span>, <span class="st">"DCA"</span>) <span class="co"># MDS = PCoA, "CCA", "DCA", "DPCoA", "RDA"</span></span>
<span id="cb107-1863"><a href="#cb107-1863" aria-hidden="true" tabindex="-1"></a>     tmp_plist <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">llply</span>(<span class="fu">as.list</span>(ord_meths), <span class="cf">function</span>(i, physeq, d) {</span>
<span id="cb107-1864"><a href="#cb107-1864" aria-hidden="true" tabindex="-1"></a>        ordi <span class="ot">=</span> <span class="fu">ordinate</span>(physeq, <span class="at">method =</span> i, <span class="at">distance =</span> d)</span>
<span id="cb107-1865"><a href="#cb107-1865" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot_ordination</span>(physeq, ordi, <span class="st">"samples"</span>, <span class="at">color =</span> <span class="st">"TEMP"</span>)</span>
<span id="cb107-1866"><a href="#cb107-1866" aria-hidden="true" tabindex="-1"></a>   }, tmp_get, d)</span>
<span id="cb107-1867"><a href="#cb107-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1868"><a href="#cb107-1868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(tmp_plist) <span class="ot">&lt;-</span> ord_meths</span>
<span id="cb107-1869"><a href="#cb107-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1870"><a href="#cb107-1870" aria-hidden="true" tabindex="-1"></a>  tmp_df <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">ldply</span>(tmp_plist, <span class="cf">function</span>(x){</span>
<span id="cb107-1871"><a href="#cb107-1871" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">=</span> x<span class="sc">$</span>data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb107-1872"><a href="#cb107-1872" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(df) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Axis_1"</span>, <span class="st">"Axis_2"</span>)</span>
<span id="cb107-1873"><a href="#cb107-1873" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">cbind</span>(df, x<span class="sc">$</span>data))})</span>
<span id="cb107-1874"><a href="#cb107-1874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(tmp_df)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">"method"</span></span>
<span id="cb107-1875"><a href="#cb107-1875" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-1876"><a href="#cb107-1876" aria-hidden="true" tabindex="-1"></a>  tmp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tmp_df, <span class="fu">aes</span>(Axis_1, Axis_2, <span class="at">color =</span> TEMP, <span class="at">shape =</span> TEMP, <span class="at">fill =</span> TEMP))</span>
<span id="cb107-1877"><a href="#cb107-1877" aria-hidden="true" tabindex="-1"></a>  tmp_plot <span class="ot">&lt;-</span> tmp_plot <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb107-1878"><a href="#cb107-1878" aria-hidden="true" tabindex="-1"></a>  tmp_plot <span class="ot">&lt;-</span> tmp_plot <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb107-1879"><a href="#cb107-1879" aria-hidden="true" tabindex="-1"></a>  tmp_plot <span class="ot">&lt;-</span> tmp_plot <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span>
<span id="cb107-1880"><a href="#cb107-1880" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-1881"><a href="#cb107-1881" aria-hidden="true" tabindex="-1"></a>  tmp_df_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(samp_ps, <span class="st">"_dist_"</span>, .))</span>
<span id="cb107-1882"><a href="#cb107-1882" aria-hidden="true" tabindex="-1"></a>  tmp_plist_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(samp_ps, <span class="st">"_"</span>, ., <span class="st">"_plist"</span>))</span>
<span id="cb107-1883"><a href="#cb107-1883" aria-hidden="true" tabindex="-1"></a>  tmp_plot_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(d, <span class="sc">~</span> <span class="fu">paste0</span>(samp_ps, <span class="st">"_dist_"</span>, ., <span class="st">"_plot"</span>))</span>
<span id="cb107-1884"><a href="#cb107-1884" aria-hidden="true" tabindex="-1"></a>  tmp_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"tmp_df_name"</span> <span class="ot">=</span> tmp_df, <span class="at">tmp_plist_name =</span> tmp_plist, <span class="at">tmp_plot_name =</span> tmp_plot)</span>
<span id="cb107-1885"><a href="#cb107-1885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(samp_ps, <span class="st">"_"</span>,  d, <span class="st">"_ord_results"</span>), tmp_list)</span>
<span id="cb107-1886"><a href="#cb107-1886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"_tmp"</span>))</span>
<span id="cb107-1887"><a href="#cb107-1887" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb107-1888"><a href="#cb107-1888" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1889"><a href="#cb107-1889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1890"><a href="#cb107-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1893"><a href="#cb107-1893" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1894"><a href="#cb107-1894" aria-hidden="true" tabindex="-1"></a>plist_name <span class="ot">&lt;-</span> <span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">"_ord_results"</span>)</span>
<span id="cb107-1895"><a href="#cb107-1895" aria-hidden="true" tabindex="-1"></a>plot_num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb107-1896"><a href="#cb107-1896" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> plist_name) {</span>
<span id="cb107-1897"><a href="#cb107-1897" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> plot_num) {</span>
<span id="cb107-1898"><a href="#cb107-1898" aria-hidden="true" tabindex="-1"></a>       tmp_get_i <span class="ot">&lt;-</span> <span class="fu">get</span>(i)<span class="sc">$</span>tmp_plist_name</span>
<span id="cb107-1899"><a href="#cb107-1899" aria-hidden="true" tabindex="-1"></a>       tmp_ord <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp_get_i)[j]</span>
<span id="cb107-1900"><a href="#cb107-1900" aria-hidden="true" tabindex="-1"></a>       tmp_name <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(i, <span class="st">"ord_results"</span>, tmp_ord)</span>
<span id="cb107-1901"><a href="#cb107-1901" aria-hidden="true" tabindex="-1"></a>       tmp_plot <span class="ot">&lt;-</span> tmp_get_i[[j]] <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span>
<span id="cb107-1902"><a href="#cb107-1902" aria-hidden="true" tabindex="-1"></a>       tmp_plot <span class="ot">&lt;-</span> tmp_plot <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">shape =</span> TEMP)) <span class="sc">+</span></span>
<span id="cb107-1903"><a href="#cb107-1903" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb107-1904"><a href="#cb107-1904" aria-hidden="true" tabindex="-1"></a>       tmp_plot<span class="sc">$</span>labels<span class="sc">$</span>shape <span class="ot">&lt;-</span> <span class="st">"TEMP"</span></span>
<span id="cb107-1905"><a href="#cb107-1905" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_name, tmp_plot)</span>
<span id="cb107-1906"><a href="#cb107-1906" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1907"><a href="#cb107-1907" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-1908"><a href="#cb107-1908" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1909"><a href="#cb107-1909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1910"><a href="#cb107-1910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1911"><a href="#cb107-1911" aria-hidden="true" tabindex="-1"></a>And now the code for ordination implementation in <span class="in">`microeco`</span>. </span>
<span id="cb107-1912"><a href="#cb107-1912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1915"><a href="#cb107-1915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1916"><a href="#cb107-1916" aria-hidden="true" tabindex="-1"></a>microeco_path <span class="ot">&lt;-</span> <span class="st">"files/beta/microeco/"</span></span>
<span id="cb107-1917"><a href="#cb107-1917" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_data_sets) {</span>
<span id="cb107-1918"><a href="#cb107-1918" aria-hidden="true" tabindex="-1"></a>  tmp_dataset <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span><span class="fu">paste0</span>(., <span class="st">"_me"</span>)))</span>
<span id="cb107-1919"><a href="#cb107-1919" aria-hidden="true" tabindex="-1"></a>  tmp_dataset<span class="sc">$</span><span class="fu">cal_betadiv</span>(<span class="at">unifrac =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-1920"><a href="#cb107-1920" aria-hidden="true" tabindex="-1"></a><span class="do">#### CODE TO ADD JSD DISTANCE ####  </span></span>
<span id="cb107-1921"><a href="#cb107-1921" aria-hidden="true" tabindex="-1"></a>  tmp_jsd <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">distance</span>(<span class="fu">get</span>(i), <span class="at">method =</span> <span class="st">"jsd"</span>) </span>
<span id="cb107-1922"><a href="#cb107-1922" aria-hidden="true" tabindex="-1"></a>  tmp_jsd <span class="ot">&lt;-</span> <span class="fu">forceSymmetric</span>(<span class="fu">as.matrix</span>(tmp_jsd), <span class="at">uplo =</span> <span class="st">"L"</span>)</span>
<span id="cb107-1923"><a href="#cb107-1923" aria-hidden="true" tabindex="-1"></a>  tmp_jsd <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_jsd)</span>
<span id="cb107-1924"><a href="#cb107-1924" aria-hidden="true" tabindex="-1"></a>  tmp_dataset<span class="sc">$</span>beta_diversity<span class="sc">$</span>jsd <span class="ot">&lt;-</span> tmp_jsd</span>
<span id="cb107-1925"><a href="#cb107-1925" aria-hidden="true" tabindex="-1"></a><span class="do">#### CODE TO ADD GOWER DISTANCE ####  </span></span>
<span id="cb107-1926"><a href="#cb107-1926" aria-hidden="true" tabindex="-1"></a>  tmp_gower <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">distance</span>(<span class="fu">get</span>(i), <span class="at">method =</span> <span class="st">"gower"</span>) </span>
<span id="cb107-1927"><a href="#cb107-1927" aria-hidden="true" tabindex="-1"></a>  tmp_gower <span class="ot">&lt;-</span> <span class="fu">forceSymmetric</span>(<span class="fu">as.matrix</span>(tmp_gower), <span class="at">uplo =</span> <span class="st">"L"</span>)</span>
<span id="cb107-1928"><a href="#cb107-1928" aria-hidden="true" tabindex="-1"></a>  tmp_gower <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_gower)</span>
<span id="cb107-1929"><a href="#cb107-1929" aria-hidden="true" tabindex="-1"></a>  tmp_dataset<span class="sc">$</span>beta_diversity<span class="sc">$</span>gower <span class="ot">&lt;-</span> tmp_gower</span>
<span id="cb107-1930"><a href="#cb107-1930" aria-hidden="true" tabindex="-1"></a><span class="do">#### #### #### #### #### #### #### ####  </span></span>
<span id="cb107-1931"><a href="#cb107-1931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(microeco_path, i, <span class="st">"/metrics/"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-1932"><a href="#cb107-1932" aria-hidden="true" tabindex="-1"></a>  tmp_dataset<span class="sc">$</span><span class="fu">save_betadiv</span>(<span class="at">dirpath =</span> <span class="fu">paste</span>(microeco_path, i, <span class="st">"/metrics/"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb107-1933"><a href="#cb107-1933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1934"><a href="#cb107-1934" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1935"><a href="#cb107-1935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1936"><a href="#cb107-1936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1939"><a href="#cb107-1939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1940"><a href="#cb107-1940" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb107-1941"><a href="#cb107-1941" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-1942"><a href="#cb107-1942" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(its18_ps_perfect_me<span class="sc">$</span>beta_diversity)</span>
<span id="cb107-1943"><a href="#cb107-1943" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(its18_ps_perfect_me<span class="sc">$</span>beta_diversity)</span>
<span id="cb107-1944"><a href="#cb107-1944" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1945"><a href="#cb107-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1946"><a href="#cb107-1946" aria-hidden="true" tabindex="-1"></a>Here we call the custom function described above. </span>
<span id="cb107-1947"><a href="#cb107-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1950"><a href="#cb107-1950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1951"><a href="#cb107-1951" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity)) {</span>
<span id="cb107-1952"><a href="#cb107-1952" aria-hidden="true" tabindex="-1"></a>  tmp_metric <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity[j])</span>
<span id="cb107-1953"><a href="#cb107-1953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"its18_ps_work"</span>, <span class="at">choose_metric =</span> tmp_metric, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1954"><a href="#cb107-1954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1955"><a href="#cb107-1955" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1956"><a href="#cb107-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1957"><a href="#cb107-1957" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"its18_ps_filt"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity)) {</span>
<span id="cb107-1958"><a href="#cb107-1958" aria-hidden="true" tabindex="-1"></a>  tmp_metric <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"its18_ps_filt"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity[j])</span>
<span id="cb107-1959"><a href="#cb107-1959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"its18_ps_filt"</span>, <span class="at">choose_metric =</span> tmp_metric, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1960"><a href="#cb107-1960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1961"><a href="#cb107-1961" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1962"><a href="#cb107-1962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1963"><a href="#cb107-1963" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"its18_ps_perfect"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity)) {</span>
<span id="cb107-1964"><a href="#cb107-1964" aria-hidden="true" tabindex="-1"></a>  tmp_metric <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"its18_ps_perfect"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity[j])</span>
<span id="cb107-1965"><a href="#cb107-1965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"its18_ps_perfect"</span>, <span class="at">choose_metric =</span> tmp_metric, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1966"><a href="#cb107-1966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1967"><a href="#cb107-1967" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1968"><a href="#cb107-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1969"><a href="#cb107-1969" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"its18_ps_pime"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity)) {</span>
<span id="cb107-1970"><a href="#cb107-1970" aria-hidden="true" tabindex="-1"></a>  tmp_metric <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get</span>(<span class="fu">paste</span>(<span class="st">"its18_ps_pime"</span>, <span class="st">"_me"</span>, <span class="at">sep =</span> <span class="st">""</span>))<span class="sc">$</span>beta_diversity[j])</span>
<span id="cb107-1971"><a href="#cb107-1971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">microeco_beta_plot</span>(<span class="at">choose_input =</span> <span class="st">"its18_ps_pime"</span>, <span class="at">choose_metric =</span> tmp_metric, <span class="at">choose_ord =</span> <span class="st">"PCoA"</span>)</span>
<span id="cb107-1972"><a href="#cb107-1972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-1973"><a href="#cb107-1973" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-1974"><a href="#cb107-1974" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-1975"><a href="#cb107-1975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1976"><a href="#cb107-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1979"><a href="#cb107-1979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-1980"><a href="#cb107-1980" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-1981"><a href="#cb107-1981" aria-hidden="true" tabindex="-1"></a>its18_ps_work_title <span class="ot">&lt;-</span> <span class="st">"FULL Ordination Plots"</span></span>
<span id="cb107-1982"><a href="#cb107-1982" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_title <span class="ot">&lt;-</span> <span class="st">"Arbitrary Ordination Plots"</span></span>
<span id="cb107-1983"><a href="#cb107-1983" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_title <span class="ot">&lt;-</span> <span class="st">"PERfect Ordination Plots"</span></span>
<span id="cb107-1984"><a href="#cb107-1984" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_title <span class="ot">&lt;-</span> <span class="st">"PIME Ordination Plots"</span></span>
<span id="cb107-1985"><a href="#cb107-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-1986"><a href="#cb107-1986" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (samp_ps <span class="cf">in</span> its18_data_sets) {</span>
<span id="cb107-1987"><a href="#cb107-1987" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot <span class="ot">&lt;-</span> (</span>
<span id="cb107-1988"><a href="#cb107-1988" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_jsd_PCoA"</span>))) <span class="sc">+</span></span>
<span id="cb107-1989"><a href="#cb107-1989" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_bray_PCoA"</span>))) <span class="sc">+</span></span>
<span id="cb107-1990"><a href="#cb107-1990" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_gower_PCoA"</span>))) </span>
<span id="cb107-1991"><a href="#cb107-1991" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">/</span></span>
<span id="cb107-1992"><a href="#cb107-1992" aria-hidden="true" tabindex="-1"></a>                    (</span>
<span id="cb107-1993"><a href="#cb107-1993" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me"</span>,  <span class="st">"_jsd_PCoA"</span>))) <span class="sc">+</span></span>
<span id="cb107-1994"><a href="#cb107-1994" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me"</span>, <span class="st">"_bray_PCoA"</span>))) <span class="sc">+</span></span>
<span id="cb107-1995"><a href="#cb107-1995" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me"</span>, <span class="st">"_gower_PCoA"</span>)))</span>
<span id="cb107-1996"><a href="#cb107-1996" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb107-1997"><a href="#cb107-1997" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-1998"><a href="#cb107-1998" aria-hidden="true" tabindex="-1"></a>  tmp_title <span class="ot">&lt;-</span> <span class="fu">paste</span>(samp_ps, <span class="st">"_title"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-1999"><a href="#cb107-1999" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot <span class="ot">&lt;-</span>  tmp_combo_plot <span class="sc">+</span></span>
<span id="cb107-2000"><a href="#cb107-2000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="fu">get</span>(tmp_title),</span>
<span id="cb107-2001"><a href="#cb107-2001" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Comparisons of three distance metrics. Implemented in phyloseq (top) and microeco (bottom).'</span>) <span class="sc">+</span></span>
<span id="cb107-2002"><a href="#cb107-2002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb107-2003"><a href="#cb107-2003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb107-2004"><a href="#cb107-2004" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb107-2005"><a href="#cb107-2005" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb107-2006"><a href="#cb107-2006" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb107-2007"><a href="#cb107-2007" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb107-2008"><a href="#cb107-2008" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb107-2009"><a href="#cb107-2009" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb107-2010"><a href="#cb107-2010" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.75</span>)),</span>
<span id="cb107-2011"><a href="#cb107-2011" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>)))</span>
<span id="cb107-2012"><a href="#cb107-2012" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_plots"</span>))</span>
<span id="cb107-2013"><a href="#cb107-2013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_combo_plot_name, tmp_combo_plot)</span>
<span id="cb107-2014"><a href="#cb107-2014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-2015"><a href="#cb107-2015" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-2016"><a href="#cb107-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2017"><a href="#cb107-2017" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_plots</span>
<span id="cb107-2018"><a href="#cb107-2018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2019"><a href="#cb107-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2022"><a href="#cb107-2022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2023"><a href="#cb107-2023" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2024"><a href="#cb107-2024" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_data_sets) {</span>
<span id="cb107-2025"><a href="#cb107-2025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(<span class="st">"files/beta/figures/combo_plots"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-2026"><a href="#cb107-2026" aria-hidden="true" tabindex="-1"></a>  tmp_path <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"files/beta/figures/combo_plots"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-2027"><a href="#cb107-2027" aria-hidden="true" tabindex="-1"></a>  tmp_filename <span class="ot">&lt;-</span> <span class="fu">paste</span>(i, <span class="st">"_beta_div_ord_plots"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb107-2028"><a href="#cb107-2028" aria-hidden="true" tabindex="-1"></a>  tmp_get_plot <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_plots"</span>)))</span>
<span id="cb107-2029"><a href="#cb107-2029" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_plot, <span class="at">path =</span> tmp_path, <span class="at">filename =</span> <span class="fu">paste</span>(tmp_filename, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">height=</span><span class="dv">28</span>, <span class="at">width=</span><span class="dv">36</span>,</span>
<span id="cb107-2030"><a href="#cb107-2030" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb107-2031"><a href="#cb107-2031" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_plot, <span class="at">path =</span> tmp_path, <span class="at">filename =</span> <span class="fu">paste</span>(tmp_filename, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">height=</span><span class="dv">10</span>, <span class="at">width=</span><span class="dv">12</span>)</span>
<span id="cb107-2032"><a href="#cb107-2032" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb107-2033"><a href="#cb107-2033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2034"><a href="#cb107-2034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2037"><a href="#cb107-2037" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2038"><a href="#cb107-2038" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2039"><a href="#cb107-2039" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/its18_ps_work_beta_div_ord_plots.png include/beta/its18_ps_work_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2040"><a href="#cb107-2040" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/its18_ps_filt_beta_div_ord_plots.png include/beta/its18_ps_filt_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2041"><a href="#cb107-2041" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/its18_ps_perfect_beta_div_ord_plots.png include/beta/its18_ps_perfect_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2042"><a href="#cb107-2042" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/its18_ps_pime_beta_div_ord_plots.png include/beta/its18_ps_pime_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2043"><a href="#cb107-2043" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2044"><a href="#cb107-2044" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb107-2045"><a href="#cb107-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2046"><a href="#cb107-2046" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br/&gt;</span></span>
<span id="cb107-2047"><a href="#cb107-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2048"><a href="#cb107-2048" aria-hidden="true" tabindex="-1"></a><span class="fu">## 16S rRNA</span></span>
<span id="cb107-2049"><a href="#cb107-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2050"><a href="#cb107-2050" aria-hidden="true" tabindex="-1"></a>::: {.column-body-outset}</span>
<span id="cb107-2051"><a href="#cb107-2051" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-2052"><a href="#cb107-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2053"><a href="#cb107-2053" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL </span></span>
<span id="cb107-2054"><a href="#cb107-2054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2057"><a href="#cb107-2057" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2058"><a href="#cb107-2058" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2059"><a href="#cb107-2059" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2060"><a href="#cb107-2060" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2061"><a href="#cb107-2061" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/ssu18_ps_work_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2062"><a href="#cb107-2062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2063"><a href="#cb107-2063" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_beta_div_plots_full")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2064"><a href="#cb107-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2065"><a href="#cb107-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2066"><a href="#cb107-2066" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary</span></span>
<span id="cb107-2067"><a href="#cb107-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2070"><a href="#cb107-2070" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2071"><a href="#cb107-2071" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2072"><a href="#cb107-2072" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2073"><a href="#cb107-2073" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2074"><a href="#cb107-2074" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/ssu18_ps_filt_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2075"><a href="#cb107-2075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2076"><a href="#cb107-2076" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_beta_div_plots_filt")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2077"><a href="#cb107-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2078"><a href="#cb107-2078" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-2079"><a href="#cb107-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2082"><a href="#cb107-2082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2083"><a href="#cb107-2083" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2084"><a href="#cb107-2084" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2085"><a href="#cb107-2085" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2086"><a href="#cb107-2086" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/ssu18_ps_perfect_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2087"><a href="#cb107-2087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2088"><a href="#cb107-2088" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_beta_div_plots_perfect")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2089"><a href="#cb107-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2090"><a href="#cb107-2090" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-2091"><a href="#cb107-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2094"><a href="#cb107-2094" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2095"><a href="#cb107-2095" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2096"><a href="#cb107-2096" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2097"><a href="#cb107-2097" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2098"><a href="#cb107-2098" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/ssu18_ps_pime_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2099"><a href="#cb107-2099" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2100"><a href="#cb107-2100" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_beta_div_plots_pime")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2101"><a href="#cb107-2101" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-2102"><a href="#cb107-2102" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-2103"><a href="#cb107-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2104"><a href="#cb107-2104" aria-hidden="true" tabindex="-1"></a><span class="fu">## ITS</span></span>
<span id="cb107-2105"><a href="#cb107-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2106"><a href="#cb107-2106" aria-hidden="true" tabindex="-1"></a>::: {.column-body-outset}</span>
<span id="cb107-2107"><a href="#cb107-2107" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-2108"><a href="#cb107-2108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2109"><a href="#cb107-2109" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary </span></span>
<span id="cb107-2110"><a href="#cb107-2110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2113"><a href="#cb107-2113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2114"><a href="#cb107-2114" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2115"><a href="#cb107-2115" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2116"><a href="#cb107-2116" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2117"><a href="#cb107-2117" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/its18_ps_work_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2118"><a href="#cb107-2118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2119"><a href="#cb107-2119" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_beta_div_plots_full")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2120"><a href="#cb107-2120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2121"><a href="#cb107-2121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2122"><a href="#cb107-2122" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FILT </span></span>
<span id="cb107-2123"><a href="#cb107-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2126"><a href="#cb107-2126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2127"><a href="#cb107-2127" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2128"><a href="#cb107-2128" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2129"><a href="#cb107-2129" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2130"><a href="#cb107-2130" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/its18_ps_filt_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2131"><a href="#cb107-2131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2132"><a href="#cb107-2132" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_beta_div_plots_filt")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2133"><a href="#cb107-2133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2134"><a href="#cb107-2134" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-2135"><a href="#cb107-2135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2138"><a href="#cb107-2138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2139"><a href="#cb107-2139" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2140"><a href="#cb107-2140" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2141"><a href="#cb107-2141" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2142"><a href="#cb107-2142" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/its18_ps_perfect_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2143"><a href="#cb107-2143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2144"><a href="#cb107-2144" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_beta_div_plots_perfect")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2145"><a href="#cb107-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2146"><a href="#cb107-2146" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-2147"><a href="#cb107-2147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2150"><a href="#cb107-2150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2151"><a href="#cb107-2151" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2152"><a href="#cb107-2152" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2153"><a href="#cb107-2153" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2154"><a href="#cb107-2154" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/its18_ps_pime_beta_div_ord_plots.png"</span>)</span>
<span id="cb107-2155"><a href="#cb107-2155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2156"><a href="#cb107-2156" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_beta_div_plots_pime")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2157"><a href="#cb107-2157" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-2158"><a href="#cb107-2158" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-2159"><a href="#cb107-2159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2160"><a href="#cb107-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2163"><a href="#cb107-2163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2164"><a href="#cb107-2164" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2165"><a href="#cb107-2165" aria-hidden="true" tabindex="-1"></a><span class="do">## NEXT few blocks are to modify with and between group plots</span></span>
<span id="cb107-2166"><a href="#cb107-2166" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_wg_"</span>)) {</span>
<span id="cb107-2167"><a href="#cb107-2167" aria-hidden="true" tabindex="-1"></a>  tmp_dataset <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb107-2168"><a href="#cb107-2168" aria-hidden="true" tabindex="-1"></a>  tmp_wg <span class="ot">&lt;-</span> tmp_dataset <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">fill=</span>swel_col) <span class="sc">+</span> </span>
<span id="cb107-2169"><a href="#cb107-2169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#191919"</span>, <span class="st">"#191919"</span>, <span class="st">"#191919"</span>))</span>
<span id="cb107-2170"><a href="#cb107-2170" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_mod"</span>))</span>
<span id="cb107-2171"><a href="#cb107-2171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_wg)</span>
<span id="cb107-2172"><a href="#cb107-2172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-2173"><a href="#cb107-2173" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-2174"><a href="#cb107-2174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2175"><a href="#cb107-2175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2178"><a href="#cb107-2178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2179"><a href="#cb107-2179" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2180"><a href="#cb107-2180" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb107-2181"><a href="#cb107-2181" aria-hidden="true" tabindex="-1"></a>btw_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#FF00FF"</span>, <span class="st">"#FFFF00"</span>, <span class="st">"#00FFFF"</span>)</span>
<span id="cb107-2182"><a href="#cb107-2182" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_bg_"</span>)) {</span>
<span id="cb107-2183"><a href="#cb107-2183" aria-hidden="true" tabindex="-1"></a>  tmp_dataset <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb107-2184"><a href="#cb107-2184" aria-hidden="true" tabindex="-1"></a>  tmp_wg <span class="ot">&lt;-</span> tmp_dataset <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"grey90"</span>) <span class="sc">+</span> </span>
<span id="cb107-2185"><a href="#cb107-2185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#191919"</span>, <span class="st">"#191919"</span>, <span class="st">"#191919"</span>))</span>
<span id="cb107-2186"><a href="#cb107-2186" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_mod"</span>))</span>
<span id="cb107-2187"><a href="#cb107-2187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_wg)</span>
<span id="cb107-2188"><a href="#cb107-2188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-2189"><a href="#cb107-2189" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-2190"><a href="#cb107-2190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2191"><a href="#cb107-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2194"><a href="#cb107-2194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2195"><a href="#cb107-2195" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2196"><a href="#cb107-2196" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_jsd_PCoA_mod"</span>)) {</span>
<span id="cb107-2197"><a href="#cb107-2197" aria-hidden="true" tabindex="-1"></a>  tmp_wg <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb107-2198"><a href="#cb107-2198" aria-hidden="true" tabindex="-1"></a>  tmp_wg <span class="ot">&lt;-</span> tmp_wg <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Jensen-Shannon divergence"</span>)</span>
<span id="cb107-2199"><a href="#cb107-2199" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> i</span>
<span id="cb107-2200"><a href="#cb107-2200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_wg)</span>
<span id="cb107-2201"><a href="#cb107-2201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-2202"><a href="#cb107-2202" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-2203"><a href="#cb107-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2204"><a href="#cb107-2204" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_bray_PCoA_mod"</span>)) {</span>
<span id="cb107-2205"><a href="#cb107-2205" aria-hidden="true" tabindex="-1"></a>  tmp_wg <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb107-2206"><a href="#cb107-2206" aria-hidden="true" tabindex="-1"></a>  tmp_wg <span class="ot">&lt;-</span> tmp_wg <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Bray-Curtis dissimilarity"</span>)</span>
<span id="cb107-2207"><a href="#cb107-2207" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> i</span>
<span id="cb107-2208"><a href="#cb107-2208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_wg)</span>
<span id="cb107-2209"><a href="#cb107-2209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-2210"><a href="#cb107-2210" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-2211"><a href="#cb107-2211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2212"><a href="#cb107-2212" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_gower_PCoA_mod"</span>)) {</span>
<span id="cb107-2213"><a href="#cb107-2213" aria-hidden="true" tabindex="-1"></a>  tmp_wg <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb107-2214"><a href="#cb107-2214" aria-hidden="true" tabindex="-1"></a>  tmp_wg <span class="ot">&lt;-</span> tmp_wg <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Gower distance"</span>)</span>
<span id="cb107-2215"><a href="#cb107-2215" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> i</span>
<span id="cb107-2216"><a href="#cb107-2216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_wg)</span>
<span id="cb107-2217"><a href="#cb107-2217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-2218"><a href="#cb107-2218" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-2219"><a href="#cb107-2219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2220"><a href="#cb107-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2221"><a href="#cb107-2221" aria-hidden="true" tabindex="-1"></a><span class="fu"># Within &amp; Between Group Distances</span></span>
<span id="cb107-2222"><a href="#cb107-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2223"><a href="#cb107-2223" aria-hidden="true" tabindex="-1"></a>Above we calculated the sample distances within groups. Let's see what those plots look like.</span>
<span id="cb107-2224"><a href="#cb107-2224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2225"><a href="#cb107-2225" aria-hidden="true" tabindex="-1"></a><span class="fu">## 16S rRNA</span></span>
<span id="cb107-2226"><a href="#cb107-2226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2229"><a href="#cb107-2229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2230"><a href="#cb107-2230" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2231"><a href="#cb107-2231" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_title <span class="ot">&lt;-</span> <span class="st">"FULL (unfiltered)"</span></span>
<span id="cb107-2232"><a href="#cb107-2232" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_title <span class="ot">&lt;-</span> <span class="st">"Arbitrary filtered"</span></span>
<span id="cb107-2233"><a href="#cb107-2233" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_title <span class="ot">&lt;-</span> <span class="st">"PERfect filtered"</span></span>
<span id="cb107-2234"><a href="#cb107-2234" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_title <span class="ot">&lt;-</span> <span class="st">"PIME filtered"</span></span>
<span id="cb107-2235"><a href="#cb107-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2236"><a href="#cb107-2236" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (samp_ps <span class="cf">in</span> ssu18_data_sets) {</span>
<span id="cb107-2237"><a href="#cb107-2237" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot <span class="ot">&lt;-</span> (</span>
<span id="cb107-2238"><a href="#cb107-2238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_wg_jsd_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Within-group"</span>) <span class="sc">+</span></span>
<span id="cb107-2239"><a href="#cb107-2239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_wg_unwei_unifrac_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-2240"><a href="#cb107-2240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_wg_wei_unifrac_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) </span>
<span id="cb107-2241"><a href="#cb107-2241" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">/</span></span>
<span id="cb107-2242"><a href="#cb107-2242" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb107-2243"><a href="#cb107-2243" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_bg_jsd_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)  <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="at">title =</span> <span class="st">"Between-group"</span>) <span class="sc">+</span></span>
<span id="cb107-2244"><a href="#cb107-2244" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_bg_unwei_unifrac_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-2245"><a href="#cb107-2245" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_bg_wei_unifrac_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-2246"><a href="#cb107-2246" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb107-2247"><a href="#cb107-2247" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-2248"><a href="#cb107-2248" aria-hidden="true" tabindex="-1"></a>  tmp_title <span class="ot">&lt;-</span> <span class="fu">paste</span>(samp_ps, <span class="st">"_title"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-2249"><a href="#cb107-2249" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot <span class="ot">&lt;-</span>  tmp_combo_plot <span class="sc">+</span></span>
<span id="cb107-2250"><a href="#cb107-2250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="fu">get</span>(tmp_title),</span>
<span id="cb107-2251"><a href="#cb107-2251" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Treatment-level variation of three distance metrics.'</span>) <span class="sc">+</span></span>
<span id="cb107-2252"><a href="#cb107-2252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">6</span>), <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb107-2253"><a href="#cb107-2253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb107-2254"><a href="#cb107-2254" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb107-2255"><a href="#cb107-2255" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb107-2256"><a href="#cb107-2256" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb107-2257"><a href="#cb107-2257" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb107-2258"><a href="#cb107-2258" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb107-2259"><a href="#cb107-2259" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb107-2260"><a href="#cb107-2260" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb107-2261"><a href="#cb107-2261" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.75</span>)),</span>
<span id="cb107-2262"><a href="#cb107-2262" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>)))</span>
<span id="cb107-2263"><a href="#cb107-2263" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_variation_plots"</span>))</span>
<span id="cb107-2264"><a href="#cb107-2264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_combo_plot_name, tmp_combo_plot)</span>
<span id="cb107-2265"><a href="#cb107-2265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-2266"><a href="#cb107-2266" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-2267"><a href="#cb107-2267" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_me_variation_plots</span>
<span id="cb107-2268"><a href="#cb107-2268" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_plots"</span>)</span>
<span id="cb107-2269"><a href="#cb107-2269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2270"><a href="#cb107-2270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2273"><a href="#cb107-2273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2274"><a href="#cb107-2274" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2275"><a href="#cb107-2275" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_data_sets) {</span>
<span id="cb107-2276"><a href="#cb107-2276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(<span class="st">"files/beta/figures/combo_plots"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-2277"><a href="#cb107-2277" aria-hidden="true" tabindex="-1"></a>  tmp_path <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"files/beta/figures/combo_plots"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-2278"><a href="#cb107-2278" aria-hidden="true" tabindex="-1"></a>  tmp_filename <span class="ot">&lt;-</span> <span class="fu">paste</span>(i, <span class="st">"_variation_plots"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb107-2279"><a href="#cb107-2279" aria-hidden="true" tabindex="-1"></a>  tmp_get_plot <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_variation_plots"</span>)))</span>
<span id="cb107-2280"><a href="#cb107-2280" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_plot, <span class="at">path =</span> tmp_path, <span class="at">filename =</span> <span class="fu">paste</span>(tmp_filename, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">height=</span><span class="dv">26</span>, <span class="at">width=</span><span class="dv">36</span>,</span>
<span id="cb107-2281"><a href="#cb107-2281" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb107-2282"><a href="#cb107-2282" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_plot, <span class="at">path =</span> tmp_path, <span class="at">filename =</span> <span class="fu">paste</span>(tmp_filename, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">height=</span><span class="dv">9</span>, <span class="at">width=</span><span class="dv">12</span>)</span>
<span id="cb107-2283"><a href="#cb107-2283" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb107-2284"><a href="#cb107-2284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2285"><a href="#cb107-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2288"><a href="#cb107-2288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2289"><a href="#cb107-2289" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2290"><a href="#cb107-2290" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/ssu18_ps_work_variation_plots.png include/beta/ssu18_ps_work_variation_plots.png"</span>)</span>
<span id="cb107-2291"><a href="#cb107-2291" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/ssu18_ps_filt_variation_plots.png include/beta/ssu18_ps_filt_variation_plots.png"</span>)</span>
<span id="cb107-2292"><a href="#cb107-2292" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/ssu18_ps_perfect_variation_plots.png include/beta/ssu18_ps_perfect_variation_plots.png"</span>)</span>
<span id="cb107-2293"><a href="#cb107-2293" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/ssu18_ps_pime_variation_plots.png include/beta/ssu18_ps_pime_variation_plots.png"</span>)</span>
<span id="cb107-2294"><a href="#cb107-2294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2295"><a href="#cb107-2295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2296"><a href="#cb107-2296" aria-hidden="true" tabindex="-1"></a>::: {.column-body-outset}</span>
<span id="cb107-2297"><a href="#cb107-2297" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-2298"><a href="#cb107-2298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2299"><a href="#cb107-2299" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL </span></span>
<span id="cb107-2300"><a href="#cb107-2300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2303"><a href="#cb107-2303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2304"><a href="#cb107-2304" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2305"><a href="#cb107-2305" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2306"><a href="#cb107-2306" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2307"><a href="#cb107-2307" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/ssu18_ps_work_variation_plots.png"</span>)</span>
<span id="cb107-2308"><a href="#cb107-2308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2309"><a href="#cb107-2309" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_variation_plots_full")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2310"><a href="#cb107-2310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2311"><a href="#cb107-2311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2312"><a href="#cb107-2312" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary</span></span>
<span id="cb107-2313"><a href="#cb107-2313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2316"><a href="#cb107-2316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2317"><a href="#cb107-2317" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2318"><a href="#cb107-2318" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2319"><a href="#cb107-2319" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2320"><a href="#cb107-2320" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/ssu18_ps_filt_variation_plots.png"</span>)</span>
<span id="cb107-2321"><a href="#cb107-2321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2322"><a href="#cb107-2322" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_variation_plots_filt")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2323"><a href="#cb107-2323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2324"><a href="#cb107-2324" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-2325"><a href="#cb107-2325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2328"><a href="#cb107-2328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2329"><a href="#cb107-2329" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2330"><a href="#cb107-2330" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2331"><a href="#cb107-2331" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2332"><a href="#cb107-2332" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/ssu18_ps_perfect_variation_plots.png"</span>)</span>
<span id="cb107-2333"><a href="#cb107-2333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2334"><a href="#cb107-2334" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_variation_plots_perfect")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2335"><a href="#cb107-2335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2336"><a href="#cb107-2336" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-2337"><a href="#cb107-2337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2340"><a href="#cb107-2340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2341"><a href="#cb107-2341" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2342"><a href="#cb107-2342" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2343"><a href="#cb107-2343" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2344"><a href="#cb107-2344" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/ssu18_ps_pime_variation_plots.png"</span>)</span>
<span id="cb107-2345"><a href="#cb107-2345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2346"><a href="#cb107-2346" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_variation_plots_pime")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2347"><a href="#cb107-2347" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-2348"><a href="#cb107-2348" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-2349"><a href="#cb107-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2350"><a href="#cb107-2350" aria-hidden="true" tabindex="-1"></a><span class="fu">## ITS</span></span>
<span id="cb107-2351"><a href="#cb107-2351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2354"><a href="#cb107-2354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2355"><a href="#cb107-2355" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2356"><a href="#cb107-2356" aria-hidden="true" tabindex="-1"></a>its18_ps_work_title <span class="ot">&lt;-</span> <span class="st">"FULL (unfiltered)"</span></span>
<span id="cb107-2357"><a href="#cb107-2357" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_title <span class="ot">&lt;-</span> <span class="st">"Arbitrary filtered"</span></span>
<span id="cb107-2358"><a href="#cb107-2358" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_title <span class="ot">&lt;-</span> <span class="st">"PERfect filtered"</span></span>
<span id="cb107-2359"><a href="#cb107-2359" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_title <span class="ot">&lt;-</span> <span class="st">"PIME filtered"</span></span>
<span id="cb107-2360"><a href="#cb107-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2361"><a href="#cb107-2361" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (samp_ps <span class="cf">in</span> its18_data_sets) {</span>
<span id="cb107-2362"><a href="#cb107-2362" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot <span class="ot">&lt;-</span> (</span>
<span id="cb107-2363"><a href="#cb107-2363" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_wg_jsd_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Within-group"</span>)<span class="sc">+</span></span>
<span id="cb107-2364"><a href="#cb107-2364" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_wg_bray_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-2365"><a href="#cb107-2365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_wg_gower_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-2366"><a href="#cb107-2366" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">/</span></span>
<span id="cb107-2367"><a href="#cb107-2367" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb107-2368"><a href="#cb107-2368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_bg_jsd_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Between-group"</span>)<span class="sc">+</span></span>
<span id="cb107-2369"><a href="#cb107-2369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_bg_bray_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-2370"><a href="#cb107-2370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_bg_gower_PCoA_mod"</span>))) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-2371"><a href="#cb107-2371" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb107-2372"><a href="#cb107-2372" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-2373"><a href="#cb107-2373" aria-hidden="true" tabindex="-1"></a>  tmp_title <span class="ot">&lt;-</span> <span class="fu">paste</span>(samp_ps, <span class="st">"_title"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-2374"><a href="#cb107-2374" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot <span class="ot">&lt;-</span>  tmp_combo_plot <span class="sc">+</span></span>
<span id="cb107-2375"><a href="#cb107-2375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="fu">get</span>(tmp_title),</span>
<span id="cb107-2376"><a href="#cb107-2376" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Treatment-level variation of three distance metrics.'</span>) <span class="sc">+</span></span>
<span id="cb107-2377"><a href="#cb107-2377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">6</span>), <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb107-2378"><a href="#cb107-2378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb107-2379"><a href="#cb107-2379" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb107-2380"><a href="#cb107-2380" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb107-2381"><a href="#cb107-2381" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb107-2382"><a href="#cb107-2382" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb107-2383"><a href="#cb107-2383" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb107-2384"><a href="#cb107-2384" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb107-2385"><a href="#cb107-2385" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>,</span>
<span id="cb107-2386"><a href="#cb107-2386" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.75</span>)),</span>
<span id="cb107-2387"><a href="#cb107-2387" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>)))</span>
<span id="cb107-2388"><a href="#cb107-2388" aria-hidden="true" tabindex="-1"></a>  tmp_combo_plot_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(samp_ps, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_variation_plots"</span>))</span>
<span id="cb107-2389"><a href="#cb107-2389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_combo_plot_name, tmp_combo_plot)</span>
<span id="cb107-2390"><a href="#cb107-2390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb107-2391"><a href="#cb107-2391" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-2392"><a href="#cb107-2392" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_me_variation_plots</span>
<span id="cb107-2393"><a href="#cb107-2393" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_plots"</span>)</span>
<span id="cb107-2394"><a href="#cb107-2394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2395"><a href="#cb107-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2398"><a href="#cb107-2398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2399"><a href="#cb107-2399" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2400"><a href="#cb107-2400" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_data_sets) {</span>
<span id="cb107-2401"><a href="#cb107-2401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(<span class="st">"files/beta/figures/combo_plots"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-2402"><a href="#cb107-2402" aria-hidden="true" tabindex="-1"></a>  tmp_path <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"files/beta/figures/combo_plots"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb107-2403"><a href="#cb107-2403" aria-hidden="true" tabindex="-1"></a>  tmp_filename <span class="ot">&lt;-</span> <span class="fu">paste</span>(i, <span class="st">"_variation_plots"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb107-2404"><a href="#cb107-2404" aria-hidden="true" tabindex="-1"></a>  tmp_get_plot <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_me_variation_plots"</span>)))</span>
<span id="cb107-2405"><a href="#cb107-2405" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_plot, <span class="at">path =</span> tmp_path, <span class="at">filename =</span> <span class="fu">paste</span>(tmp_filename, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">height=</span><span class="dv">26</span>, <span class="at">width=</span><span class="dv">36</span>,</span>
<span id="cb107-2406"><a href="#cb107-2406" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb107-2407"><a href="#cb107-2407" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_plot, <span class="at">path =</span> tmp_path, <span class="at">filename =</span> <span class="fu">paste</span>(tmp_filename, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">height=</span><span class="dv">9</span>, <span class="at">width=</span><span class="dv">12</span>)</span>
<span id="cb107-2408"><a href="#cb107-2408" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb107-2409"><a href="#cb107-2409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2410"><a href="#cb107-2410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2413"><a href="#cb107-2413" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2414"><a href="#cb107-2414" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2415"><a href="#cb107-2415" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/its18_ps_work_variation_plots.png include/beta/its18_ps_work_variation_plots.png"</span>)</span>
<span id="cb107-2416"><a href="#cb107-2416" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/its18_ps_filt_variation_plots.png include/beta/its18_ps_filt_variation_plots.png"</span>)</span>
<span id="cb107-2417"><a href="#cb107-2417" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/its18_ps_perfect_variation_plots.png include/beta/its18_ps_perfect_variation_plots.png"</span>)</span>
<span id="cb107-2418"><a href="#cb107-2418" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/beta/figures/combo_plots/its18_ps_pime_variation_plots.png include/beta/its18_ps_pime_variation_plots.png"</span>)</span>
<span id="cb107-2419"><a href="#cb107-2419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2420"><a href="#cb107-2420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2421"><a href="#cb107-2421" aria-hidden="true" tabindex="-1"></a>::: {.column-body-outset}</span>
<span id="cb107-2422"><a href="#cb107-2422" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb107-2423"><a href="#cb107-2423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2424"><a href="#cb107-2424" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FULL </span></span>
<span id="cb107-2425"><a href="#cb107-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2428"><a href="#cb107-2428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2429"><a href="#cb107-2429" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2430"><a href="#cb107-2430" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2431"><a href="#cb107-2431" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2432"><a href="#cb107-2432" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/its18_ps_work_variation_plots.png"</span>)</span>
<span id="cb107-2433"><a href="#cb107-2433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2434"><a href="#cb107-2434" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_variation_plots_full")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2435"><a href="#cb107-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2436"><a href="#cb107-2436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2437"><a href="#cb107-2437" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arbitrary </span></span>
<span id="cb107-2438"><a href="#cb107-2438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2441"><a href="#cb107-2441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2442"><a href="#cb107-2442" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2443"><a href="#cb107-2443" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2444"><a href="#cb107-2444" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2445"><a href="#cb107-2445" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/its18_ps_filt_variation_plots.png"</span>)</span>
<span id="cb107-2446"><a href="#cb107-2446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2447"><a href="#cb107-2447" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_variation_plots_filt")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2448"><a href="#cb107-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2449"><a href="#cb107-2449" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PERfect</span></span>
<span id="cb107-2450"><a href="#cb107-2450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2453"><a href="#cb107-2453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2454"><a href="#cb107-2454" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2455"><a href="#cb107-2455" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2456"><a href="#cb107-2456" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2457"><a href="#cb107-2457" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/its18_ps_perfect_variation_plots.png"</span>)</span>
<span id="cb107-2458"><a href="#cb107-2458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2459"><a href="#cb107-2459" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_variation_plots_perfect")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2460"><a href="#cb107-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2461"><a href="#cb107-2461" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PIME</span></span>
<span id="cb107-2462"><a href="#cb107-2462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2465"><a href="#cb107-2465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2466"><a href="#cb107-2466" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2467"><a href="#cb107-2467" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2468"><a href="#cb107-2468" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb107-2469"><a href="#cb107-2469" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/beta/its18_ps_pime_variation_plots.png"</span>)</span>
<span id="cb107-2470"><a href="#cb107-2470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2471"><a href="#cb107-2471" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_variation_plots_pime")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb107-2472"><a href="#cb107-2472" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-2473"><a href="#cb107-2473" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb107-2474"><a href="#cb107-2474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2477"><a href="#cb107-2477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2478"><a href="#cb107-2478" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2479"><a href="#cb107-2479" aria-hidden="true" tabindex="-1"></a><span class="co">#objects()</span></span>
<span id="cb107-2480"><a href="#cb107-2480" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(ssu18_ps_filt, ssu18_ps_work, ssu18_ps_perfect, ssu18_ps_pime)</span></span>
<span id="cb107-2481"><a href="#cb107-2481" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"page_build/beta_wf_part_2.rdata"</span>)</span>
<span id="cb107-2482"><a href="#cb107-2482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2483"><a href="#cb107-2483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2486"><a href="#cb107-2486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2487"><a href="#cb107-2487" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb107-2488"><a href="#cb107-2488" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2489"><a href="#cb107-2489" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb107-2490"><a href="#cb107-2490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2491"><a href="#cb107-2491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2492"><a href="#cb107-2492" aria-hidden="true" tabindex="-1"></a><span class="fu"># Workflow Output </span></span>
<span id="cb107-2493"><a href="#cb107-2493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2494"><a href="#cb107-2494" aria-hidden="true" tabindex="-1"></a>Data products generated in this workflow can be downloaded from figshare.</span>
<span id="cb107-2495"><a href="#cb107-2495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2496"><a href="#cb107-2496" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://widgets.figshare.com/articles/16828063/embed?show_title=1"</span> <span class="er">width</span><span class="ot">=</span><span class="st">"100%"</span> <span class="er">height</span><span class="ot">=</span><span class="st">"251"</span> <span class="er">allowfullscreen</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">"0"</span><span class="kw">&gt;&lt;/iframe&gt;</span></span>
<span id="cb107-2497"><a href="#cb107-2497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2498"><a href="#cb107-2498" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/br&gt;</span></span>
<span id="cb107-2499"><a href="#cb107-2499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2500"><a href="#cb107-2500" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"da.html"</span> <span class="er">class</span><span class="ot">=</span><span class="st">"btnnav button_round"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"float: right;"</span><span class="kw">&gt;</span>Next workflow:</span>
<span id="cb107-2501"><a href="#cb107-2501" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span> 7. Differentially Abundant ASVs &amp; Taxa<span class="kw">&lt;/a&gt;</span></span>
<span id="cb107-2502"><a href="#cb107-2502" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"alpha.html"</span> <span class="er">class</span><span class="ot">=</span><span class="st">"btnnav button_round"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"float: left;"</span><span class="kw">&gt;</span>Previous workflow:</span>
<span id="cb107-2503"><a href="#cb107-2503" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span> 5. Alpha Diversity Estimates<span class="kw">&lt;/a&gt;&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb107-2504"><a href="#cb107-2504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2507"><a href="#cb107-2507" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2508"><a href="#cb107-2508" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb107-2509"><a href="#cb107-2509" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb107-2510"><a href="#cb107-2510" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2511"><a href="#cb107-2511" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2512"><a href="#cb107-2512" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb107-2513"><a href="#cb107-2513" aria-hidden="true" tabindex="-1"></a><span class="do">### COmmon formatting scripts</span></span>
<span id="cb107-2514"><a href="#cb107-2514" aria-hidden="true" tabindex="-1"></a><span class="do">### </span><span class="al">NOTE</span><span class="do">: captioner.R must be read BEFORE captions_XYZ.R</span></span>
<span id="cb107-2515"><a href="#cb107-2515" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">file.path</span>(<span class="st">"assets"</span>, <span class="st">"functions.R"</span>))</span>
<span id="cb107-2516"><a href="#cb107-2516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-2517"><a href="#cb107-2517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2518"><a href="#cb107-2518" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Source Code {.appendix}</span></span>
<span id="cb107-2519"><a href="#cb107-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2520"><a href="#cb107-2520" aria-hidden="true" tabindex="-1"></a>The source code for this page can be accessed on GitHub <span class="in">`r fa(name = "github")`</span> by <span class="co">[</span><span class="ot">clicking this link</span><span class="co">]</span>(<span class="in">`r source_code()`</span>). </span>
<span id="cb107-2521"><a href="#cb107-2521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2522"><a href="#cb107-2522" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data Availability {.appendix}</span></span>
<span id="cb107-2523"><a href="#cb107-2523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2524"><a href="#cb107-2524" aria-hidden="true" tabindex="-1"></a>Data generated in this workflow and the Rdata need to run the workflow can be accessed on figshare at <span class="co">[</span><span class="ot">10.25573/data.16828063</span><span class="co">](https://doi.org/10.25573/data.16828063)</span>.</span>
<span id="cb107-2525"><a href="#cb107-2525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2526"><a href="#cb107-2526" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Last updated on {.appendix}</span></span>
<span id="cb107-2527"><a href="#cb107-2527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-2530"><a href="#cb107-2530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb107-2531"><a href="#cb107-2531" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb107-2532"><a href="#cb107-2532" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb107-2533"><a href="#cb107-2533" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span>
<span id="cb107-2534"><a href="#cb107-2534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">© Copyright 2022 <a href="https://metacrobe.github.io/">metacrobe</a> &amp; The SWELTR Project. Site constructed using <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>