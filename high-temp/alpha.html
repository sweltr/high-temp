<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>sweltr: 6 Alpha Diversity Estimates</title>


  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>


  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="sweltr: 6 Alpha Diversity Estimates"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="sweltr"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="sweltr: 6 Alpha Diversity Estimates"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Hilldiv: An r package for the integral analysis of diversity based on hill numbers;citation_publication_date=2019;citation_author=Antton Alberdi;citation_author=M Thomas P Gilbert"/>
  <meta name="citation_reference" content="citation_title=A guide to the application of hill numbers to DNA-based diversity analyses;citation_publication_date=2019;citation_volume=19;citation_author=Antton Alberdi;citation_author=M Thomas P Gilbert"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","descriptiokabn","bibliography","output"]}},"value":[{"type":"character","attributes":{},"value":["6 Alpha Diversity Estimates"]},{"type":"character","attributes":{},"value":["Reproducible workflow for ... In this workflow, ....\n"]},{"type":"character","attributes":{},"value":["assets/cite.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["css","toc","toc_depth"]}},"value":[{"type":"character","attributes":{},"value":["assets/styles.css"]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
  <script src="site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
  <link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
  <script src="site_libs/datatables-binding-0.18/datatables.js"></script>
  <link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
  <link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
  <script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
  <script src="site_libs/jszip-1.10.20/jszip.min.js"></script>
  <link href="site_libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
  <script src="site_libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
  <script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
  <script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
  <script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
  <script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
  <link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
  <script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
  <link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
  <script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
  <link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
  <script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <style type="text/css">
  /* Whole document: */
  @import url('https://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|Lato:300|Roboto:300|Nunito+Sans:300|Inconsolata|Source+Sans+Pro|Work+Sans:200,300,400,500');
  /********************************/
  /* controls general properties of site*/
  /********************************/

  body {
    color: #414141;
  /*  line-height: 1.7;
    font-size: 17px; */
    font-family: 'Open Sans', 'Source Sans Pro', 'PT Sans';
    background-color: #FEFEFE;
  }

  d-title h1{
  font-size: 2.1em;
  font-family: 'Work Sans';
  font-weight: 300;
  }

  d-article h1 {
    font-size: 1.8em;
    font-family: 'Open Sans', 'Source Sans Pro', 'PT Sans';
    font-weight: 300;
  }

  d-article h2 {
    font-size: 1.65em;
    font-family: 'Open Sans', 'Source Sans Pro', 'PT Sans';
    font-weight: 500;
  }

  d-article h3 {
    font-family: 'Open Sans', 'Source Sans Pro', 'PT Sans';
    margin-top: 1em;
  }

  d-article p {
    font-size: 18px;
    font-family: 'Open Sans', 'Source Sans Pro', 'PT Sans';
  }

  d-byline .authors-affiliations {
    grid-column-end: span 3;
    grid-column-gap: 8px;
  }

  img.orcid-id {
    margin: 0;
  }

  a.name:-webkit-any-link {
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  a.affiliation:-webkit-any-link {
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  blockquote p {
  	font-size: 1.3em;
  	font-family: 'Lato';
    font-style: normal;
    margin: 0.5em 0 0.5em;
  }

  d-article li {
    margin: 0px 0px 4px;
    font-size: 18px;
    font-family: 'Open Sans', 'Source Sans Pro', 'PT Sans';
  }

  /********************************/
  /* controls CODE*/
  /********************************/

  /** pre.sourceCode controls code block without lang **/

  /** Controls r code  **/

  pre.sourceCode.r {
    margin-top: 0px;
     color: #333333;
     background-color: #E8E8E8;
     border-radius: 3px;
     font-size: 0.80em;
     font-family: 'Monaco', 'PT Mono', monospace;
     overflow-x: scroll !important;
     border-left: 6px solid #323232;
     border-top: 1px solid #B7B7B7;
     border-right: 1px solid #B7B7B7;
     border-bottom: 1px solid #B7B7B7;
     padding: 18px 0px 18px 20px;
   }

   pre.sourceCode.bash {
     margin-top: 0px;
      color: #333333;
      background-color: #E8E8E8;
      border-radius: 3px;
      font-size: 0.80em;
      font-family: 'Monaco', 'PT Mono', monospace;
      overflow-x: scroll !important;
      border-left: 6px solid #FC6464;
      border-top: 1px solid #B7B7B7;
      border-right: 1px solid #B7B7B7;
      border-bottom: 1px solid #B7B7B7;
      padding: 18px 0px 18px 20px;
    }
  /** Controls code output **/

  d-article pre {
     margin-top: 0px;
      color: #333333;
      background-color: #FAFAFA;
      font-size: 0.8em;
      border: 1px solid #ccc;
      overflow-x: scroll !important;
      padding:  10px 10px 10px 18px;
      border-radius: 5px;

    }

  /** Controls inline code  **/

  p code {
    background-color: #E8E8E8;
    border-radius: 3px;
    font-size: 0.8em;
    font-family: 'Monaco', 'PT Mono', monospace;
    overflow-x: scroll !important;
    margin-bottom: 20px;
    color: #BF2727;
  }

  d-article aside code {
    background-color: #E8E8E8;
    border-radius: 3px;
    font-family: 'Monaco', 'PT Mono', monospace;
    color: #BF2727;
  }

  /********************************/
  /* controls NAV BAR and HEADERS*/
  /********************************/

  .nav-dropdown-content .nav-dropdown-header {
    text-transform: none;
  }

  .distill-site-header .logo img {
    margin-top: 10px;
    max-height: 30px;
    margin-bottom: 10px;
  }

  .distill-site-nav {
      background-color: #323232;
      font-size: 16px;
      font-weight: 300;
  }

  img {
    margin: 5px;
  }

  /** LIGHTBOX MARKUP **/
  .thumbnail {
    max-width: 100%;
    position: relative;
  }

  /** DETAILS fold down**/

  details {
    background-color: hsla(206, 95%, 20%, 0.2);
    cursor: pointer;
    color: #2d2d2d;
    margin-bottom:1vh;
    padding: 1em;
    border: none;
    text-align: left;
    outline: none;
  }

  .active, details:hover {
    transition: max-height 0.2s ease-out;
    outline: none;

    /* background-color: #acc2c2; */
  }


  details {
    display: flex;
    justify-content: space-between;
    align-content: center;
    border-radius: 4px;
    outline: none;

  }

  details.active {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    outline: none;

  }

  summary::-webkit-details-marker {
    display: none;
    outline: none;

  }
  summary:focus {
    outline: none;
  }
  summary::after {
    float: right;
    font-family: "Font Awesome 5 Free";
    content: "\f0fe";
  }

  details[open] summary::after {
    float: right;
    font-family: "Font Awesome 5 Free";
    content: "\f146";
  }

  </style>
  <!--/radix_placeholder_site_in_header-->

  <link rel="stylesheet" href="assets/styles.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"6 Alpha Diversity Estimates","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title"></a>
<a href="index.html">
<i class="fa fa-home" aria-hidden="true"></i>
</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
A. Processing Workflows
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="dada2.html">1. DADA2</a>
<a href="data-prep.html">2. Data Set Prep</a>
<a href="otu.html">3. OTU Clustering</a>
<hr/>
<span class="nav-dropdown-header">Filtering</span>
<a href="pime.html">4a. PIME Filtering</a>
<a href="perfect.html">4b. PERFect Filtering</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
B. Diversity Workflows
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="taxa.html">5. Taxonomic</a>
<a href="alpha.html">6. Alpha Diversity</a>
<a href="beta.html">7. Beta Diversity</a>
<a href="da.html">8. DA ASVs &amp; OTUs</a>
<a href="metadata.html">9. Metadata</a>
</div>
</div>
</div>
<div class="nav-right">
<a href="temp.html">Data</a>
<a href="https://github.com/sweltr/high-temp/">
<i class="fa fa-github fa-lg" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>6 Alpha Diversity Estimates</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#synopsis">Synopsis</a></li>
<li><a href="#s-rrna">16s rRNA</a>
<ul>
<li><a href="#read-distribution">Read Distribution</a>
<ul>
<li><a href="#histogram-of-read-counts">Histogram of Read Counts</a></li>
<li><a href="#rarefaction-curves">Rarefaction Curves</a></li>
</ul></li>
<li><a href="#alpha-diversity">Alpha Diversity</a>
<ul>
<li><a href="#calculate-hill-numbers">Calculate Hill Numbers</a></li>
<li><a href="#sample-summary">Sample Summary</a></li>
<li><a href="#asv-hill-summary">ASV Hill Summary</a></li>
<li><a href="#otu-hill-summary">OTU Hill Summary</a></li>
<li><a href="#normality-tests">Normality Tests</a></li>
<li><a href="#significance-tests">Significance Tests</a></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#posthoc-analyses-asv-data-sets">PostHoc Analyses (ASV data sets)</a></li>
<li><a href="#posthoc-analyses-otu-data-sets">PostHoc Analyses (OTU data sets)</a></li>
<li><a href="#alpha-diversity-plots">Alpha Diversity Plots</a></li>
</ul></li>
</ul></li>
<li><a href="#its">ITS</a>
<ul>
<li><a href="#read-distribution-1">Read Distribution</a>
<ul>
<li><a href="#histogram-of-read-counts-1">Histogram of Read Counts</a></li>
<li><a href="#rarefaction-curves-1">Rarefaction Curves</a></li>
</ul></li>
<li><a href="#alpha-diversity-1">Alpha Diversity</a>
<ul>
<li><a href="#calculate-hill-numbers-1">Calculate Hill Numbers</a></li>
<li><a href="#sample-summary-1">Sample Summary</a></li>
<li><a href="#asv-hill-summary-1">ASV Hill Summary</a></li>
<li><a href="#otu-hill-summary-1">OTU Hill Summary</a></li>
<li><a href="#normality-tests-1">Normality Tests</a></li>
<li><a href="#significance-tests-1">Significance Tests</a></li>
<li><a href="#posthoc-analyses-asv-data-sets-1">PostHoc Analyses (ASV data sets)</a></li>
<li><a href="#posthoc-analyses-otu-data-sets-1">PostHoc Analyses (OTU data sets)</a></li>
<li><a href="#alpha-diversity-plots-1">Alpha Diversity Plots</a></li>
</ul></li>
<li><a href="#source-code">Source Code</a></li>
</ul></li>
</ul>
</nav>
</div>
<details>
<summary>
Click here for setup information.
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">eval =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(conflicted)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq); <span class="fu">packageVersion</span>(<span class="st">&quot;phyloseq&quot;</span>)</span></code></pre></div>
<pre><code>[1] &#39;1.34.0&#39;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biostrings); <span class="fu">packageVersion</span>(<span class="st">&quot;Biostrings&quot;</span>)</span></code></pre></div>
<pre><code>[1] &#39;2.58.0&#39;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, DT, ampvis2, hilldiv, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>               microbiome, phytools, phangorn, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>               pairwiseAdonis, codefolder, naniar, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>               labdsv, patchwork, agricolae, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">install =</span> <span class="cn">FALSE</span>, <span class="at">update =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_depends(agricolae, local = TRUE)  </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_depends_reverse(agricolae, local = TRUE)  </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;hack_code/div_test_plot_jjs.R&quot;</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;hack_code/div_test_jjs.R&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_current<span class="sc">$</span><span class="fu">get</span>(<span class="fu">c</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;cache&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;cache.path&quot;</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;cache.rebuild&quot;</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;dependson&quot;</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;autodep&quot;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>$cache
[1] 0

$cache.path
[1] &quot;alpha_cache/html5/&quot;

$cache.rebuild
[1] FALSE

$dependson
NULL

$autodep
[1] FALSE</code></pre>
</div>
</details>
<p></br></p>
<blockquote>
<p>Hit the <em>Show Code</em> button to show the R code (hidden by default).</p>
</blockquote>
<aside>
<div class="layout-chunk" data-layout="l-body">
<input onclick="codefolder(&#39;pre.sourceCode&#39;);" type="button" value="Hide Code" id="codefolder-button" style="position: absolute; right: 14%; z-index: 200"/>
<script>
  function codefolder(query) {

    var x = document.querySelectorAll(query);
    if (x.length === 0) return;

    function toggle_vis(o) {
      var d = o.style.display;
      o.style.display = (d === 'block' || d === '') ? 'none':'block';
    }

    for (i = 0; i < x.length; i++) {
      var y = x[i];
      toggle_vis(y);
    }

    var elem = document.getElementById("codefolder-button");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
  }
</script>
</div>
</aside>
<h1 id="synopsis">Synopsis</h1>
<p>This workflow contains diversity assessments for the 2018 high temperature data sets. In order to run the workflow, you either need to first run the <a href="dada2.html">DADA2 Workflow for 2018 High Temp samples</a> <strong>and</strong> the <a href="data-prep.html">Data Preparation workflow</a> <strong>or</strong> begin with the output files from the Data Preparation workflow. See the <a href="data-availability.html">Data Availability</a> page for complete details.</p>
<p>In this workflow</p>
<h1 id="s-rrna">16s rRNA</h1>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="read-distribution">Read Distribution</h2>
<h3 id="histogram-of-read-counts">Histogram of Read Counts</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ssu18_max <span class="ot">&lt;-</span> <span class="fu">max</span>(ssu18_samp_data<span class="sc">$</span>total_reads) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">max</span>(ssu18_samp_data<span class="sc">$</span>total_reads))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ssu18_p_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ssu18_samp_data,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(ssu18_samp_data<span class="sc">$</span>total_reads)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, ssu18_max, <span class="at">by =</span> <span class="dv">5000</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of total reads&quot;</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> <span class="st">&quot;Bin width equals 5000 reads&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;No. of reads&quot;</span>, <span class="at">y =</span> <span class="st">&quot;No. of samples&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="alpha_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<h3 id="rarefaction-curves">Rarefaction Curves</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ssu18_rare_curve1 <span class="ot">&lt;-</span> <span class="fu">amp_rarecurve</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  ssu18_amp_data,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1000</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_by =</span> <span class="st">&quot;TEMP&quot;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="alpha_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>For a quick comparison, we can facet the above data by Temperature.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ssu18_rare_curve2 <span class="ot">&lt;-</span> <span class="fu">amp_rarecurve</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  ssu18_amp_data,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1000</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_by =</span> <span class="st">&quot;TEMP&quot;</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet_by =</span> <span class="st">&quot;TEMP&quot;</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet_scales =</span> <span class="st">&quot;free&quot;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="alpha_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p>In the <strong>full data set</strong>, there was a minimum read count of 25088, a median of 62117 reads, and a maximum of 86600 reads.</p>
<p>After <strong>PIME</strong> filtering, there was a minimum read count of 10585, a median of 10585 reads, and a maximum of 10585 reads</p>
<p>After <strong>PERfect</strong> filtering, there was a minimum read count of 16697, a median of 50241 reads, and a maximum of 71026 reads</p>
<h2 id="alpha-diversity">Alpha Diversity</h2>
<p>To account for presence of rare sequence variants caused by sequencing errors or other technical artifacts, we use Hill numbers <span class="citation" data-cites="alberdi2019guide">(<a href="#ref-alberdi2019guide" role="doc-biblioref">Alberdi and Gilbert 2019a</a>)</span>. Hill numbers allow the weight put on rare versus abundant sequence variants to be scaled while providing intuitive comparisons of diversity levels using effective number of ASVs as a measuring unit. This approach allows for balancing the over representation of rare ASVs that might be inflated due to sequencing errors.</p>
<p>We will then use Shapiro-Wilk tests to test for normalcy and then, depending on the results, either use parametric ANOVA or non-parametric Kruskal-Wallis to compare alpha diversity among treatments.</p>
<h3 id="calculate-hill-numbers">Calculate Hill Numbers</h3>
<p>To calculate Hill numbers, we use the R package <code>hilldiv</code> <span class="citation" data-cites="alberdi2019hilldiv">(<a href="#ref-alberdi2019hilldiv" role="doc-biblioref">Alberdi and Gilbert 2019b</a>)</span>. We calculate three metrics that put more or less weight on common species:</p>
<ol type="1">
<li>Observed richness, where <code>q-value = 0</code>.</li>
<li>Shannon exponential, which weighs ASVs by their frequency, where <code>q-value = 1</code>.</li>
<li>Simpson multiplicative inverse, which over weighs abundant ASVs, where <code>q-value = 2</code>.</li>
</ol>
<p>We perform each analysis against the full data set, the PIME filtered data set, and the PERfect filtered data set using the function <code>hill_div</code>.</p>
<p>The command is as follows:</p>
<p><code>hill_div(count = x, qvalue = i, tree = ultrametric_tree)</code>, where <code>x</code> is the sample by ASV table, <code>i</code> is the q-value corresponding to the metric of interest and <code>tree</code> is an ultrametric formatted phylogenetic tree (see below).</p>
<p>We first transform all the data to relative abundance values, and compute new trees.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu18_ps_work&quot;</span>, <span class="st">&quot;ssu18_ps_pime&quot;</span>, <span class="st">&quot;ssu18_ps_perfect&quot;</span>, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;ssu18_ps_work_otu&quot;</span>, <span class="st">&quot;ssu18_ps_pime_otu&quot;</span>, <span class="st">&quot;ssu18_ps_perfect_otu&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_otu<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_otu<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_otu<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  tmp_ps &lt;- transform_sample_counts(get(i), function(otu) 1e5 otu/sum(otu))</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(<span class="fu">get</span>(i), <span class="cf">function</span>(otu) otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  tmp_ps_norm <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_ps_norm)))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_norm&quot;</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name, tmp_ps_norm)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_asv_name, tmp_asv)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span></code></pre></div>
</div>
<h4 id="no-phylogenetic-tree">No phylogenetic tree</h4>
<p>Next, we run the analysis for all three metrics on the data sets without a tree.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;tmp_name&quot;</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SamName&quot;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h&quot;</span>, i))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_h&quot;</span>)</span></code></pre></div>
</div>
<p>And make summary tables to add back into each <code>ps</code> object.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h0&quot;</span>)))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h1&quot;</span>)))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h2&quot;</span>)))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Observed&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Shannon_exp&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;InvSimpson&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_hill&quot;</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_hill&quot;</span>)</span></code></pre></div>
</div>
<p>And then create the new objects with the diversity data.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="with-a-phylogenetic-tree">With a phylogenetic tree</h4>
<p>We can also run the tests using the phylogenetic tree to assess <strong>lineage</strong> diversity rather than ASV diversity for the filtered data sets. We do a quick check to ensure the ASV names in the ASV table and the tip names in the new phylogenetic tree are identical.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i, j)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu18_ps_pime&quot;</span>, <span class="st">&quot;ssu18_ps_pime_otu&quot;</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;ssu18_ps_perfect&quot;</span>, <span class="st">&quot;ssu18_ps_perfect_otu&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> ssu18_alpha_ds_tree) {</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>)))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i, <span class="at">tree =</span> tmp_tree))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;tmp_name&quot;</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SamName&quot;</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht&quot;</span>, i))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree_pime <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu18_ps_pime&quot;</span>, <span class="st">&quot;ssu18_ps_pime_otu&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree_pime) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht0&quot;</span>)))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht1&quot;</span>)))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht2&quot;</span>)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Observed_pit&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Shannon_exp_pit&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;InvSimpson_pit&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_hill_t&quot;</span>))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree_perfect <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu18_ps_perfect&quot;</span>, <span class="st">&quot;ssu18_ps_perfect_otu&quot;</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree_perfect) {</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht0&quot;</span>)))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht1&quot;</span>)))</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht2&quot;</span>)))</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Observed_pet&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Shannon_exp_pet&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;InvSimpson_pet&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_hill_t&quot;</span>))</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="sample-summary">Sample Summary</h3>
<p>Now we summarize the data for each sample against all three metrics. The table contains the results of ASV diversity estimates from the full data set and the PIME filtered data set, as well as the lineage diversity from the PIME data set.</p>
<p>The suffix <code>_pi</code> indicates metrics for the PIME data set and the suffix <code>_pit</code> indicates the lineage diversity for the PIME data set.</p>
<p>The suffix <code>_pe</code> indicates metrics for the PERfect data set and the suffix <code>_pet</code> indicates the lineage diversity for the PERfect data set.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="asv-hill-summary">ASV Hill Summary</h3>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<div id="ldbyiw77yhl3z0epbzg8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="ldbyiw77yhl3z0epbzg8">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"813\" data-max=\"3065\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"170\" data-max=\"664\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"332\" data-max=\"857\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"67.1103653272874\" data-max=\"156.765669763409\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"97.864970931352\" data-max=\"179.678022554991\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"236.052181157244\" data-max=\"1098.37442252987\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"47.8809144738881\" data-max=\"331.326161395686\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"14.886441233417\" data-max=\"34.1876455829572\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"126.483978231041\" data-max=\"481.285523949896\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"19.6907491121722\" data-max=\"32.5136331218508\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"25.5363832105844\" data-max=\"427.59074783731\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"9.6411370581627\" data-max=\"174.7432309287\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"5.61123845855918\" data-max=\"10.399781487563\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"18.5068307462522\" data-max=\"231.431356942513\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"6.36290948453117\" data-max=\"9.38021629764388\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"caption":"<caption style=\"caption-side: bottom; text-align: left;\">\n  Table: \n  <em>Sample summary table including\n            ASV diversity indices for FULL and PIME filtered data.\n            Use the buttons to navigate through the table or\n            download a copy.<\/em>\n<\/caption>","data":[["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],["00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010"],["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],[2371,1610,2272,2356,1575,2040,1663,2124,3065,2010,2157,2441,2386,813,2066],[502,322,590,596,224,570,499,289,664,516,276,594,563,170,491],[707,563,737,764,411,663,574,661,857,725,671,681,751,332,571],[134.884328757936,102.085583069872,146.772980072512,147.056599001552,80.6955350868519,142.350209136136,130.43286871787,95.3741091237807,156.765669763409,136.464780619863,93.1128961637023,144.29616086822,142.767941544315,67.1103653272874,131.743926230565],[159.667786883115,138.932939654709,164.422294738343,167.795192127753,116.937183800965,150.950684271113,139.874236432496,154.130332893512,179.678022554991,164.191914893234,156.393092240737,157.674328632861,166.50650974809,97.864970931352,139.457863927935],[760.745300613305,236.052181157244,781.137266928522,686.756310794732,501.000130356145,797.838416278312,578.836487117878,307.254995944644,1098.37442252987,598.825972134675,560.777089413923,973.301170130139,680.058754112726,375.290206763155,886.758805170951],[226.326260450783,59.2228535837285,291.157247903551,234.951976792399,90.0876963490191,309.249161155079,246.146114386488,47.8809144738881,324.743154259934,208.037692357758,88.1472336037074,331.326161395686,224.415552678798,67.8500978337736,298.287677220408],[30.7674718227473,16.6348374058699,33.1438777069153,30.7921995531924,22.4253689275057,33.9742419080606,32.0281768577874,14.886441233417,33.8810691171695,29.5575109547844,20.9332779185554,34.1876455829571,30.028340965042,19.4520265313087,33.8264367105064],[353.42457863537,126.483978231041,397.367118131181,337.27108709024,211.87480620728,388.375328096481,299.19770176643,146.893596804706,481.285523949897,327.472572623565,270.338821687756,419.804603132439,334.505326249644,149.92136180941,379.432237907266],[29.8002041634889,19.6907491121722,31.0471238656161,29.4917235513396,27.1161875802655,30.5381477669797,29.2521686019154,20.7369274171181,32.5136331218508,29.3845308694223,26.9207137675655,31.9184337112537,29.9005213301539,23.2863627476581,31.1420701916372],[200.296464625358,25.5363832105844,261.494627066664,159.361463852878,153.260998536647,272.046815705854,201.167681089235,27.3429280119678,309.410335537549,146.754694832416,91.5064685353865,394.228114006766,168.524614667152,120.154642123401,427.59074783731],[84.2064480397769,12.0084510790169,129.323125643342,75.7816838059007,38.6349622182354,130.669694932272,110.956201395504,9.64113705816271,120.612504574387,67.5192935920804,24.4467302108243,168.74191895782,76.4841803918449,26.3604265015369,174.7432309287],[9.69130618349076,6.22102498056269,9.95274920313542,9.93351260773769,9.15897938548672,10.399781487563,10.1106335574336,5.61123845855918,10.0082689514925,9.56259584431773,7.78681994367373,10.031803924791,9.60318381189014,8.46351611426415,10.0960815612405],[123.617061625401,19.1172052771354,171.567337175768,103.836276324414,82.5813684361664,166.803575148949,132.562579111329,18.5068307462522,179.711656432322,99.6919626053022,60.175681507109,220.521973136055,109.448977006215,56.7970872297023,231.431356942513],[8.82860911387874,6.36290948453117,9.1594807457187,9.041613237572,9.31210091360053,8.9080490229932,9.18753420279291,6.44488488107998,9.12911752046758,8.99667282319975,8.14596096079628,9.38021629764388,9.30149558525162,8.19919393702038,9.07926129098155]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>sample_id<\/th>\n      <th>PLOT<\/th>\n      <th>DEPTH<\/th>\n      <th>TREAT<\/th>\n      <th>TEMP<\/th>\n      <th>PAIR<\/th>\n      <th>Observed<\/th>\n      <th>Observed_pi<\/th>\n      <th>Observed_pe<\/th>\n      <th>Observed_pit<\/th>\n      <th>Observed_pet<\/th>\n      <th>Shannon_exp<\/th>\n      <th>Shannon_exp_pi<\/th>\n      <th>Shannon_exp_pit<\/th>\n      <th>Shannon_exp_pe<\/th>\n      <th>Shannon_exp_pet<\/th>\n      <th>InvSimpson<\/th>\n      <th>InvSimpson_pi<\/th>\n      <th>InvSimpson_pit<\/th>\n      <th>InvSimpson_pe<\/th>\n      <th>InvSimpson_pet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"Blfrtip","buttons":["copy","csv","excel"],"pageLength":5,"lengthMenu":[[5,-1],["5","All"]],"columnDefs":[{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'80%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'80%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'80%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'80%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'80%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'80%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'80%'});\nvar value=data[7]; $(this.api().cell(row, 7).node()).css({'font-size':'80%'});\nvar value=data[8]; $(this.api().cell(row, 8).node()).css({'font-size':'80%'});\nvar value=data[9]; $(this.api().cell(row, 9).node()).css({'font-size':'80%'});\nvar value=data[10]; $(this.api().cell(row, 10).node()).css({'font-size':'80%'});\nvar value=data[11]; $(this.api().cell(row, 11).node()).css({'font-size':'80%'});\nvar value=data[12]; $(this.api().cell(row, 12).node()).css({'font-size':'80%'});\nvar value=data[13]; $(this.api().cell(row, 13).node()).css({'font-size':'80%'});\nvar value=data[14]; $(this.api().cell(row, 14).node()).css({'font-size':'80%'});\nvar value=data[15]; $(this.api().cell(row, 15).node()).css({'font-size':'80%'});\nvar value=data[16]; $(this.api().cell(row, 16).node()).css({'font-size':'80%'});\nvar value=data[17]; $(this.api().cell(row, 17).node()).css({'font-size':'80%'});\nvar value=data[18]; $(this.api().cell(row, 18).node()).css({'font-size':'80%'});\nvar value=data[19]; $(this.api().cell(row, 19).node()).css({'font-size':'80%'});\nvar value=data[20]; $(this.api().cell(row, 20).node()).css({'font-size':'80%'});\n}"}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.rowCallback"],"jsHooks":[]}</script>
</div>
<h3 id="otu-hill-summary">OTU Hill Summary</h3>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<div id="cq9rn3363xwmkpwkl5e5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="cq9rn3363xwmkpwkl5e5">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"707\" data-max=\"2796\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"280\" data-max=\"834\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"478\" data-max=\"1116\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"89.7224172389249\" data-max=\"177.590807083155\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"142.991632224784\" data-max=\"236.817310335605\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"159.59669413073\" data-max=\"765.644770835946\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"70.531160814394\" data-max=\"346.978529444445\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"17.1375057279479\" data-max=\"32.2691905421839\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"113.081045040247\" data-max=\"479.26925568535\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"21.6862658104601\" data-max=\"37.6766806279\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"22.4844428237002\" data-max=\"280.350703804235\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"13.4995965197572\" data-max=\"181.313429763733\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"6.10883671983997\" data-max=\"9.13032707383519\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"19.6482993064969\" data-max=\"215.457347210311\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"7.02348617769601\" data-max=\"9.17552275104931\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"caption":"<caption style=\"caption-side: bottom; text-align: left;\">\n  Table: \n  <em>Sample summary table including\n            OTU diversity indices for FULL and PIME filtered data.\n            Use the buttons to navigate through the table or\n            download a copy.<\/em>\n<\/caption>","data":[["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],["00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010"],["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],[2170,1463,2089,2131,1454,1895,1543,1948,2796,1839,2003,2254,2158,707,1923],[662,441,766,751,362,731,629,432,834,658,409,753,692,280,659],[911,687,963,978,616,850,759,802,1116,872,848,908,941,478,790],[153.729104175987,119.080485549851,168.243595544439,165.177589485148,106.377333409073,164.133358674799,149.207485765325,118.03876312692,177.590807083155,153.73599248752,114.373376984261,167.105803208701,158.43095884016,89.7224172389249,154.329623865278],[208.404780410255,176.02006420936,214.386003386982,217.722518963537,165.025270930962,198.930685570317,187.69314960333,194.714792061004,236.817310335604,202.419292365651,199.837809077796,210.277922750679,214.504834924031,142.991632224784,190.004006657551],[494.918366669988,159.596694130731,519.524148722087,445.185553949597,364.5438327751,595.321489064865,405.539305850927,222.931241629657,765.644770835946,395.679301765228,399.475419355206,681.574921194103,409.899462758239,292.407611385825,656.134793344756],[232.132492078145,78.3550936181672,285.029129644749,234.775633895311,124.33273738806,337.965576052747,237.931328357067,70.531160814394,346.978529444445,207.187901694284,117.589570675711,342.134937021402,201.8740301348,115.820696455762,333.176408669389],[28.142729031356,17.889223192132,29.5136283832464,27.6854554354183,23.4677825906975,32.0138708597007,28.3811636579642,17.1375057279479,32.2691905421839,26.965131811581,22.3447936011577,31.9517363838315,26.3653675316191,22.8282633061093,32.0352780196786],[318.559617981,113.081045040247,360.717183433808,309.936974128643,234.488992327592,397.761412736486,287.120193164166,143.078879701137,479.26925568535,276.411189130735,261.055571041418,418.749812382382,276.484929646573,207.990516801205,411.280685932855],[33.6080458899322,21.6862658104601,34.6239156332972,32.6927820624751,30.359441976097,36.1283891586298,32.7640477633983,23.2742648785934,37.6766806279,31.862287318665,30.9656795567876,36.7427153252868,31.4429344719848,28.8939971693079,36.7872157542894],[124.017377618727,22.4844428237002,145.504708678595,104.082732017538,100.927726744165,191.696162672617,118.819893459008,25.1578953505542,213.13370431346,88.3267554511174,72.6354633234575,238.173413782178,82.4955835171331,102.689495845483,280.350703804235],[80.8635143952796,16.5039909382113,105.289044345735,74.0917062161641,46.4989200942983,138.902536854982,89.7194991479995,13.4995965197572,128.882572002539,60.8420692704634,34.2867927437264,157.594062113818,56.9910919073005,45.7081983382738,181.313429763733],[8.85600668214351,6.52711643666617,8.73256638089483,8.59598616304326,8.45343308316631,9.13032707383519,8.74143861362978,6.10883671983997,9.09646007966368,8.59905687430256,8.03457596860078,8.84769484292283,8.31565710755243,8.38549911927464,8.85544677259799],[100.027993041252,19.6482993064969,122.15894865996,88.2637927711777,76.6312488620222,154.573849836077,100.190004986191,20.6996679574736,167.308105260173,74.6596159801198,59.6212243967992,183.056967230936,68.9427156178291,79.0012085184388,215.457347210311],[8.87715610108616,7.02348617769601,8.85418266512527,8.71274476809203,8.65284106076029,9.0134424501933,8.72566405107537,7.03732523781205,8.96399720664047,8.62821280333118,8.47052754173995,8.92817352506369,8.5532595137433,8.54497499699921,9.17552275104931]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>sample_id<\/th>\n      <th>PLOT<\/th>\n      <th>DEPTH<\/th>\n      <th>TREAT<\/th>\n      <th>TEMP<\/th>\n      <th>PAIR<\/th>\n      <th>Observed<\/th>\n      <th>Observed_pi<\/th>\n      <th>Observed_pe<\/th>\n      <th>Observed_pit<\/th>\n      <th>Observed_pet<\/th>\n      <th>Shannon_exp<\/th>\n      <th>Shannon_exp_pi<\/th>\n      <th>Shannon_exp_pit<\/th>\n      <th>Shannon_exp_pe<\/th>\n      <th>Shannon_exp_pet<\/th>\n      <th>InvSimpson<\/th>\n      <th>InvSimpson_pi<\/th>\n      <th>InvSimpson_pit<\/th>\n      <th>InvSimpson_pe<\/th>\n      <th>InvSimpson_pet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"Blfrtip","buttons":["copy","csv","excel"],"pageLength":5,"lengthMenu":[[5,-1],["5","All"]],"columnDefs":[{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":15,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":16,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":17,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":18,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":19,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":20,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'80%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'80%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'80%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'80%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'80%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'80%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'80%'});\nvar value=data[7]; $(this.api().cell(row, 7).node()).css({'font-size':'80%'});\nvar value=data[8]; $(this.api().cell(row, 8).node()).css({'font-size':'80%'});\nvar value=data[9]; $(this.api().cell(row, 9).node()).css({'font-size':'80%'});\nvar value=data[10]; $(this.api().cell(row, 10).node()).css({'font-size':'80%'});\nvar value=data[11]; $(this.api().cell(row, 11).node()).css({'font-size':'80%'});\nvar value=data[12]; $(this.api().cell(row, 12).node()).css({'font-size':'80%'});\nvar value=data[13]; $(this.api().cell(row, 13).node()).css({'font-size':'80%'});\nvar value=data[14]; $(this.api().cell(row, 14).node()).css({'font-size':'80%'});\nvar value=data[15]; $(this.api().cell(row, 15).node()).css({'font-size':'80%'});\nvar value=data[16]; $(this.api().cell(row, 16).node()).css({'font-size':'80%'});\nvar value=data[17]; $(this.api().cell(row, 17).node()).css({'font-size':'80%'});\nvar value=data[18]; $(this.api().cell(row, 18).node()).css({'font-size':'80%'});\nvar value=data[19]; $(this.api().cell(row, 19).node()).css({'font-size':'80%'});\nvar value=data[20]; $(this.api().cell(row, 20).node()).css({'font-size':'80%'});\n}"}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.rowCallback"],"jsHooks":[]}</script>
</div>
<h3 id="normality-tests">Normality Tests</h3>
<p>Before running significance tests, we need to know if data is normally distributed, which will tell use whether to use a parametric or non-parametric test. To test if the data are normally distributed, we use the Shapiro-Wilk Normality test and the Bartlett Test of Homogeneity of Variances.</p>
<p>If the p-values are both <strong>not significant</strong> (p &gt; 0.05) from the tests, we accept the null hypothesis (that the results are normally distributed) and test for significance between samples using an ANOVA. If the p-values are both <strong>significant</strong> (p &lt; 0.05), we reject the null hypothesis (that the results are normally distributed) and test for significance between samples using Kruskal-Wallis (non-parametric equivalent of ANOVA).</p>
<p>The commands are as follows:</p>
<p><code>shapiro.test(x)</code>, where <code>x</code> is a numeric vector of alpha diversity values from the sample data table.</p>
<p><code>bartlett.test(Value ~ Group, data = df)</code> Where <code>Value</code> is the metric of interest, <code>Group</code> in the treatment to compare, and <code>df</code> is the data frame.</p>
<p>First the Shapiro-Wilk Normality test.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ssu18_div_tab <span class="ot">&lt;-</span> ssu18_samp_data_tab</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ssu18_shap_tests_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(ssu18_div_tab)])) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu18_shap_asv_&quot;</span>, .))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>   ssu18_shap_tests_asv <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu18_shap_tests_asv, tmp_name)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">shapiro.test</span>(ssu18_div_tab[[i]]))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>ssu18_div_tab <span class="ot">&lt;-</span> ssu18_samp_data_otu_tab</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>ssu18_shap_tests_otu <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(ssu18_div_tab)])) {</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu18_shap_otu_&quot;</span>, .))</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>   ssu18_shap_tests_otu <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu18_shap_tests_otu, tmp_name)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">shapiro.test</span>(ssu18_div_tab[[i]]))</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;shap_&quot;</span>)</span></code></pre></div>
</div>
<p>And then the Bartlett Test of Homogeneity of Variances.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ssu18_div_tab_asv <span class="ot">&lt;-</span> ssu18_samp_data_tab</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ssu18_bart_tests_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab_asv[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(ssu18_div_tab_asv)])) {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu18_bart_asv_&quot;</span>, .))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>   ssu18_bart_tests_asv <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu18_bart_tests_asv, tmp_name)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">bartlett.test</span>(ssu18_div_tab_asv[[i]] <span class="sc">~</span> TEMP, <span class="at">data =</span> ssu18_div_tab_asv))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>ssu18_div_tab_otu <span class="ot">&lt;-</span> ssu18_samp_data_otu_tab</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>ssu18_bart_tests_otu <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab_otu[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(ssu18_div_tab_otu)])) {</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu18_bart_otu_&quot;</span>, .))</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>   ssu18_bart_tests_otu <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu18_bart_tests_otu, tmp_name)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">bartlett.test</span>(ssu18_div_tab_otu[[i]] <span class="sc">~</span> TEMP, <span class="at">data =</span> ssu18_div_tab_otu))</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_bart_&quot;</span>)</span></code></pre></div>
</div>
<p>Here we see which Shapiro-Wilk Normality <strong>and</strong> Bartlett tests were significant and which were not for the ASV analysis?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab_asv[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  tmp_get_shap <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu18_shap_asv_&quot;</span>, .)))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  tmp_shap_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_shap[[<span class="dv">2</span>]], <span class="dv">4</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  tmp_get_bart <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu18_bart_asv_&quot;</span>, .)))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  tmp_bart_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_bart[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_get_shap[[<span class="dv">2</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> <span class="fu">isTRUE</span>(tmp_get_bart[[<span class="dv">3</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(i, <span class="st">&quot;Shapiro p-value =&quot;</span>, tmp_shap_p, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Bartlett p-value =&quot;</span>, tmp_bart_p, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Are both p-values &gt; 0.05?&quot;</span>, tmp_res)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(tmp_print,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Observed Shapiro p-value = 0.2682 Bartlett p-value = 0.5992 Are both p-values &gt; 0.05? TRUE 
Observed_pi Shapiro p-value = 0.0552 Bartlett p-value = 0.7551 Are both p-values &gt; 0.05? TRUE 
Observed_pe Shapiro p-value = 0.1905 Bartlett p-value = 0.437 Are both p-values &gt; 0.05? TRUE 
Observed_pit Shapiro p-value = 0.0299 Bartlett p-value = 0.369 Are both p-values &gt; 0.05? FALSE 
Observed_pet Shapiro p-value = 0.0814 Bartlett p-value = 0.3126 Are both p-values &gt; 0.05? TRUE 
Shannon_exp Shapiro p-value = 0.994 Bartlett p-value = 0.4904 Are both p-values &gt; 0.05? TRUE 
Shannon_exp_pi Shapiro p-value = 0.0366 Bartlett p-value = 0.88 Are both p-values &gt; 0.05? FALSE 
Shannon_exp_pit Shapiro p-value = 0.0084 Bartlett p-value = 0.0018 Are both p-values &gt; 0.05? FALSE 
Shannon_exp_pe Shapiro p-value = 0.3311 Bartlett p-value = 0.1592 Are both p-values &gt; 0.05? TRUE </code></pre>
</div>
<p>And which of the metrics are significant for the OTU analysis?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab_otu[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  tmp_get_shap <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu18_shap_otu_&quot;</span>, .)))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  tmp_shap_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_shap[[<span class="dv">2</span>]], <span class="dv">4</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  tmp_get_bart <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu18_bart_otu_&quot;</span>, .)))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  tmp_bart_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_bart[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_get_shap[[<span class="dv">2</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> <span class="fu">isTRUE</span>(tmp_get_bart[[<span class="dv">3</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(i, <span class="st">&quot;Shapiro p-value =&quot;</span>, tmp_shap_p, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Bartlett p-value =&quot;</span>, tmp_bart_p, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Are both p-values &gt; 0.05?&quot;</span>, tmp_res)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(tmp_print,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Observed Shapiro p-value = 0.191 Bartlett p-value = 0.4813 Are both p-values &gt; 0.05? TRUE 
Observed_pi Shapiro p-value = 0.0843 Bartlett p-value = 0.7803 Are both p-values &gt; 0.05? TRUE 
Observed_pe Shapiro p-value = 0.7849 Bartlett p-value = 0.5749 Are both p-values &gt; 0.05? TRUE 
Observed_pit Shapiro p-value = 0.049 Bartlett p-value = 0.4263 Are both p-values &gt; 0.05? FALSE 
Observed_pet Shapiro p-value = 0.5626 Bartlett p-value = 0.4748 Are both p-values &gt; 0.05? TRUE 
Shannon_exp Shapiro p-value = 0.913 Bartlett p-value = 0.2558 Are both p-values &gt; 0.05? TRUE 
Shannon_exp_pi Shapiro p-value = 0.1312 Bartlett p-value = 0.7164 Are both p-values &gt; 0.05? TRUE 
Shannon_exp_pit Shapiro p-value = 0.1287 Bartlett p-value = 0.0417 Are both p-values &gt; 0.05? FALSE 
Shannon_exp_pe Shapiro p-value = 0.9563 Bartlett p-value = 0.1316 Are both p-values &gt; 0.05? TRUE </code></pre>
</div>
<p>So wherever the value of both p-values in <code>&gt; 0.05</code> we can use an ANOVA, otherwise we use Kruskal-Wallis.</p>
<h3 id="significance-tests">Significance Tests</h3>
<p>To begin, we need to create a hierarchy variable; a two-column matrix specifying the relationship between samples (first column) and groups (second column).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier <span class="ot">&lt;-</span> ssu18_samp_data_tab</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier <span class="ot">&lt;-</span> ssu18_hill_hier <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;sample_id&quot;</span>, <span class="st">&quot;TEMP&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier <span class="ot">&lt;-</span> ssu18_hill_hier[<span class="fu">order</span>(ssu18_hill_hier<span class="sc">$</span>TEMP), ]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier<span class="sc">$</span>TEMP <span class="ot">=</span> <span class="fu">paste</span>(ssu18_hill_hier<span class="sc">$</span>TEMP, <span class="st">&#39;C&#39;</span>, <span class="at">sep=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier <span class="ot">&lt;-</span> ssu18_hill_hier <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_hill_hier, <span class="st">&quot;files/alpha/rdata/ssu18_hill_hier.rds&quot;</span>)</span></code></pre></div>
</div>
<p>Again, we start by testing significance of ASV diversity for the full data set against each of the three metrics using the <code>div_test</code> function.</p>
<p>The command is as follows:</p>
<p><code>div_test(countable = x, qvalue = i, hierarchy = hier, tree = ultrametric_tree, posthoc = TRUE)</code>, where <code>x</code> is ASV by sample table, <code>i</code> is the q-value corresponding to the metric of interest, <code>hier</code> is the hierarchy matrix, <code>tree</code> is an ultrametric formatted phylogenetic tree (see below), and <code>posthoc</code> indicates whether to run post hoc pairwise analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> ssu18_hill_hier,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_q&quot;</span>, j, <span class="st">&quot;_adt&quot;</span>))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>And then test significance of lineage diversity for the PIME filtered data sets.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu18_ps_pime&quot;</span>, <span class="st">&quot;ssu18_ps_pime_otu&quot;</span>, <span class="st">&quot;ssu18_ps_perfect&quot;</span>, <span class="st">&quot;ssu18_ps_perfect_otu&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree) {</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>         tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>)))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> ssu18_hill_hier,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tree =</span> tmp_tree)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_t_q&quot;</span>, j, <span class="st">&quot;_adt&quot;</span>))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="summary">Summary</h3>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table style="width:100%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 2%" />
<col style="width: 4%" />
<col style="width: 11%" />
<col style="width: 4%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 26%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">dataset</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">lineage</th>
<th style="text-align: left;">metric</th>
<th style="text-align: left;">q-value</th>
<th style="text-align: right;">normality p-value</th>
<th style="text-align: right;">homogeneity p-value</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">posthoc method</th>
<th style="text-align: right;">posthoc p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.2681998</td>
<td style="text-align: right;">0.5991626</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0605074</td>
</tr>
<tr class="even">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.9939992</td>
<td style="text-align: right;">0.4904235</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000627</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.5839636</td>
<td style="text-align: right;">0.1546384</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000467</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0552211</td>
<td style="text-align: right;">0.7550599</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0365560</td>
<td style="text-align: right;">0.8800330</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0019305</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.3700798</td>
<td style="text-align: right;">0.3713868</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.1905324</td>
<td style="text-align: right;">0.4370236</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0504543</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.3311190</td>
<td style="text-align: right;">0.1591881</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000071</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.7467994</td>
<td style="text-align: right;">0.3483932</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000032</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0298648</td>
<td style="text-align: right;">0.3690373</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0075214</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0084235</td>
<td style="text-align: right;">0.0017782</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0019305</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0011146</td>
<td style="text-align: right;">0.0001765</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0044716</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0814245</td>
<td style="text-align: right;">0.3125886</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0645723</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0125488</td>
<td style="text-align: right;">0.0001550</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0019305</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0002360</td>
<td style="text-align: right;">0.0002044</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.1339887</td>
</tr>
<tr class="even">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.1909930</td>
<td style="text-align: right;">0.4813418</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0559591</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.9130116</td>
<td style="text-align: right;">0.2557555</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000628</td>
</tr>
<tr class="even">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.3401696</td>
<td style="text-align: right;">0.1988375</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0001413</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0842990</td>
<td style="text-align: right;">0.7802781</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000011</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.1312023</td>
<td style="text-align: right;">0.7163842</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.5348064</td>
<td style="text-align: right;">0.2986110</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000069</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.7848775</td>
<td style="text-align: right;">0.5749074</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0186153</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.9563337</td>
<td style="text-align: right;">0.1316418</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000204</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.4550383</td>
<td style="text-align: right;">0.2823848</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000616</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0490294</td>
<td style="text-align: right;">0.4263028</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0037350</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.1287099</td>
<td style="text-align: right;">0.0416755</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0019305</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0005127</td>
<td style="text-align: right;">0.0007859</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0076734</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.5626109</td>
<td style="text-align: right;">0.4747618</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0215911</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0946729</td>
<td style="text-align: right;">0.0053474</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0019305</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0002749</td>
<td style="text-align: right;">0.0002655</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0039660</td>
</tr>
</tbody>
</table>
</div>
<p><em>Summary of significant tests.</em></p>
<p><br/></p>
<h3 id="posthoc-analyses-asv-data-sets">PostHoc Analyses (ASV data sets)</h3>
<p>First lets check the results of each posthoc analysis.</p>
<details>
<summary>
Detailed results of PostHoc Analyses for each metric
</summary>
<h4 id="observed-q-value-0">Observed (q-value = 0)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff       lwr       upr      p.adj
3C-0C -219.6  -956.946 517.74597 0.71329233
8C-0C -721.0 -1458.346  16.34597 0.05546473
8C-3C -501.4 -1238.746 235.94597 0.20658985</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff       lwr       upr          p.adj
3C-0C  -46.6 -140.1306   46.9306 0.406733563435
8C-0C -325.6 -419.1306 -232.0694 0.000002206313
8C-3C -279.0 -372.5306 -185.4694 0.000011005557</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff       lwr       upr      p.adj
3C-0C    2.4 -191.8227 196.62267 0.99940103
8C-0C -174.2 -368.4227  20.02267 0.08059254
8C-3C -176.6 -370.8227  17.62267 0.07616681</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME Lineage (Observed)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
              Z     P.unadj      P.adj
0C-3C 0.6363961 0.524518280 0.52451828
0C-8C 2.9698485 0.002979467 0.00893840
3C-8C 2.3334524 0.019624415 0.02943662</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect Lineage (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff       lwr       upr      p.adj
3C-0C   1.170489 -29.44297 31.783949 0.99428278
8C-0C -25.584935 -56.19839  5.028525 0.10619378
8C-3C -26.755424 -57.36888  3.858036 0.08944194</code></pre>
</div>
<h4 id="shannon-exponential-q-value-1">Shannon exponential (q-value = 1)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff       lwr        upr         p.adj
3C-0C -246.4375 -442.9939  -49.88101 0.01492642034
8C-0C -511.4071 -707.9635 -314.85066 0.00004295672
8C-3C -264.9696 -461.5261  -68.41321 0.00950353162</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj       P.adj
0C-3C 1.767767 0.077099872 0.077099872
0C-8C 3.535534 0.000406952 0.001220856
3C-8C 1.767767 0.077099872 0.115649808</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff       lwr        upr          p.adj
3C-0C  -82.87871 -155.6134  -10.14407 0.025808833615
8C-0C -232.15045 -304.8851 -159.41581 0.000005488596
8C-3C -149.27174 -222.0064  -76.53710 0.000385348747</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME Lineage (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj       P.adj
0C-3C 1.767767 0.077099872 0.077099872
0C-8C 3.535534 0.000406952 0.001220856
3C-8C 1.767767 0.077099872 0.115649808</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect Lineage (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj       P.adj
0C-3C 1.767767 0.077099872 0.077099872
0C-8C 3.535534 0.000406952 0.001220856
3C-8C 1.767767 0.077099872 0.115649808</code></pre>
</div>
<h4 id="simpson-multiplicative-i.e.-inverse-simpson-q-value-2">Simpson multiplicative (i.e., Inverse Simpson) (q-value = 2)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff       lwr        upr         p.adj
3C-0C -157.7331 -251.7760  -63.69027 0.00202540187
8C-0C -249.3938 -343.4367 -155.35097 0.00003566326
8C-3C  -91.6607 -185.7036    2.38217 0.05628905499</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff        lwr       upr          p.adj
3C-0C  -61.82853  -93.26452 -30.39255 0.000556162049
8C-0C -122.59975 -154.03574 -91.16377 0.000000651479
8C-3C  -60.77122  -92.20720 -29.33524 0.000643758728</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff       lwr        upr          p.adj
3C-0C  -80.17581 -122.1927  -38.15894 0.000718157610
8C-0C -146.57155 -188.5884 -104.55467 0.000002158578
8C-3C  -66.39574 -108.4126  -24.37887 0.003172202683</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME Lineage (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj      P.adj
0C-3C 1.202082 0.229331942 0.22933194
0C-8C 3.252691 0.001143177 0.00342953
3C-8C 2.050610 0.040304974 0.06045746</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect Lineage (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
              Z   P.unadj     P.adj
0C-3C 0.4242641 0.6713732 0.6713732
0C-8C 1.9091883 0.0562378 0.1687134
3C-8C 1.4849242 0.1375639 0.2063458</code></pre>
</div>
</details>
<h3 id="posthoc-analyses-otu-data-sets">PostHoc Analyses (OTU data sets)</h3>
<p>Again, lets check the results of each posthoc analysis.</p>
<details>
<summary>
Detailed results of PostHoc Analyses for each metric
</summary>
<h4 id="observed-q-value-0-1">Observed (q-value = 0)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff        lwr         upr      p.adj
3C-0C -223.2  -899.0877 452.6876931 0.66188885
8C-0C -676.4 -1352.2877  -0.5123069 0.04982256
8C-3C -453.2 -1129.0877 222.6876931 0.21466785</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff       lwr        upr          p.adj
3C-0C  -70.2 -170.0332   29.63325 0.187886405687
8C-0C -363.8 -463.6332 -263.96675 0.000001355009
8C-3C -293.6 -393.4332 -193.76675 0.000012714871</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff       lwr         upr      p.adj
3C-0C  -33.2 -238.8014 172.4014356 0.90356021
8C-0C -239.2 -444.8014 -33.5985644 0.02301574
8C-3C -206.0 -411.6014  -0.3985644 0.04954739</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME Lineage  (Observed)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj       P.adj
0C-3C 1.343503 0.179109193 0.179109193
0C-8C 3.323402 0.000889267 0.002667801
3C-8C 1.979899 0.047714880 0.071572320</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect Lineage (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff       lwr        upr      p.adj
3C-0C  -3.93427 -34.55582 26.6872783 0.93762030
8C-0C -34.36527 -64.98682 -3.7437233 0.02801955
8C-3C -30.43100 -61.05255  0.1905472 0.05147974</code></pre>
</div>
<h4 id="shannon-exponential-q-value-1-1">Shannon exponential (q-value = 1)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff       lwr         upr         p.adj
3C-0C -213.3956 -351.0524  -75.738845 0.00364944549
8C-0C -355.8491 -493.5058 -218.192283 0.00004574417
8C-3C -142.4534 -280.1102   -4.796657 0.04243825218</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff       lwr        upr             p.adj
3C-0C -106.2766 -144.4684  -68.08487 0.000022165913123
8C-0C -227.7311 -265.9228 -189.53930 0.000000005600612
8C-3C -121.4544 -159.6462  -83.26266 0.000005700395158</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff       lwr        upr         p.adj
3C-0C -119.8531 -195.8804  -43.82579 0.00322839921
8C-0C -221.6167 -297.6440 -145.58937 0.00001390846
8C-3C -101.7636 -177.7909  -25.73628 0.00994714139</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME Lineage  (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj       P.adj
0C-3C 1.767767 0.077099872 0.077099872
0C-8C 3.535534 0.000406952 0.001220856
3C-8C 1.767767 0.077099872 0.115649808</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect Lineage (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj       P.adj
0C-3C 1.767767 0.077099872 0.077099872
0C-8C 3.535534 0.000406952 0.001220856
3C-8C 1.767767 0.077099872 0.115649808</code></pre>
</div>
<h4 id="simpson-multiplicative-i.e.-inverse-simpson-q-value-2-1">Simpson multiplicative (i.e., Inverse Simpson) (q-value = 2)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff       lwr       upr        p.adj
3C-0C -110.22327 -174.9669 -45.47960 0.0018046838
8C-0C -148.99273 -213.7364 -84.24906 0.0001376732
8C-3C  -38.76946 -103.5131  25.97421 0.2840928368</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff        lwr        upr          p.adj
3C-0C  -69.89475 -104.49486 -35.294650 0.000442123349
8C-0C -111.09683 -145.69693 -76.496726 0.000005158065
8C-3C  -41.20208  -75.80218  -6.601974 0.020186238381</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff        lwr       upr         p.adj
3C-0C  -82.09422 -128.29789 -35.89054 0.00128813757
8C-0C -117.39071 -163.59439 -71.18704 0.00005406988
8C-3C  -35.29649  -81.50017  10.90718 0.14542596882</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME Lineage  (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj       P.adj
0C-3C 1.343503 0.179109193 0.179109193
0C-8C 3.111270 0.001862846 0.005588539
3C-8C 1.767767 0.077099872 0.115649808</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect Lineage (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
             Z     P.unadj       P.adj
0C-3C 1.767767 0.077099872 0.115649808
0C-8C 3.323402 0.000889267 0.002667801
3C-8C 1.555635 0.119794930 0.119794930</code></pre>
</div>
</details>
<p>Now we can plot the results from the posthoc analyses for each metric and data set using the function <code>div_test_plot_jjs</code>. I modified the original function (<code>div_test_plot</code>) to control a little of the formatting.</p>
<p>The command is as follows:</p>
<p><code>div_test_plot(divtest = x, chart = "type", colour = col.pal, posthoc = TRUE, threshold = value))</code>, where <code>x</code> is the results from the <code>div_test</code> function, <code>"type"</code> is chart type (box, jitter, or violin),<code>colour</code> is is a color palette, <code>posthoc</code> indicates whether to run posthoc pairwise analyses, and <code>value</code> is the maximum p-value to show in pairwise posthoc results. <strong>WARNING</strong> if none of the posthoc results are below the specified threshold, the function will throw an error. Therefore, until this is fixed, all posthoc values are shown.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;hack_code/div_test_plot_jjs.R&quot;</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>(<span class="at">pattern=</span><span class="st">&quot;_adt_plot&quot;</span>))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">&quot;_adt&quot;</span>)) {</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_plot&quot;</span>))</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">div_test_plot_jjs</span>(tmp_get, <span class="at">chart =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">colour =</span> swel_col, <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">ggpar</span>(tmp_df, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<h3 id="alpha-diversity-plots">Alpha Diversity Plots</h3>
<p>Posthoc adjusted p-values given for each pairwise comparison.</p>
<h4 id="asv-data-sets">ASV data sets</h4>
<div class="layout-chunk" data-layout="l-page">
<div class="figure"><span id="fig:unnamed-chunk-67"></span>
<img src="include/alpha/ssu18_alph_div_plots_asv.png" alt="**Top row** = Observed; **middle row** = Shannon exponential; **bottom row** = Inverse Simpson." width="7086" />
<p class="caption">
Figure 1: <strong>Top row</strong> = Observed; <strong>middle row</strong> = Shannon exponential; <strong>bottom row</strong> = Inverse Simpson.
</p>
</div>
</div>
<h4 id="otu-data-sets">OTU data sets</h4>
<div class="layout-chunk" data-layout="l-page">
<div class="figure"><span id="fig:unnamed-chunk-68"></span>
<img src="include/alpha/ssu18_alph_div_plots_otu.png" alt="**Top row** = Observed; **middle row** = Shannon exponential; **bottom row** = Inverse Simpson." width="7086" />
<p class="caption">
Figure 2: <strong>Top row</strong> = Observed; <strong>middle row</strong> = Shannon exponential; <strong>bottom row</strong> = Inverse Simpson.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="its">ITS</h1>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="read-distribution-1">Read Distribution</h2>
<h3 id="histogram-of-read-counts-1">Histogram of Read Counts</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>its18_max <span class="ot">&lt;-</span> <span class="fu">max</span>(its18_samp_data<span class="sc">$</span>total_reads) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">max</span>(its18_samp_data<span class="sc">$</span>total_reads))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>its18_p_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(its18_samp_data,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(its18_samp_data<span class="sc">$</span>total_reads)) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, its18_max, <span class="at">by =</span> <span class="dv">5000</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of total reads&quot;</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> <span class="st">&quot;Bin width equals 5000 reads&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;No. of reads&quot;</span>, <span class="at">y =</span> <span class="st">&quot;No. of samples&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="alpha_files/figure-html5/unnamed-chunk-74-1.png" width="624" /></p>
</div>
<h3 id="rarefaction-curves-1">Rarefaction Curves</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>its18_rare_curve1 <span class="ot">&lt;-</span> <span class="fu">amp_rarecurve</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  its18_amp_data,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1000</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_by =</span> <span class="st">&quot;TEMP&quot;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="alpha_files/figure-html5/unnamed-chunk-76-1.png" width="624" /></p>
</div>
<p>For a quick comparison, we can facet the above data by Temperature.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>its18_rare_curve2 <span class="ot">&lt;-</span> <span class="fu">amp_rarecurve</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  its18_amp_data,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1000</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_by =</span> <span class="st">&quot;TEMP&quot;</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet_by =</span> <span class="st">&quot;TEMP&quot;</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet_scales =</span> <span class="st">&quot;free&quot;</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="alpha_files/figure-html5/unnamed-chunk-78-1.png" width="624" /></p>
</div>
<p>In the <strong>full data set</strong>, there was a minimum read count of 9172, a median of 38371 reads, and a maximum of 64636 reads.</p>
<p>After <strong>PIME</strong> filtering, there was a minimum read count of 3442, a median of 3442 reads, and a maximum of 3442 reads</p>
<p>After <strong>PERfect</strong> filtering, there was a minimum read count of 7286, a median of 24313 reads, and a maximum of 56772 reads</p>
<h2 id="alpha-diversity-1">Alpha Diversity</h2>
<p>To account for presence of rare sequence variants caused by sequencing errors or other technical artifacts, we use Hill numbers <span class="citation" data-cites="alberdi2019guide">(<a href="#ref-alberdi2019guide" role="doc-biblioref">Alberdi and Gilbert 2019a</a>)</span>. Hill numbers allow the weight put on rare versus abundant sequence variants to be scaled while providing intuitive comparisons of diversity levels using effective number of ASVs as a measuring unit. This approach allows for balancing the over representation of rare ASVs that might be inflated due to sequencing errors.</p>
<p>We will then use Shapiro-Wilk tests to test for normalcy and then, depending on the results, either use parametric ANOVA or non-parametric Kruskal-Wallis to compare alpha diversity among treatments.</p>
<h3 id="calculate-hill-numbers-1">Calculate Hill Numbers</h3>
<p>To calculate Hill numbers, we use the R package <code>hilldiv</code> <span class="citation" data-cites="alberdi2019hilldiv">(<a href="#ref-alberdi2019hilldiv" role="doc-biblioref">Alberdi and Gilbert 2019b</a>)</span>. We calculate three metrics that put more or less weight on common species:</p>
<ol type="1">
<li>Observed richness, where <code>q-value = 0</code>.</li>
<li>Shannon exponential, which weighs ASVs by their frequency, where <code>q-value = 1</code>.</li>
<li>Simpson multiplicative inverse, which over weighs abundant ASVs, where <code>q-value = 2</code>.</li>
</ol>
<p>We perform each analysis against the full data set and the PIME filtered data set using the function <code>hill_div</code>.</p>
<p>The command is as follows:</p>
<p><code>hill_div(count = x, qvalue = i, tree = ultrametric_tree)</code>, where <code>x</code> is the sample by ASV table, <code>i</code> is the q-value corresponding to the metric of interest and <code>tree</code> is an ultrametric formatted phylogenetic tree (see below).</p>
<p>We first transform all the data to relative abundance values, and compute new trees.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>its18_alpha_ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;its18_ps_work&quot;</span>, <span class="st">&quot;its18_ps_pime&quot;</span>, <span class="st">&quot;its18_ps_perfect&quot;</span>, </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;its18_ps_work_otu&quot;</span>, <span class="st">&quot;its18_ps_pime_otu&quot;</span>, <span class="st">&quot;its18_ps_perfect_otu&quot;</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>its18_ps_work<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>its18_ps_pime<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>its18_ps_work_otu<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_otu<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_otu<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  tmp_ps &lt;- transform_sample_counts(get(i), function(otu) 1e5 otu/sum(otu))</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(<span class="fu">get</span>(i), <span class="cf">function</span>(otu) otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  tmp_ps_norm <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_ps_norm)))</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_norm&quot;</span>))</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name, tmp_ps_norm)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_asv_name, tmp_asv)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span></code></pre></div>
</div>
<p>Next, we run the analysis for all three metrics on the data sets without a tree.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;tmp_name&quot;</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SamName&quot;</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h&quot;</span>, i))</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_h&quot;</span>)</span></code></pre></div>
</div>
<p>And make summary tables to add back into each <code>ps</code> object.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h0&quot;</span>)))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h1&quot;</span>)))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h2&quot;</span>)))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Observed&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Shannon_exp&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;InvSimpson&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_hill&quot;</span>))</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_hill&quot;</span>)</span></code></pre></div>
</div>
<p>And then create the new objects with the diversity data.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="sample-summary-1">Sample Summary</h3>
<p>Now we summarize the data for each sample against all three metrics. The table contains the results of ASV diversity estimates from the full data set and the PIME filtered data set, as well as the lineage diversity from the PIME data set.</p>
<p>The suffix <code>_pi</code> indicates metrics for the PIME data set and the suffix <code>_pe</code> indicates metrics for the PERfect data set.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="asv-hill-summary-1">ASV Hill Summary</h3>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<div id="iq195q9miycqt7qj1e5y" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="iq195q9miycqt7qj1e5y">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"335\" data-max=\"1017\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"97\" data-max=\"246\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"64\" data-max=\"161\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"24.5926217976632\" data-max=\"232.719037872627\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"8.07861258768907\" data-max=\"66.558920824491\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"11.1251760308792\" data-max=\"51.874028139934\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"4.90037340761829\" data-max=\"96.0074005806289\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2.48152383745447\" data-max=\"34.8720313531092\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"3.78176527081543\" data-max=\"33.8879063583643\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"caption":"<caption style=\"caption-side: bottom; text-align: left;\">\n  Table: \n  <em>Sample summary table including\n            ASV diversity indices for FULL plus PIME &amp; PERfect filtered data.\n            Use the buttons to navigate through the table or\n            download a copy.<\/em>\n<\/caption>","data":[["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],["P01","P01","P02","P03","P03","P04","P05","P06","P07","P07","P08","P09","P10"],["00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010"],["W","W","C","W","W","C","W","C","W","W","C","W","C"],["3","8","0","3","8","0","8","0","3","8","0","3","0"],["A","A","A","B","B","B","C","C","D","D","D","E","E"],[945,719,1011,765,349,1017,616,954,867,335,702,745,812],[181,123,238,196,109,229,131,246,205,97,198,196,203],[148,98,147,136,64,161,90,157,147,76,105,118,143],[55.9005290284547,141.463030764704,112.497599018983,132.852605064604,112.146416025363,60.8867274297495,157.516557836314,99.4612260970262,160.359206976709,34.9525788463565,87.208177176001,232.719037872627,24.5926217976632],[14.8150344194193,31.6308800678541,43.3354376936543,56.5449626812564,42.8453429017297,39.5217659864322,35.1498045541576,35.1897135266992,48.0272106776515,18.0520392603761,30.6651369919752,66.558920824491,8.07861258768907],[18.5429784624608,31.7563711950937,38.0631882830239,45.7370496663878,26.2085022532176,25.2325518921389,34.1735842794145,34.2077783035054,46.2549335171949,16.8891560865946,25.6580400044172,51.874028139934,11.1251760308792],[10.7020654804311,42.4048152782962,36.1388263465906,44.1152687211836,48.9736767454319,17.606673791684,41.7772306049991,23.9279582440085,56.1824799683539,13.7198530644516,25.5425355904973,96.0074005806289,4.90037340761829],[5.58462846176209,12.4777393941947,19.9121796172314,26.8613427688068,23.7210627306273,20.556042569796,11.5380676954109,13.0513841048505,22.4962704663127,9.94275683870675,14.1510115202073,34.8720313531092,2.48152383745447],[6.81105578797532,17.2628989998294,21.9059921806506,24.419551557086,17.7792631330269,12.5087419818649,15.3372192543724,14.7532908783479,27.2186818939502,9.10369221767316,14.1588621952838,33.8879063583643,3.78176527081543]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>sample_id<\/th>\n      <th>PLOT<\/th>\n      <th>DEPTH<\/th>\n      <th>TREAT<\/th>\n      <th>TEMP<\/th>\n      <th>PAIR<\/th>\n      <th>Observed<\/th>\n      <th>Observed_pi<\/th>\n      <th>Observed_pe<\/th>\n      <th>Shannon_exp<\/th>\n      <th>Shannon_exp_pi<\/th>\n      <th>Shannon_exp_pe<\/th>\n      <th>InvSimpson<\/th>\n      <th>InvSimpson_pi<\/th>\n      <th>InvSimpson_pe<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"Blfrtip","buttons":["copy","csv","excel"],"pageLength":5,"lengthMenu":[[5,-1],["5","All"]],"columnDefs":[{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'80%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'80%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'80%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'80%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'80%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'80%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'80%'});\nvar value=data[7]; $(this.api().cell(row, 7).node()).css({'font-size':'80%'});\nvar value=data[8]; $(this.api().cell(row, 8).node()).css({'font-size':'80%'});\nvar value=data[9]; $(this.api().cell(row, 9).node()).css({'font-size':'80%'});\nvar value=data[10]; $(this.api().cell(row, 10).node()).css({'font-size':'80%'});\nvar value=data[11]; $(this.api().cell(row, 11).node()).css({'font-size':'80%'});\nvar value=data[12]; $(this.api().cell(row, 12).node()).css({'font-size':'80%'});\nvar value=data[13]; $(this.api().cell(row, 13).node()).css({'font-size':'80%'});\nvar value=data[14]; $(this.api().cell(row, 14).node()).css({'font-size':'80%'});\n}"}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.rowCallback"],"jsHooks":[]}</script>
</div>
<h3 id="otu-hill-summary-1">OTU Hill Summary</h3>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<div id="fnrcrxhsf5q7j1rswmja" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="fnrcrxhsf5q7j1rswmja">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"274\" data-max=\"871\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"96\" data-max=\"216\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"76\" data-max=\"169\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"20.1375891863329\" data-max=\"176.639111520055\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"6.13530859989578\" data-max=\"67.3636882791554\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"11.0096083905704\" data-max=\"59.8759655995611\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"4.37307659314499\" data-max=\"78.5648930051688\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2.1712124801067\" data-max=\"37.5276363739335\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"3.612560056393\" data-max=\"39.7866034315573\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"caption":"<caption style=\"caption-side: bottom; text-align: left;\">\n  Table: \n  <em>Sample summary table including\n            OTU diversity indices for FULL plus PIME &amp; PERfect filtered data.\n            Use the buttons to navigate through the table or\n            download a copy.<\/em>\n<\/caption>","data":[["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],["P01","P01","P02","P03","P03","P04","P05","P06","P07","P07","P08","P09","P10"],["00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010","00_010"],["W","W","C","W","W","C","W","C","W","W","C","W","C"],["3","8","0","3","8","0","8","0","3","8","0","3","0"],["A","A","A","B","B","B","C","C","D","D","D","E","E"],[796,605,861,624,301,871,509,801,725,274,602,619,693],[197,120,134,216,107,127,129,142,202,96,131,205,122],[160,110,168,143,76,169,101,162,153,78,129,130,151],[45.3733990459843,107.272192435225,82.5700492814001,98.8483062453143,94.2985940346041,47.9777989715896,111.665172982157,74.7403911186051,111.591887973862,21.8972381706832,74.6142881913937,176.639111520055,20.137589186333],[17.6746153484348,31.9682962126142,31.345882466404,53.3773213768246,41.7020930787448,20.5483737545499,36.1884515495988,22.815371596735,42.8477400433082,10.3260171806853,25.5110975080898,67.3636882791554,6.13530859989578],[19.2585011399648,36.4229977615216,36.5968851532286,46.3109914360313,33.8866485443991,24.321981900476,36.1587871233282,32.5041474508934,40.8222909828185,12.441911524895,30.9613172575477,59.8759655995611,11.0096083905704],[10.0990113603782,35.0800224440538,29.2529066770641,38.307698751231,44.617479558567,15.0148180893143,34.5974287135072,18.377914057569,34.8069584318129,8.05382492996931,23.7768242126677,78.5648930051689,4.37307659314499],[5.25187780765041,14.3876633117677,15.920586780631,23.8032485591018,24.5163980686022,8.39046344932475,13.6680554678536,8.81972789276782,17.6130512162913,4.71007401115833,13.2568323299245,37.5276363739335,2.1712124801067],[7.21354567832536,19.3844086821437,20.5232199764884,26.0992691488931,22.6942983230362,11.7343859495184,18.1551730645285,12.9775594734466,19.818025972178,6.3806019373789,15.3604142685839,39.7866034315573,3.612560056393]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>sample_id<\/th>\n      <th>PLOT<\/th>\n      <th>DEPTH<\/th>\n      <th>TREAT<\/th>\n      <th>TEMP<\/th>\n      <th>PAIR<\/th>\n      <th>Observed<\/th>\n      <th>Observed_pi<\/th>\n      <th>Observed_pe<\/th>\n      <th>Shannon_exp<\/th>\n      <th>Shannon_exp_pi<\/th>\n      <th>Shannon_exp_pe<\/th>\n      <th>InvSimpson<\/th>\n      <th>InvSimpson_pi<\/th>\n      <th>InvSimpson_pe<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"Blfrtip","buttons":["copy","csv","excel"],"pageLength":5,"lengthMenu":[[5,-1],["5","All"]],"columnDefs":[{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'80%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'80%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'80%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'80%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'80%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'80%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'80%'});\nvar value=data[7]; $(this.api().cell(row, 7).node()).css({'font-size':'80%'});\nvar value=data[8]; $(this.api().cell(row, 8).node()).css({'font-size':'80%'});\nvar value=data[9]; $(this.api().cell(row, 9).node()).css({'font-size':'80%'});\nvar value=data[10]; $(this.api().cell(row, 10).node()).css({'font-size':'80%'});\nvar value=data[11]; $(this.api().cell(row, 11).node()).css({'font-size':'80%'});\nvar value=data[12]; $(this.api().cell(row, 12).node()).css({'font-size':'80%'});\nvar value=data[13]; $(this.api().cell(row, 13).node()).css({'font-size':'80%'});\nvar value=data[14]; $(this.api().cell(row, 14).node()).css({'font-size':'80%'});\n}"}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.rowCallback"],"jsHooks":[]}</script>
</div>
<h3 id="normality-tests-1">Normality Tests</h3>
<p>Before running significance tests, we need to know if data is normally distributed, which will tell use whether to use a parametric or non-parametric test. To test if the data are normally distributed, we use the Shapiro-Wilk Normality test and the Bartlett Test of Homogeneity of Variances.</p>
<p>If the p-values are both <strong>not significant</strong> (p &gt; 0.05) from the tests, we accept the null hypothesis (that the results are normally distributed) and test for significance between samples using an ANOVA. If the p-values are both <strong>significant</strong> (p &lt; 0.05), we reject the null hypothesis (that the results are normally distributed) and test for significance between samples using Kruskal-Wallis (non-parametric equivalent of ANOVA).</p>
<p>The commands are as follows:</p>
<p><code>shapiro.test(x)</code>, where <code>x</code> is a numeric vector of alpha diversity values from the sample data table.</p>
<p><code>bartlett.test(Value ~ Group, data = df)</code> Where <code>Value</code> is the metric of interest, <code>Group</code> in the treatment to compare, and <code>df</code> is the data frame.</p>
<p>First the Shapiro-Wilk Normality test.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>its18_div_tab <span class="ot">&lt;-</span> its18_samp_data_tab</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>its18_shap_tests_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(its18_div_tab)])) {</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;its18_shap_asv_&quot;</span>, .))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>   its18_shap_tests_asv <span class="ot">&lt;-</span> <span class="fu">append</span>(its18_shap_tests_asv, tmp_name)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">shapiro.test</span>(its18_div_tab[[i]]))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>its18_div_tab <span class="ot">&lt;-</span> its18_samp_data_otu_tab</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>its18_shap_tests_otu <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(its18_div_tab)])) {</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;its18_shap_otu_&quot;</span>, .))</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>   its18_shap_tests_otu <span class="ot">&lt;-</span> <span class="fu">append</span>(its18_shap_tests_otu, tmp_name)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">shapiro.test</span>(its18_div_tab[[i]]))</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;shap_&quot;</span>)</span></code></pre></div>
</div>
<p>And then the Bartlett Test of Homogeneity of Variances.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>its18_div_tab_asv <span class="ot">&lt;-</span> its18_samp_data_tab</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>its18_bart_tests_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab_asv[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(its18_div_tab_asv)])) {</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;its18_bart_asv_&quot;</span>, .))</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>   its18_bart_tests_asv <span class="ot">&lt;-</span> <span class="fu">append</span>(its18_bart_tests_asv, tmp_name)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">bartlett.test</span>(its18_div_tab_asv[[i]] <span class="sc">~</span> TEMP, <span class="at">data =</span> its18_div_tab_asv))</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>its18_div_tab_otu <span class="ot">&lt;-</span> its18_samp_data_otu_tab</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>its18_bart_tests_otu <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab_otu[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(its18_div_tab_otu)])) {</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;its18_bart_otu_&quot;</span>, .))</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>   its18_bart_tests_otu <span class="ot">&lt;-</span> <span class="fu">append</span>(its18_bart_tests_otu, tmp_name)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">bartlett.test</span>(its18_div_tab_otu[[i]] <span class="sc">~</span> TEMP, <span class="at">data =</span> its18_div_tab_otu))</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_bart_&quot;</span>)</span></code></pre></div>
</div>
<p>Here we see which Shapiro-Wilk Normality <strong>and</strong> Bartlett tests were significant and which were not for the ASV analysis?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab_asv[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  tmp_get_shap <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;its18_shap_asv_&quot;</span>, .)))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  tmp_shap_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_shap[[<span class="dv">2</span>]], <span class="dv">4</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  tmp_get_bart <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;its18_bart_asv_&quot;</span>, .)))</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  tmp_bart_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_bart[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_get_shap[[<span class="dv">2</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> <span class="fu">isTRUE</span>(tmp_get_bart[[<span class="dv">3</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>))</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(i, <span class="st">&quot;Shapiro p-value =&quot;</span>, tmp_shap_p, </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Bartlett p-value =&quot;</span>, tmp_bart_p, </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Are both p-values &gt; 0.05?&quot;</span>, tmp_res)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(tmp_print,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Observed Shapiro p-value = 0.1284 Bartlett p-value = 0.5161 Are both p-values &gt; 0.05? TRUE 
Observed_pi Shapiro p-value = 0.1343 Bartlett p-value = 0.4543 Are both p-values &gt; 0.05? TRUE 
Observed_pe Shapiro p-value = 0.1616 Bartlett p-value = 0.6674 Are both p-values &gt; 0.05? TRUE 
Shannon_exp Shapiro p-value = 0.8456 Bartlett p-value = 0.4454 Are both p-values &gt; 0.05? TRUE 
Shannon_exp_pi Shapiro p-value = 0.9721 Bartlett p-value = 0.4363 Are both p-values &gt; 0.05? TRUE 
Shannon_exp_pe Shapiro p-value = 0.9194 Bartlett p-value = 0.5554 Are both p-values &gt; 0.05? TRUE 
InvSimpson Shapiro p-value = 0.1837 Bartlett p-value = 0.1258 Are both p-values &gt; 0.05? TRUE 
InvSimpson_pi Shapiro p-value = 0.9549 Bartlett p-value = 0.4768 Are both p-values &gt; 0.05? TRUE 
InvSimpson_pe Shapiro p-value = 0.9609 Bartlett p-value = 0.2362 Are both p-values &gt; 0.05? TRUE </code></pre>
</div>
<p>And which of the metrics are significant for the OTU analysis?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab_otu[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  tmp_get_shap <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;its18_shap_otu_&quot;</span>, .)))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  tmp_shap_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_shap[[<span class="dv">2</span>]], <span class="dv">4</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  tmp_get_bart <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;its18_bart_otu_&quot;</span>, .)))</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  tmp_bart_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_bart[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_get_shap[[<span class="dv">2</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> <span class="fu">isTRUE</span>(tmp_get_bart[[<span class="dv">3</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>))</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(i, <span class="st">&quot;Shapiro p-value =&quot;</span>, tmp_shap_p, </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Bartlett p-value =&quot;</span>, tmp_bart_p, </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Are both p-values &gt; 0.05?&quot;</span>, tmp_res)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(tmp_print,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Observed Shapiro p-value = 0.1837 Bartlett p-value = 0.5934 Are both p-values &gt; 0.05? TRUE 
Observed_pi Shapiro p-value = 0.0268 Bartlett p-value = 0.4436 Are both p-values &gt; 0.05? FALSE 
Observed_pe Shapiro p-value = 0.1076 Bartlett p-value = 0.898 Are both p-values &gt; 0.05? TRUE 
Shannon_exp Shapiro p-value = 0.5041 Bartlett p-value = 0.4471 Are both p-values &gt; 0.05? TRUE 
Shannon_exp_pi Shapiro p-value = 0.9238 Bartlett p-value = 0.3758 Are both p-values &gt; 0.05? TRUE 
Shannon_exp_pe Shapiro p-value = 0.7183 Bartlett p-value = 0.636 Are both p-values &gt; 0.05? TRUE 
InvSimpson Shapiro p-value = 0.1337 Bartlett p-value = 0.1673 Are both p-values &gt; 0.05? TRUE 
InvSimpson_pi Shapiro p-value = 0.3106 Bartlett p-value = 0.2679 Are both p-values &gt; 0.05? TRUE 
InvSimpson_pe Shapiro p-value = 0.4968 Bartlett p-value = 0.3296 Are both p-values &gt; 0.05? TRUE </code></pre>
</div>
<p>So wherever the value of both p-values in <code>&gt; 0.05</code> we can use an ANOVA, otherwise we use Kruskal-Wallis.</p>
<h3 id="significance-tests-1">Significance Tests</h3>
<p>To begin, we need to create a hierarchy variable; a two-column matrix specifying the relationship between samples (first column) and groups (second column).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>its18_hill_hier <span class="ot">&lt;-</span> its18_samp_data_tab</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>its18_hill_hier <span class="ot">&lt;-</span> its18_hill_hier <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;sample_id&quot;</span>, <span class="st">&quot;TEMP&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>its18_hill_hier <span class="ot">&lt;-</span> its18_hill_hier[<span class="fu">order</span>(its18_hill_hier<span class="sc">$</span>TEMP), ]</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>its18_hill_hier<span class="sc">$</span>TEMP <span class="ot">=</span> <span class="fu">paste</span>(its18_hill_hier<span class="sc">$</span>TEMP, <span class="st">&#39;C&#39;</span>, <span class="at">sep=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>its18_hill_hier <span class="ot">&lt;-</span> its18_hill_hier <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_hill_hier, <span class="st">&quot;files/alpha/rdata/its18_hill_hier.rds&quot;</span>)</span></code></pre></div>
</div>
<p>Again, we start by testing significance of ASV diversity for the full data set against each of the three metrics using the <code>div_test</code> function.</p>
<p>The command is as follows:</p>
<p><code>div_test(countable = x, qvalue = i, hierarchy = hier, tree = ultrametric_tree, posthoc = TRUE)</code>, where <code>x</code> is ASV by sample table, <code>i</code> is the q-value corresponding to the metric of interest, <code>hier</code> is the hierarchy matrix, <code>tree</code> is an ultrametric formatted phylogenetic tree (see below), and <code>posthoc</code> indicates whether to run post hoc pairwise analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;hack_code/div_test_jjs.R&quot;</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSA)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test_jjs</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> its18_hill_hier,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_q&quot;</span>, j, <span class="st">&quot;_adt&quot;</span>))</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="summary-1">Summary</h4>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table style="width:100%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 2%" />
<col style="width: 4%" />
<col style="width: 11%" />
<col style="width: 4%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 26%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">dataset</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">lineage</th>
<th style="text-align: left;">metric</th>
<th style="text-align: left;">q-value</th>
<th style="text-align: right;">normality p-value</th>
<th style="text-align: right;">homogeneity p-value</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">posthoc method</th>
<th style="text-align: right;">posthoc p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.1284212</td>
<td style="text-align: right;">0.5161063</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0061450</td>
</tr>
<tr class="even">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.8456387</td>
<td style="text-align: right;">0.4454001</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.2212163</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.1836713</td>
<td style="text-align: right;">0.1257827</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.1818723</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.1343394</td>
<td style="text-align: right;">0.4542512</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0000074</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.9721337</td>
<td style="text-align: right;">0.4363471</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.3464419</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.9548847</td>
<td style="text-align: right;">0.4767540</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.3417883</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.1616400</td>
<td style="text-align: right;">0.6673562</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0010871</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.9194147</td>
<td style="text-align: right;">0.5554159</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.1868931</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">ASV</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.9608862</td>
<td style="text-align: right;">0.2362368</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.2048504</td>
</tr>
<tr class="even">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.1837379</td>
<td style="text-align: right;">0.5933921</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0055785</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.5040810</td>
<td style="text-align: right;">0.4471188</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.2598239</td>
</tr>
<tr class="even">
<td style="text-align: left;">FULL</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.1336757</td>
<td style="text-align: right;">0.1673023</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.2496917</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0268341</td>
<td style="text-align: right;">0.4435751</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0081757</td>
</tr>
<tr class="even">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.9237960</td>
<td style="text-align: right;">0.3757598</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.1020852</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PIME</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.3106198</td>
<td style="text-align: right;">0.2678828</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.2336085</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.1076452</td>
<td style="text-align: right;">0.8979613</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0002692</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.7182849</td>
<td style="text-align: right;">0.6359563</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.2640847</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERfect</td>
<td style="text-align: left;">OTU</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.4968139</td>
<td style="text-align: right;">0.3295649</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.2877935</td>
</tr>
</tbody>
</table>
</div>
<p><em>Summary of significant tests.</em></p>
<p><br/></p>
<h3 id="posthoc-analyses-asv-data-sets-1">PostHoc Analyses (ASV data sets)</h3>
<p>First lets check the results of each posthoc analysis.</p>
<details>
<summary>
Detailed results of PostHoc Analyses for each metric
</summary>
<h4 id="observed-q-value-0-2">Observed (q-value = 0)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
         diff       P.adj
3C-0C  -68.70 0.768173881
8C-0C -394.45 0.006201167
8C-3C -325.75 0.025372568</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff          P.adj
3C-0C  -28.3 0.071121744588
8C-0C -107.8 0.000006170051
8C-3C  -79.5 0.000138893963</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff       P.adj
3C-0C  -5.35 0.898558605
8C-0C -60.60 0.001378091
8C-3C -55.25 0.003804791</code></pre>
</div>
<h4 id="shannon-exponential-q-value-1-2">Shannon exponential (q-value = 1)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff     P.adj
3C-0C  68.52857 0.1967805
8C-0C  34.59038 0.6257554
8C-3C -33.93820 0.6644870</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
             diff     P.adj
3C-0C  15.1283988 0.3777877
8C-0C   0.5613833 0.9985157
8C-3C -14.5670155 0.4381419</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
             diff     P.adj
3C-0C  13.7449005 0.2152611
8C-0C   0.3995566 0.9984731
8C-3C -13.3453440 0.2639185</code></pre>
</div>
<h4 id="simpson-multiplicative-i.e.-inverse-simpson-q-value-2-2">Simpson multiplicative (i.e., Inverse Simpson) (q-value = 2)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff     P.adj
3C-0C  30.12853 0.1597780
8C-0C  15.09562 0.5888250
8C-3C -15.03291 0.6216188</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff     P.adj
3C-0C  8.4231399 0.3705643
8C-0C  0.3894783 0.9976460
8C-3C -8.0336616 0.4372626</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff     P.adj
3C-0C  9.662568 0.2078889
8C-0C  1.449038 0.9592809
8C-3C -8.213530 0.3405328</code></pre>
</div>
</details>
<h3 id="posthoc-analyses-otu-data-sets-1">PostHoc Analyses (OTU data sets)</h3>
<p>Again, lets check the results of each posthoc analysis.</p>
<details>
<summary>
Detailed results of PostHoc Analyses for each metric
</summary>
<h4 id="observed-q-value-0-3">Observed (q-value = 0)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
         diff       P.adj
3C-0C  -74.60 0.652956841
8C-0C -343.35 0.005199564
8C-3C -268.75 0.029003111</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Observed)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
              Z       P.adj
0C-3C -1.875620 0.091061309
0C-8C  1.378006 0.168201373
3C-8C  3.086660 0.006072561</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
        diff        P.adj
3C-0C  -9.30 0.6626981212
8C-0C -64.55 0.0002980537
8C-3C -55.25 0.0014652925
$data
            Sample Group Value
1  P02_D00_010_C0A    0C   168
2  P04_D00_010_C0B    0C   169
3  P06_D00_010_C0C    0C   162
4  P08_D00_010_C0D    0C   129
5  P10_D00_010_C0E    0C   151
6  P01_D00_010_W3A    3C   160
7  P03_D00_010_W3B    3C   143
8  P07_D00_010_W3D    3C   153
9  P09_D00_010_W3E    3C   130
10 P01_D00_010_W8A    8C   110
11 P03_D00_010_W8B    8C    76
12 P05_D00_010_W8C    8C   101
13 P07_D00_010_W8D    8C    78

$normality.pvalue
[1] 0.1076452

$homogeneity.pvalue
[1] 0.8979613

$groups
[1] 3

$method
[1] &quot;ANOVA&quot;

$test
            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Group        2  10300    5150   20.88 0.000269 ***
Residuals   10   2467     247                     
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

$posthoc.method
[1] &quot;Tukey post-hoc test&quot;

$posthoc
        diff        P.adj
3C-0C  -9.30 0.6626981212
8C-0C -64.55 0.0002980537
8C-3C -55.25 0.0014652925</code></pre>
</div>
<h4 id="shannon-exponential-q-value-1-3">Shannon exponential (q-value = 1)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff     P.adj
3C-0C  48.10515 0.2330413
8C-0C  23.77528 0.6714344
8C-3C -24.32988 0.6863968</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff      P.adj
3C-0C  24.044634 0.08759277
8C-0C   8.775008 0.66773246
8C-3C -15.269627 0.35707124</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Shannon exponential)&quot;
[1] &quot;Tukey post-hoc test&quot;
            diff     P.adj
3C-0C  14.488149 0.2608150
8C-0C   2.648798 0.9497742
8C-3C -11.839351 0.4267835</code></pre>
</div>
<h4 id="simpson-multiplicative-i.e.-inverse-simpson-q-value-2-3">Simpson multiplicative (i.e., Inverse Simpson) (q-value = 2)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;FULL (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff     P.adj
3C-0C 22.285532 0.2270673
8C-0C 12.428081 0.5995926
8C-3C -9.857451 0.7435925</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PIME (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff     P.adj
3C-0C 11.337189 0.2077404
8C-0C  4.608783 0.7426439
8C-3C -6.728406 0.5738355</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;PERfect (Inverse Simpson)&quot;
[1] &quot;Tukey post-hoc test&quot;
           diff     P.adj
3C-0C 10.387733 0.2612182
8C-0C  3.811993 0.8154204
8C-3C -6.575741 0.5897141</code></pre>
</div>
</details>
<p>Now we can plot the results from the posthoc analyses for each metric and data set using the function <code>div_test_plot_jjs</code>. I modified the orihginal function (<code>div_test_plot</code>) to control a little of the formatting.</p>
<p>The command is as follows:</p>
<p><code>div_test_plot(divtest = x, chart = "type", colour = col.pal, posthoc = TRUE, threshold = value))</code>, where <code>x</code> is the results from the <code>div_test</code> function, <code>"type"</code> is chart type (box, jitter, or violin),<code>colour</code> is is a color palette, <code>posthoc</code> indicates whether to run posthoc pairwise analyses, and <code>value</code> is the maximum p-value to show in pairwise posthoc results. <strong>WARNING</strong> if none of the posthoc results are below the specified threshold, the function will throw an error. Therefore, until this is fixed, all posthoc values are shown.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;hack_code/div_test_plot_jjs_2.R&quot;</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>(<span class="at">pattern=</span><span class="st">&quot;_adt_plot&quot;</span>))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">&quot;_adt&quot;</span>)) {</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_plot&quot;</span>))</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">div_test_plot_jjs_2</span>(tmp_get, <span class="at">chart =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">colour =</span> swel_col, <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">ggpar</span>(tmp_df, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_adt&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<h3 id="alpha-diversity-plots-1">Alpha Diversity Plots</h3>
<p>Posthoc adjusted p-values given for each pairwise comparison.</p>
<h4 id="asv-data-sets-1">ASV data sets</h4>
<div class="layout-chunk" data-layout="l-page">
<div class="figure"><span id="fig:unnamed-chunk-118"></span>
<img src="include/alpha/its18_alph_div_plots_asv.png" alt="**Top row** = Observed; **middle row** = Shannon exponential; **bottom row** = Inverse Simpson." width="7086" />
<p class="caption">
Figure 3: <strong>Top row</strong> = Observed; <strong>middle row</strong> = Shannon exponential; <strong>bottom row</strong> = Inverse Simpson.
</p>
</div>
</div>
<h4 id="otu-data-sets-1">OTU data sets</h4>
<div class="layout-chunk" data-layout="l-page">
<div class="figure"><span id="fig:unnamed-chunk-119"></span>
<img src="include/alpha/its18_alph_div_plots_otu.png" alt="**Top row** = Observed; **middle row** = Shannon exponential; **bottom row** = Inverse Simpson." width="7086" />
<p class="caption">
Figure 4: <strong>Top row</strong> = Observed; <strong>middle row</strong> = Shannon exponential; <strong>bottom row</strong> = Inverse Simpson.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 class="appendix" id="source-code">Source Code</h2>
<p>The source code for this page can be accessed on GitHub by <a href="https://github.com/sweltr/high-temp/blob/master/alpha.Rmd">clicking this link</a>. Please note, that in order to process the data <em>and</em> build the website, we needed to run the workflow and get the results. Then hard code the results and turn off the individual commands. So the raw file for this page is a bit messyyou have been warned.</p>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-alberdi2019guide" class="csl-entry" role="doc-biblioentry">
Alberdi, Antton, and M Thomas P Gilbert. 2019a. <span>A Guide to the Application of Hill Numbers to DNA-Based Diversity Analyses.</span> <em>Molecular Ecology Resources</em> 19 (4): 80417. <a href="https://doi.org/10.1111/17550998.13014">https://doi.org/10.1111/17550998.13014</a>.
</div>
<div id="ref-alberdi2019hilldiv" class="csl-entry" role="doc-biblioentry">
. 2019b. <span>Hilldiv: An r Package for the Integral Analysis of Diversity Based on Hill Numbers.</span> <em>bioRxiv</em>, 545665. <a href="https://doi.org/10.1101/545665">https://doi.org/10.1101/545665</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/sweltr/high-temp/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/sweltr/high-temp/">https://github.com/sweltr/high-temp/</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p> Copyright 2021 The SWELTR Project.</p>
<p>Site constructed using <a href="https://rstudio.github.io/distill/">Distill for R Markdown</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
