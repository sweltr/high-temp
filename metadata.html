<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>: 8. Metadata Analysis</title>

  <meta property="description" itemprop="description" content="Workflow for to compare environmental metadata with microbial communities."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>


  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content=": 8. Metadata Analysis"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Workflow for to compare environmental metadata with microbial communities."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content=""/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content=": 8. Metadata Analysis"/>
  <meta property="twitter:description" content="Workflow for to compare environmental metadata with microbial communities."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Vegan: Community ecology package;citation_publication_date=2012;citation_volume=2;citation_author=Jari Oksanen;citation_author=F. Guillaume Blanchet;citation_author=Roeland Kindt;citation_author=Pierre Legendre;citation_author=Peter R. Minchin;citation_author=R. B. O’Hara;citation_author=Gavin L. Simpson;citation_author=Peter Sólymos;citation_author=M. Henry H. Stevens;citation_author=Helene Wagner"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["8. Metadata Analysis"]},{"type":"character","attributes":{},"value":["Workflow for to compare environmental metadata with microbial communities. \n"]},{"type":"character","attributes":{},"value":["assets/cite.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
  <script src="site_libs/clipboard-2.0.6/clipboard.min.js"></script>
  <link href="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
  <script src="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
  <script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clone fa-2x\" style=\"color: #004276\"><\/i>","success":"<i class=\"fa fa-check fa-2x\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times fa-2x\" style=\"color: #F94144\"><\/i>"})</script>
  <script src="site_libs/font-awesome-5.13.0/js/script.js"></script>
  <link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet" />
  <script src="site_libs/panelset-0.2.6/panelset.js"></script>
  <script src="site_libs/core-js-2.5.3/shim.min.js"></script>
  <script src="site_libs/react-17.0.0/react.min.js"></script>
  <script src="site_libs/react-17.0.0/react-dom.min.js"></script>
  <script src="site_libs/reactwidget-1.0.0/react-tools.js"></script>
  <script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <script src="site_libs/reactable-binding-0.2.3.9000/reactable.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <style type="text/css">
  /* Whole document: */
  @import url('https://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|Lato:300|Inconsolata|Source+Sans+Pro|Work+Sans:200,300,400,500|Karla:400,400i,700,700i');
  /********************************/
  /* controls general properties of site*/
  /********************************/

  body {
    color: #414141;
  /*  line-height: 1.7;
    font-size: 17px; */
    background-color: #FEFEFE;
  }

  d-title h1{
  font-size: 2.1em;
  font-family: 'Work Sans';
  font-weight: 300;
  }

  d-article h1 {
    font-size: 1.8em;
    font-family: 'Work Sans', 'Source Sans Pro', 'PT Sans';
    font-weight: 300;
  }

  d-article h2 {
    font-size: 1.65em;
    font-family: 'Work Sans', 'Source Sans Pro', 'PT Sans';
    font-weight: 500;
  }

  d-article h3 {
    margin-top: 1em;
    font-family: 'Work Sans', 'Source Sans Pro', 'PT Sans';
  }

  d-byline .authors-affiliations {
    grid-column-end: span 3;
    grid-column-gap: 8px;
  }

  img.orcid-id {
    margin: 0;
  }

  a.name:-webkit-any-link {
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  a.affiliation:-webkit-any-link {
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  blockquote p {
  	font-size: 1em;
  	font-family: 'Work Sans';
    font-style: normal;
    margin: 0.5em 0 0.5em;
  }

  d-article li {
    margin: 0px 0px 4px;
    font-size: 18px;
    font-family: 'Open Sans', 'Source Sans Pro', 'PT Sans';
  }

  /********************************/
  /* controls CODE*/
  /********************************/

  /** pre.sourceCode controls code block without lang **/

  /** Controls r code  **/

  pre.sourceCode.r {
    margin-top: 0px;
     color: #333333;
     background-color: #E8E8E8;
     border-radius: 3px;
     font-size: 0.80em;
     font-family: 'Monaco', 'PT Mono', monospace;
     overflow-x: scroll !important;
     border-left: 6px solid #2271B2;
     border-top: 1px solid #B7B7B7;
     border-right: 1px solid #B7B7B7;
     border-bottom: 1px solid #B7B7B7;
     padding: 18px 0px 18px 20px;
   }

   pre.sourceCode.bash {
     margin-top: 0px;
      color: #333333;
      background-color: #E8E8E8;
      border-radius: 3px;
      font-size: 0.80em;
      font-family: 'Monaco', 'PT Mono', monospace;
      overflow-x: scroll !important;
      border-left: 6px solid #B22271;
      border-top: 1px solid #B7B7B7;
      border-right: 1px solid #B7B7B7;
      border-bottom: 1px solid #B7B7B7;
      padding: 18px 0px 18px 20px;
    }
  /** Controls code output **/

  d-article pre {
     margin-top: 0px;
      color: #333333;
      background-color: #FAFAFA;
      font-size: 0.8em;
      border: 1px solid #ccc;
      overflow-x: scroll !important;
      padding:  10px 10px 10px 18px;
      border-radius: 5px;
    }

  /** Controls inline code  **/

  p code {
    background-color: #E8E8E8;
    border-radius: 3px;
    font-size: 0.8em;
    font-family: 'Monaco', 'PT Mono', monospace;
    overflow-x: scroll !important;
    margin-bottom: 20px;
    color: #BF2727;
  }

  li code {
    background-color: #E8E8E8;
    border-radius: 3px;
    font-size: 0.8em;
    font-family: 'Monaco', 'PT Mono', monospace;
    overflow-x: scroll !important;
    margin-bottom: 20px;
    color: #BF2727;
  }

  d-article aside code {
    background-color: #E8E8E8;
    border-radius: 3px;
    font-family: 'Monaco', 'PT Mono', monospace;
    color: #BF2727;
  }

  /********************************/
  /* controls NAV BAR and HEADERS*/
  /********************************/

  .nav-dropdown-content .nav-dropdown-header {
    text-transform: uppercase;
    color: #686868;
  }

  .nav-dropdown-content a {
    font-family: 'Work Sans'
  }
  .nav-dropdown .nav-dropbtn {
    color: #FEFEFE;
    font-weight: 400;
  }

  .distill-site-header .logo img {
    margin-top: 10px;
    max-height: 30px;
    margin-bottom: auto;
  }

  .distill-site-nav {
      color: #FEFEFE;
      background-color: #113858;
      font-size: 0.95em;
      font-weight: 400;
      min-width: 165px;
      position: absolute;
      font-family: 'Karla';
      letter-spacing: .1em;
      text-transform: uppercase;
  }

  img {
    margin: 5px;
  }

  /** LIGHTBOX MARKUP **/
  .thumbnail {
    max-width: 100%;
    position: relative;
  }

  /** DETAILS fold down**/

  details {
    background-color: #f6f6f6;
    cursor: pointer;
    color: #2d2d2d;
    margin-bottom:1vh;
    padding: 1em;
    border: none;
    text-align: left;
    outline: none;
  }

  .active, details:hover {
    transition: max-height 0.2s ease-out;
    outline: none;

    /* background-color: #acc2c2; */
  }

  details {
    display: flex;
    justify-content: space-between;
    align-content: center;
    border-radius: 4px;
    outline: none;
  }

  details.active {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    outline: none;
  }

  summary::-webkit-details-marker {
    display: none;
    outline: none;
  }

  summary:focus {
    outline: none;
  }

  summary::after {
    float: right;
    font-family: "Font Awesome 5 Free";
    content: "\f0fe";
  }

  details[open] summary::after {
    float: right;
    font-family: "Font Awesome 5 Free";
    content: "\f146";
  }

  /********************************/
  /* controls downloadthis  */
  /********************************/

  button.btn.btn-default {
    font-size: 0.8em;
    font-family: "PT Sans";
    border-color: #B22271;
    border-width: medium;
    margin-bottom: 15px;
  }

  /********************************/
  /* controls reactable  */
  /********************************/

  div.rt-text-content {
    font-size: 1.2em;
  }

  /********************************/
  /* next and previous buttons at the end of the article */
  /********************************/

  .btnnav {
    border: none;
    background-color: #113858;
    color: #f2f2f2;
    padding: 14px 28px;
    font-size: 16px;
    cursor: pointer;
    display: inline-block;
  }

  .button_round {border-radius: 12px;}

  </style>
  <!--/radix_placeholder_site_in_header-->

  <link rel="stylesheet" href="assets/styles.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"8. Metadata Analysis","description":"Workflow for to compare environmental metadata with microbial communities.","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="index.html">
<img src="assets/icon.png" alt="Logo"/>
</a>
<a href="index.html" class="title"></a>
</div>
<div class="nav-right">
<div class="nav-dropdown">
<button class="nav-dropbtn">
A. Processing
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<span class="nav-dropdown-header">Workflows</span>
<hr/>
<a href="dada2.html">1. DADA2</a>
<a href="data-prep.html">2. Data Set Prep</a>
<a href="filtering.html">3. Filtering</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
B. Diversity
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<span class="nav-dropdown-header">Workflows</span>
<hr/>
<a href="taxa.html">4. Taxonomic</a>
<a href="alpha.html">5. Alpha Diversity</a>
<a href="beta.html">6. Beta Diversity</a>
<a href="da.html">7. DA ASVs &amp; Taxa</a>
<a href="metadata.html">8. Metadata</a>
</div>
</div>
<a href="data-availability.html">Data</a>
<a href="som.html">SOM</a>
<a href="https://github.com/sweltr/high-temp/">
<i class="fa fa-github fa-lg" aria-hidden="true"></i>
</a>
<a href="about.html">
<i class="fa fa-question" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>8. Metadata Analysis</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Workflow for to compare environmental metadata with microbial
communities.</p></p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#synopsis">Synopsis</a>
<ul>
<li><a href="#workflow-input">Workflow Input</a></li>
<li><a href="#metadata">Metadata</a></li>
</ul></li>
<li><a href="#multivariate-summary">Multivariate Summary</a>
<ul>
<li><a href="#s-rrna">16S rRNA</a></li>
<li><a href="#its">ITS</a></li>
</ul></li>
<li><a href="#s-rrna-1">16s rRNA</a>
<ul>
<li><a href="#data-formating">Data Formating</a></li>
<li><a href="#choose-data-set">Choose Data Set</a></li>
<li><a href="#normality-tests">Normality Tests</a></li>
<li><a href="#normalize-parameters">Normalize Parameters</a></li>
<li><a href="#normalized-metadata">Normalized Metadata</a></li>
<li><a href="#autocorrelation-tests">Autocorrelation Tests</a></li>
<li><a href="#autocorrelation-plots">Autocorrelation Plots</a></li>
<li><a href="#dissimilarity-correlation-tests">Dissimilarity Correlation
Tests</a></li>
<li><a href="#best-subset-of-variables">Best Subset of
Variables</a></li>
<li><a href="#distance-based-redundancy">Distance-based
Redundancy</a></li>
<li><a href="#capscale-plots">Capscale Plots</a></li>
</ul></li>
<li><a href="#its-1">ITS</a>
<ul>
<li><a href="#data-formating-1">Data Formating</a></li>
<li><a href="#choose-data-set-1">Choose Data Set</a></li>
<li><a href="#normality-tests-1">Normality Tests</a></li>
<li><a href="#normalize-parameters-1">Normalize Parameters</a></li>
<li><a href="#normalized-metadata-1">Normalized Metadata</a></li>
<li><a href="#autocorrelation-tests-1">Autocorrelation Tests</a></li>
<li><a href="#autocorrelation-plots-1">Autocorrelation Plots</a></li>
<li><a href="#dissimilarity-correlation-tests-1">Dissimilarity
Correlation Tests</a></li>
<li><a href="#best-subset-of-variables-1">Best Subset of
Variables</a></li>
<li><a href="#distance-based-redundancy-1">Distance-based
Redundancy</a></li>
<li><a href="#capscale-plots-1">Capscale Plots</a></li>
</ul></li>
<li><a href="#workflow-output">Workflow Output</a>
<ul>
<li><a href="#source-code">Source Code</a></li>
<li><a href="#data-availability">Data Availability</a></li>
<li><a href="#last-updated-on">Last updated on</a></li>
</ul></li>
</ul>
</nav>
</div>
<details>
<summary>
<strong>Click here</strong> for setup information.
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">eval =</span> <span class="cn">FALSE</span>, <span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(conflicted)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_depends(vegan, local = TRUE)  </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_depends_reverse(vegan, local = TRUE)  </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq); <span class="fu">packageVersion</span>(<span class="st">&quot;phyloseq&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ape, bestNormalize, DT, tidyverse, gdata, mctoolsr, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               ggpubr, ggvegan, ggfortify, vegan, reactable, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               downloadthis, captioner,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">install =</span> <span class="cn">FALSE</span>, <span class="at">update =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_current<span class="sc">$</span><span class="fu">get</span>(<span class="fu">c</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;cache&quot;</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;cache.path&quot;</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;cache.rebuild&quot;</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;dependson&quot;</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;autodep&quot;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="synopsis">Synopsis</h1>
<p>In this workflow we compare the environmental metadata with the
microbial community data. Part 1 involves the <a href="#s-rrna-1">16S
rRNA</a> community data and Part 2 deals with the <a
href="#its-1">ITS</a> community data. Each workflow contains the same
major steps:</p>
<ol type="1">
<li>Metadata Normality Tests: Shapiro-Wilk Normality Test to test
whether each matadata parameter is normally distributed.</li>
<li>Normalize Parameters: R package <a
href="https://github.com/petersonR/bestNormalize"><code>bestNormalize</code></a>
to find and execute the best normalizing transformation.</li>
<li>Split Metadata parameters into groups: a) Environmental and edaphic
properties, b) Microbial functional responses, and c) Temperature
adaptation properties.</li>
<li>Autocorrelation Tests: Test all possible pair-wise comparisons, on
both normalized and non-normalized data sets, for each group.</li>
<li>Remove autocorrelated parameters from each group.</li>
<li>Dissimilarity Correlation Tests: Use Mantel Tests to see if any on
the metadata groups are significantly correlated with the community
data.</li>
<li>Best Subset of Variables: Determine which of the metadata parameters
from each group are the most strongly correlated with the community
data. For this we use the <code>bioenv</code> function from the
<code>vegan</code> <span class="citation"
data-cites="oksanen2013community">(<a href="#ref-oksanen2013community"
role="doc-biblioref">Oksanen et al. 2012</a>)</span> package.</li>
<li>Distance-based Redundancy Analysis: Ordination analysis of samples
and metadata vector overlays using <code>capscale</code>, also from the
<code>vegan</code> package.</li>
</ol>
<h2 id="workflow-input">Workflow Input</h2>
<p>Files needed to run this workflow can be downloaded from figshare.
You will also need the metadata table, which can be accessed below.</p>
<iframe src="https://widgets.figshare.com/articles/16826779/embed?show_title=1" width="568" height="251" allowfullscreen frameborder="0">
</iframe>
<h2 id="metadata">Metadata</h2>
<p>In this section we provide access to the complete environmental
metadata containing 61 parameters across all 15 samples.</p>
<p><br/></p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body-outset">
<a onclick="fetch(&#39;data:text/csv;base64,U2FtcGxlX0lELFBMT1QsVFJFQVQsVFJFQVRfVCxQQUlSLFNFQVNPTixBVEFQLEFTVCxIMk8sTixQLEFsLENhLEZlLEssTWcsTW4sTmEsVEVCLEVDRUMscEgsbWluUE80LG1pbk5INCxtaW5OTzMsbWluVElOLE5INCxOTzMsUE80LERPQyxET04sRE9DTixtaWNDLG1pY04sbWljUCxtaWNDTixtaWNDUCxtaWNOUCxBR19hc2UsQkdfYXNlLEJQX2FzZSxDRV9hc2UsUF9hc2UsTl9hc2UsU19hc2UsWFlfYXNlLEFHX1ExMCxCR19RMTAsQlBfUTEwLENFX1ExMCxQX1ExMCxOX1ExMCxTX1ExMCxYWV9RMTAsQ08yLExQX2FzZSxMUF9RMTAsUFhfYXNlLFBYX1ExMCxDVUVjbixDVUVjcCxOVUUsUFVFLFRtaW4sU0ksZW56Q04sZW56Q1AsZW56TlAKUDAxX0QwMF8wMTBfVzNBLFAwMSxXLDMsQSxXLDI5LDI5LjM4LDAuMzk5OSwwLjQyNjcsMC4zNSwwLDMxLjQzLDAuMDEsMS43Miw5Ljk4LDAuMDQsMC4xNSw0My4zLDQzLjMsNi4wMSwxLjMzLDMuNjcsNDcuMTcsNTAuODMsOC4wMyw0LjY3LDkuNTIsMTE4Ljc0LDExLjY2LDExLjE1LDY5MC4xMSwxMzUuNDgsODcuOTgsNC42MSw4LjYxLDEuNzQsMC4yNiw0LjEsMy41LDEsMjAuNDMsNS42Myw2LjA4LDEuMTcsMS43NywxLjM4LDEuMzksMi4wMywxLjM3LDEuNDYsMS4zLDEuNzIsMTEuNzgsNTIuOCwxLjc2LDE0Ny4xMywxLjIyLDAuMzIsMC4yMSwwLjc3LDAuODgsMC4wNywxLjUxLDAuNDYxNCwwLjU5MTEsMS4yODEyClAwMV9EMDBfMDEwX1c4QSxQMDEsVyw4LEEsVywzNCwzMC42NiwwLjI2MSwwLjQyNjcsMC4zNSwwLDMxLjQzLDAuMDEsMS43Miw5Ljk4LDAuMDQsMC4xNSw0My4zLDQzLjMsNi4wMSwwLjEyLDEuNjUsMTEuMzEsMTIuOTYsNC4wOCwyLjY1LDguNTUsMzkuNyw0LjIsOS40NSw0NjksODQsNTUsNS41OCw4LjQ4LDEuNTIsMC4xNSw2Ljk3LDUuMzQsMi4wNywyNS42NSw0LjUyLDYuNywyLjUyLDIuMDEsMS43NSwxLjUxLDEuODcsMS4zOSwxLjU2LDEuNjUsMS44Niw0LjI4LDQwLjY5LDEuNzEsMjExLjE4LDEuMDcsMC4yMywwLjE4LDAuODcsMC45LDIuMTksMi4zLDAuNjQ1NiwwLjcxNjYsMS4xMQpQMDJfRDAwXzAxMF9DMEEsUDAyLEMsMCxBLFcsMjYsMjYuMiwwLjM3OTMsMC4zMzY3LDAuNDMsMC4wMSwzNi42NSwwLjAxLDAuNjksOC4xNiwwLjA0LDAuMTEsNDUuNiw0NS43LDYuMTgsMS40MiwzLjkyLDI0LjMzLDI4LjI1LDQuODEsMy4xMyw3LjU4LDc1Ljg2LDguMjIsOS40NCw0NDQuNzIsMTEwLjEzLDY1LjAzLDQuNDIsOC4xMywyLjM3LDAuMjQsNC4yMiwyLjU0LDEuMDksMTUuMDcsMy41NCwzLjgsMS4wMSwxLjUxLDEuMzEsMS4zNCwxLjg5LDEuMjIsMS41NCwxLjIzLDEuNTksNS4yNywzOC42MSwxLjgxLDk0LjEzLDEuNTgsMC4yMiwwLjIxLDAuODcsMC44OCwwLjE0LDEuNDQsMC41MDI0LDAuNjU1NCwxLjMwNDQKUDAzX0QwMF8wMTBfVzNCLFAwMyxXLDMsQixXLDI5LDI5LjI5LDAuNDAwNywwLjMyLDAuMzcsMC4wMSwyNy4xOSwwLjAxLDAuODUsMTYuNTEsMC4wNiwwLjEyLDQ0LjcsNDQuNyw1Ljg2LDIuODMsMy4zMyw0Mi41LDQ1LjgzLDMuMTEsMi41Nyw4LjY2LDYwLjU3LDYuNDgsMTAuMTIsMzY0LjYyLDY2LjQsNzAuNjgsNS4wNyw2LjcsMS4zMSwwLjMzLDQuMzcsMy4wNSwxLjI2LDE5LjIxLDMuNTgsNS43MiwxLjM2LDIuNDgsMS4zNiwxLjQyLDEuOTksMS4yNywxLjU0LDEuMjcsMS43Miw0LjQ2LDMyLjEsMiwxMTkuNzUsMS40MSwwLjI2LDAuMTgsMC44NCwwLjksLTAuMjksMS40OSwwLjU1NjUsMC42NDEyLDEuMTUyMgpQMDNfRDAwXzAxMF9XOEIsUDAzLFcsOCxCLFcsMzQsNDEuNzcsMC4yNDMsMC4zMiwwLjM3LDAuMDEsMjcuMTksMC4wMSwwLjg1LDE2LjUxLDAuMDYsMC4xMiw0NC43LDQ0LjcsNS44NiwwLjIsMS4yOCwyMi43MSwyMy45OSwyLjUsMS4wNiwyLjgsMzMuMiwyLjUsMTMuMjksMTE3LDIwLDExLDUuODUsMTAuNTQsMS44LDAuMDIsMy4wNCwyLjg5LDAuNjUsMTguMTEsMi45MSwxLjI4LDAuNzYsMS40OSwxLjU2LDEuNTUsMS45LDEuNTEsMS43NSwxLjM5LDEuODksNDAuNDcsMTMuOTQsMS43NywyMjUuNTYsMS4xNSwwLjI5LDAuMzMsMC44MSwwLjc3LDAuNjMsMS43MiwwLjUzMDIsMC40OTE4LDAuOTI3NwpQMDRfRDAwXzAxMF9DMEIsUDA0LEMsMCxCLFcsMjYsMjYuMjksMC4zODMyLDAuMzAzMywwLjMzLDAsMjkuMjMsMC4wMiwxLjE4LDE0LjU5LDAuMTIsMC4xNCw0NS4xLDQ1LjMsNS43MywxLjUsMy4xNywxOS45MiwyMy4wOCw1LjU3LDMuMjIsNy45NSw1OS41MSw2LjMyLDEwLjY3LDQ0MC42LDg2LjE5LDgxLjQ1LDUuMTQsNS4zOSwxLjA5LDAuMjIsNC41NywzLjAyLDEuMDksMjAuMjcsMy42NSw0LjkyLDEuMTEsMS41MSwxLjUsMS41OCwyLjMsMS4zNywxLjg1LDEuMzksMS43Niw0LjA2LDI5LjUxLDIuMTQsODEuMjUsMS4yNCwwLjI1LDAuMTksMC44NSwwLjksLTIuNjMsMS4yNSwwLjU1NSwwLjYxNzMsMS4xMTIzClAwNV9EMDBfMDEwX1czQyxQMDUsVywzLEMsVywyOSwyOC41MywwLjM1NDUsMC4zMzMzLDAuMzMsMCwyNi4xNCwwLDAuNjcsMTQuODMsMC4wNSwwLDQxLjYsNDEuNyw1Ljg3LDEuMTcsMi4xNywxMS4yNSwxMy40MiwyLjMyLDMuMzEsNy4zLDY0Ljk4LDcuMDMsMTEuOTMsMjg0LjUsNDguNzksNTIuNSw1LjU3LDguMzMsMS4zOSwwLjM0LDMuMDEsMi4zNCwwLjc2LDE1LjE5LDIuNjEsMy4yLDAuODYsMS40OCwxLjM1LDEuMzksMS44OCwxLjI4LDEuNTEsMS4zLDEuODIsNC42MiwyNC4xMSwxLjc5LDExMC43NSwxLjMzLDAuMjcsMC4xOCwwLjgzLDAuOSwwLjgxLDEuNzcsMC40ODc3LDAuNTU5NiwxLjE0NzMKUDA1X0QwMF8wMTBfVzhDLFAwNSxXLDgsQyxXLDM0LDM2LjI0LDAuMjMzLDAuMzMzMywwLjMzLDAsMjYuMTQsMCwwLjY3LDE0LjgzLDAuMDUsMCw0MS42LDQxLjcsNS44NywwLjExLDEuMTgsMzYuNjEsMzcuNzksMy45MSwyLjMsNC4yNSw0NSw0LjMsMTAuNDYsNDQwLDk3LDU2LDQuNTQsNy45MSwxLjc0LDAuMTUsOS4wOSw3LjI4LDEuNSw0NC4wNCw1LjU2LDUuNTcsMS43NSwxLjczLDEuNzIsMS40MiwxLjk1LDEuNDgsMS42OCwxLjYsMS44OCwxNS4zNywzMi42NSwxLjY3LDI0NS42NSwxLjIzLDAuMTksMC4yMywwLjksMC44NywwLjk0LDIuMDgsMC42OTMxLDAuNjQxMiwwLjkyNTEKUDA2X0QwMF8wMTBfQzBDLFAwNixDLDAsQyxXLDI2LDI2LjI2LDAuMzc3NCwwLjMzMzMsMC4zLDAsMzIuMDcsMCwwLjU3LDIxLjMyLDAuMDYsMC4xNCw1NC4xLDU0LjIsNS45MywwLjc1LDEuODMsMTkuNjcsMjEuNSwyLjkyLDIuMjcsNy4wNCw1Ni42OCw1LjQyLDExLjA5LDM5MC42Niw3Mi42MSw4NS43LDUuMjYsNC41LDAuODMsMC4yMSwzLjIyLDIuMzMsMC43NSwxNC43OSwyLjU3LDUuNDUsMC42NiwxLjgzLDEuMzEsMS40NCwyLjM2LDEuMjQsMS42LDEuNDcsMS42Myw0LjI4LDI3Ljc4LDEuODUsOTIuNSwxLjUzLDAuMjcsMC4xNiwwLjgzLDAuOTIsLTAuMTMsMS40MiwwLjQ2MjQsMC41NTU2LDEuMjAxNwpQMDdfRDAwXzAxMF9XM0QsUDA3LFcsMyxELFcsMjksMjguNzgsMC4zODQ5LDAuNDM2NywwLjM1LDAsMjguMTMsMC4wMSwxLjYsMTguODcsMC4wNywwLjEsNDguNyw0OC44LDYuMjEsMSwyLjQyLDIwLjY3LDIzLjA4LDQuMjgsNS4wNyw5LjE1LDczLjk4LDguNDcsOS45MywzOTYuNDIsNzMuNzMsOTMuMTMsNC43Miw0LjY2LDAuOTgsMC4zMiw0LjE0LDMuNDUsMS4wNywyMy4yNiwzLjcsNS44NiwxLjExLDEuNzIsMS40NSwxLjQ2LDEuNzYsMS4yOCwxLjM2LDEuMywxLjYzLDYuMTksNDIuNCwxLjk2LDk3LDEuMTUsMC4yNywwLjE1LDAuODMsMC45MiwwLjY1LDEuNjEsMC40OTQxLDAuNTc2MiwxLjE2NjIKUDA3X0QwMF8wMTBfVzhELFAwNyxXLDgsRCxXLDM0LDI5LjksMC4yMDQsMC40MzY3LDAuMzUsMCwyOC4xMywwLjAxLDEuNiwxOC44NywwLjA3LDAuMSw0OC43LDQ4LjgsNi4yMSwwLjAyLDIuNiwxMi4zMSwxNC45MSw4LjE5LDYuMzksNS42Miw0NC4zLDMuNywxMS45OCw2NzYsMTQ3LDk0LDQuNiw3LjE4LDEuNTYsMC4zOSw4LjYxLDcuMTEsMS41MywzNS4xLDguMzQsMTAuNjgsMS40MiwxLjMxLDEuMzksMS40MiwxLjk2LDEuMzMsMS41NCwxLjUxLDEuOTEsOC44Nyw1Ny4xMywxLjQsMjk0LjM5LDEuMjcsMC4yNiwwLjE3LDAuODQsMC45MSwxLjQ4LDEuODEsMC41OTMzLDAuNjYyOCwxLjExNzMKUDA4X0QwMF8wMTBfQzBELFAwOCxDLDAsRCxXLDI2LDI1LjgsMC40MDExLDAuMjQzMywwLjI3LDAsMjUuNDksMCwxLjg2LDE0LjkzLDAuMDIsMC4wOCw0Mi4zLDQyLjQsNi4wMSwzLjY3LDQuMzMsMTA2LjQyLDExMC43NSwyLjA0LDMuNzEsNS45Nyw0NC44OSw1LjIyLDExLjU3LDI3Ny4zNyw1Ni41NSwzMy40LDQuNzIsMTEuNTUsMi40NSwwLjE1LDMuNTUsMS43NywwLjY4LDEzLjAyLDIuOTUsMy41NiwwLjcxLDIuMDgsMS43NiwxLjc0LDIsMS40OCwxLjY5LDEuNDgsMS44MywyLjA4LDIxLjk2LDIuMDcsOTIuMzgsMy41OCwwLjI0LDAuMjIsMC44NSwwLjg4LDAsMS41NCwwLjUwNTgsMC42MDM3LDEuMTkzNQpQMDlfRDAwXzAxMF9XM0UsUDA5LFcsMyxFLFcsMjksMjguOCwwLjM2NDYsMC4yODMzLDAuMzYsMC4wMiwzOS43OSwwLjA0LDEuMDksMjAuNjQsMC4wOCwwLjE5LDYxLjcsNjEuOCw2LjEsMi41OCwzLjUsMTEuNTgsMTUuMDgsMi4wMywyLjksOC4yOCw0My44NCw1LjU2LDEyLjIxLDM5Mi41Niw2Mi4zNyw2Ni42NSw1Ljc4LDcuMzQsMS4xOSwwLjIsMy45MiwyLjI2LDAuODYsMTYuOSwyLjgzLDUuMjYsMS4wMSwxLjY3LDEuMzYsMS41NiwxLjgxLDEuMzUsMS40OCwxLjMyLDEuODQsOS4zOSwzMC4zNywxLjksMTIyLjYzLDEuMzksMC4yNiwwLjIxLDAuODQsMC44OCwtMC4yNCwxLjUxLDAuNTExMiwwLjYwNjQsMS4xODYyClAwOV9EMDBfMDEwX1c4RSxQMDksVyw4LEUsVywzNCwzMS42MSwwLjM1OSwwLjI4MzMsMC4zNiwwLjAyLDM5Ljc5LDAuMDQsMS4wOSwyMC42NCwwLjA4LDAuMTksNjEuNyw2MS44LDYuMSwwLDAuOTIsNy44NCw4Ljc2LDYuNSwyLjc2LDYuMDgsMzAuOCwxLjYsMTkuMjcsNDE2LDkxLDYzLDQuNTcsNi42LDEuNDQsMC4zNywxMC40OCw2LjQ2LDIuMjEsMzUuNzUsOS40MywxMS43OCwxLjg0LDEuOTMsMS41MywxLjQ0LDIuMTEsMS4zOCwxLjQ2LDEuNSwxLjc2LDEzLjYsNTMuNzksMS43OSwzMzkuNiwxLjI3LDAuMjQsMC4xOSwwLjg1LDAuODksMC45NiwxLjgyLDAuNjUxNSwwLjcyMTgsMS4xMDc5ClAxMF9EMDBfMDEwX0MwRSxQMTAsQywwLEUsVywyNiwyNi4wOSwwLjM3MDIsMC4yNiwwLjMyLDAuMDIsMzcuMDYsMC4wMSwxLjM4LDIxLjQzLDAuMDcsMC4xMyw2MCw2MC4xLDYuMjgsNC4wOCw0Ljc1LDM3LjMzLDQyLjA4LDMuNDQsNC41Myw5LjQ1LDYzLjc5LDQuOTEsMTQuNjcsMzM0LjkzLDcyLjY0LDY0LjIzLDQuNDksNS41NCwxLjE3LDAuMjgsNC42MiwyLjExLDAuODYsMTQuOCwzLjM3LDQuNTQsMC43MiwxLjU0LDEuMzcsMS40MSwxLjgxLDEuMjcsMS40NywxLjMzLDEuNjUsNS4yMSwzMi4yMiwxLjgsMTExLjg4LDEuMTQsMC4yMiwwLjE2LDAuODcsMC45MiwtMi40NiwxLjI5LDAuNTIzMSwwLjY2MDcsMS4yNjMK&#39;).then(res =&gt; res.blob()).then(blob =&gt; {&#10;      const downloadURL = window.URL.createObjectURL(blob);&#10;      const a = document.createElement(&#39;a&#39;);&#10;      document.body.appendChild(a);&#10;      a.href = downloadURL;&#10;      a.download = &#39;metadata.csv&#39;; a.click();&#10;      window.URL.revokeObjectURL(downloadURL);&#10;      document.body.removeChild(a);&#10;    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
<p><small><strong>(common) Table 1 | Metadata values for each
sample.</strong></small></p>
<div class="layout-chunk" data-layout="l-body-outset">
<div id="htmlwidget-dc29ecf1654ad0043dad" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dc29ecf1654ad0043dad">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"PLOT":["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],"TREAT":["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],"TREAT_T":[3,8,0,3,8,0,3,8,0,3,8,0,3,8,0],"PAIR":["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],"SEASON":["W","W","W","W","W","W","W","W","W","W","W","W","W","W","W"],"ATAP":[29,34,26,29,34,26,29,34,26,29,34,26,29,34,26],"AST":[29.38,30.66,26.2,29.29,41.77,26.29,28.53,36.24,26.26,28.78,29.9,25.8,28.8,31.61,26.09],"H2O":[0.3999,0.261,0.3793,0.4007,0.243,0.3832,0.3545,0.233,0.3774,0.3849,0.204,0.4011,0.3646,0.359,0.3702],"N":[0.4267,0.4267,0.3367,0.32,0.32,0.3033,0.3333,0.3333,0.3333,0.4367,0.4367,0.2433,0.2833,0.2833,0.26],"P":[0.35,0.35,0.43,0.37,0.37,0.33,0.33,0.33,0.3,0.35,0.35,0.27,0.36,0.36,0.32],"Al":[0,0,0.01,0.01,0.01,0,0,0,0,0,0,0,0.02,0.02,0.02],"Ca":[31.43,31.43,36.65,27.19,27.19,29.23,26.14,26.14,32.07,28.13,28.13,25.49,39.79,39.79,37.06],"Fe":[0.01,0.01,0.01,0.01,0.01,0.02,0,0,0,0.01,0.01,0,0.04,0.04,0.01],"K":[1.72,1.72,0.69,0.85,0.85,1.18,0.67,0.67,0.57,1.6,1.6,1.86,1.09,1.09,1.38],"Mg":[9.98,9.98,8.16,16.51,16.51,14.59,14.83,14.83,21.32,18.87,18.87,14.93,20.64,20.64,21.43],"Mn":[0.04,0.04,0.04,0.06,0.06,0.12,0.05,0.05,0.06,0.07,0.07,0.02,0.08,0.08,0.07],"Na":[0.15,0.15,0.11,0.12,0.12,0.14,0,0,0.14,0.1,0.1,0.08,0.19,0.19,0.13],"TEB":[43.3,43.3,45.6,44.7,44.7,45.1,41.6,41.6,54.1,48.7,48.7,42.3,61.7,61.7,60],"ECEC":[43.3,43.3,45.7,44.7,44.7,45.3,41.7,41.7,54.2,48.8,48.8,42.4,61.8,61.8,60.1],"pH":[6.01,6.01,6.18,5.86,5.86,5.73,5.87,5.87,5.93,6.21,6.21,6.01,6.1,6.1,6.28],"minPO4":[1.33,0.12,1.42,2.83,0.2,1.5,1.17,0.11,0.75,1,0.02,3.67,2.58,0,4.08],"minNH4":[3.67,1.65,3.92,3.33,1.28,3.17,2.17,1.18,1.83,2.42,2.6,4.33,3.5,0.92,4.75],"minNO3":[47.17,11.31,24.33,42.5,22.71,19.92,11.25,36.61,19.67,20.67,12.31,106.42,11.58,7.84,37.33],"minTIN":[50.83,12.96,28.25,45.83,23.99,23.08,13.42,37.79,21.5,23.08,14.91,110.75,15.08,8.76,42.08],"NH4":[8.03,4.08,4.81,3.11,2.5,5.57,2.32,3.91,2.92,4.28,8.19,2.04,2.03,6.5,3.44],"NO3":[4.67,2.65,3.13,2.57,1.06,3.22,3.31,2.3,2.27,5.07,6.39,3.71,2.9,2.76,4.53],"PO4":[9.52,8.55,7.58,8.66,2.8,7.95,7.3,4.25,7.04,9.15,5.62,5.97,8.28,6.08,9.45],"DOC":[118.74,39.7,75.86,60.57,33.2,59.51,64.98,45,56.68,73.98,44.3,44.89,43.84,30.8,63.79],"DON":[11.66,4.2,8.22,6.48,2.5,6.32,7.03,4.3,5.42,8.47,3.7,5.22,5.56,1.6,4.91],"DOCN":[11.15,9.45,9.44,10.12,13.29,10.67,11.93,10.46,11.09,9.93,11.98,11.57,12.21,19.27,14.67],"micC":[690.11,469,444.72,364.62,117,440.6,284.5,440,390.66,396.42,676,277.37,392.56,416,334.93],"micN":[135.48,84,110.13,66.4,20,86.19,48.79,97,72.61,73.73,147,56.55,62.37,91,72.64],"micP":[87.98,55,65.03,70.68,11,81.45,52.5,56,85.7,93.13,94,33.4,66.65,63,64.23],"micCN":[4.61,5.58,4.42,5.07,5.85,5.14,5.57,4.54,5.26,4.72,4.6,4.72,5.78,4.57,4.49],"micCP":[8.61,8.48,8.13,6.7,10.54,5.39,8.33,7.91,4.5,4.66,7.18,11.55,7.34,6.6,5.54],"micNP":[1.74,1.52,2.37,1.31,1.8,1.09,1.39,1.74,0.83,0.98,1.56,2.45,1.19,1.44,1.17],"AG_ase":[0.26,0.15,0.24,0.33,0.02,0.22,0.34,0.15,0.21,0.32,0.39,0.15,0.2,0.37,0.28],"BG_ase":[4.1,6.97,4.22,4.37,3.04,4.57,3.01,9.09,3.22,4.14,8.61,3.55,3.92,10.48,4.62],"BP_ase":[3.5,5.34,2.54,3.05,2.89,3.02,2.34,7.28,2.33,3.45,7.11,1.77,2.26,6.46,2.11],"CE_ase":[1,2.07,1.09,1.26,0.65,1.09,0.76,1.5,0.75,1.07,1.53,0.68,0.86,2.21,0.86],"P_ase":[20.43,25.65,15.07,19.21,18.11,20.27,15.19,44.04,14.79,23.26,35.1,13.02,16.9,35.75,14.8],"N_ase":[5.63,4.52,3.54,3.58,2.91,3.65,2.61,5.56,2.57,3.7,8.34,2.95,2.83,9.43,3.37],"S_ase":[6.08,6.7,3.8,5.72,1.28,4.92,3.2,5.57,5.45,5.86,10.68,3.56,5.26,11.78,4.54],"XY_ase":[1.17,2.52,1.01,1.36,0.76,1.11,0.86,1.75,0.66,1.11,1.42,0.71,1.01,1.84,0.72],"AG_Q10":[1.77,2.01,1.51,2.48,1.49,1.51,1.48,1.73,1.83,1.72,1.31,2.08,1.67,1.93,1.54],"BG_Q10":[1.38,1.75,1.31,1.36,1.56,1.5,1.35,1.72,1.31,1.45,1.39,1.76,1.36,1.53,1.37],"BP_Q10":[1.39,1.51,1.34,1.42,1.55,1.58,1.39,1.42,1.44,1.46,1.42,1.74,1.56,1.44,1.41],"CE_Q10":[2.03,1.87,1.89,1.99,1.9,2.3,1.88,1.95,2.36,1.76,1.96,2,1.81,2.11,1.81],"P_Q10":[1.37,1.39,1.22,1.27,1.51,1.37,1.28,1.48,1.24,1.28,1.33,1.48,1.35,1.38,1.27],"N_Q10":[1.46,1.56,1.54,1.54,1.75,1.85,1.51,1.68,1.6,1.36,1.54,1.69,1.48,1.46,1.47],"S_Q10":[1.3,1.65,1.23,1.27,1.39,1.39,1.3,1.6,1.47,1.3,1.51,1.48,1.32,1.5,1.33],"XY_Q10":[1.72,1.86,1.59,1.72,1.89,1.76,1.82,1.88,1.63,1.63,1.91,1.83,1.84,1.76,1.65],"CO2":[11.78,4.28,5.27,4.46,40.47,4.06,4.62,15.37,4.28,6.19,8.87,2.08,9.39,13.6,5.21],"LP_ase":[52.8,40.69,38.61,32.1,13.94,29.51,24.11,32.65,27.78,42.4,57.13,21.96,30.37,53.79,32.22],"LP_Q10":[1.76,1.71,1.81,2,1.77,2.14,1.79,1.67,1.85,1.96,1.4,2.07,1.9,1.79,1.8],"PX_ase":[147.13,211.18,94.13,119.75,225.56,81.25,110.75,245.65,92.5,97,294.39,92.38,122.63,339.6,111.88],"PX_Q10":[1.22,1.07,1.58,1.41,1.15,1.24,1.33,1.23,1.53,1.15,1.27,3.58,1.39,1.27,1.14],"CUEcn":[0.32,0.23,0.22,0.26,0.29,0.25,0.27,0.19,0.27,0.27,0.26,0.24,0.26,0.24,0.22],"CUEcp":[0.21,0.18,0.21,0.18,0.33,0.19,0.18,0.23,0.16,0.15,0.17,0.22,0.21,0.19,0.16],"NUE":[0.77,0.87,0.87,0.84,0.81,0.85,0.83,0.9,0.83,0.83,0.84,0.85,0.84,0.85,0.87],"PUE":[0.88,0.9,0.88,0.9,0.77,0.9,0.9,0.87,0.92,0.92,0.91,0.88,0.88,0.89,0.92],"Tmin":[0.07,2.19,0.14,-0.29,0.63,-2.63,0.81,0.94,-0.13,0.65,1.48,0,-0.24,0.96,-2.46],"SI":[1.51,2.3,1.44,1.49,1.72,1.25,1.77,2.08,1.42,1.61,1.81,1.54,1.51,1.82,1.29],"enzCN":[0.4614,0.6456,0.5024,0.5565,0.5302,0.555,0.4877,0.6931,0.4624,0.4941,0.5933,0.5058,0.5112,0.6515,0.5231],"enzCP":[0.5911,0.7166,0.6554,0.6412,0.4918,0.6173,0.5596,0.6412,0.5556,0.5762,0.6628,0.6037,0.6064,0.7218,0.6607],"enzNP":[1.2812,1.11,1.3044,1.1522,0.9277,1.1123,1.1473,0.9251,1.2017,1.1662,1.1173,1.1935,1.1862,1.1079,1.263]},"columns":[{"accessor":"Sample_ID","name":"Sample ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"header":"Sample ID","align":"left","headerStyle":{"borderRight":"1px solid #eee","fontSize":"0.9em"},"footerStyle":{"fontWeight":"bold"},"minWidth":150,"sticky":"left","style":{"borderRight":"1px solid #eee"}},{"accessor":"PLOT","name":"PLOT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],"header":"PLOT","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"TREAT","name":"TREAT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],"header":"TREAT","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"TREAT_T","name":"TREAT_T","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],"header":"TREAT T","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PAIR","name":"PAIR","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],"header":"PAIR","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"SEASON","name":"SEASON","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["W","W","W","W","W","W","W","W","W","W","W","W","W","W","W"],"header":"SEASON","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"ATAP","name":"ATAP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["29","34","26","29","34","26","29","34","26","29","34","26","29","34","26"],"header":"ATAP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AST","name":"AST","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["29.38","30.66","26.2","29.29","41.77","26.29","28.53","36.24","26.26","28.78","29.9","25.8","28.8","31.61","26.09"],"header":"AST","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"H2O","name":"H2O","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.3999","0.261","0.3793","0.4007","0.243","0.3832","0.3545","0.233","0.3774","0.3849","0.204","0.4011","0.3646","0.359","0.3702"],"header":"H2O","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N","name":"N","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.4267","0.4267","0.3367","0.32","0.32","0.3033","0.3333","0.3333","0.3333","0.4367","0.4367","0.2433","0.2833","0.2833","0.26"],"header":"N","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P","name":"P","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.35","0.35","0.43","0.37","0.37","0.33","0.33","0.33","0.3","0.35","0.35","0.27","0.36","0.36","0.32"],"header":"P","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Al","name":"Al","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.0","0.0","0.01","0.01","0.01","0.0","0.0","0.0","0.0","0.0","0.0","0.0","0.02","0.02","0.02"],"header":"Al","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Ca","name":"Ca","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["31.43","31.43","36.65","27.19","27.19","29.23","26.14","26.14","32.07","28.13","28.13","25.49","39.79","39.79","37.06"],"header":"Ca","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Fe","name":"Fe","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.01","0.01","0.01","0.01","0.01","0.02","0.0","0.0","0.0","0.01","0.01","0.0","0.04","0.04","0.01"],"header":"Fe","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"K","name":"K","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.72","1.72","0.69","0.85","0.85","1.18","0.67","0.67","0.57","1.6","1.6","1.86","1.09","1.09","1.38"],"header":"K","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Mg","name":"Mg","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["9.98","9.98","8.16","16.51","16.51","14.59","14.83","14.83","21.32","18.87","18.87","14.93","20.64","20.64","21.43"],"header":"Mg","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Mn","name":"Mn","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.04","0.04","0.04","0.06","0.06","0.12","0.05","0.05","0.06","0.07","0.07","0.02","0.08","0.08","0.07"],"header":"Mn","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Na","name":"Na","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.15","0.15","0.11","0.12","0.12","0.14","0.0","0.0","0.14","0.1","0.1","0.08","0.19","0.19","0.13"],"header":"Na","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"TEB","name":"TEB","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["43.3","43.3","45.6","44.7","44.7","45.1","41.6","41.6","54.1","48.7","48.7","42.3","61.7","61.7","60.0"],"header":"TEB","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"ECEC","name":"ECEC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["43.3","43.3","45.7","44.7","44.7","45.3","41.7","41.7","54.2","48.8","48.8","42.4","61.8","61.8","60.1"],"header":"ECEC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"pH","name":"pH","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["6.01","6.01","6.18","5.86","5.86","5.73","5.87","5.87","5.93","6.21","6.21","6.01","6.1","6.1","6.28"],"header":"pH","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minPO4","name":"minPO4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.33","0.12","1.42","2.83","0.2","1.5","1.17","0.11","0.75","1.0","0.02","3.67","2.58","0.0","4.08"],"header":"minPO4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minNH4","name":"minNH4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["3.67","1.65","3.92","3.33","1.28","3.17","2.17","1.18","1.83","2.42","2.6","4.33","3.5","0.92","4.75"],"header":"minNH4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minNO3","name":"minNO3","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["47.17","11.31","24.33","42.5","22.71","19.92","11.25","36.61","19.67","20.67","12.31","106.42","11.58","7.84","37.33"],"header":"minNO3","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minTIN","name":"minTIN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["50.83","12.96","28.25","45.83","23.99","23.08","13.42","37.79","21.5","23.08","14.91","110.75","15.08","8.76","42.08"],"header":"minTIN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NH4","name":"NH4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["8.03","4.08","4.81","3.11","2.5","5.57","2.32","3.91","2.92","4.28","8.19","2.04","2.03","6.5","3.44"],"header":"NH4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NO3","name":"NO3","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.67","2.65","3.13","2.57","1.06","3.22","3.31","2.3","2.27","5.07","6.39","3.71","2.9","2.76","4.53"],"header":"NO3","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PO4","name":"PO4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["9.52","8.55","7.58","8.66","2.8","7.95","7.3","4.25","7.04","9.15","5.62","5.97","8.28","6.08","9.45"],"header":"PO4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DOC","name":"DOC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["118.74","39.7","75.86","60.57","33.2","59.51","64.98","45.0","56.68","73.98","44.3","44.89","43.84","30.8","63.79"],"header":"DOC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DON","name":"DON","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["11.66","4.2","8.22","6.48","2.5","6.32","7.03","4.3","5.42","8.47","3.7","5.22","5.56","1.6","4.91"],"header":"DON","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DOCN","name":"DOCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["11.15","9.45","9.44","10.12","13.29","10.67","11.93","10.46","11.09","9.93","11.98","11.57","12.21","19.27","14.67"],"header":"DOCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micC","name":"micC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["690.11","469.0","444.72","364.62","117.0","440.6","284.5","440.0","390.66","396.42","676.0","277.37","392.56","416.0","334.93"],"header":"micC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micN","name":"micN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["135.48","84.0","110.13","66.4","20.0","86.19","48.79","97.0","72.61","73.73","147.0","56.55","62.37","91.0","72.64"],"header":"micN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micP","name":"micP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["87.98","55.0","65.03","70.68","11.0","81.45","52.5","56.0","85.7","93.13","94.0","33.4","66.65","63.0","64.23"],"header":"micP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micCN","name":"micCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.61","5.58","4.42","5.07","5.85","5.14","5.57","4.54","5.26","4.72","4.6","4.72","5.78","4.57","4.49"],"header":"micCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micCP","name":"micCP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["8.61","8.48","8.13","6.7","10.54","5.39","8.33","7.91","4.5","4.66","7.18","11.55","7.34","6.6","5.54"],"header":"micCP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micNP","name":"micNP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.74","1.52","2.37","1.31","1.8","1.09","1.39","1.74","0.83","0.98","1.56","2.45","1.19","1.44","1.17"],"header":"micNP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AG_ase","name":"AG_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.26","0.15","0.24","0.33","0.02","0.22","0.34","0.15","0.21","0.32","0.39","0.15","0.2","0.37","0.28"],"header":"AG ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BG_ase","name":"BG_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.1","6.97","4.22","4.37","3.04","4.57","3.01","9.09","3.22","4.14","8.61","3.55","3.92","10.48","4.62"],"header":"BG ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BP_ase","name":"BP_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["3.5","5.34","2.54","3.05","2.89","3.02","2.34","7.28","2.33","3.45","7.11","1.77","2.26","6.46","2.11"],"header":"BP ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CE_ase","name":"CE_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.0","2.07","1.09","1.26","0.65","1.09","0.76","1.5","0.75","1.07","1.53","0.68","0.86","2.21","0.86"],"header":"CE ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P_ase","name":"P_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["20.43","25.65","15.07","19.21","18.11","20.27","15.19","44.04","14.79","23.26","35.1","13.02","16.9","35.75","14.8"],"header":"P ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N_ase","name":"N_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["5.63","4.52","3.54","3.58","2.91","3.65","2.61","5.56","2.57","3.7","8.34","2.95","2.83","9.43","3.37"],"header":"N ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"S_ase","name":"S_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["6.08","6.7","3.8","5.72","1.28","4.92","3.2","5.57","5.45","5.86","10.68","3.56","5.26","11.78","4.54"],"header":"S ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"XY_ase","name":"XY_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.17","2.52","1.01","1.36","0.76","1.11","0.86","1.75","0.66","1.11","1.42","0.71","1.01","1.84","0.72"],"header":"XY ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AG_Q10","name":"AG_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.77","2.01","1.51","2.48","1.49","1.51","1.48","1.73","1.83","1.72","1.31","2.08","1.67","1.93","1.54"],"header":"AG Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BG_Q10","name":"BG_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.38","1.75","1.31","1.36","1.56","1.5","1.35","1.72","1.31","1.45","1.39","1.76","1.36","1.53","1.37"],"header":"BG Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BP_Q10","name":"BP_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.39","1.51","1.34","1.42","1.55","1.58","1.39","1.42","1.44","1.46","1.42","1.74","1.56","1.44","1.41"],"header":"BP Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CE_Q10","name":"CE_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["2.03","1.87","1.89","1.99","1.9","2.3","1.88","1.95","2.36","1.76","1.96","2.0","1.81","2.11","1.81"],"header":"CE Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P_Q10","name":"P_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.37","1.39","1.22","1.27","1.51","1.37","1.28","1.48","1.24","1.28","1.33","1.48","1.35","1.38","1.27"],"header":"P Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N_Q10","name":"N_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.46","1.56","1.54","1.54","1.75","1.85","1.51","1.68","1.6","1.36","1.54","1.69","1.48","1.46","1.47"],"header":"N Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"S_Q10","name":"S_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.3","1.65","1.23","1.27","1.39","1.39","1.3","1.6","1.47","1.3","1.51","1.48","1.32","1.5","1.33"],"header":"S Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"XY_Q10","name":"XY_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.72","1.86","1.59","1.72","1.89","1.76","1.82","1.88","1.63","1.63","1.91","1.83","1.84","1.76","1.65"],"header":"XY Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CO2","name":"CO2","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["11.78","4.28","5.27","4.46","40.47","4.06","4.62","15.37","4.28","6.19","8.87","2.08","9.39","13.6","5.21"],"header":"CO2","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"LP_ase","name":"LP_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["52.8","40.69","38.61","32.1","13.94","29.51","24.11","32.65","27.78","42.4","57.13","21.96","30.37","53.79","32.22"],"header":"LP ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"LP_Q10","name":"LP_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.76","1.71","1.81","2.0","1.77","2.14","1.79","1.67","1.85","1.96","1.4","2.07","1.9","1.79","1.8"],"header":"LP Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PX_ase","name":"PX_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["147.13","211.18","94.13","119.75","225.56","81.25","110.75","245.65","92.5","97.0","294.39","92.38","122.63","339.6","111.88"],"header":"PX ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PX_Q10","name":"PX_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.22","1.07","1.58","1.41","1.15","1.24","1.33","1.23","1.53","1.15","1.27","3.58","1.39","1.27","1.14"],"header":"PX Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CUEcn","name":"CUEcn","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.32","0.23","0.22","0.26","0.29","0.25","0.27","0.19","0.27","0.27","0.26","0.24","0.26","0.24","0.22"],"header":"CUEcn","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CUEcp","name":"CUEcp","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.21","0.18","0.21","0.18","0.33","0.19","0.18","0.23","0.16","0.15","0.17","0.22","0.21","0.19","0.16"],"header":"CUEcp","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NUE","name":"NUE","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.77","0.87","0.87","0.84","0.81","0.85","0.83","0.9","0.83","0.83","0.84","0.85","0.84","0.85","0.87"],"header":"NUE","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PUE","name":"PUE","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.88","0.9","0.88","0.9","0.77","0.9","0.9","0.87","0.92","0.92","0.91","0.88","0.88","0.89","0.92"],"header":"PUE","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Tmin","name":"Tmin","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.07","2.19","0.14","-0.29","0.63","-2.63","0.81","0.94","-0.13","0.65","1.48","0.0","-0.24","0.96","-2.46"],"header":"Tmin","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"SI","name":"SI","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.51","2.3","1.44","1.49","1.72","1.25","1.77","2.08","1.42","1.61","1.81","1.54","1.51","1.82","1.29"],"header":"SI","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzCN","name":"enzCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.4614","0.6456","0.5024","0.5565","0.5302","0.555","0.4877","0.6931","0.4624","0.4941","0.5933","0.5058","0.5112","0.6515","0.5231"],"header":"enzCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzCP","name":"enzCP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.5911","0.7166","0.6554","0.6412","0.4918","0.6173","0.5596","0.6412","0.5556","0.5762","0.6628","0.6037","0.6064","0.7218","0.6607"],"header":"enzCP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzNP","name":"enzNP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.2812","1.11","1.3044","1.1522","0.9277","1.1123","1.1473","0.9251","1.2017","1.1662","1.1173","1.1935","1.1862","1.1079","1.263"],"header":"enzNP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,15],"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"2fceb59691ab8660564d28367278fbe8"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<h1 id="multivariate-summary">Multivariate Summary</h1>
<p>Summary results for of <code>envfit</code> and <code>bioenv</code>
tests for edaphic properties, soil functional response, and temperature
adaptation for both 16S rRNA and ITS data sets.</p>
<h2 id="s-rrna">16S rRNA</h2>
<p>Metadata parameters removed based on autocorrelation results.</p>
<ul>
<li>edaphic properties: TEB + DON + Na + Al + Ca</li>
<li>soil functional response: micN + micNP + enzCN + enzCP +
BP<sub>ase</sub> + CE<sub>ase</sub> + LP<sub>ase</sub> + N<sub>ase</sub>
+ P<sub>ase</sub></li>
<li>temperature adaptation: NUE + PUE + SI</li>
</ul>
<p>Metadata parameters removed from capscale analysis based on Degrees
of Freedom.</p>
<ul>
<li>edaphic properties: Mg + Mn</li>
<li>soil functional response: NONE</li>
<li>temperature adaptation: NONE</li>
</ul>
<p><br/></p>
<div class="layout-chunk" data-layout="l-body">
<a onclick="fetch(&#39;data:text/csv;base64,bWV0YWRhdGFfc2V0LHBhcmFtZXRlcixyMi4uZW52Zml0LixQci4uci4uLmVudmZpdC4sci4uYmlvZW52LixwdmFsLi5iaW9lbnYuCmVkYXBoaWMsQVNULDAuODI4Njc5MDkwNTU2MTc0LDkuOTkwMDA5OTkwMDA5OTllLTQsMSwwLjAwMQplZGFwaGljLEgyTywwLjUxODkzMjg5NjE5Njc5MSwwLjAwOTk5MDAwOTk5MDAwOTk5LE5BLE5BCmVkYXBoaWMsRE9DLDAuNDQ1OTA0MTQ2NTcwNjk1LDAuMDIzOTc2MDIzOTc2MDI0LE5BLE5BCmZ1bmN0aW9uYWwgcmVzcG9uc2UsQUdfYXNlLDAuNDQzNTQxMzY5MDg2MDU4LDAuMDI1OTc0MDI1OTc0MDI2LDAuNTU4ODA3Nzg2ODg5NjUsMC4wMDEKZnVuY3Rpb25hbCByZXNwb25zZSxCR19hc2UsMC41NjAzODgwOTAxNDMwMDEsMC4wMDY5OTMwMDY5OTMwMDY5OSxOQSxOQQpmdW5jdGlvbmFsIHJlc3BvbnNlLFNfYXNlLDAuNzM3MDgyNjIxOTg3NzY2LDAuMDAxOTk4MDAxOTk4MDAyLDAuNjEzODUzNDgyNTU3OTE4LDAuMDAxCmZ1bmN0aW9uYWwgcmVzcG9uc2UsWFlfYXNlLDAuNTE5MzAxMTcwMzIwMzQ5LDAuMDA4OTkxMDA4OTkxMDA4OTksMC40NTU5NjY4MjQ2Mzg0MTEsMC4wMDIKZnVuY3Rpb25hbCByZXNwb25zZSxQWF9hc2UsMC43NjM5OTQzNjc0MTA2MDQsOS45OTAwMDk5OTAwMDk5OWUtNCwwLjYxMTUyNTM5NDA3MjIzNSwwLjAwMQpmdW5jdGlvbmFsIHJlc3BvbnNlLENPMiwwLjUwNDEyMjg4MzcyOTgxOCwwLjAxMjk4NzAxMjk4NzAxMyxOQSxOQQpmdW5jdGlvbmFsIHJlc3BvbnNlLGVuek5QLDAuNjI0MTgzMjAyMTAxOTI0LDAuMDAzOTk2MDAzOTk2MDA0LDAuNDYyMzI2MzUyODkyMzkxLDAuMDA2CnRlbXBlcmF0dXJlIGFkYXB0YXRpb24sU19RMTAsMC40OTU2NDMyMjgwMTk5MzYsMC4wMTQ5ODUwMTQ5ODUwMTUsMC40Mzk0ODM2MTgxNTMyMDcsMC4wMDEKdGVtcGVyYXR1cmUgYWRhcHRhdGlvbixMUF9RMTAsMC40MTMxMjk5ODg2NzI0ODQsMC4wNDA5NTkwNDA5NTkwNDEsMC4zNzcxNzY0NTY3MTAxMTMsMC4wMDUKdGVtcGVyYXR1cmUgYWRhcHRhdGlvbixUbWluLDAuNDQ1NTkwNjk4NjMzODkzLDAuMDI5OTcwMDI5OTcwMDMsMC40MDQ0MzQwNDI3NzQxNTcsMC4wMDUKdGVtcGVyYXR1cmUgYWRhcHRhdGlvbixDVUVjcCxOQSxOQSwwLjMyNTAzOTg3Mzg1ODE4NywwLjAxMwp0ZW1wZXJhdHVyZSBhZGFwdGF0aW9uLFBfUTEwLE5BLE5BLDAuNTE3NzIzMzg3MDkwODI2LDAuMDAxCg==&#39;).then(res =&gt; res.blob()).then(blob =&gt; {&#10;      const downloadURL = window.URL.createObjectURL(blob);&#10;      const a = document.createElement(&#39;a&#39;);&#10;      document.body.appendChild(a);&#10;      a.href = downloadURL;&#10;      a.download = &#39;ssu_multivariate_summary.csv&#39;; a.click();&#10;      window.URL.revokeObjectURL(downloadURL);&#10;      document.body.removeChild(a);&#10;    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><small><strong>(16S rRNA) Table 1 | Significant results of envfit
&amp; bioenv tests for the 16S rRNA data set.</strong></small></p>
<div class="layout-chunk" data-layout="l-body-outset">
<div id="htmlwidget-8265b90b3a32bfcc4437" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8265b90b3a32bfcc4437">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"metadata_set":["edaphic","edaphic","edaphic","functional_response","functional_response","functional_response","functional_response","functional_response","functional_response","functional_response","temperature adaptation","temperature adaptation","temperature adaptation","temperature adaptation","temperature adaptation"],"parameter":["AST","H2O","DOC","AG_ase","BG_ase","S_ase","XY_ase","PX_ase","CO2","enzNP","S_Q10","LP_Q10","Tmin","CUEcp","P_Q10"],"envfit_r2":["0.829","0.519","0.446","0.444","0.56","0.737","0.519","0.764","0.504","0.624","0.496","0.413","0.446","",""],"envfit_pval":["0.001","0.01","0.024","0.026","0.007","0.002","0.009","0.001","0.013","0.004","0.015","0.041","0.03","",""],"bioenv_r":["1","","","0.559","","0.614","0.456","0.612","","0.462","0.439","0.377","0.404","0.325","0.518"],"bioenv_pval":["0.001","","","0.001","","0.001","0.002","0.001","","0.006","0.001","0.005","0.005","0.013","0.001"]},"columns":[{"accessor":"metadata_set","name":"Metadata group","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["edaphic","edaphic","edaphic","functional_response","functional_response","functional_response","functional_response","functional_response","functional_response","functional_response","temperature adaptation","temperature adaptation","temperature adaptation","temperature adaptation","temperature adaptation"],"header":"Metadata group","minWidth":90,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"parameter","name":"parameter","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["AST","H2O","DOC","AG_ase","BG_ase","S_ase","XY_ase","PX_ase","CO2","enzNP","S_Q10","LP_Q10","Tmin","CUEcp","P_Q10"],"header":"parameter","minWidth":50,"align":"center","footerStyle":{"fontWeight":"bold"},"style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"envfit_r2","name":"r2","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["0.829","0.519","0.446","0.444","0.56","0.737","0.519","0.764","0.504","0.624","0.496","0.413","0.446","",""],"header":"r2","minWidth":50,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"envfit_pval","name":"P(>r)","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","0.01","0.024","0.026","0.007","0.002","0.009","0.001","0.013","0.004","0.015","0.041","0.03","",""],"header":"P(>r)","minWidth":50,"align":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"}],"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"bioenv_r","name":"r","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["1","","","0.559","","0.614","0.456","0.612","","0.462","0.439","0.377","0.404","0.325","0.518"],"header":"r","minWidth":40,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"bioenv_pval","name":"p-value","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","","","0.001","","0.001","0.002","0.001","","0.006","0.001","0.005","0.005","0.013","0.001"],"header":"p-value","minWidth":50,"align":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}]}],"columnGroups":[{"name":"envfit","headerStyle":{"fontSize":"1.2em"},"columns":["envfit_r2","envfit_pval"]},{"name":"bioenv","headerStyle":{"fontSize":"1.2em"},"columns":["bioenv_r","bioenv_pval"]}],"pivotBy":["metadata_set"],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[5,10,15],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"defaultExpanded":true,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"f8921c85bc20a3af01c8aab7f90684d9"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<h2 id="its">ITS</h2>
<p>Metadata parameters removed based on autocorrelation results.</p>
<ul>
<li>edaphic properties: TEB + DON + Na + Al + Ca</li>
<li>soil functional response: micN + micNP + enzCN + enzCP +
BP<sub>ase</sub> + CE<sub>ase</sub> + LP<sub>ase</sub> + N<sub>ase</sub>
+ P<sub>ase</sub></li>
<li>temperature adaptation: NUE + PUE + P<sub>Q10</sub> + SI</li>
</ul>
<p>Metadata parameters removed from capscale analysis based on Degrees
of Freedom.</p>
<ul>
<li>edaphic properties: Mg + Mn + Na + Al + Fe + K</li>
<li>soil functional response: NONE</li>
<li>temperature adaptation: S<sub>Q10</sub></li>
</ul>
<p><br/></p>
<div class="layout-chunk" data-layout="l-body">
<a onclick="fetch(&#39;data:text/csv;base64,bWV0YWRhdGFfc2V0LHBhcmFtZXRlcixyMi4uZW52Zml0LixQci4uci4uLmVudmZpdC4sci4uYmlvZW52LixwdmFsLi5iaW9lbnYuCmVkYXBoaWMsQVNULDAuNDg0ODg2NDQ1ODk5Nzc1LDAuMDM2OTYzMDM2OTYzMDM3LDEsMC4wMDEKZWRhcGhpYyxET0MsMC41MzUzODA1ODYzNzMyMzgsMC4wMjc5NzIwMjc5NzIwMjgsTkEsTkEKZnVuY3Rpb25hbCByZXNwb25zZSxtaWNQLDAuNjkyNDY3MjMzMzU3Mjg2LDAuMDAxOTk4MDAxOTk4MDAyLE5BLE5BCmZ1bmN0aW9uYWwgcmVzcG9uc2UsbWljQ1AsMC41ODMxMjUzMzQzMzI3MTgsMC4wMTU5ODQwMTU5ODQwMTYsTkEsTkEKZnVuY3Rpb25hbCByZXNwb25zZSxBR19hc2UsMC41MDU5OTczMjI0OTI1MDQsMC4wMzY5NjMwMzY5NjMwMzcsTkEsTkEKZnVuY3Rpb25hbCByZXNwb25zZSxQWF9hc2UsMC41MDAyMjE0MDAxNTczNzMsMC4wMzQ5NjUwMzQ5NjUwMzUsMC42ODUzNTk0NDQwNzg2NzMsMC4wMDEKZnVuY3Rpb25hbCByZXNwb25zZSxlbnpOUCwwLjU0NzEwNTM5NzYxMDE3MiwwLjAxMzk4NjAxMzk4NjAxNCwwLjU1Mjg1MjIxMTA4MDA1OSwwLjAwMQpmdW5jdGlvbmFsIHJlc3BvbnNlLFhZX2FzZSxOQSxOQSwwLjUwNTQ0ODIzMjM1MDk4OCwwLjAwMgp0ZW1wZXJhdHVyZSBhZGFwdGF0aW9uLFhZX1ExMCwwLjYxNjU3MzUxMTQ1ODc2NSwwLjAwOTk5MDAwOTk5MDAwOTk5LDAuNzI1Nzc1NDgxMjg0MDk1LDAuMDAxCnRlbXBlcmF0dXJlIGFkYXB0YXRpb24sQ1VFY3AsMC40Nzg1ODM4MDk5NTUyMjEsMC4wMzQ5NjUwMzQ5NjUwMzUsTkEsTkEKdGVtcGVyYXR1cmUgYWRhcHRhdGlvbixUbWluLDAuNDc0ODY2Nzc4Njk5MjE2LDAuMDI3OTcyMDI3OTcyMDI4LDAuNjE2MDE1OTMzODQ2NzE3LDAuMDAxCg==&#39;).then(res =&gt; res.blob()).then(blob =&gt; {&#10;      const downloadURL = window.URL.createObjectURL(blob);&#10;      const a = document.createElement(&#39;a&#39;);&#10;      document.body.appendChild(a);&#10;      a.href = downloadURL;&#10;      a.download = &#39;its_multivariate_summary.csv&#39;; a.click();&#10;      window.URL.revokeObjectURL(downloadURL);&#10;      document.body.removeChild(a);&#10;    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><small><strong>(ITS) Table 1 | Significant results of envfit &amp;
bioenv tests for the ITS data set.</strong></small></p>
<div class="layout-chunk" data-layout="l-body-outset">
<div id="htmlwidget-bf6d657f1ee5f79ebe40" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bf6d657f1ee5f79ebe40">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"metadata_set":["edaphic","edaphic","functional_response","functional_response","functional_response","functional_response","functional_response","functional_response","temperature adaptation","temperature adaptation","temperature adaptation"],"parameter":["AST","DOC","micP","micCP","AG_ase","PX_ase","enzNP","XY_ase","XY_Q10","CUEcp","Tmin"],"envfit_r2":["0.485","0.535","0.692","0.583","0.506","0.5","0.547","","0.617","0.479","0.475"],"envfit_pval":["0.037","0.028","0.002","0.016","0.037","0.035","0.014","","0.01","0.035","0.028"],"bioenv_r":["1","","","","","0.685","0.553","0.505","0.726","","0.616"],"bioenv_pval":["0.001","","","","","0.001","0.001","0.002","0.001","","0.001"]},"columns":[{"accessor":"metadata_set","name":"Metadata group","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["edaphic","edaphic","functional_response","functional_response","functional_response","functional_response","functional_response","functional_response","temperature adaptation","temperature adaptation","temperature adaptation"],"header":"Metadata group","minWidth":90,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"parameter","name":"parameter","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["AST","DOC","micP","micCP","AG_ase","PX_ase","enzNP","XY_ase","XY_Q10","CUEcp","Tmin"],"header":"parameter","minWidth":50,"align":"center","footerStyle":{"fontWeight":"bold"},"style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"envfit_r2","name":"r2","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["0.485","0.535","0.692","0.583","0.506","0.5","0.547","","0.617","0.479","0.475"],"header":"r2","minWidth":50,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"envfit_pval","name":"P(>r)","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["0.037","0.028","0.002","0.016","0.037","0.035","0.014","","0.01","0.035","0.028"],"header":"P(>r)","minWidth":50,"align":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"},{"color":"#B22271","fontWeight":"bold","borderRight":"5px solid #eee"}],"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"bioenv_r","name":"r","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["1","","","","","0.685","0.553","0.505","0.726","","0.616"],"header":"r","minWidth":40,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"bioenv_pval","name":"p-value","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","","","","","0.001","0.001","0.002","0.001","","0.001"],"header":"p-value","minWidth":50,"align":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}]}],"columnGroups":[{"name":"envfit","headerStyle":{"fontSize":"1.2em"},"columns":["envfit_r2","envfit_pval"]},{"name":"bioenv","headerStyle":{"fontSize":"1.2em"},"columns":["bioenv_r","bioenv_pval"]}],"pivotBy":["metadata_set"],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[5,10,11],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"defaultExpanded":true,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"5ae27f58dea759ea70d2fa87b9f7647c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="s-rrna-1">16s rRNA</h1>
<h2 id="data-formating">Data Formating</h2>
<ol type="1">
<li>Transform <code>ps</code> Objects</li>
</ol>
<p>The first step is to transform the phyloseq objects.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>samp_ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu18_ps_work&quot;</span>, <span class="st">&quot;ssu18_ps_pime&quot;</span>, <span class="st">&quot;ssu18_ps_perfect&quot;</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;ssu18_ps_work_otu&quot;</span>, <span class="st">&quot;ssu18_ps_pime_otu&quot;</span>, <span class="st">&quot;ssu18_ps_perfect_otu&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps) {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(tmp_get, <span class="cf">function</span>(otu) <span class="fl">1e5</span> <span class="sc">*</span> otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>     tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">prune_samples</span>(<span class="fu">sample_sums</span>(tmp_ps) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_ps)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>, <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_get))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> tmp_samp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;TREAT_T&quot;</span> <span class="ot">=</span> <span class="st">&quot;TEMP&quot;</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">sample_data</span>(tmp_ps) <span class="ot">&lt;-</span> tmp_samp</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_prop&quot;</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_ps)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Format for <code>mctoolsr</code></li>
</ol>
<p>Then a bit of formatting to make the data compatible with
<code>mctoolsr</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_prop&quot;</span>)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>     tmp_tax <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tax_table</span>(tmp_get))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>     tmp_tax<span class="sc">$</span>ASV_SEQ <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>     tmp_col_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(tmp_tax)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>     tmp_tax_merge <span class="ot">&lt;-</span> tmp_tax <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">unite</span>(taxonomy, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">all_of</span>(tmp_col_names), </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>     tmp_tax_merge <span class="ot">&lt;-</span> tmp_tax_merge <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;#OTU_ID&quot;</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>     tmp_otu <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_get)))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>     tmp_otu <span class="ot">&lt;-</span> tmp_otu <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;#OTU_ID&quot;</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>     tmp_otu_tax <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_otu, tmp_tax_merge, <span class="at">by =</span> <span class="st">&quot;#OTU_ID&quot;</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_get))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>     tmp_samp[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> tmp_samp <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;#SampleID&quot;</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>     tmp_metad <span class="ot">&lt;-</span> metad <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;#SampleID&quot;</span> <span class="ot">=</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>     tmp_metad[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>     tmp_md <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp, tmp_metad, <span class="at">by =</span> <span class="st">&quot;#SampleID&quot;</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>     tmp_otu_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_otu_tax&quot;</span>))</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_otu_name)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_otu_name, tmp_otu_tax)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>     tmp_md_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_md&quot;</span>))</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_md_name)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_md_name, tmp_md)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>     tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;files/metadata/tables/&quot;</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>     <span class="fu">write_delim</span>(tmp_otu_tax, <span class="fu">paste</span>(tmp_path, tmp_otu_name, <span class="st">&quot;.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>     <span class="fu">write_delim</span>(tmp_md, <span class="fu">paste</span>(tmp_path, tmp_md_name, <span class="st">&quot;.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>     tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;files/metadata/tables/&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     tmp_otu_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_otu_tax&quot;</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>     tmp_md_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_md&quot;</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>     tmp_tax_table_fp <span class="ot">&lt;-</span> <span class="fu">paste</span>(tmp_path, tmp_otu_name, <span class="st">&quot;.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>     tmp_map_fp <span class="ot">&lt;-</span> <span class="fu">paste</span>(tmp_path, tmp_md_name, <span class="st">&quot;.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>     tmp_input <span class="ot">&lt;-</span> <span class="fu">load_taxa_table</span>(tmp_tax_table_fp, tmp_map_fp)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>     tmp_input_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_mc&quot;</span>))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_input_name)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_input_name, tmp_input)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_md&quot;</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_otu_tax&quot;</span>))</span></code></pre></div>
</details>
</div>
<h2 id="choose-data-set">Choose Data Set</h2>
<p>At this point in the code we need to choose a data set to use,
formatted with <code>mctoolsr</code>. Remember, there are four
choices:</p>
<ol type="1">
<li>FULL, unfiltered data set.</li>
<li>Arbitrary filtered data set.</li>
<li>PERfect filtered data set.</li>
<li>PIME filtered data set.</li>
</ol>
<p>This way, if we want to test other data sets we only need to change
the name here.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_mc&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ssu18_select_mc <span class="ot">&lt;-</span> ssu18_ps_pime_mc</span></code></pre></div>
</div>
<h2 id="normality-tests">Normality Tests</h2>
<p>Before proceeding, we need to test each parameter in the metadata to
see which ones are and are not normally distributed. For that, we use
the Shapiro-Wilk Normality Test. Here we only need one of the metadata
files.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>temp_md <span class="ot">&lt;-</span> ssu18_select_mc<span class="sc">$</span>map_loaded</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>temp_md[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>shap_results <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(temp_md)) {</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  tmp_shap <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(temp_md[[i]])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  tmp_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_shap<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">5</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_shap<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  shap_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(shap_results, <span class="fu">data.frame</span>(i, tmp_p, tmp_res))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(shap_results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;tranform&quot;</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>shap_results</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(shap_results, tranform <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>md_to_tranform <span class="ot">&lt;-</span> shap_results<span class="sc">$</span>parameter[shap_results<span class="sc">$</span>tranform <span class="sc">==</span> <span class="cn">TRUE</span>]</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;temp_md&quot;</span>))</span></code></pre></div>
</details>
</div>
<details>
<summary>
<strong>Show the results</strong> of each normality test for metadata
parameters
</summary>
<p></br></p>
<p><small><strong>(16S rRNA) Table 2 | Results of the Shapiro-Wilk
Normality Tests. P-values in red are significance (p-value &lt; 0.05)
meaning the parameter needs to be normalized.</strong></small></p>
<div class="layout-chunk" data-layout="l-body">
<div id="htmlwidget-18069ed4e250861e54bb" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-18069ed4e250861e54bb">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"parameter":["AST","H2O","N","P","Al","Ca","Fe","K","Mg","Mn","Na","TEB","ECEC","pH","minPO4","minNH4","minNO3","minTIN","NH4","NO3","PO4","DOC","DON","DOCN","micC","micN","micP","micCN","micCP","micNP","AG_ase","BG_ase","BP_ase","CE_ase","P_ase","N_ase","S_ase","XY_ase","AG_Q10","BG_Q10","BP_Q10","CE_Q10","P_Q10","N_Q10","S_Q10","XY_Q10","CO2","LP_ase","LP_Q10","PX_ase","PX_Q10","CUEcn","CUEcp","NUE","PUE","Tmin","SI","enzCN","enzCP","enzNP"],"p-value":[0.00276,0.00188,0.05771,0.29892,0.00028,0.03383,0.00068,0.13159,0.16381,0.32078,0.05849,0.00435,0.00433,0.54818,0.05053,0.70522,0.0005,0.00072,0.07406,0.48101,0.24574,0.03038,0.79687,0.00309,0.16051,0.7732,0.23294,0.04004,0.66207,0.34934,0.70541,0.00305,0.00483,0.03066,0.00864,0.00206,0.05361,0.04239,0.2518,0.01348,0.03611,0.0619,0.28886,0.37946,0.27576,0.27276,6e-05,0.59206,0.45921,0.00822,0,0.91397,0.0037,0.33275,0.00025,0.05998,0.28369,0.09137,0.92171,0.09436],"tranform":[true,true,false,false,true,true,true,false,false,false,false,true,true,false,false,false,true,true,false,false,false,true,false,true,false,false,false,true,false,false,false,true,true,true,true,true,false,true,false,true,true,false,false,false,false,false,true,false,false,true,true,false,true,false,true,false,false,false,false,false]},"columns":[{"accessor":"parameter","name":"Parameter","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["AST","H2O","N","P","Al","Ca","Fe","K","Mg","Mn","Na","TEB","ECEC","pH","minPO4","minNH4","minNO3","minTIN","NH4","NO3","PO4","DOC","DON","DOCN","micC","micN","micP","micCN","micCP","micNP","AG_ase","BG_ase","BP_ase","CE_ase","P_ase","N_ase","S_ase","XY_ase","AG_Q10","BG_Q10","BP_Q10","CE_Q10","P_Q10","N_Q10","S_Q10","XY_Q10","CO2","LP_ase","LP_Q10","PX_ase","PX_Q10","CUEcn","CUEcp","NUE","PUE","Tmin","SI","enzCN","enzCP","enzNP"],"header":"Parameter","align":"left","headerStyle":{"borderRight":"1px solid #eee","fontSize":"0.9em"},"footerStyle":{"fontWeight":"bold"},"minWidth":150,"sticky":"left","style":{"borderRight":"1px solid #eee"}},{"accessor":"p-value","name":"p-value","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.00276","0.00188","0.05771","0.29892","0.00028","0.03383","0.00068","0.13159","0.16381","0.32078","0.05849","0.00435","0.00433","0.54818","0.05053","0.70522","0.0005","0.00072","0.07406","0.48101","0.24574","0.03038","0.79687","0.00309","0.16051","0.7732","0.23294","0.04004","0.66207","0.34934","0.70541","0.00305","0.00483","0.03066","0.00864","0.00206","0.05361","0.04239","0.2518","0.01348","0.03611","0.0619","0.28886","0.37946","0.27576","0.27276","0.00006","0.59206","0.45921","0.00822","0.0","0.91397","0.0037","0.33275","0.00025","0.05998","0.28369","0.09137","0.92171","0.09436"],"header":"p-value","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"},"style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"}]},{"accessor":"tranform","name":"tranform","type":"logical","sortable":true,"resizable":true,"filterable":true,"cell":["TRUE","TRUE","FALSE","FALSE","TRUE","TRUE","TRUE","FALSE","FALSE","FALSE","FALSE","TRUE","TRUE","FALSE","FALSE","FALSE","TRUE","TRUE","FALSE","FALSE","FALSE","TRUE","FALSE","TRUE","FALSE","FALSE","FALSE","TRUE","FALSE","FALSE","FALSE","TRUE","TRUE","TRUE","TRUE","TRUE","FALSE","TRUE","FALSE","TRUE","TRUE","FALSE","FALSE","FALSE","FALSE","FALSE","TRUE","FALSE","FALSE","TRUE","TRUE","FALSE","TRUE","FALSE","TRUE","FALSE","FALSE","FALSE","FALSE","FALSE"],"header":"tranform","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":60,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"c00f9cada74cd3856858bafcb7cb61a5"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</details>
<p>Looks like we need to transform 25 metadata parameters.</p>
<h2 id="normalize-parameters">Normalize Parameters</h2>
<p>Here we use the R package <a
href="https://cran.r-project.org/web/packages/bestNormalize/vignettes/bestNormalize.html"><code>bestNormalize</code></a>
to find and execute the best normalizing transformation. The function
will test the following normalizing transformations:</p>
<ul>
<li><p><code>arcsinh_x</code> performs an arcsinh
transformation.</p></li>
<li><p><code>boxcox</code> Perform a Box-Cox transformation and
center/scale a vector to attempt normalization. <code>boxcox</code>
estimates the optimal value of lambda for the Box-Cox transformation.
The function will return an error if a user attempt to transform
nonpositive data.</p></li>
<li><p><code>yeojohnson</code> Perform a Yeo-Johnson Transformation and
center/scale a vector to attempt normalization. <code>yeojohnson</code>
estimates the optimal value of lambda for the Yeo-Johnson
transformation. The Yeo-Johnson is similar to the Box-Cox method,
however it allows for the transformation of nonpositive data as
well.</p></li>
<li><p><code>orderNorm</code> The Ordered Quantile (ORQ) normalization
transformation, <code>orderNorm()</code>, is a rank-based procedure by
which the values of a vector are mapped to their percentile, which is
then mapped to the same percentile of the normal distribution. Without
the presence of ties, this essentially guarantees that the
transformation leads to a uniform distribution.</p></li>
<li><p><code>log_x</code> performs a simple log transformation. The
parameter a is essentially estimated by the training set by default
(estimated as the minimum possible to some extent epsilon), while the
base must be specified beforehand. The default base of the log is
10.</p></li>
<li><p><code>sqrt_x</code> performs a simple square-root transformation.
The parameter a is essentially estimated by the training set by default
(estimated as the minimum possible), while the base must be specified
beforehand.</p></li>
<li><p><code>exp_x</code> performs a simple exponential
transformation.</p></li>
</ul>
<p>See this GitHub issue (<a
href="https://github.com/petersonR/bestNormalize/issues/5">#5</a>) for a
description on getting reproducible results. Apparently, you can get
different results because the <code>bestNormalize()</code> function uses
repeated cross-validation (and doesn’t automatically set the seed), so
the results will be slightly different each time the function is
executed.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> md_to_tranform) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  tmp_md <span class="ot">&lt;-</span> ssu18_select_mc<span class="sc">$</span>map_loaded</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  tmp_best_norm <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(tmp_md[[i]], <span class="at">r =</span> <span class="dv">1</span>, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">loo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_best_norm_test&quot;</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_best_norm)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tmp_name)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<details>
<summary>
Show the chosen transformations
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
## bestNormalize Chosen transformation of AST ## 
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
25.800 26.275 28.800 30.280 41.770 
_____________________________________

## bestNormalize Chosen transformation of H2O ## 
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
   0%   25%   50%   75%  100% 
0.204 0.308 0.370 0.384 0.401 
_____________________________________

## bestNormalize Chosen transformation of Al ## 
Standardized asinh(x) Transformation with 15 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 0.0059997 
 - sd (before standardization) = 0.008280287 
_____________________________________

## bestNormalize Chosen transformation of Ca ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
25.49 27.19 29.23 34.36 39.79 
_____________________________________

## bestNormalize Chosen transformation of Fe ## 
Standardized asinh(x) Transformation with 15 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 0.0119984 
 - sd (before standardization) = 0.01264569 
_____________________________________

## bestNormalize Chosen transformation of TEB ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
41.6 43.3 45.1 51.4 61.7 
_____________________________________

## bestNormalize Chosen transformation of ECEC ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
41.7 43.3 45.3 51.5 61.8 
_____________________________________

## bestNormalize Chosen transformation of minNO3 ## 
Standardized Box Cox Transformation with 15 nonmissing obs.:
 Estimated statistics:
 - lambda = -0.3344538 
 - mean (before standardization) = 1.907818 
 - sd (before standardization) = 0.2388776 
_____________________________________

## bestNormalize Chosen transformation of minTIN ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 14 unique values 
 - Original quantiles:
     0%     25%     50%     75%    100% 
  8.760  14.995  23.080  39.935 110.750 
_____________________________________

## bestNormalize Chosen transformation of DOC ## 
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
     0%     25%     50%     75%    100% 
 30.800  44.070  56.680  64.385 118.740 
_____________________________________

## bestNormalize Chosen transformation of DOCN ## 
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 9.440 10.290 11.150 12.095 19.270 
_____________________________________

## bestNormalize Chosen transformation of micCN ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 14 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
4.420 4.585 4.720 5.415 5.850 
_____________________________________

## bestNormalize Chosen transformation of BG_ase ## 
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 3.010  3.735  4.220  5.795 10.480 
_____________________________________

## bestNormalize Chosen transformation of BP_ase ## 
Standardized Log_b(x + a) Transformation with 15 nonmissing obs.:
 Relevant statistics:
 - a = 0 
 - b = 10 
 - mean (before standardization) = 0.5217757 
 - sd (before standardization) = 0.2001498 
_____________________________________

## bestNormalize Chosen transformation of CE_ase ## 
Standardized Log_b(x + a) Transformation with 15 nonmissing obs.:
 Relevant statistics:
 - a = 0 
 - b = 10 
 - mean (before standardization) = 0.03306978 
 - sd (before standardization) = 0.1652591 
_____________________________________

## bestNormalize Chosen transformation of P_ase ## 
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
13.020 15.130 19.210 24.455 44.040 
_____________________________________

## bestNormalize Chosen transformation of N_ase ## 
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
  0%  25%  50%  75% 100% 
2.57 2.93 3.58 5.04 9.43 
_____________________________________

## bestNormalize Chosen transformation of XY_ase ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 13 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
0.66 0.81 1.11 1.39 2.52 
_____________________________________

## bestNormalize Chosen transformation of BG_Q10 ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 13 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
1.310 1.360 1.390 1.545 1.760 
_____________________________________

## bestNormalize Chosen transformation of BP_Q10 ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 11 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
1.340 1.415 1.440 1.530 1.740 
_____________________________________

## bestNormalize Chosen transformation of CO2 ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 14 unique values 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 2.080  4.370  5.270 10.585 40.470 
_____________________________________

## bestNormalize Chosen transformation of PX_ase ## 
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
     0%     25%     50%     75%    100% 
 81.250  95.565 119.750 218.370 339.600 
_____________________________________

## bestNormalize Chosen transformation of PX_Q10 ## 
Standardized Yeo-Johnson Transformation with 15 nonmissing obs.:
 Estimated statistics:
 - lambda = -4.999946 
 - mean (before standardization) = 0.1968247 
 - sd (before standardization) = 0.001294011 
_____________________________________

## bestNormalize Chosen transformation of CUEcp ## 
Standardized Box Cox Transformation with 15 nonmissing obs.:
 Estimated statistics:
 - lambda = -0.9999576 
 - mean (before standardization) = -4.229896 
 - sd (before standardization) = 0.9115063 
_____________________________________

## bestNormalize Chosen transformation of PUE ## 
orderNorm Transformation with 15 nonmissing obs and ties
 - 7 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
0.770 0.880 0.900 0.905 0.920 
_____________________________________</code></pre>
</div>
</details>
<details>
<summary>
Show the complete <code>bestNormalize</code> results
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
## Results of bestNormalize for AST ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.4
 - Box-Cox: 1.8
 - Center+scale: 4.2
 - Exp(x): 21.2667
 - Log_b(x+a): 3.4
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 4.2
 - Yeo-Johnson: 2.8667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
25.800 26.275 28.800 30.280 41.770 
_____________________________________

## Results of bestNormalize for H2O ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 6.8667
 - Box-Cox: 5.8
 - Center+scale: 5.8
 - Exp(x): 5.8
 - Log_b(x+a): 6.0667
 - orderNorm (ORQ): 0.7333
 - sqrt(x + a): 6.8667
 - Yeo-Johnson: 5.8
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
   0%   25%   50%   75%  100% 
0.204 0.308 0.370 0.384 0.401 
_____________________________________

## Results of bestNormalize for Al ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 8.2
 - Center+scale: 8.2
 - Exp(x): 8.2
 - Log_b(x+a): 8.2
 - orderNorm (ORQ): 8.2
 - sqrt(x + a): 8.2
 - Yeo-Johnson: 8.2
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized asinh(x) Transformation with 15 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 0.0059997 
 - sd (before standardization) = 0.008280287 
_____________________________________

## Results of bestNormalize for Ca ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.8
 - Box-Cox: 1.8
 - Center+scale: 3.4
 - Exp(x): 18.0667
 - Log_b(x+a): 1.8
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 1.8
 - Yeo-Johnson: 1.2667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
25.49 27.19 29.23 34.36 39.79 
_____________________________________

## Results of bestNormalize for Fe ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 6.3333
 - Center+scale: 6.3333
 - Exp(x): 6.3333
 - Log_b(x+a): 6.3333
 - orderNorm (ORQ): 6.3333
 - sqrt(x + a): 6.3333
 - Yeo-Johnson: 6.3333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized asinh(x) Transformation with 15 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 0.0119984 
 - sd (before standardization) = 0.01264569 
_____________________________________

## Results of bestNormalize for TEB ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.3333
 - Box-Cox: 1.2667
 - Center+scale: 6.0667
 - Exp(x): 18.0667
 - Log_b(x+a): 2.3333
 - orderNorm (ORQ): 0.4667
 - sqrt(x + a): 5.5333
 - Yeo-Johnson: 1.5333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
41.6 43.3 45.1 51.4 61.7 
_____________________________________

## Results of bestNormalize for ECEC ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.2667
 - Box-Cox: 1.2667
 - Center+scale: 6.0667
 - Exp(x): 18.0667
 - Log_b(x+a): 1.2667
 - orderNorm (ORQ): 0.4667
 - sqrt(x + a): 3.9333
 - Yeo-Johnson: 1.5333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
41.7 43.3 45.3 51.5 61.8 
_____________________________________

## Results of bestNormalize for minNO3 ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.8
 - Box-Cox: 1.2667
 - Center+scale: 3.9333
 - Exp(x): 21.2667
 - Log_b(x+a): 1.8
 - orderNorm (ORQ): 1.2667
 - sqrt(x + a): 1.8
 - Yeo-Johnson: 1.2667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized Box Cox Transformation with 15 nonmissing obs.:
 Estimated statistics:
 - lambda = -0.3344538 
 - mean (before standardization) = 1.907818 
 - sd (before standardization) = 0.2388776 
_____________________________________

## Results of bestNormalize for minTIN ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.8
 - Box-Cox: 1.8
 - Center+scale: 3.9333
 - Exp(x): 21.2667
 - Log_b(x+a): 1.8
 - orderNorm (ORQ): 0.7333
 - sqrt(x + a): 1.8
 - Yeo-Johnson: 1.8
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 14 unique values 
 - Original quantiles:
     0%     25%     50%     75%    100% 
  8.760  14.995  23.080  39.935 110.750 
_____________________________________

## Results of bestNormalize for DOC ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.3333
 - Box-Cox: 1.2667
 - Center+scale: 2.8667
 - Exp(x): 21.2667
 - Log_b(x+a): 2.3333
 - orderNorm (ORQ): 0.4667
 - sqrt(x + a): 2.8667
 - Yeo-Johnson: 1.2667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
     0%     25%     50%     75%    100% 
 30.800  44.070  56.680  64.385 118.740 
_____________________________________

## Results of bestNormalize for DOCN ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.3333
 - Box-Cox: 0.7333
 - Center+scale: 3.9333
 - Exp(x): 21.2667
 - Log_b(x+a): 2.3333
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 3.1333
 - Yeo-Johnson: 0.2
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 9.440 10.290 11.150 12.095 19.270 
_____________________________________

## Results of bestNormalize for micCN ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.1333
 - Box-Cox: 3.1333
 - Center+scale: 3.1333
 - Exp(x): 5.5333
 - Log_b(x+a): 3.1333
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 3.1333
 - Yeo-Johnson: 3.1333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 14 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
4.420 4.585 4.720 5.415 5.850 
_____________________________________

## Results of bestNormalize for BG_ase ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.8667
 - Box-Cox: 2.3333
 - Center+scale: 5
 - Exp(x): 21.2667
 - Log_b(x+a): 2.8667
 - orderNorm (ORQ): 0.4667
 - sqrt(x + a): 2.8667
 - Yeo-Johnson: 2.3333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 3.010  3.735  4.220  5.795 10.480 
_____________________________________

## Results of bestNormalize for BP_ase ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.5333
 - Box-Cox: 1.5333
 - Center+scale: 3.1333
 - Exp(x): 11.9333
 - Log_b(x+a): 0.7333
 - orderNorm (ORQ): 0.7333
 - sqrt(x + a): 3.1333
 - Yeo-Johnson: 1.5333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized Log_b(x + a) Transformation with 15 nonmissing obs.:
 Relevant statistics:
 - a = 0 
 - b = 10 
 - mean (before standardization) = 0.5217757 
 - sd (before standardization) = 0.2001498 
_____________________________________

## Results of bestNormalize for CE_ase ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1
 - Box-Cox: 0.7333
 - Center+scale: 1.8
 - Exp(x): 4.2
 - Log_b(x+a): 0.4667
 - orderNorm (ORQ): 1
 - sqrt(x + a): 1
 - Yeo-Johnson: 0.4667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized Log_b(x + a) Transformation with 15 nonmissing obs.:
 Relevant statistics:
 - a = 0 
 - b = 10 
 - mean (before standardization) = 0.03306978 
 - sd (before standardization) = 0.1652591 
_____________________________________

## Results of bestNormalize for P_ase ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.0667
 - Box-Cox: 1.2667
 - Center+scale: 3.6667
 - Exp(x): 21.2667
 - Log_b(x+a): 2.0667
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 2.3333
 - Yeo-Johnson: 1.2667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
13.020 15.130 19.210 24.455 44.040 
_____________________________________

## Results of bestNormalize for N_ase ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.2667
 - Box-Cox: 1.8
 - Center+scale: 3.1333
 - Exp(x): 17.8
 - Log_b(x+a): 1.2667
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 3.1333
 - Yeo-Johnson: 1.2667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
  0%  25%  50%  75% 100% 
2.57 2.93 3.58 5.04 9.43 
_____________________________________

## Results of bestNormalize for XY_ase ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 0.7333
 - Box-Cox: 0.7333
 - Center+scale: 2.8667
 - Exp(x): 6.3333
 - Log_b(x+a): 0.7333
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 1.8
 - Yeo-Johnson: 0.7333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 13 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
0.66 0.81 1.11 1.39 2.52 
_____________________________________

## Results of bestNormalize for BG_Q10 ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.3333
 - Box-Cox: 2.3333
 - Center+scale: 2.3333
 - Exp(x): 6.0667
 - Log_b(x+a): 2.3333
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 2.3333
 - Yeo-Johnson: 2.3333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 13 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
1.310 1.360 1.390 1.545 1.760 
_____________________________________

## Results of bestNormalize for BP_Q10 ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.6
 - Box-Cox: 2.6
 - Center+scale: 2.6
 - Exp(x): 2.6
 - Log_b(x+a): 2.6
 - orderNorm (ORQ): 0.7333
 - sqrt(x + a): 2.6
 - Yeo-Johnson: 2.3333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 11 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
1.340 1.415 1.440 1.530 1.740 
_____________________________________

## Results of bestNormalize for CO2 ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.5333
 - Box-Cox: 2.6
 - Center+scale: 11.9333
 - Exp(x): 21.2667
 - Log_b(x+a): 1.5333
 - orderNorm (ORQ): 1.2667
 - sqrt(x + a): 3.4
 - Yeo-Johnson: 2.0667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 14 unique values 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 2.080  4.370  5.270 10.585 40.470 
_____________________________________

## Results of bestNormalize for PX_ase ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.3333
 - Box-Cox: 1.2667
 - Center+scale: 7.6667
 - Exp(x): 21.2667
 - Log_b(x+a): 2.3333
 - orderNorm (ORQ): 0.2
 - sqrt(x + a): 2.8667
 - Yeo-Johnson: 1.2667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and no ties 
 - Original quantiles:
     0%     25%     50%     75%    100% 
 81.250  95.565 119.750 218.370 339.600 
_____________________________________

## Results of bestNormalize for PX_Q10 ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 14.6
 - Box-Cox: 4.2
 - Center+scale: 21.2667
 - Exp(x): 21.2667
 - Log_b(x+a): 11.9333
 - orderNorm (ORQ): 2.0667
 - sqrt(x + a): 21.2667
 - Yeo-Johnson: 1.5333
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized Yeo-Johnson Transformation with 15 nonmissing obs.:
 Estimated statistics:
 - lambda = -4.999946 
 - mean (before standardization) = 0.1968247 
 - sd (before standardization) = 0.001294011 
_____________________________________

## Results of bestNormalize for CUEcp ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.9333
 - Box-Cox: 1.5333
 - Center+scale: 3.9333
 - Exp(x): 3.9333
 - Log_b(x+a): 2.0667
 - orderNorm (ORQ): 1.5333
 - sqrt(x + a): 2.0667
 - Yeo-Johnson: 2.0667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized Box Cox Transformation with 15 nonmissing obs.:
 Estimated statistics:
 - lambda = -0.9999576 
 - mean (before standardization) = -4.229896 
 - sd (before standardization) = 0.9115063 
_____________________________________

## Results of bestNormalize for PUE ## 
Best Normalizing transformation with 15 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 8.2
 - Box-Cox: 9.8
 - Center+scale: 8.2
 - Exp(x): 3.9333
 - Log_b(x+a): 9.8
 - orderNorm (ORQ): 2.0667
 - sqrt(x + a): 9.8
 - Yeo-Johnson: 9.8
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 15 nonmissing obs and ties
 - 7 unique values 
 - Original quantiles:
   0%   25%   50%   75%  100% 
0.770 0.880 0.900 0.905 0.920 
_____________________________________</code></pre>
</div>
</details>
<p>Great, now we can add the normalized transformed data back to our
<code>mctoolsr</code> metadata file.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ssu18_select_mc_norm <span class="ot">&lt;-</span> ssu18_select_mc</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> md_to_tranform) {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">&quot;_best_norm_test&quot;</span>)))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      tmp_new_data <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>x.t</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>      ssu18_select_mc_norm<span class="sc">$</span>map_loaded[[i]] <span class="ot">&lt;-</span> tmp_new_data</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}     </span></code></pre></div>
</details>
</div>
<p>And rerun the Shapiro Tests.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>temp_md_norm <span class="ot">&lt;-</span> ssu18_select_mc_norm<span class="sc">$</span>map_loaded</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>temp_md_norm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>shap_results_norm <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(temp_md_norm)) {</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  tmp_shap <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(temp_md_norm[[i]])</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  tmp_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_shap<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">5</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_shap<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  shap_results_norm <span class="ot">&lt;-</span> <span class="fu">rbind</span>(shap_results_norm, <span class="fu">data.frame</span>(i, tmp_p, tmp_res))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(shap_results_norm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;tranform&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>shap_results_norm</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;temp_md_norm&quot;</span>))</span></code></pre></div>
</details>
</div>
<p>And check if there are any parameters that are still significant for
the normality test.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>shap_results<span class="sc">$</span>parameter[shap_results_norm<span class="sc">$</span>tranform <span class="sc">==</span> <span class="cn">TRUE</span>]</span></code></pre></div>
<pre><code>[1] &quot;Al&quot; &quot;Fe&quot;</code></pre>
</div>
<p>Ok. Looks like <code>bestNormalize</code> was unable to find a
suitable transformation for <code>Al</code> and <code>Fe</code>. This is
likely because there is very little variation in these metadata and/or
there are too few significant digits.</p>
<h2 id="normalized-metadata">Normalized Metadata</h2>
<p>Finally, here is a new summary table that includes all of the
normalized data.</p>
<p></br></p>
<div class="layout-chunk" data-layout="l-body">
<a onclick="fetch(&#39;data:text/csv;base64,U2FtcGxlX0lELEFUQVAsQVNULEgyTyxOLFAsQWwsQ2EsRmUsSyxNZyxNbixOYSxURUIsRUNFQyxwSCxtaW5QTzQsbWluTkg0LG1pbk5PMyxtaW5USU4sTkg0LE5PMyxQTzQsRE9DLERPTixET0NOLG1pY0MsbWljTixtaWNQLG1pY0NOLG1pY0NQLG1pY05QLEFHX2FzZSxCR19hc2UsQlBfYXNlLENFX2FzZSxQX2FzZSxOX2FzZSxTX2FzZSxYWV9hc2UsQUdfUTEwLEJHX1ExMCxCUF9RMTAsQ0VfUTEwLFBfUTEwLE5fUTEwLFNfUTEwLFhZX1ExMCxDTzIsTFBfYXNlLExQX1ExMCxQWF9hc2UsUFhfUTEwLENVRWNuLENVRWNwLE5VRSxQVUUsVG1pbixTSSxlbnpDTixlbnpDUCxlbnpOUApQMTBfRDAwXzAxMF9DMEUsMjYsLTEuMjgxNTUxNTY1NTQ0NjAwOCwwLDAuMjYsMC4zMiwxLjY5MDYzNzk4MDg0MzI3NTksMC45Njc0MjE1NjYxMDE3MDE0LC0wLjE1ODA0MzMyNzgzODI3NTUsMS4zOCwyMS40MywwLjA3LDAuMTMsMC45Njc0MjE1NjYxMDE3MDE0LDAuOTY3NDIxNTY2MTAxNzAxNCw2LjI4LDQuMDgsNC43NSwwLjgwMDA3NTQ5NTM3ODcxNTYsMC43Mjc5MTMyOTA4ODE2NDQ1LDMuNDQsNC41Myw5LjQ1LDAuNTI0NDAwNTEyNzA4MDQwNyw0LjkxLDEuMjgxNTUxNTY1NTQ0NjAwOCwzMzQuOTMsNzIuNjQsNjQuMjMsLTEuMjgxNTUxNTY1NTQ0NjAwOCw1LjU0LDEuMTcsMC4yOCwwLjUyNDQwMDUxMjcwODA0MDcsLTAuOTg2NzI3MjQ0MTE4NjQzOSwtMC41OTY0NjUzMjE1NzI2NTQsLTAuOTY3NDIxNTY2MTAxNzAxNCwtMC4zNDA2OTQ4MjcwODc3OTU0Nyw0LjU0LC0wLjk2NzQyMTU2NjEwMTcwMTQsMS41NCwtMC4zNDA2OTQ4MjcwODc3OTU0NywtMC43Mjc5MTMyOTA4ODE2NDQsMS44MSwxLjI3LDEuNDcsMS4zMywxLjY1LC0wLjE2Nzg5NDAwNDc4ODEwNTQsMzIuMjIsMS44LC0wLjE2Nzg5NDAwNDc4ODEwNTQsLTAuOTg4MzQ0MjY5ODQzMDk0OSwwLjIyLC0xLjExODg1MjUxOTU3NTA4MywwLjg3LDEuMjgxNTUxNTY1NTQ0NjAwOCwtMi40NiwxLjI5LDAuNTIzMSwwLjY2MDcsMS4yNjMKUDAyX0QwMF8wMTBfQzBBLDI2LC0wLjk2NzQyMTU2NjEwMTcwMTQsMC4zNDA2OTQ4MjcwODc3OTUzNiwwLjMzNjcsMC40MywwLjQ4MzA5MTE2OTQ5ODg2NTIsMC43Mjc5MTMyOTA4ODE2NDQ1LC0wLjE1ODA0MzMyNzgzODI3NTUsMC42OSw4LjE2LDAuMDQsMC4xMSwwLjE2Nzg5NDAwNDc4ODEwNTQsMC4xNjc4OTQwMDQ3ODgxMDU0LDYuMTgsMS40MiwzLjkyLDAuMjI1OTEwMjU2NTAwNjA4NjcsMC4zNDA2OTQ4MjcwODc3OTUzNiw0LjgxLDMuMTMsNy41OCwxLjI4MTU1MTU2NTU0NDYwMDgsOC4yMiwtMS44MzM5MTQ2MzU4MTU5MTQyLDQ0NC43MiwxMTAuMTMsNjUuMDMsLTEuODMzOTE0NjM1ODE1OTE0Miw4LjEzLDIuMzcsMC4yNCwwLC0wLjU4NDI3MjQzNTYzNjMyMDEsMC4wMjYzNjI5NzA0NTA3OTg5MzYsLTAuNzI3OTEzMjkwODgxNjQ0LC0wLjE2Nzg5NDAwNDc4ODEwNTQsMy44LC0wLjI1MzM0NzEwMzEzNTc5OTgsMS41MSwtMS41MDEwODU5NDYwNDQwMjQ3LC0xLjgzMzkxNDYzNTgxNTkxNDIsMS44OSwxLjIyLDEuNTQsMS4yMywxLjU5LDAsMzguNjEsMS44MSwtMC43Mjc5MTMyOTA4ODE2NDQsMS4xMDMzODA5NzE1MzA2MzgsMC4yMiwwLjUxMzU5NjcyNjE3NTgyMDIsMC44NywtMC42MjI5MjU3MjMyMTAwODc4LDAuMTQsMS40NCwwLjUwMjQsMC42NTU0LDEuMzA0NApQMDRfRDAwXzAxMF9DMEIsMjYsLTAuNTI0NDAwNTEyNzA4MDQwNywwLjUyNDQwMDUxMjcwODA0MDcsMC4zMDMzLDAuMzMsLTAuNzI0NTc2MzgzNDQ3MzgwNCwwLDAuNjMyNjQ3MzkwMDcyMTg1MywxLjE4LDE0LjU5LDAuMTIsMC4xNCwwLDAsNS43MywxLjUsMy4xNywtMC4wNzE4MjM3NDczNDg4NDI2NCwtMC4wODM2NTE3MzM5MDcxMjkwNyw1LjU3LDMuMjIsNy45NSwwLjE2Nzg5NDAwNDc4ODEwNTQsNi4zMiwtMC4zNDA2OTQ4MjcwODc3OTU0Nyw0NDAuNiw4Ni4xOSw4MS40NSwwLjM0MDY5NDgyNzA4Nzc5NTM2LDUuMzksMS4wOSwwLjIyLDAuMzQwNjk0ODI3MDg3Nzk1MzYsLTAuMjA4Njg3NjcyNDQ0MjEwOCwwLjAyNjM2Mjk3MDQ1MDc5ODkzNiwwLjE2Nzg5NDAwNDc4ODEwNTQsMC4xNjc4OTQwMDQ3ODgxMDU0LDQuOTIsMC4wODM2NTE3MzM5MDcxMjkwNywxLjUxLDAuMzQwNjk0ODI3MDg3Nzk1MzYsMS4yODE1NTE1NjU1NDQ2MDA4LDIuMywxLjM3LDEuODUsMS4zOSwxLjc2LC0xLjI4MTU1MTU2NTU0NDYwMDgsMjkuNTEsMi4xNCwtMS44MzM5MTQ2MzU4MTU5MTQyLC0wLjI4NTI3MTMxNTI1NDM5OTgsMC4yNSwtMC4wMzYyODMwNDIwNDcyNTMwOSwwLjg1LDAuMjUzMzQ3MTAzMTM1Nzk5OCwtMi42MywxLjI1LDAuNTU1LDAuNjE3MywxLjExMjMKUDA2X0QwMF8wMTBfQzBDLDI2LC0wLjcyNzkxMzI5MDg4MTY0NCwwLjE2Nzg5NDAwNDc4ODEwNTQsMC4zMzMzLDAuMywtMC43MjQ1NzYzODM0NDczODA0LDAuNTI0NDAwNTEyNzA4MDQwNywtMC45NDg4MTMxMDYyNTYzMjAzLDAuNTcsMjEuMzIsMC4wNiwwLjE0LDAuNzI3OTEzMjkwODgxNjQ0NSwwLjcyNzkxMzI5MDg4MTY0NDUsNS45MywwLjc1LDEuODMsLTAuMDkxMzAzMzQ4MjMwNDM5NDcsLTAuMzQwNjk0ODI3MDg3Nzk1NDcsMi45MiwyLjI3LDcuMDQsMCw1LjQyLC0wLjE2Nzg5NDAwNDc4ODEwNTQsMzkwLjY2LDcyLjYxLDg1LjcsMC41MjQ0MDA1MTI3MDgwNDA3LDQuNSwwLjgzLDAuMjEsLTAuOTY3NDIxNTY2MTAxNzAxNCwtMC43NzE1MjExMzY2NTYwMzg5LC0wLjk1NjEyNTkxMzQxNzA5OTQsLTEuMjgxNTUxNTY1NTQ0NjAwOCwtMS44MzM5MTQ2MzU4MTU5MTQyLDUuNDUsLTEuODMzOTE0NjM1ODE1OTE0MiwxLjgzLC0xLjUwMTA4NTk0NjA0NDAyNDcsMC4wODM2NTE3MzM5MDcxMjkwNywyLjM2LDEuMjQsMS42LDEuNDcsMS42MywtMC44NDE2MjEyMzM1NzI5MTQyLDI3Ljc4LDEuODUsLTAuOTY3NDIxNTY2MTAxNzAxNCwwLjk2NDM4NTgzODk3NjEzMzQsMC4yNywtMS4xMTg4NTI1MTk1NzUwODMsMC44MywxLjI4MTU1MTU2NTU0NDYwMDgsLTAuMTMsMS40MiwwLjQ2MjQsMC41NTU2LDEuMjAxNwpQMDhfRDAwXzAxMF9DMEQsMjYsLTEuODMzOTE0NjM1ODE1OTE0MiwxLjgzMzkxNDYzNTgxNTkxNDIsMC4yNDMzLDAuMjcsLTAuNzI0NTc2MzgzNDQ3MzgwNCwtMS44MzM5MTQ2MzU4MTU5MTQyLC0wLjk0ODgxMzEwNjI1NjMyMDMsMS44NiwxNC45MywwLjAyLDAuMDgsLTAuOTY3NDIxNTY2MTAxNzAxNCwtMC45Njc0MjE1NjYxMDE3MDE0LDYuMDEsMy42Nyw0LjMzLDEuOTAyNTY0NzEyNTU0MjQxOCwxLjgzMzkxNDYzNTgxNTkxNDIsMi4wNCwzLjcxLDUuOTcsLTAuMzQwNjk0ODI3MDg3Nzk1NDcsNS4yMiwwLjE2Nzg5NDAwNDc4ODEwNTQsMjc3LjM3LDU2LjU1LDMzLjQsLTAuMDgzNjUxNzMzOTA3MTI5MDcsMTEuNTUsMi40NSwwLjE1LC0wLjcyNzkxMzI5MDg4MTY0NCwtMS4zNjc5ODc1Njg0NzAwNDEzLC0xLjIxMzYxNDYwMzMyNzAwMzcsLTEuODMzOTE0NjM1ODE1OTE0MiwtMC41MjQ0MDA1MTI3MDgwNDA3LDMuNTYsLTEuMjgxNTUxNTY1NTQ0NjAwOCwyLjA4LDEuODMzOTE0NjM1ODE1OTE0MiwxLjgzMzkxNDYzNTgxNTkxNDIsMiwxLjQ4LDEuNjksMS40OCwxLjgzLC0xLjgzMzkxNDYzNTgxNTkxNDIsMjEuOTYsMi4wNywtMS4yODE1NTE1NjU1NDQ2MDA4LDIuMzc4ODE1MDc5NjAxNjAxNywwLjI0LDAuNzUxMDQ1NTUyNTQ2ODA1NiwwLjg1LC0wLjYyMjkyNTcyMzIxMDA4NzgsMCwxLjU0LDAuNTA1OCwwLjYwMzcsMS4xOTM1ClAwMV9EMDBfMDEwX1czQSwyOSwwLjM0MDY5NDgyNzA4Nzc5NTM2LDAuOTY3NDIxNTY2MTAxNzAxNCwwLjQyNjcsMC4zNSwtMC43MjQ1NzYzODM0NDczODA0LDAuMjUzMzQ3MTAzMTM1Nzk5OCwtMC4xNTgwNDMzMjc4MzgyNzU1LDEuNzIsOS45OCwwLjA0LDAuMTUsLTAuNjIyOTI1NzIzMjEwMDg3OCwtMC42MjI5MjU3MjMyMTAwODc4LDYuMDEsMS4zMywzLjY3LDEuMDgwODE2NjEwMjM3Nzk1OCwxLjI4MTU1MTU2NTU0NDYwMDgsOC4wMyw0LjY3LDkuNTIsMS44MzM5MTQ2MzU4MTU5MTQyLDExLjY2LDAsNjkwLjExLDEzNS40OCw4Ny45OCwtMC4zNDA2OTQ4MjcwODc3OTU0Nyw4LjYxLDEuNzQsMC4yNiwtMC4zNDA2OTQ4MjcwODc3OTU0NywwLjExMTM3ODA1Nzk4Nzk1NjQ0LC0wLjIwMDEwODY1MjU1OTY1MzY4LDAuMzQwNjk0ODI3MDg3Nzk1MzYsMC45Njc0MjE1NjYxMDE3MDE0LDYuMDgsMC4zNDA2OTQ4MjcwODc3OTUzNiwxLjc3LC0wLjE2Nzg5NDAwNDc4ODEwNTQsLTEuMTEwNzcxNjE2NjM2Nzg1NiwyLjAzLDEuMzcsMS40NiwxLjMsMS43MiwwLjcyNzkxMzI5MDg4MTY0NDUsNTIuOCwxLjc2LDAuMzQwNjk0ODI3MDg3Nzk1MzYsLTAuNDEwOTczNDc1NjU2OTk1NDQsMC4zMiwwLjUxMzU5NjcyNjE3NTgyMDIsMC43NywtMC42MjI5MjU3MjMyMTAwODc4LDAuMDcsMS41MSwwLjQ2MTQsMC41OTExLDEuMjgxMgpQMDNfRDAwXzAxMF9XM0IsMjksMC4xNjc4OTQwMDQ3ODgxMDU0LDEuMjgxNTUxNTY1NTQ0NjAwOCwwLjMyLDAuMzcsMC40ODMwOTExNjk0OTg4NjUyLC0wLjYyMjkyNTcyMzIxMDA4NzgsLTAuMTU4MDQzMzI3ODM4Mjc1NSwwLjg1LDE2LjUxLDAuMDYsMC4xMiwtMC4yNTMzNDcxMDMxMzU3OTk4LC0wLjI1MzM0NzEwMzEzNTc5OTgsNS44NiwyLjgzLDMuMzMsMC45NTg0MjYzNDE0NDg3NzE5LDAuOTY3NDIxNTY2MTAxNzAxNCwzLjExLDIuNTcsOC42NiwwLjM0MDY5NDgyNzA4Nzc5NTM2LDYuNDgsLTAuNzI3OTEzMjkwODgxNjQ0LDM2NC42Miw2Ni40LDcwLjY4LDAuMTY3ODk0MDA0Nzg4MTA1NCw2LjcsMS4zMSwwLjMzLDAuMTY3ODk0MDA0Nzg4MTA1NCwtMC4xODcyMzkyNTg1Mjc4NDIxNSwwLjQwNzI0MzkzMTk5OTAzNzksMCwwLDUuNzIsMC41MjQ0MDA1MTI3MDgwNDA3LDIuNDgsLTAuNjIyOTI1NzIzMjEwMDg3OCwtMC4zNDA2OTQ4MjcwODc3OTU0NywxLjk5LDEuMjcsMS41NCwxLjI3LDEuNzIsLTAuNTI0NDAwNTEyNzA4MDQwNywzMi4xLDIsMCwwLjU1NDI5ODIzMzIxMzY2NTcsMC4yNiwtMC4zNTcwNDUxOTk4NzU4NTMyNiwwLjg0LDAuMjUzMzQ3MTAzMTM1Nzk5OCwtMC4yOSwxLjQ5LDAuNTU2NSwwLjY0MTIsMS4xNTIyClAwNV9EMDBfMDEwX1czQywyOSwtMC4zNDA2OTQ4MjcwODc3OTU0NywtMC41MjQ0MDA1MTI3MDgwNDA3LDAuMzMzMywwLjMzLC0wLjcyNDU3NjM4MzQ0NzM4MDQsLTEuMTEwNzcxNjE2NjM2Nzg1NiwtMC45NDg4MTMxMDYyNTYzMjAzLDAuNjcsMTQuODMsMC4wNSwwLC0xLjUwMTA4NTk0NjA0NDAyNDcsLTEuNTAxMDg1OTQ2MDQ0MDI0Nyw1Ljg3LDEuMTcsMi4xNywtMS4wNDA4NDg0NDE3NzI4Mjc0LC0wLjk2NzQyMTU2NjEwMTcwMTQsMi4zMiwzLjMxLDcuMywwLjcyNzkxMzI5MDg4MTY0NDUsNy4wMywwLjM0MDY5NDgyNzA4Nzc5NTM2LDI4NC41LDQ4Ljc5LDUyLjUsMC43Mjc5MTMyOTA4ODE2NDQ1LDguMzMsMS4zOSwwLjM0LC0xLjgzMzkxNDYzNTgxNTkxNDIsLTAuNzYyMjI4NDE2MzU2MjYyMywtMC45MjEzMTc5NzQzNTU2MDM4LC0wLjUyNDQwMDUxMjcwODA0MDcsLTEuMjgxNTUxNTY1NTQ0NjAwOCwzLjIsLTAuNTI0NDAwNTEyNzA4MDQwNywxLjQ4LC0wLjk2NzQyMTU2NjEwMTcwMTQsLTEuMTEwNzcxNjE2NjM2Nzg1NiwxLjg4LDEuMjgsMS41MSwxLjMsMS44MiwtMC4zNDA2OTQ4MjcwODc3OTU0NywyNC4xMSwxLjc5LC0wLjM0MDY5NDgyNzA4Nzc5NTQ3LDAuMjA0NzE3MDAzMTY3OTI5OTYsMC4yNywtMC4zNTcwNDUxOTk4NzU4NTMyNiwwLjgzLDAuMjUzMzQ3MTAzMTM1Nzk5OCwwLjgxLDEuNzcsMC40ODc3LDAuNTU5NiwxLjE0NzMKUDA3X0QwMF8wMTBfVzNELDI5LC0wLjE2Nzg5NDAwNDc4ODEwNTQsMC43Mjc5MTMyOTA4ODE2NDQ1LDAuNDM2NywwLjM1LC0wLjcyNDU3NjM4MzQ0NzM4MDQsLTAuMjUzMzQ3MTAzMTM1Nzk5OCwtMC4xNTgwNDMzMjc4MzgyNzU1LDEuNiwxOC44NywwLjA3LDAuMSwwLjQzMDcyNzI5OTI5NTQ1NzMzLDAuNDMwNzI3Mjk5Mjk1NDU3MzMsNi4yMSwxLDIuNDIsLTAuMDE1Mjg5MzkyMjAwMzYwMjUsLTAuMDgzNjUxNzMzOTA3MTI5MDcsNC4yOCw1LjA3LDkuMTUsMC45Njc0MjE1NjYxMDE3MDE0LDguNDcsLTAuOTY3NDIxNTY2MTAxNzAxNCwzOTYuNDIsNzMuNzMsOTMuMTMsLTAuMDgzNjUxNzMzOTA3MTI5MDcsNC42NiwwLjk4LDAuMzIsLTAuMTY3ODk0MDA0Nzg4MTA1NCwwLjA4MDE1NjcwMTAxMzQxNTE0LC0wLjAyMjMwNDM2NDQ1NTkzODQ4NSwwLjUyNDQwMDUxMjcwODA0MDcsMC4zNDA2OTQ4MjcwODc3OTUzNiw1Ljg2LDAuMDgzNjUxNzMzOTA3MTI5MDcsMS43MiwwLjE2Nzg5NDAwNDc4ODEwNTQsMC4zNDA2OTQ4MjcwODc3OTUzNiwxLjc2LDEuMjgsMS4zNiwxLjMsMS42MywwLjE2Nzg5NDAwNDc4ODEwNTQsNDIuNCwxLjk2LC0wLjUyNDQwMDUxMjcwODA0MDcsLTAuOTA4OTk2ODgzMTc2MzkwNSwwLjI3LC0xLjU3NTkzNTE2MDE5MTg1ODUsMC44MywxLjI4MTU1MTU2NTU0NDYwMDgsMC42NSwxLjYxLDAuNDk0MSwwLjU3NjIsMS4xNjYyClAwOV9EMDBfMDEwX1czRSwyOSwwLC0wLjE2Nzg5NDAwNDc4ODEwNTQsMC4yODMzLDAuMzYsMS42OTA2Mzc5ODA4NDMyNzU5LDEuNTAxMDg1OTQ2MDQ0MDI0NywyLjIxMzQ3NTgyODgyOTY0OTcsMS4wOSwyMC42NCwwLjA4LDAuMTksMS41MDEwODU5NDYwNDQwMjQ3LDEuNTAxMDg1OTQ2MDQ0MDI0Nyw2LjEsMi41OCwzLjUsLTAuOTg3MjQwMDQ4NzYwOTIzMSwtMC41MjQ0MDA1MTI3MDgwNDA3LDIuMDMsMi45LDguMjgsLTAuNzI3OTEzMjkwODgxNjQ0LDUuNTYsMC43Mjc5MTMyOTA4ODE2NDQ1LDM5Mi41Niw2Mi4zNyw2Ni42NSwxLjI4MTU1MTU2NTU0NDYwMDgsNy4zNCwxLjE5LDAuMiwtMC41MjQ0MDA1MTI3MDgwNDA3LC0wLjgzNzcwODk2MTU4NjU5NTcsLTAuNTk2NDY1MzIxNTcyNjU0LC0wLjM0MDY5NDgyNzA4Nzc5NTQ3LC0wLjk2NzQyMTU2NjEwMTcwMTQsNS4yNiwtMC4yNTMzNDcxMDMxMzU3OTk4LDEuNjcsLTAuNjIyOTI1NzIzMjEwMDg3OCwwLjk2NzQyMTU2NjEwMTcwMTQsMS44MSwxLjM1LDEuNDgsMS4zMiwxLjg0LDAuNTI0NDAwNTEyNzA4MDQwNywzMC4zNywxLjksMC4xNjc4OTQwMDQ3ODgxMDU0LDAuNDczNDA3Njc2MzExNzgyOCwwLjI2LDAuNTEzNTk2NzI2MTc1ODIwMiwwLjg0LC0wLjYyMjkyNTcyMzIxMDA4NzgsLTAuMjQsMS41MSwwLjUxMTIsMC42MDY0LDEuMTg2MgpQMDFfRDAwXzAxMF9XOEEsMzQsMC43Mjc5MTMyOTA4ODE2NDQ1LC0wLjcyNzkxMzI5MDg4MTY0NCwwLjQyNjcsMC4zNSwtMC43MjQ1NzYzODM0NDczODA0LDAuMjUzMzQ3MTAzMTM1Nzk5OCwtMC4xNTgwNDMzMjc4MzgyNzU1LDEuNzIsOS45OCwwLjA0LDAuMTUsLTAuNjIyOTI1NzIzMjEwMDg3OCwtMC42MjI5MjU3MjMyMTAwODc4LDYuMDEsMC4xMiwxLjY1LC0xLjAzMDk0NjUyMDgyNjk4NTUsLTEuMjgxNTUxNTY1NTQ0NjAwOCw0LjA4LDIuNjUsOC41NSwtMC45Njc0MjE1NjYxMDE3MDE0LDQuMiwtMS4yODE1NTE1NjU1NDQ2MDA4LDQ2OSw4NCw1NSwwLjk2NzQyMTU2NjEwMTcwMTQsOC40OCwxLjUyLDAuMTUsMC43Mjc5MTMyOTA4ODE2NDQ1LDEuMDI4MDU3MzkzMDg0NjI3NSwxLjcxMTg2MDY5NzkzNDQwNzUsMC43Mjc5MTMyOTA4ODE2NDQ1LDAuNTI0NDAwNTEyNzA4MDQwNyw2LjcsMS44MzM5MTQ2MzU4MTU5MTQyLDIuMDEsMS4yODE1NTE1NjU1NDQ2MDA4LDAuNTI0NDAwNTEyNzA4MDQwNywxLjg3LDEuMzksMS41NiwxLjY1LDEuODYsLTAuODQxNjIxMjMzNTcyOTE0Miw0MC42OSwxLjcxLDAuNTI0NDAwNTEyNzA4MDQwNywtMS42MTEzNjkwOTczOTMxNjM2LDAuMjMsLTAuMzU3MDQ1MTk5ODc1ODUzMjYsMC44NywwLjI1MzM0NzEwMzEzNTc5OTgsMi4xOSwyLjMsMC42NDU2LDAuNzE2NiwxLjExClAwM19EMDBfMDEwX1c4QiwzNCwxLjgzMzkxNDYzNTgxNTkxNDIsLTAuOTY3NDIxNTY2MTAxNzAxNCwwLjMyLDAuMzcsMC40ODMwOTExNjk0OTg4NjUyLC0wLjYyMjkyNTcyMzIxMDA4NzgsLTAuMTU4MDQzMzI3ODM4Mjc1NSwwLjg1LDE2LjUxLDAuMDYsMC4xMiwtMC4yNTMzNDcxMDMxMzU3OTk4LC0wLjI1MzM0NzEwMzEzNTc5OTgsNS44NiwwLjIsMS4yOCwwLjEyNTU2NzE5OTE5MDkzNzY1LDAuMTY3ODk0MDA0Nzg4MTA1NCwyLjUsMS4wNiwyLjgsLTEuMjgxNTUxNTY1NTQ0NjAwOCwyLjUsMC45Njc0MjE1NjYxMDE3MDE0LDExNywyMCwxMSwxLjgzMzkxNDYzNTgxNTkxNDIsMTAuNTQsMS44LDAuMDIsLTEuMjgxNTUxNTY1NTQ0NjAwOCwtMC4zMDQxNjE2NDkzMjg3ODIsLTEuMzMyMTg5MzQ2NjE0Njc4OCwtMC4xNjc4OTQwMDQ3ODgxMDU0LC0wLjcyNzkxMzI5MDg4MTY0NCwxLjI4LC0wLjcyNzkxMzI5MDg4MTY0NCwxLjQ5LDAuNzI3OTEzMjkwODgxNjQ0NSwwLjcyNzkxMzI5MDg4MTY0NDUsMS45LDEuNTEsMS43NSwxLjM5LDEuODksMS44MzM5MTQ2MzU4MTU5MTQyLDEzLjk0LDEuNzcsMC43Mjc5MTMyOTA4ODE2NDQ1LC0wLjkwODk5Njg4MzE3NjM5MDUsMC4yOSwyLjQxMzIwMjMxNTExNTM0LDAuODEsLTEuODMzOTE0NjM1ODE1OTE0MiwwLjYzLDEuNzIsMC41MzAyLDAuNDkxOCwwLjkyNzcKUDA1X0QwMF8wMTBfVzhDLDM0LDEuMjgxNTUxNTY1NTQ0NjAwOCwtMS4yODE1NTE1NjU1NDQ2MDA4LDAuMzMzMywwLjMzLC0wLjcyNDU3NjM4MzQ0NzM4MDQsLTEuMTEwNzcxNjE2NjM2Nzg1NiwtMC45NDg4MTMxMDYyNTYzMjAzLDAuNjcsMTQuODMsMC4wNSwwLC0xLjUwMTA4NTk0NjA0NDAyNDcsLTEuNTAxMDg1OTQ2MDQ0MDI0Nyw1Ljg3LDAuMTEsMS4xOCwwLjc3NTY5OTg3NDUzMDA1NywwLjUyNDQwMDUxMjcwODA0MDcsMy45MSwyLjMsNC4yNSwtMC4xNjc4OTQwMDQ3ODgxMDU0LDQuMywtMC41MjQ0MDA1MTI3MDgwNDA3LDQ0MCw5Nyw1NiwtMC45Njc0MjE1NjYxMDE3MDE0LDcuOTEsMS43NCwwLjE1LDEuMjgxNTUxNTY1NTQ0NjAwOCwxLjcwMDUwNDI0MjQzODM2MTYsMC44NjU0Mzc4MzAwMzAzNjY4LDEuODMzOTE0NjM1ODE1OTE0MiwwLjcyNzkxMzI5MDg4MTY0NDUsNS41NywwLjk2NzQyMTU2NjEwMTcwMTQsMS43MywwLjk2NzQyMTU2NjEwMTcwMTQsLTAuMzQwNjk0ODI3MDg3Nzk1NDcsMS45NSwxLjQ4LDEuNjgsMS42LDEuODgsMS4yODE1NTE1NjU1NDQ2MDA4LDMyLjY1LDEuNjcsMC45Njc0MjE1NjYxMDE3MDE0LC0wLjM0NzI3NjkxMjQ0Nzc2OTQsMC4xOSwwLjk2Nzg0NzA3MzE4ODU3NDUsMC45LC0xLjI4MTU1MTU2NTU0NDYwMDgsMC45NCwyLjA4LDAuNjkzMSwwLjY0MTIsMC45MjUxClAwN19EMDBfMDEwX1c4RCwzNCwwLjUyNDQwMDUxMjcwODA0MDcsLTEuODMzOTE0NjM1ODE1OTE0MiwwLjQzNjcsMC4zNSwtMC43MjQ1NzYzODM0NDczODA0LC0wLjI1MzM0NzEwMzEzNTc5OTgsLTAuMTU4MDQzMzI3ODM4Mjc1NSwxLjYsMTguODcsMC4wNywwLjEsMC40MzA3MjcyOTkyOTU0NTczMywwLjQzMDcyNzI5OTI5NTQ1NzMzLDYuMjEsMC4wMiwyLjYsLTAuODc1NTc4NzEyNjgyNTU5NSwtMC43Mjc5MTMyOTA4ODE2NDQsOC4xOSw2LjM5LDUuNjIsLTAuNTI0NDAwNTEyNzA4MDQwNywzLjcsMC41MjQ0MDA1MTI3MDgwNDA3LDY3NiwxNDcsOTQsLTAuNTI0NDAwNTEyNzA4MDQwNyw3LjE4LDEuNTYsMC4zOSwwLjk2NzQyMTU2NjEwMTcwMTQsMS42NDkyMzM3NTg2OTE0MTQ1LDAuOTE3NDc4MzYxODUzMDM3MiwwLjk2NzQyMTU2NjEwMTcwMTQsMS4yODE1NTE1NjU1NDQ2MDA4LDEwLjY4LDAuNzI3OTEzMjkwODgxNjQ0NSwxLjMxLDAsLTAuMzQwNjk0ODI3MDg3Nzk1NDcsMS45NiwxLjMzLDEuNTQsMS41MSwxLjkxLDAuMzQwNjk0ODI3MDg3Nzk1MzYsNTcuMTMsMS40LDEuMjgxNTUxNTY1NTQ0NjAwOCwtMC4xMDg4ODc5ODI5MjY3NTIyLDAuMjYsLTAuNzE1NTQzMjM2MzE0MDkwNCwwLjg0LDAuNzI3OTEzMjkwODgxNjQ0NSwxLjQ4LDEuODEsMC41OTMzLDAuNjYyOCwxLjExNzMKUDA5X0QwMF8wMTBfVzhFLDM0LDAuOTY3NDIxNTY2MTAxNzAxNCwtMC4zNDA2OTQ4MjcwODc3OTU0NywwLjI4MzMsMC4zNiwxLjY5MDYzNzk4MDg0MzI3NTksMS41MDEwODU5NDYwNDQwMjQ3LDIuMjEzNDc1ODI4ODI5NjQ5NywxLjA5LDIwLjY0LDAuMDgsMC4xOSwxLjUwMTA4NTk0NjA0NDAyNDcsMS41MDEwODU5NDYwNDQwMjQ3LDYuMSwwLDAuOTIsLTEuNzU2MDMwMjc4MDE4MTkxMSwtMS44MzM5MTQ2MzU4MTU5MTQyLDYuNSwyLjc2LDYuMDgsLTEuODMzOTE0NjM1ODE1OTE0MiwxLjYsMS44MzM5MTQ2MzU4MTU5MTQyLDQxNiw5MSw2MywtMC43Mjc5MTMyOTA4ODE2NDQsNi42LDEuNDQsMC4zNywxLjgzMzkxNDYzNTgxNTkxNDIsMS40NDEyMDQxODk5MDg5NjM4LDEuODgzODQ0NzM1MTU2ODM4NiwxLjI4MTU1MTU2NTU0NDYwMDgsMS44MzM5MTQ2MzU4MTU5MTQyLDExLjc4LDEuMjgxNTUxNTY1NTQ0NjAwOCwxLjkzLDAuNTI0NDAwNTEyNzA4MDQwNywwLjA4MzY1MTczMzkwNzEyOTA3LDIuMTEsMS4zOCwxLjQ2LDEuNSwxLjc2LDAuOTY3NDIxNTY2MTAxNzAxNCw1My43OSwxLjc5LDEuODMzOTE0NjM1ODE1OTE0MiwtMC4xMDg4ODc5ODI5MjY3NTIyLDAuMjQsLTAuMDM2MjgzMDQyMDQ3MjUzMDksMC44NSwtMC4xNjc4OTQwMDQ3ODgxMDU0LDAuOTYsMS44MiwwLjY1MTUsMC43MjE4LDEuMTA3OQo=&#39;).then(res =&gt; res.blob()).then(blob =&gt; {&#10;      const downloadURL = window.URL.createObjectURL(blob);&#10;      const a = document.createElement(&#39;a&#39;);&#10;      document.body.appendChild(a);&#10;      a.href = downloadURL;&#10;      a.download = &#39;normalized_metadata.csv&#39;; a.click();&#10;      window.URL.revokeObjectURL(downloadURL);&#10;      document.body.removeChild(a);&#10;    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
<p><small><strong>(16S rRNA) Table 3 | Results of bestNormalize function
applied to each parameter.</strong></small></p>
<div class="layout-chunk" data-layout="l-page">
<div id="htmlwidget-2ae193cc8a21bcc729d6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2ae193cc8a21bcc729d6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P10_D00_010_C0E","P02_D00_010_C0A","P04_D00_010_C0B","P06_D00_010_C0C","P08_D00_010_C0D","P01_D00_010_W3A","P03_D00_010_W3B","P05_D00_010_W3C","P07_D00_010_W3D","P09_D00_010_W3E","P01_D00_010_W8A","P03_D00_010_W8B","P05_D00_010_W8C","P07_D00_010_W8D","P09_D00_010_W8E"],"ATAP":[26,26,26,26,26,29,29,29,29,29,34,34,34,34,34],"AST":[-1.282,-0.967,-0.524,-0.728,-1.834,0.341,0.168,-0.341,-0.168,0,0.728,1.834,1.282,0.524,0.967],"H2O":[0,0.341,0.524,0.168,1.834,0.967,1.282,-0.524,0.728,-0.168,-0.728,-0.967,-1.282,-1.834,-0.341],"N":[0.26,0.337,0.303,0.333,0.243,0.427,0.32,0.333,0.437,0.283,0.427,0.32,0.333,0.437,0.283],"P":[0.32,0.43,0.33,0.3,0.27,0.35,0.37,0.33,0.35,0.36,0.35,0.37,0.33,0.35,0.36],"Al":[1.691,0.483,-0.725,-0.725,-0.725,-0.725,0.483,-0.725,-0.725,1.691,-0.725,0.483,-0.725,-0.725,1.691],"Ca":[0.967,0.728,0,0.524,-1.834,0.253,-0.623,-1.111,-0.253,1.501,0.253,-0.623,-1.111,-0.253,1.501],"Fe":[-0.158,-0.158,0.633,-0.949,-0.949,-0.158,-0.158,-0.949,-0.158,2.213,-0.158,-0.158,-0.949,-0.158,2.213],"K":[1.38,0.69,1.18,0.57,1.86,1.72,0.85,0.67,1.6,1.09,1.72,0.85,0.67,1.6,1.09],"Mg":[21.43,8.16,14.59,21.32,14.93,9.98,16.51,14.83,18.87,20.64,9.98,16.51,14.83,18.87,20.64],"Mn":[0.07,0.04,0.12,0.06,0.02,0.04,0.06,0.05,0.07,0.08,0.04,0.06,0.05,0.07,0.08],"Na":[0.13,0.11,0.14,0.14,0.08,0.15,0.12,0,0.1,0.19,0.15,0.12,0,0.1,0.19],"TEB":[0.967,0.168,0,0.728,-0.967,-0.623,-0.253,-1.501,0.431,1.501,-0.623,-0.253,-1.501,0.431,1.501],"ECEC":[0.967,0.168,0,0.728,-0.967,-0.623,-0.253,-1.501,0.431,1.501,-0.623,-0.253,-1.501,0.431,1.501],"pH":[6.28,6.18,5.73,5.93,6.01,6.01,5.86,5.87,6.21,6.1,6.01,5.86,5.87,6.21,6.1],"minPO4":[4.08,1.42,1.5,0.75,3.67,1.33,2.83,1.17,1,2.58,0.12,0.2,0.11,0.02,0],"minNH4":[4.75,3.92,3.17,1.83,4.33,3.67,3.33,2.17,2.42,3.5,1.65,1.28,1.18,2.6,0.92],"minNO3":[0.8,0.226,-0.072,-0.091,1.903,1.081,0.958,-1.041,-0.015,-0.987,-1.031,0.126,0.776,-0.876,-1.756],"minTIN":[0.728,0.341,-0.084,-0.341,1.834,1.282,0.967,-0.967,-0.084,-0.524,-1.282,0.168,0.524,-0.728,-1.834],"NH4":[3.44,4.81,5.57,2.92,2.04,8.03,3.11,2.32,4.28,2.03,4.08,2.5,3.91,8.19,6.5],"NO3":[4.53,3.13,3.22,2.27,3.71,4.67,2.57,3.31,5.07,2.9,2.65,1.06,2.3,6.39,2.76],"PO4":[9.45,7.58,7.95,7.04,5.97,9.52,8.66,7.3,9.15,8.28,8.55,2.8,4.25,5.62,6.08],"DOC":[0.524,1.282,0.168,0,-0.341,1.834,0.341,0.728,0.967,-0.728,-0.967,-1.282,-0.168,-0.524,-1.834],"DON":[4.91,8.22,6.32,5.42,5.22,11.66,6.48,7.03,8.47,5.56,4.2,2.5,4.3,3.7,1.6],"DOCN":[1.282,-1.834,-0.341,-0.168,0.168,0,-0.728,0.341,-0.967,0.728,-1.282,0.967,-0.524,0.524,1.834],"micC":[334.93,444.72,440.6,390.66,277.37,690.11,364.62,284.5,396.42,392.56,469,117,440,676,416],"micN":[72.64,110.13,86.19,72.61,56.55,135.48,66.4,48.79,73.73,62.37,84,20,97,147,91],"micP":[64.23,65.03,81.45,85.7,33.4,87.98,70.68,52.5,93.13,66.65,55,11,56,94,63],"micCN":[-1.282,-1.834,0.341,0.524,-0.084,-0.341,0.168,0.728,-0.084,1.282,0.967,1.834,-0.967,-0.524,-0.728],"micCP":[5.54,8.13,5.39,4.5,11.55,8.61,6.7,8.33,4.66,7.34,8.48,10.54,7.91,7.18,6.6],"micNP":[1.17,2.37,1.09,0.83,2.45,1.74,1.31,1.39,0.98,1.19,1.52,1.8,1.74,1.56,1.44],"AG_ase":[0.28,0.24,0.22,0.21,0.15,0.26,0.33,0.34,0.32,0.2,0.15,0.02,0.15,0.39,0.37],"BG_ase":[0.524,0,0.341,-0.967,-0.728,-0.341,0.168,-1.834,-0.168,-0.524,0.728,-1.282,1.282,0.967,1.834],"BP_ase":[-0.987,-0.584,-0.209,-0.772,-1.368,0.111,-0.187,-0.762,0.08,-0.838,1.028,-0.304,1.701,1.649,1.441],"CE_ase":[-0.596,0.026,0.026,-0.956,-1.214,-0.2,0.407,-0.921,-0.022,-0.596,1.712,-1.332,0.865,0.917,1.884],"P_ase":[-0.967,-0.728,0.168,-1.282,-1.834,0.341,0,-0.524,0.524,-0.341,0.728,-0.168,1.834,0.967,1.282],"N_ase":[-0.341,-0.168,0.168,-1.834,-0.524,0.967,0,-1.282,0.341,-0.967,0.524,-0.728,0.728,1.282,1.834],"S_ase":[4.54,3.8,4.92,5.45,3.56,6.08,5.72,3.2,5.86,5.26,6.7,1.28,5.57,10.68,11.78],"XY_ase":[-0.967,-0.253,0.084,-1.834,-1.282,0.341,0.524,-0.524,0.084,-0.253,1.834,-0.728,0.967,0.728,1.282],"AG_Q10":[1.54,1.51,1.51,1.83,2.08,1.77,2.48,1.48,1.72,1.67,2.01,1.49,1.73,1.31,1.93],"BG_Q10":[-0.341,-1.501,0.341,-1.501,1.834,-0.168,-0.623,-0.967,0.168,-0.623,1.282,0.728,0.967,0,0.524],"BP_Q10":[-0.728,-1.834,1.282,0.084,1.834,-1.111,-0.341,-1.111,0.341,0.967,0.524,0.728,-0.341,-0.341,0.084],"CE_Q10":[1.81,1.89,2.3,2.36,2,2.03,1.99,1.88,1.76,1.81,1.87,1.9,1.95,1.96,2.11],"P_Q10":[1.27,1.22,1.37,1.24,1.48,1.37,1.27,1.28,1.28,1.35,1.39,1.51,1.48,1.33,1.38],"N_Q10":[1.47,1.54,1.85,1.6,1.69,1.46,1.54,1.51,1.36,1.48,1.56,1.75,1.68,1.54,1.46],"S_Q10":[1.33,1.23,1.39,1.47,1.48,1.3,1.27,1.3,1.3,1.32,1.65,1.39,1.6,1.51,1.5],"XY_Q10":[1.65,1.59,1.76,1.63,1.83,1.72,1.72,1.82,1.63,1.84,1.86,1.89,1.88,1.91,1.76],"CO2":[-0.168,0,-1.282,-0.842,-1.834,0.728,-0.524,-0.341,0.168,0.524,-0.842,1.834,1.282,0.341,0.967],"LP_ase":[32.22,38.61,29.51,27.78,21.96,52.8,32.1,24.11,42.4,30.37,40.69,13.94,32.65,57.13,53.79],"LP_Q10":[1.8,1.81,2.14,1.85,2.07,1.76,2,1.79,1.96,1.9,1.71,1.77,1.67,1.4,1.79],"PX_ase":[-0.168,-0.728,-1.834,-0.967,-1.282,0.341,0,-0.341,-0.524,0.168,0.524,0.728,0.967,1.282,1.834],"PX_Q10":[-0.988,1.103,-0.285,0.964,2.379,-0.411,0.554,0.205,-0.909,0.473,-1.611,-0.909,-0.347,-0.109,-0.109],"CUEcn":[0.22,0.22,0.25,0.27,0.24,0.32,0.26,0.27,0.27,0.26,0.23,0.29,0.19,0.26,0.24],"CUEcp":[-1.119,0.514,-0.036,-1.119,0.751,0.514,-0.357,-0.357,-1.576,0.514,-0.357,2.413,0.968,-0.716,-0.036],"NUE":[0.87,0.87,0.85,0.83,0.85,0.77,0.84,0.83,0.83,0.84,0.87,0.81,0.9,0.84,0.85],"PUE":[1.282,-0.623,0.253,1.282,-0.623,-0.623,0.253,0.253,1.282,-0.623,0.253,-1.834,-1.282,0.728,-0.168],"Tmin":[-2.46,0.14,-2.63,-0.13,0,0.07,-0.29,0.81,0.65,-0.24,2.19,0.63,0.94,1.48,0.96],"SI":[1.29,1.44,1.25,1.42,1.54,1.51,1.49,1.77,1.61,1.51,2.3,1.72,2.08,1.81,1.82],"enzCN":[0.523,0.502,0.555,0.462,0.506,0.461,0.556,0.488,0.494,0.511,0.646,0.53,0.693,0.593,0.651],"enzCP":[0.661,0.655,0.617,0.556,0.604,0.591,0.641,0.56,0.576,0.606,0.717,0.492,0.641,0.663,0.722],"enzNP":[1.263,1.304,1.112,1.202,1.194,1.281,1.152,1.147,1.166,1.186,1.11,0.928,0.925,1.117,1.108]},"columns":[{"accessor":"Sample_ID","name":"Sample ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P10_D00_010_C0E","P02_D00_010_C0A","P04_D00_010_C0B","P06_D00_010_C0C","P08_D00_010_C0D","P01_D00_010_W3A","P03_D00_010_W3B","P05_D00_010_W3C","P07_D00_010_W3D","P09_D00_010_W3E","P01_D00_010_W8A","P03_D00_010_W8B","P05_D00_010_W8C","P07_D00_010_W8D","P09_D00_010_W8E"],"header":"Sample ID","align":"left","headerStyle":{"borderRight":"1px solid #eee","fontSize":"0.9em"},"footerStyle":{"fontWeight":"bold"},"minWidth":150,"sticky":"left","style":{"borderRight":"1px solid #eee"}},{"accessor":"ATAP","name":"ATAP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["26","26","26","26","26","29","29","29","29","29","34","34","34","34","34"],"header":"ATAP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AST","name":"AST","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-1.282","-0.967","-0.524","-0.728","-1.834","0.341","0.168","-0.341","-0.168","0.0","0.728","1.834","1.282","0.524","0.967"],"header":"AST","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"H2O","name":"H2O","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.0","0.341","0.524","0.168","1.834","0.967","1.282","-0.524","0.728","-0.168","-0.728","-0.967","-1.282","-1.834","-0.341"],"header":"H2O","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N","name":"N","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.26","0.337","0.303","0.333","0.243","0.427","0.32","0.333","0.437","0.283","0.427","0.32","0.333","0.437","0.283"],"header":"N","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P","name":"P","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.32","0.43","0.33","0.3","0.27","0.35","0.37","0.33","0.35","0.36","0.35","0.37","0.33","0.35","0.36"],"header":"P","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Al","name":"Al","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.691","0.483","-0.725","-0.725","-0.725","-0.725","0.483","-0.725","-0.725","1.691","-0.725","0.483","-0.725","-0.725","1.691"],"header":"Al","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Ca","name":"Ca","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.967","0.728","0.0","0.524","-1.834","0.253","-0.623","-1.111","-0.253","1.501","0.253","-0.623","-1.111","-0.253","1.501"],"header":"Ca","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Fe","name":"Fe","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.158","-0.158","0.633","-0.949","-0.949","-0.158","-0.158","-0.949","-0.158","2.213","-0.158","-0.158","-0.949","-0.158","2.213"],"header":"Fe","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"K","name":"K","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.38","0.69","1.18","0.57","1.86","1.72","0.85","0.67","1.6","1.09","1.72","0.85","0.67","1.6","1.09"],"header":"K","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Mg","name":"Mg","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["21.43","8.16","14.59","21.32","14.93","9.98","16.51","14.83","18.87","20.64","9.98","16.51","14.83","18.87","20.64"],"header":"Mg","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Mn","name":"Mn","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.07","0.04","0.12","0.06","0.02","0.04","0.06","0.05","0.07","0.08","0.04","0.06","0.05","0.07","0.08"],"header":"Mn","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Na","name":"Na","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.13","0.11","0.14","0.14","0.08","0.15","0.12","0.0","0.1","0.19","0.15","0.12","0.0","0.1","0.19"],"header":"Na","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"TEB","name":"TEB","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.967","0.168","0.0","0.728","-0.967","-0.623","-0.253","-1.501","0.431","1.501","-0.623","-0.253","-1.501","0.431","1.501"],"header":"TEB","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"ECEC","name":"ECEC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.967","0.168","0.0","0.728","-0.967","-0.623","-0.253","-1.501","0.431","1.501","-0.623","-0.253","-1.501","0.431","1.501"],"header":"ECEC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"pH","name":"pH","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["6.28","6.18","5.73","5.93","6.01","6.01","5.86","5.87","6.21","6.1","6.01","5.86","5.87","6.21","6.1"],"header":"pH","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minPO4","name":"minPO4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.08","1.42","1.5","0.75","3.67","1.33","2.83","1.17","1.0","2.58","0.12","0.2","0.11","0.02","0.0"],"header":"minPO4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minNH4","name":"minNH4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.75","3.92","3.17","1.83","4.33","3.67","3.33","2.17","2.42","3.5","1.65","1.28","1.18","2.6","0.92"],"header":"minNH4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minNO3","name":"minNO3","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.8","0.226","-0.072","-0.091","1.903","1.081","0.958","-1.041","-0.015","-0.987","-1.031","0.126","0.776","-0.876","-1.756"],"header":"minNO3","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minTIN","name":"minTIN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.728","0.341","-0.084","-0.341","1.834","1.282","0.967","-0.967","-0.084","-0.524","-1.282","0.168","0.524","-0.728","-1.834"],"header":"minTIN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NH4","name":"NH4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["3.44","4.81","5.57","2.92","2.04","8.03","3.11","2.32","4.28","2.03","4.08","2.5","3.91","8.19","6.5"],"header":"NH4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NO3","name":"NO3","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.53","3.13","3.22","2.27","3.71","4.67","2.57","3.31","5.07","2.9","2.65","1.06","2.3","6.39","2.76"],"header":"NO3","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PO4","name":"PO4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["9.45","7.58","7.95","7.04","5.97","9.52","8.66","7.3","9.15","8.28","8.55","2.8","4.25","5.62","6.08"],"header":"PO4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DOC","name":"DOC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.524","1.282","0.168","0.0","-0.341","1.834","0.341","0.728","0.967","-0.728","-0.967","-1.282","-0.168","-0.524","-1.834"],"header":"DOC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DON","name":"DON","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.91","8.22","6.32","5.42","5.22","11.66","6.48","7.03","8.47","5.56","4.2","2.5","4.3","3.7","1.6"],"header":"DON","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DOCN","name":"DOCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.282","-1.834","-0.341","-0.168","0.168","0.0","-0.728","0.341","-0.967","0.728","-1.282","0.967","-0.524","0.524","1.834"],"header":"DOCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micC","name":"micC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["334.93","444.72","440.6","390.66","277.37","690.11","364.62","284.5","396.42","392.56","469.0","117.0","440.0","676.0","416.0"],"header":"micC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micN","name":"micN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["72.64","110.13","86.19","72.61","56.55","135.48","66.4","48.79","73.73","62.37","84.0","20.0","97.0","147.0","91.0"],"header":"micN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micP","name":"micP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["64.23","65.03","81.45","85.7","33.4","87.98","70.68","52.5","93.13","66.65","55.0","11.0","56.0","94.0","63.0"],"header":"micP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micCN","name":"micCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-1.282","-1.834","0.341","0.524","-0.084","-0.341","0.168","0.728","-0.084","1.282","0.967","1.834","-0.967","-0.524","-0.728"],"header":"micCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micCP","name":"micCP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["5.54","8.13","5.39","4.5","11.55","8.61","6.7","8.33","4.66","7.34","8.48","10.54","7.91","7.18","6.6"],"header":"micCP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micNP","name":"micNP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.17","2.37","1.09","0.83","2.45","1.74","1.31","1.39","0.98","1.19","1.52","1.8","1.74","1.56","1.44"],"header":"micNP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AG_ase","name":"AG_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.28","0.24","0.22","0.21","0.15","0.26","0.33","0.34","0.32","0.2","0.15","0.02","0.15","0.39","0.37"],"header":"AG ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BG_ase","name":"BG_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.524","0.0","0.341","-0.967","-0.728","-0.341","0.168","-1.834","-0.168","-0.524","0.728","-1.282","1.282","0.967","1.834"],"header":"BG ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BP_ase","name":"BP_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.987","-0.584","-0.209","-0.772","-1.368","0.111","-0.187","-0.762","0.08","-0.838","1.028","-0.304","1.701","1.649","1.441"],"header":"BP ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CE_ase","name":"CE_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.596","0.026","0.026","-0.956","-1.214","-0.2","0.407","-0.921","-0.022","-0.596","1.712","-1.332","0.865","0.917","1.884"],"header":"CE ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P_ase","name":"P_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.967","-0.728","0.168","-1.282","-1.834","0.341","0.0","-0.524","0.524","-0.341","0.728","-0.168","1.834","0.967","1.282"],"header":"P ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N_ase","name":"N_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.341","-0.168","0.168","-1.834","-0.524","0.967","0.0","-1.282","0.341","-0.967","0.524","-0.728","0.728","1.282","1.834"],"header":"N ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"S_ase","name":"S_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.54","3.8","4.92","5.45","3.56","6.08","5.72","3.2","5.86","5.26","6.7","1.28","5.57","10.68","11.78"],"header":"S ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"XY_ase","name":"XY_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.967","-0.253","0.084","-1.834","-1.282","0.341","0.524","-0.524","0.084","-0.253","1.834","-0.728","0.967","0.728","1.282"],"header":"XY ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AG_Q10","name":"AG_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.54","1.51","1.51","1.83","2.08","1.77","2.48","1.48","1.72","1.67","2.01","1.49","1.73","1.31","1.93"],"header":"AG Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BG_Q10","name":"BG_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.341","-1.501","0.341","-1.501","1.834","-0.168","-0.623","-0.967","0.168","-0.623","1.282","0.728","0.967","0.0","0.524"],"header":"BG Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BP_Q10","name":"BP_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.728","-1.834","1.282","0.084","1.834","-1.111","-0.341","-1.111","0.341","0.967","0.524","0.728","-0.341","-0.341","0.084"],"header":"BP Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CE_Q10","name":"CE_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.81","1.89","2.3","2.36","2.0","2.03","1.99","1.88","1.76","1.81","1.87","1.9","1.95","1.96","2.11"],"header":"CE Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P_Q10","name":"P_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.27","1.22","1.37","1.24","1.48","1.37","1.27","1.28","1.28","1.35","1.39","1.51","1.48","1.33","1.38"],"header":"P Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N_Q10","name":"N_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.47","1.54","1.85","1.6","1.69","1.46","1.54","1.51","1.36","1.48","1.56","1.75","1.68","1.54","1.46"],"header":"N Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"S_Q10","name":"S_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.33","1.23","1.39","1.47","1.48","1.3","1.27","1.3","1.3","1.32","1.65","1.39","1.6","1.51","1.5"],"header":"S Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"XY_Q10","name":"XY_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.65","1.59","1.76","1.63","1.83","1.72","1.72","1.82","1.63","1.84","1.86","1.89","1.88","1.91","1.76"],"header":"XY Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CO2","name":"CO2","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.168","0.0","-1.282","-0.842","-1.834","0.728","-0.524","-0.341","0.168","0.524","-0.842","1.834","1.282","0.341","0.967"],"header":"CO2","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"LP_ase","name":"LP_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["32.22","38.61","29.51","27.78","21.96","52.8","32.1","24.11","42.4","30.37","40.69","13.94","32.65","57.13","53.79"],"header":"LP ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"LP_Q10","name":"LP_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.8","1.81","2.14","1.85","2.07","1.76","2.0","1.79","1.96","1.9","1.71","1.77","1.67","1.4","1.79"],"header":"LP Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PX_ase","name":"PX_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.168","-0.728","-1.834","-0.967","-1.282","0.341","0.0","-0.341","-0.524","0.168","0.524","0.728","0.967","1.282","1.834"],"header":"PX ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PX_Q10","name":"PX_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.988","1.103","-0.285","0.964","2.379","-0.411","0.554","0.205","-0.909","0.473","-1.611","-0.909","-0.347","-0.109","-0.109"],"header":"PX Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CUEcn","name":"CUEcn","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.22","0.22","0.25","0.27","0.24","0.32","0.26","0.27","0.27","0.26","0.23","0.29","0.19","0.26","0.24"],"header":"CUEcn","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CUEcp","name":"CUEcp","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-1.119","0.514","-0.036","-1.119","0.751","0.514","-0.357","-0.357","-1.576","0.514","-0.357","2.413","0.968","-0.716","-0.036"],"header":"CUEcp","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NUE","name":"NUE","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.87","0.87","0.85","0.83","0.85","0.77","0.84","0.83","0.83","0.84","0.87","0.81","0.9","0.84","0.85"],"header":"NUE","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PUE","name":"PUE","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.282","-0.623","0.253","1.282","-0.623","-0.623","0.253","0.253","1.282","-0.623","0.253","-1.834","-1.282","0.728","-0.168"],"header":"PUE","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Tmin","name":"Tmin","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-2.46","0.14","-2.63","-0.13","0.0","0.07","-0.29","0.81","0.65","-0.24","2.19","0.63","0.94","1.48","0.96"],"header":"Tmin","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"SI","name":"SI","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.29","1.44","1.25","1.42","1.54","1.51","1.49","1.77","1.61","1.51","2.3","1.72","2.08","1.81","1.82"],"header":"SI","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzCN","name":"enzCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.523","0.502","0.555","0.462","0.506","0.461","0.556","0.488","0.494","0.511","0.646","0.53","0.693","0.593","0.651"],"header":"enzCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzCP","name":"enzCP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.661","0.655","0.617","0.556","0.604","0.591","0.641","0.56","0.576","0.606","0.717","0.492","0.641","0.663","0.722"],"header":"enzCP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzNP","name":"enzNP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.263","1.304","1.112","1.202","1.194","1.281","1.152","1.147","1.166","1.186","1.11","0.928","0.925","1.117","1.108"],"header":"enzNP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,15],"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"bb6f883cc66c59a8e1422935cd2a09dd"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="autocorrelation-tests">Autocorrelation Tests</h2>
<p>Next, we test the metadata for autocorrelations. Do we do this on the
original data or the transformed data? No idea, so let’s do both.</p>
<h3 id="split-metadata">Split Metadata</h3>
<p>We need to split the data into different groups.</p>
<ol type="A">
<li>Environmental and edaphic properties</li>
<li>Microbial functional responses</li>
<li>Temperature adaptation properties</li>
</ol>
<p>We first create lists of metadata parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>div <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PLOT&quot;</span>, <span class="st">&quot;TREAT&quot;</span>, <span class="st">&quot;TREAT_T&quot;</span>, <span class="st">&quot;PAIR&quot;</span>, <span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Shannon_exp&quot;</span>, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;InvSimpson&quot;</span>, <span class="st">&quot;ATAP&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>edaphic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AST&quot;</span>, <span class="st">&quot;H2O&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;Al&quot;</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Ca&quot;</span>, <span class="st">&quot;Fe&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;Mg&quot;</span>, <span class="st">&quot;Mn&quot;</span>, <span class="st">&quot;Na&quot;</span>, <span class="st">&quot;TEB&quot;</span>, <span class="st">&quot;ECEC&quot;</span>, <span class="st">&quot;pH&quot;</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;NH4&quot;</span>, <span class="st">&quot;NO3&quot;</span>, <span class="st">&quot;PO4&quot;</span>, <span class="st">&quot;DOC&quot;</span>, <span class="st">&quot;DON&quot;</span>, <span class="st">&quot;DOCN&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>soil_funct <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;micC&quot;</span>, <span class="st">&quot;micN&quot;</span>, <span class="st">&quot;micP&quot;</span>, <span class="st">&quot;micCN&quot;</span>, <span class="st">&quot;micCP&quot;</span>, <span class="st">&quot;micNP&quot;</span>, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;AG_ase&quot;</span>, <span class="st">&quot;BG_ase&quot;</span>, <span class="st">&quot;BP_ase&quot;</span>, <span class="st">&quot;CE_ase&quot;</span>, <span class="st">&quot;P_ase&quot;</span>, <span class="st">&quot;N_ase&quot;</span>, </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;S_ase&quot;</span>, <span class="st">&quot;XY_ase&quot;</span>,  <span class="st">&quot;LP_ase&quot;</span>, <span class="st">&quot;PX_ase&quot;</span>, <span class="st">&quot;CO2&quot;</span>, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;enzCN&quot;</span>, <span class="st">&quot;enzCP&quot;</span>, <span class="st">&quot;enzNP&quot;</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>temp_adapt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AG_Q10&quot;</span>, <span class="st">&quot;BG_Q10&quot;</span>, <span class="st">&quot;BP_Q10&quot;</span>, <span class="st">&quot;CE_Q10&quot;</span>, <span class="st">&quot;P_Q10&quot;</span>, <span class="st">&quot;N_Q10&quot;</span>, </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;S_Q10&quot;</span>, <span class="st">&quot;XY_Q10&quot;</span>, <span class="st">&quot;LP_Q10&quot;</span>, <span class="st">&quot;PX_Q10&quot;</span>, <span class="st">&quot;CUEcn&quot;</span>, <span class="st">&quot;CUEcp&quot;</span>, </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;NUE&quot;</span>,<span class="st">&quot;PUE&quot;</span>, <span class="st">&quot;Tmin&quot;</span>, <span class="st">&quot;SI&quot;</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>md_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;edaphic&quot;</span>, <span class="st">&quot;soil_funct&quot;</span>, <span class="st">&quot;temp_adapt&quot;</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># NoT uSed: minPO4, minNH4, minNO3, minTIN</span></span></code></pre></div>
</details>
</div>
<p>And then use the lists to split the data sets by metadata group.
Here, we do this for the original metadata and the metadata after
normalization.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>select_md <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu18_select_mc&quot;</span>, <span class="st">&quot;ssu18_select_mc_norm&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> select_md) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>   <span class="co">#tmp_get &lt;- get(purrr::map_chr(i, ~ paste0(i, &quot;_mc&quot;)))</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>   tmp_md_all <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>map_loaded</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>   tmp_div <span class="ot">&lt;-</span> tmp_md_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(div))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>   tmp_div <span class="ot">&lt;-</span> tmp_div <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">## edaphic      </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>   tmp_sub_edaphic <span class="ot">&lt;-</span> tmp_md_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(edaphic))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>   tmp_sub_edaphic <span class="ot">&lt;-</span> tmp_sub_edaphic <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>   tmp_edaphic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_div, tmp_sub_edaphic, <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>   tmp_edaphic <span class="ot">&lt;-</span> tmp_edaphic <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="do">## soil_funct</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>   tmp_sub_soil_funct <span class="ot">&lt;-</span> tmp_md_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(soil_funct))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>   tmp_sub_soil_funct <span class="ot">&lt;-</span> tmp_sub_soil_funct <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>   tmp_soil_funct <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_div, tmp_sub_soil_funct, <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>   tmp_soil_funct <span class="ot">&lt;-</span> tmp_soil_funct <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;SampleID&quot;</span>)      </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="do">## temp_adapt</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>   tmp_sub_temp_adapt <span class="ot">&lt;-</span> tmp_md_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(temp_adapt))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>   tmp_sub_temp_adapt <span class="ot">&lt;-</span> tmp_sub_temp_adapt <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>   tmp_temp_adapt <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_div, tmp_sub_temp_adapt, <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>   tmp_temp_adapt <span class="ot">&lt;-</span> tmp_temp_adapt <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;SampleID&quot;</span>)      </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="do">## combine</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>   tmp_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">data_loaded =</span> ssu18_select_mc<span class="sc">$</span>data_loaded, </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">map_loaded =</span> ssu18_select_mc<span class="sc">$</span>map_loaded, </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">taxonomy_loaded =</span> ssu18_select_mc<span class="sc">$</span>taxonomy_loaded,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">edaphic =</span> tmp_edaphic, </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">soil_funct =</span> tmp_soil_funct, </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">temp_adapt =</span> tmp_temp_adapt)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_split&quot;</span>))</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(tmp_name)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_list)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<h3 id="generate-autocorrelation-plots">Generate Autocorrelation
Plots</h3>
<p>A little housekeeping to get rid of parameters we don’t need (e.g.,
plot number, pair, etc.).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>edaphic_cor <span class="ot">&lt;-</span> ssu18_select_mc_split<span class="sc">$</span>edaphic</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>edaphic_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>edaphic_norm_cor <span class="ot">&lt;-</span> ssu18_select_mc_norm_split<span class="sc">$</span>edaphic</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>edaphic_norm_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>soil_funct_cor <span class="ot">&lt;-</span> ssu18_select_mc_split<span class="sc">$</span>soil_funct</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>soil_funct_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>soil_funct_norm_cor <span class="ot">&lt;-</span> ssu18_select_mc_norm_split<span class="sc">$</span>soil_funct</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>soil_funct_norm_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>temp_adapt_cor <span class="ot">&lt;-</span> ssu18_select_mc_split<span class="sc">$</span>temp_adapt</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>temp_adapt_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>temp_adapt_norm_cor <span class="ot">&lt;-</span> ssu18_select_mc_norm_split<span class="sc">$</span>temp_adapt</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>temp_adapt_norm_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</details>
</div>
<p>And finally the code to create the plots.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_cor$&quot;</span>)) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  tmp_cormat <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(tmp_get), <span class="dv">2</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  tmp_melted_cormat <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(tmp_cormat)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  tmp_get_lower_tri <span class="ot">&lt;-</span> <span class="cf">function</span>(tmp_cormat){</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    tmp_cormat[<span class="fu">upper.tri</span>(tmp_cormat)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tmp_cormat)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get upper triangle of the correlation matrix</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  tmp_get_upper_tri <span class="ot">&lt;-</span> <span class="cf">function</span>(tmp_cormat){</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    tmp_cormat[<span class="fu">lower.tri</span>(tmp_cormat)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tmp_cormat)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  tmp_upper_tri <span class="ot">&lt;-</span> <span class="fu">tmp_get_upper_tri</span>(tmp_cormat)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  tmp_melted_cormat <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(tmp_upper_tri, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> tmp_melted_cormat, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span> </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>()</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  tmp_ggheatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> tmp_melted_cormat, <span class="fu">aes</span>(Var2, Var1, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name=</span><span class="st">&quot;Pearson</span><span class="sc">\n</span><span class="st">Correlation&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">7</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(Var2, Var1, <span class="at">label =</span> value), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">1.75</span>) <span class="sc">+</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.7</span>),</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">barwidth =</span> <span class="dv">7</span>, <span class="at">barheight =</span> <span class="dv">1</span>,</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ggheatmap&quot;</span>))</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_ggheatmap)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tmp_name)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_ggheatmap&quot;</span>)</span></code></pre></div>
</details>
</div>
<h2 id="autocorrelation-plots">Autocorrelation Plots</h2>
<p><br/></p>
<div class="l-body-outset">
<div class="panelset">
<section id="edaphic-properties" class="panel">
<h4>Edaphic properties</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-33-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 1 | Results of autocorrelation
analysis for non-normalized Environmental and edaphic
parameters.</strong></small></p>
</section>
<section id="edaphic-properties-normalized" class="panel">
<h4>Edaphic properties (normalized)</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 2 | Results of autocorrelation
analysis for normalized Environmental and edaphic
parameters.</strong></small></p>
</section>
<section id="functional-responses" class="panel">
<h4>Functional responses</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-35-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 3 | Results of autocorrelation
analysis for non-normalized Functional response
parameters.</strong></small></p>
</section>
<section id="functional-responses-normalized" class="panel">
<h4>Functional responses (normalized)</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-36-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 4 | Results of autocorrelation
analysis for normalized Functional response
parameters.</strong></small></p>
</section>
<section id="temperature-adaptation" class="panel">
<h4>Temperature adaptation</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-37-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 5 | Results of autocorrelation
analysis for non-normalized Temperature adaptation
parameters.</strong></small></p>
</section>
<section id="temperature-adaptation-normalized" class="panel">
<h4>Temperature adaptation (normalized)</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-38-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 6 | Results of autocorrelation
analysis for normalized Temperature adaptation
parameters.</strong></small></p>
</section>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Now we can remove parameters based on the autocorrelation
analysis:</p>
<ol type="A">
<li>Environmental and edaphic properties: TEB, DON, Na, Al, Ca.</li>
<li>Microbial functional responses: micN, micNP, enzCN, enzCP,
BP<sub>ase</sub>, CE<sub>ase</sub>, LP<sub>ase</sub>, N<sub>ase</sub>,
P<sub>ase</sub>.</li>
<li>Temperature adaptation properties: NUE, PUE, SI.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>edaphic_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TEB&quot;</span>, <span class="st">&quot;DON&quot;</span>, <span class="st">&quot;Na&quot;</span>, <span class="st">&quot;Al&quot;</span>, <span class="st">&quot;Ca&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>soil_funct_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;micN&quot;</span>, <span class="st">&quot;micNP&quot;</span>, <span class="st">&quot;enzCN&quot;</span>, <span class="st">&quot;enzCP&quot;</span>, <span class="st">&quot;BP_ase&quot;</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;CE_ase&quot;</span>, <span class="st">&quot;LP_ase&quot;</span>, <span class="st">&quot;N_ase&quot;</span>, <span class="st">&quot;P_ase&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>temp_adapt_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;NUE&quot;</span>, <span class="st">&quot;PUE&quot;</span>, <span class="st">&quot;SI&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> ssu18_select_mc_split</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>edaphic <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>edaphic[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>edaphic) <span class="sc">%in%</span>  edaphic_remove]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>soil_funct <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>soil_funct[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>soil_funct) <span class="sc">%in%</span>  soil_funct_remove]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>temp_adapt <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>temp_adapt[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>temp_adapt) <span class="sc">%in%</span>  temp_adapt_remove]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ssu18_select_mc_split_no_ac <span class="ot">&lt;-</span> tmp_df</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> ssu18_select_mc_norm_split</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>edaphic <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>edaphic[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>edaphic) <span class="sc">%in%</span>  edaphic_remove]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>soil_funct <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>soil_funct[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>soil_funct) <span class="sc">%in%</span>  soil_funct_remove]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>temp_adapt <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>temp_adapt[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>temp_adapt) <span class="sc">%in%</span>  temp_adapt_remove]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>ssu18_select_mc_norm_split_no_ac <span class="ot">&lt;-</span> tmp_df</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span></code></pre></div>
</details>
</div>
<h2 id="dissimilarity-correlation-tests">Dissimilarity Correlation
Tests</h2>
<p>Let’s see if any on the metadata groups are significantly correlated
with the community data. Basically, we create distance matrices for the
community data and each metadata group and then run Mantel tests for all
comparisons. For the community data we calculate Bray-Curtis distances
for the community data and Euclidean distances for the metadata. We use
the function <code>mantel.test</code> from the <code>ape</code> package
and <code>mantel</code> from the <code>vegan</code> package for the
analyses.</p>
<p>In summary, we test both <code>mantel.test</code> and
<code>mantel</code> on Bray-Curtis distance community distances against
Euclidean distances for each metadata group (<code>edaphic</code>,
<code>soil_funct</code>, <code>temp_adapt</code>) <strong>a</strong>)
before normalizing and before removing autocorrelated parameters,
<strong>b</strong>) before normalizing and after removing autocorrelated
parameters, <strong>c</strong>) after normalizing and before removing
autocorrelated parameters, and <strong>d</strong>) after normalizing and
after removing autocorrelated parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>man_df <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu18_select_mc_split&quot;</span>, <span class="st">&quot;ssu18_select_mc_split_no_ac&quot;</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;ssu18_select_mc_norm_split&quot;</span>, <span class="st">&quot;ssu18_select_mc_norm_split_no_ac&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> man_df) {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  tmp_dm_otu <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(<span class="fu">t</span>(tmp_get<span class="sc">$</span>data_loaded), </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># EDAPHIC</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  tmp_dm_md_edaphic <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_get<span class="sc">$</span>edaphic[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_get<span class="sc">$</span>edaphic)], </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">method =</span><span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  tmp_man1_edaphic <span class="ot">&lt;-</span> <span class="fu">mantel.test</span>(tmp_dm_otu, tmp_dm_md_edaphic, <span class="at">nperm =</span> <span class="dv">999</span>, </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  tmp_man2_edaphic <span class="ot">&lt;-</span> <span class="fu">mantel</span>(tmp_dm_otu, tmp_dm_md_edaphic, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co"># SOIL FUNCT</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  tmp_dm_md_soil_funct <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_get<span class="sc">$</span>soil_funct[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_get<span class="sc">$</span>soil_funct)], </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  tmp_man1_soil_funct <span class="ot">&lt;-</span> <span class="fu">mantel.test</span>(tmp_dm_otu, tmp_dm_md_soil_funct, <span class="at">nperm =</span> <span class="dv">999</span>, </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  tmp_man2_soil_funct <span class="ot">&lt;-</span> <span class="fu">mantel</span>(tmp_dm_otu, tmp_dm_md_soil_funct, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># TEMP ADAPT</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  tmp_dm_md_temp_adapt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_get<span class="sc">$</span>temp_adapt[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_get<span class="sc">$</span>temp_adapt)], </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  tmp_man1_temp_adapt <span class="ot">&lt;-</span> <span class="fu">mantel.test</span>(tmp_dm_otu, tmp_dm_md_temp_adapt, <span class="at">nperm =</span> <span class="dv">999</span>, </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>                                <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  tmp_man2_temp_adapt <span class="ot">&lt;-</span> <span class="fu">mantel</span>(tmp_dm_otu, tmp_dm_md_temp_adapt, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_mantel_tests&quot;</span>))</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  tmp_df <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">edaphic_ape_man =</span> tmp_man1_edaphic, </span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edaphic_vegan_man =</span> tmp_man2_edaphic,</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">soil_funct_ape_man =</span> tmp_man1_soil_funct, </span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">soil_funct_vegan_man =</span> tmp_man2_soil_funct,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">temp_adapt_ape_man =</span> tmp_man1_temp_adapt, </span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>                 <span class="at">temp_adapt_vegan_man =</span> tmp_man2_temp_adapt)</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tmp_name)</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="dissimilarity-correlation-results">Dissimilarity Correlation
Results</h3>
<p><br/></p>
<p><small><strong>(16S rRNA) Table 4 | Summary of Dissimilarity
Correlation Tests using <code>mantel.test</code> from the ape package
and <code>mantel</code> from the vegan. P-values in red indicate
significance (p-value &lt; 0.05)</strong></small></p>
<div class="layout-chunk" data-layout="l-page">
<div id="htmlwidget-f4461daff4b1e7125a7f" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f4461daff4b1e7125a7f">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"normalized?":["no","no","yes","yes"],"AC removed?":["no","yes","no","yes"],"edaphic_ape":[0.375,0.399,0.003,0.007],"edaphic_vegan":[0.194,0.17,0.002,0.002],"soil_funct_ape":[0.059,0.031,0.537,0.541],"soil_funct_vegan":[0.019,0.02,0.25,0.288],"temp_adapt_ape":[0.001,0.001,0.001,0.001],"temp_adapt_vegan":[0.001,0.001,0.001,0.001]},"columns":[{"accessor":"normalized?","name":"normalized?","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["no","no","yes","yes"],"header":"normalized?","minWidth":70,"align":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"AC removed?","name":"AC removed?","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["no","yes","no","yes"],"header":"AC removed?","minWidth":70,"align":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"edaphic_ape","name":"ape","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.375","0.399","0.003","0.007"],"header":"ape","minWidth":50,"align":"center","style":[{"color":"#2271B2"},{"color":"#2271B2"},{"color":"#B22271"},{"color":"#B22271"}]},{"accessor":"edaphic_vegan","name":"vegan","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.194","0.170","0.002","0.002"],"header":"vegan","minWidth":50,"align":"center","style":[{"color":"#2271B2"},{"color":"#2271B2"},{"color":"#B22271"},{"color":"#B22271"}]},{"accessor":"soil_funct_ape","name":"ape","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.059","0.031","0.537","0.541"],"header":"ape","minWidth":50,"align":"center","style":[{"color":"#2271B2"},{"color":"#B22271"},{"color":"#2271B2"},{"color":"#2271B2"}]},{"accessor":"soil_funct_vegan","name":"vegan","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.019","0.020","0.250","0.288"],"header":"vegan","minWidth":50,"align":"center","style":[{"color":"#B22271"},{"color":"#B22271"},{"color":"#2271B2"},{"color":"#2271B2"}]},{"accessor":"temp_adapt_ape","name":"ape","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","0.001","0.001","0.001"],"header":"ape","minWidth":50,"align":"center","style":[{"color":"#B22271"},{"color":"#B22271"},{"color":"#B22271"},{"color":"#B22271"}]},{"accessor":"temp_adapt_vegan","name":"vegan","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","0.001","0.001","0.001"],"header":"vegan","minWidth":50,"align":"center","style":[{"color":"#B22271"},{"color":"#B22271"},{"color":"#B22271"},{"color":"#B22271"}]}],"columnGroups":[{"name":"Environmental & edaphic","headerStyle":{"fontSize":"1.2em"},"columns":["edaphic_ape","edaphic_vegan"]},{"name":"Functional responses","headerStyle":{"fontSize":"1.2em"},"columns":["soil_funct_ape","soil_funct_vegan"]},{"name":"Temperature adaptation","headerStyle":{"fontSize":"1.2em"},"columns":["temp_adapt_ape","temp_adapt_vegan"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[5,10,4],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"47bcd92150c399e91c716485760465a6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Moving on.</p>
<h2 id="best-subset-of-variables">Best Subset of Variables</h2>
<p>Now we want to know which of the metadata parameters are the most
strongly correlated with the community data. For this we use the
<code>bioenv</code> function from the <code>vegan</code> package.
<code>bioenv</code>—<em>Best Subset of Environmental Variables with
Maximum (Rank) Correlation with Community Dissimilarities</em>—finds the
best subset of environmental variables, so that the Euclidean distances
of scaled environmental variables have the maximum (rank) correlation
with community dissimilarities.</p>
<p>Next we will use the metadata set where autocorrelated parameters
were removed and the remainder of the parameters were normalized (where
applicable based on the Shapiro tests).</p>
<p>We run <code>bioenv</code> against the three groups of metadata
parameters. We then run <code>bioenv</code> again, but this time against
the individual parameters identified as significantly correlated.</p>
<h3 id="edaphic-properties-1">Edaphic Properties</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>tmp_env <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>edaphic)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>tmp_env[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>edaphic_bioenv <span class="ot">&lt;-</span> <span class="fu">bioenv</span>(<span class="fu">wisconsin</span>(tmp_comm), tmp_env, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">index =</span> <span class="st">&quot;bray&quot;</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">upto =</span> <span class="fu">ncol</span>(tmp_env), <span class="at">metric =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>bioenv_list <span class="ot">&lt;-</span> edaphic_bioenv<span class="sc">$</span>models[[edaphic_bioenv<span class="sc">$</span>whichbest]]<span class="sc">$</span>best</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>bioenv_best <span class="ot">&lt;-</span> <span class="fu">bioenvdist</span>(edaphic_bioenv, <span class="at">which =</span> <span class="st">&quot;best&quot;</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> bioenv_list) {</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>       tmp_dp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(edaphic_bioenv<span class="sc">$</span>x)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>       tmp_md <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_dp[[i]], </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>       tmp_man <span class="ot">&lt;-</span> <span class="fu">mantel</span>(bioenv_best, tmp_md, </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>       tmp_md_name <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp_dp)[[i]]</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>       tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_md_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_name, tmp_man)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>edaphic_bioenv_ind_mantel <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">AST =</span> AST_bioenv_mantel_test)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Call:
bioenv(comm = wisconsin(tmp_comm), env = tmp_env, method = &quot;spearman&quot;,      index = &quot;bray&quot;, upto = ncol(tmp_env), metric = &quot;euclidean&quot;) 

Subset of environmental variables with best correlation to community data.

Correlations:    spearman 
Dissimilarities: bray 
Metric:          euclidean 

Best model has 1 parameters (max. 15 allowed):
AST
with correlation  0.6808861 </code></pre>
</div>
<details>
<summary>
Show the results of individual edaphic metadata Mantel tests
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$AST

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r:     1 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.177 0.226 0.271 0.326 
Permutation: free
Number of permutations: 999</code></pre>
</div>
</details>
<p><code>bioenv</code> found the following edaphic properties
significantly correlated with the community data:
<strong>AST</strong></p>
<h3 id="soil-functional-response">Soil Functional Response</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>tmp_env <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>soil_funct)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>tmp_env[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>soil_funct_bioenv <span class="ot">&lt;-</span> <span class="fu">bioenv</span>(<span class="fu">wisconsin</span>(tmp_comm), tmp_env, </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">index =</span> <span class="st">&quot;bray&quot;</span>, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">upto =</span> <span class="fu">ncol</span>(tmp_env), <span class="at">metric =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>bioenv_list <span class="ot">&lt;-</span> soil_funct_bioenv<span class="sc">$</span>models[[soil_funct_bioenv<span class="sc">$</span>whichbest]]<span class="sc">$</span>best</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>bioenv_best <span class="ot">&lt;-</span> <span class="fu">bioenvdist</span>(soil_funct_bioenv, <span class="at">which =</span> <span class="st">&quot;best&quot;</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> bioenv_list) {</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>       tmp_dp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(soil_funct_bioenv<span class="sc">$</span>x)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>       tmp_md <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_dp[[i]], </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>       tmp_man <span class="ot">&lt;-</span> <span class="fu">mantel</span>(bioenv_best, tmp_md, </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>       tmp_md_name <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp_dp)[[i]]</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>       tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_md_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_name, tmp_man)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>soil_funct_bioenv_ind_mantel <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">AG_ase =</span> AG_ase_bioenv_mantel_test, </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">enzNP =</span> enzNP_bioenv_mantel_test, </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">S_ase =</span> S_ase_bioenv_mantel_test, </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">PX_ase =</span> PX_ase_bioenv_mantel_test,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">XY_ase =</span> XY_ase_bioenv_mantel_test)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Call:
bioenv(comm = wisconsin(tmp_comm), env = tmp_env, method = &quot;spearman&quot;,      index = &quot;bray&quot;, upto = ncol(tmp_env), metric = &quot;euclidean&quot;) 

Subset of environmental variables with best correlation to community data.

Correlations:    spearman 
Dissimilarities: bray 
Metric:          euclidean 

Best model has 5 parameters (max. 11 allowed):
AG_ase S_ase XY_ase PX_ase enzNP
with correlation  0.7727866 </code></pre>
</div>
<details>
<summary>
Show the results of individual functional response metadata Mantel tests
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$AG_ase

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.5588 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.186 0.235 0.281 0.330 
Permutation: free
Number of permutations: 999


$enzNP

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.4623 
      Significance: 0.006 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.219 0.280 0.336 0.413 
Permutation: free
Number of permutations: 999


$S_ase

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.6139 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.223 0.305 0.384 0.466 
Permutation: free
Number of permutations: 999


$PX_ase

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.6115 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.176 0.222 0.289 0.346 
Permutation: free
Number of permutations: 999


$XY_ase

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.456 
      Significance: 0.002 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.189 0.258 0.304 0.347 
Permutation: free
Number of permutations: 999</code></pre>
</div>
</details>
<p><code>bioenv</code> found the following soil functions significantly
correlated with the community data: <strong>AG_ase, enzNP, S_ase,
PX_ase, XY_ase</strong></p>
<h3 id="temperature-adaptation-1">Temperature Adaptation</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>tmp_env <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>temp_adapt)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>tmp_env[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioenv <span class="ot">&lt;-</span> <span class="fu">bioenv</span>(<span class="fu">wisconsin</span>(tmp_comm), tmp_env, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">index =</span> <span class="st">&quot;bray&quot;</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">upto =</span> <span class="fu">ncol</span>(tmp_env), <span class="at">metric =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>bioenv_list <span class="ot">&lt;-</span> temp_adapt_bioenv<span class="sc">$</span>models[[temp_adapt_bioenv<span class="sc">$</span>whichbest]]<span class="sc">$</span>best</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>bioenv_best <span class="ot">&lt;-</span> <span class="fu">bioenvdist</span>(temp_adapt_bioenv, <span class="at">which =</span> <span class="st">&quot;best&quot;</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> bioenv_list) {</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>       tmp_dp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(temp_adapt_bioenv<span class="sc">$</span>x)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>       tmp_md <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_dp[[i]], </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>       tmp_man <span class="ot">&lt;-</span> <span class="fu">mantel</span>(bioenv_best, tmp_md, </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>       tmp_md_name <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp_dp)[[i]]</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>       tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_md_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_name, tmp_man)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioenv_ind_mantel <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">CUEcp =</span> CUEcp_bioenv_mantel_test, </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">LP_Q10 =</span> LP_Q10_bioenv_mantel_test, </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">P_Q10 =</span> P_Q10_bioenv_mantel_test, </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">S_Q10 =</span> S_Q10_bioenv_mantel_test, </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Tmin =</span> Tmin_bioenv_mantel_test)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Call:
bioenv(comm = wisconsin(tmp_comm), env = tmp_env, method = &quot;spearman&quot;,      index = &quot;bray&quot;, upto = ncol(tmp_env), metric = &quot;euclidean&quot;) 

Subset of environmental variables with best correlation to community data.

Correlations:    spearman 
Dissimilarities: bray 
Metric:          euclidean 

Best model has 5 parameters (max. 13 allowed):
P_Q10 S_Q10 LP_Q10 CUEcp Tmin
with correlation  0.4237093 </code></pre>
</div>
<details>
<summary>
Show the results of individual temperature adaptation metadata Mantel
tests
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$CUEcp

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.325 
      Significance: 0.013 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.188 0.226 0.280 0.331 
Permutation: free
Number of permutations: 999


$LP_Q10

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.3772 
      Significance: 0.005 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.203 0.272 0.306 0.351 
Permutation: free
Number of permutations: 999


$P_Q10

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.5177 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.158 0.211 0.261 0.309 
Permutation: free
Number of permutations: 999


$S_Q10

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.4395 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.159 0.205 0.252 0.301 
Permutation: free
Number of permutations: 999


$Tmin

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.4044 
      Significance: 0.005 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.207 0.267 0.305 0.359 
Permutation: free
Number of permutations: 999</code></pre>
</div>
</details>
<p><code>bioenv</code> found the following temperature adaptations
significantly correlated with the community data: <strong>CUEcp, LP_Q10,
P_Q10, S_Q10, Tmin</strong></p>
<h2 id="distance-based-redundancy">Distance-based Redundancy</h2>
<p>Now we turn our attention to distance-based redundancy analysis
(dbRDA), an ordination method similar to Redundancy Analysis (rda) but
it allows non-Euclidean dissimilarity indices, such as Manhattan or
Bray–Curtis distance. For this, we use <code>capscale</code> from the
<code>vegan</code> package. <code>capscale</code> is a constrained
versions of metric scaling (principal coordinates analysis), which are
based on the Euclidean distance but can be used, and are more useful,
with other dissimilarity measures. The functions can also perform
unconstrained principal coordinates analysis, optionally using extended
dissimilarities.</p>
<p>For each of the three metadata subsets, we perform the following
steps:</p>
<ol type="1">
<li>Run <code>rankindex</code> to compare metadata and community
dissimilarity indices for gradient detection. This will help us select
the best dissimilarity metric to use.</li>
<li>Run <code>capscale</code> for distance-based redundancy
analysis.</li>
<li>Run <code>envfit</code> to fit environmental parameters onto the
ordination. This function basically calculates correlation scores
between the metadata parameters and the ordination axes.</li>
<li>Select metadata parameters significant for <code>bioenv</code> (see
above) and/or <code>envfit</code> analyses.</li>
<li>Run <code>envfit</code> on ASVs.</li>
<li>Plot the ordination and vector overlays.</li>
</ol>
<h3 id="edaphic-properties-2">Edaphic Properties</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tmp_md <span class="ot">&lt;-</span> ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>edaphic</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>tmp_md<span class="sc">$</span>TREAT_T <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tmp_md<span class="sc">$</span>TREAT_T)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>edaphic_rank <span class="ot">&lt;-</span> <span class="fu">rankindex</span>(tmp_md[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_md)], tmp_comm, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">indices =</span> <span class="fu">c</span>(<span class="st">&quot;euc&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;gow&quot;</span>,<span class="st">&quot;bra&quot;</span>, <span class="st">&quot;kul&quot;</span>), </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">stepacross =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      euc       man       gow       bra       kul 
0.3171263 0.4336927 0.1028302 0.4336927 0.4336927 </code></pre>
</div>
<p>Let’s run <code>capscale</code> using Bray-Curtis. Note, we have 15
metadata parameters in this group but, for some reason,
<code>capscale</code> only works with 13 parameters. This may have to do
with degrees of freedom?</p>
<ul>
<li>Starting properties: AST, H2O, N, P, Al, Ca, Fe, K, Mg, Mn, Na, TEB,
ECEC, pH, NH4, NO3, PO4, DOC, DON, DOCN</li>
<li>Autocorrelated removed: TEB, DON, Na, Al, Ca</li>
<li>Remove for capscale: Mg, Mn</li>
</ul>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>edaphic_cap <span class="ot">&lt;-</span> <span class="fu">capscale</span>(tmp_comm <span class="sc">~</span> AST <span class="sc">+</span> H2O <span class="sc">+</span> N <span class="sc">+</span> P <span class="sc">+</span> Fe <span class="sc">+</span> K <span class="sc">+</span> ECEC <span class="sc">+</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                                   pH <span class="sc">+</span> NH4 <span class="sc">+</span> NO3 <span class="sc">+</span> PO4 <span class="sc">+</span> DOC <span class="sc">+</span> DOCN, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                        tmp_md, <span class="at">dist =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmp_md)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>Call: capscale(formula = tmp_comm ~ AST + H2O + N + P + Fe + K
+ ECEC + pH + NH4 + NO3 + PO4 + DOC + DOCN, data = tmp_md,
distance = &quot;bray&quot;)

              Inertia Proportion Rank
Total         1.67890    1.00000     
Constrained   1.63037    0.97110   13
Unconstrained 0.04853    0.02890    1
Inertia is squared Bray distance 
Species scores projected from &#39;tmp_comm&#39; 

Eigenvalues for constrained axes:
  CAP1   CAP2   CAP3   CAP4   CAP5   CAP6   CAP7   CAP8   CAP9  CAP10 
0.6287 0.2955 0.1984 0.1104 0.1085 0.0661 0.0536 0.0511 0.0359 0.0277 
 CAP11  CAP12  CAP13 
0.0247 0.0218 0.0080 

Eigenvalues for unconstrained axes:
   MDS1 
0.04853 </code></pre>
</div>
<p>Now we can look at the variance against each principal component.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="metadata_files/figure-html5/unnamed-chunk-60-1.png" width="624" /></p>
</div>
<p>And then make some quick and dirty plots. This will also come in
handy later when we need to parse out data a better plot visualization.
The <code>ggplot</code> function <code>autoplot</code> stores these data
in a more accessible way than the raw results from
<code>capscale</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">plot</span>(edaphic_cap) </span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-61-1.png" width="624" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(edaphic_cap, <span class="at">arrows =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt</span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-61-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Next, we need to grab capscale scores for the samples and create a
data frame of the first two dimensions. We will also need to add some of
the sample details to the data frame. For this we use the vegan function
<code>scores</code> which gets species or site scores from the
ordination.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> tmp_samp_scores <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">SampleID =</span> Label)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md_sub <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>edaphic_plot_data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_md_sub, tmp_samp_scores, <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span></code></pre></div>
</details>
</div>
<p>Now we have a new data frame that contains sample details and
capscale values.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>          SampleID PLOT TREAT TREAT_T PAIR        CAP1           CAP2
1  P10_D00_010_C0E  P10     C       0    E -0.51023381  0.16071056348
2  P02_D00_010_C0A  P02     C       0    A -0.48448722 -0.19055366181
3  P04_D00_010_C0B  P04     C       0    B -0.58218619  0.02325887477
4  P06_D00_010_C0C  P06     C       0    C -0.53370906  0.09973976767
5  P08_D00_010_C0D  P08     C       0    D -0.68492943  0.13143857676
6  P01_D00_010_W3A  P01     W       3    A -0.13286443 -0.28661650806
7  P03_D00_010_W3B  P03     W       3    B -0.25415783  0.00002258673
8  P05_D00_010_W3C  P05     W       3    C -0.38829574 -0.08695154559
9  P07_D00_010_W3D  P07     W       3    D -0.01360582 -0.49632449304
10 P09_D00_010_W3E  P09     W       3    E -0.10639798 -0.54219706978
11 P01_D00_010_W8A  P01     W       8    A  0.78689725  0.02214444812
12 P03_D00_010_W8B  P03     W       8    B  0.89574754 -0.92786190328
13 P05_D00_010_W8C  P05     W       8    C  1.07945322 -0.28874425650
14 P07_D00_010_W8D  P07     W       8    D  0.41234456  0.75597843926
15 P09_D00_010_W8E  P09     W       8    E  0.51642495  1.62595618128</code></pre>
</div>
<p>We can then do the same with the metadata vectors. Here though we
only need the scores and parameter name.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>edaphic_md_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;biplot&quot;</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>edaphic_md_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>edaphic_md_scores <span class="ot">&lt;-</span> edaphic_md_scores <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>     parameters        CAP1         CAP2
AST         AST  0.97882379 -0.055074169
H2O         H2O -0.76548607 -0.129779379
N             N  0.38130076 -0.131035479
P             P  0.26536024 -0.132125558
Fe           Fe  0.12138586  0.353093177
K             K -0.02490580  0.151975508
ECEC       ECEC -0.15365335  0.379848234
pH           pH -0.07327989  0.272676813
NH4         NH4  0.19922925  0.516074241
NO3         NO3 -0.27681227  0.288729283
PO4         PO4 -0.60140669 -0.009980058
DOC         DOC -0.59979130 -0.399930429
DOCN       DOCN  0.11210058  0.422975484</code></pre>
</div>
<p>Let’s run some quick correlations of metadata with ordination axes to
see which parameters are significant. For this we use the vegan function
<code>envfit</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> edaphic_plot_data[, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_samp_scores_sub)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>tmp_param_list <span class="ot">&lt;-</span> edaphic_md_scores<span class="sc">$</span>parameters</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp_md,  <span class="at">select =</span>  tmp_param_list)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>envfit_edaphic_md <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, tmp_md_sub,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

         CAP1     CAP2     r2   Pr(&gt;r)    
AST   0.99825 -0.05912 0.8287 0.000999 ***
H2O  -0.98657 -0.16333 0.5189 0.009990 ** 
N     0.94537 -0.32599 0.1403 0.398601    
P     0.89518 -0.44571 0.0759 0.602398    
Fe    0.32411  0.94602 0.1194 0.432567    
K    -0.16554  0.98620 0.0204 0.890110    
ECEC -0.37874  0.92550 0.1444 0.368631    
pH   -0.26344  0.96468 0.0685 0.672328    
NH4   0.35944  0.93317 0.2621 0.152847    
NO3  -0.69392  0.72006 0.1380 0.417582    
PO4  -0.99991 -0.01327 0.3118 0.090909 .  
DOC  -0.83396 -0.55183 0.4459 0.023976 *  
DOCN  0.25463  0.96704 0.1640 0.318681    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_edaphic_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_edaphic_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_edaphic_md<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.4</span>))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(edaphic_md_signif_hits)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(edaphic_md_signif_hits)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif <span class="ot">&lt;-</span> edaphic_md_scores[edaphic_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> edaphic_md_signif_hits,]</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif<span class="sc">$</span>parameters</span></code></pre></div>
</details>
</div>
<p><code>envfit</code> found that AST, H2O, DOC were significantly
correlated.</p>
<p>Now let’s see if the same parameters are significant for the
<code>envfit</code> and <code>bioenv</code> analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Significant parameters from bioenv analysis.&quot;
[1] &quot;AST&quot;
_____________________________________
[1] &quot;Significant parameters from envfit analysis.&quot;
[1] &quot;AST&quot; &quot;H2O&quot; &quot;DOC&quot;
_____________________________________
[1] &quot;Found in bioenv but not envfit.&quot;
character(0)
_____________________________________
[1] &quot;Found in envfit but not bioenv.&quot;
[1] &quot;H2O&quot; &quot;DOC&quot;
_____________________________________
[1] &quot;Found in envfit and bioenv.&quot;
[1] &quot;AST&quot; &quot;H2O&quot; &quot;DOC&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>new_edaphic_md_signif_hits <span class="ot">&lt;-</span> edaphic_sig_diff</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#new_edaphic_md_signif_hits &lt;- append(edaphic_md_signif_hits, edaphic_sig_diff)</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_all <span class="ot">&lt;-</span> edaphic_md_scores[edaphic_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> new_edaphic_md_signif_hits,]</span></code></pre></div>
</details>
</div>
<p>Check. Next, we run <code>envfit</code> for the ASVs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>envfit_edaphic_asv <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                             tmp_comm[, <span class="fu">order</span>(<span class="fu">colSums</span>(<span class="sc">-</span>tmp_comm))][, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>edaphic_asv_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;species&quot;</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>edaphic_asv_scores <span class="ot">&lt;-</span> edaphic_asv_scores <span class="sc">%&gt;%</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>edaphic_asv_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

          CAP1     CAP2     r2   Pr(&gt;r)    
ASV1   0.99502  0.09969 0.6491 0.005994 ** 
ASV2   0.54850 -0.83615 0.8984 0.000999 ***
ASV3   0.79245  0.60994 0.9429 0.000999 ***
ASV4  -0.12958  0.99157 0.2913 0.120879    
ASV5  -0.56363 -0.82603 0.1586 0.362637    
ASV6  -0.10651  0.99431 0.7559 0.000999 ***
ASV8  -0.84329  0.53746 0.4370 0.030969 *  
ASV7  -0.52510 -0.85104 0.0681 0.655345    
ASV9   0.51828 -0.85521 0.2559 0.185814    
ASV10 -0.34456  0.93876 0.8331 0.000999 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_edaphic_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_edaphic_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_edaphic_asv<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.5</span>))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(edaphic_asv_signif_hits)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(edaphic_asv_signif_hits)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif <span class="ot">&lt;-</span> edaphic_asv_scores[edaphic_asv_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> edaphic_asv_signif_hits,]</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      parameters        CAP1        CAP2 variable_type
ASV3        ASV3  0.48974117  0.51152737           ASV
ASV6        ASV6 -0.02123424  0.24919713           ASV
ASV2        ASV2  0.23670463 -0.49287683           ASV
ASV10      ASV10 -0.02578511  0.09240257           ASV
ASV1        ASV1  1.18949655  0.17867402           ASV</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_all<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;metadata&quot;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;ASV&quot;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>edaphic_bioplot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(edaphic_md_signif_all, edaphic_asv_signif)</span></code></pre></div>
</details>
</div>
<p>The last thing to do is categorize parameters scores and ASV scores
into different variable types for plotting.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>edaphic_bioplot_data_md <span class="ot">&lt;-</span> <span class="fu">subset</span>(edaphic_bioplot_data, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                                  edaphic_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;metadata&quot;</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>edaphic_bioplot_data_asv <span class="ot">&lt;-</span> <span class="fu">subset</span>(edaphic_bioplot_data, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                                   edaphic_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;ASV&quot;</span>)</span></code></pre></div>
</details>
</div>
<details>
<summary>
Show the code for the plot
</summary>
<div class="layout-chunk" data-layout="l-body">

</div>
</details>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="soil-functional-response-1">Soil Functional Response</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>tmp_md <span class="ot">&lt;-</span> ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>soil_funct</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>tmp_md<span class="sc">$</span>TREAT_T <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tmp_md<span class="sc">$</span>TREAT_T)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>soil_funct_rank <span class="ot">&lt;-</span> <span class="fu">rankindex</span>(tmp_md[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_md)], tmp_comm, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">indices =</span> <span class="fu">c</span>(<span class="st">&quot;euc&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;gow&quot;</span>,<span class="st">&quot;bra&quot;</span>, <span class="st">&quot;kul&quot;</span>), </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">stepacross =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      euc       man       gow       bra       kul 
0.5840452 0.7341800 0.2168775 0.7341800 0.7341800 </code></pre>
</div>
<p>Let’s run <code>capscale</code> using Bray-Curtis. Note, we have 11
metadata parameters in this group but, for some reason,
<code>capscale</code> only works with 13 parameters. This may have to do
with degrees of freedom?</p>
<ul>
<li>Starting properties: micC, micN, micP, micCN, micCP, micNP, AG_ase,
BG_ase, BP_ase, CE_ase, P_ase, N_ase, S_ase, XY_ase, LP_ase, PX_ase,
CO2, enzCN, enzCP, enzNP</li>
<li>Autocorrelated removed: micN, micNP, enzCN, enzCP, BP_ase, CE_ase,
LP_ase, N_ase, P_ase</li>
<li>Remove for capscale: NONE</li>
</ul>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>soil_funct_cap <span class="ot">&lt;-</span> <span class="fu">capscale</span>(tmp_comm <span class="sc">~</span> micC <span class="sc">+</span> micP <span class="sc">+</span> micCN <span class="sc">+</span> micCP <span class="sc">+</span> AG_ase <span class="sc">+</span> BG_ase <span class="sc">+</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                      S_ase <span class="sc">+</span> XY_ase <span class="sc">+</span> PX_ase <span class="sc">+</span> CO2 <span class="sc">+</span> enzNP, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                           tmp_md, <span class="at">dist =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>Call: capscale(formula = tmp_comm ~ micC + micP + micCN +
micCP + AG_ase + BG_ase + S_ase + XY_ase + PX_ase + CO2 +
enzNP, data = tmp_md, distance = &quot;bray&quot;)

              Inertia Proportion Rank
Total         1.67890    1.00000     
Constrained   1.52672    0.90936   11
Unconstrained 0.15218    0.09064    3
Inertia is squared Bray distance 
Species scores projected from &#39;tmp_comm&#39; 

Eigenvalues for constrained axes:
  CAP1   CAP2   CAP3   CAP4   CAP5   CAP6   CAP7   CAP8   CAP9  CAP10 
0.6202 0.2950 0.1827 0.1164 0.0950 0.0555 0.0491 0.0468 0.0290 0.0246 
 CAP11 
0.0126 

Eigenvalues for unconstrained axes:
   MDS1    MDS2    MDS3 
0.06264 0.05568 0.03386 </code></pre>
</div>
<p>Now we can look at the variance against each principal component.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="metadata_files/figure-html5/unnamed-chunk-85-1.png" width="624" /></p>
</div>
<p>And then make some quick and dirty plots. This will also come in
handy later when we need to parse out data a better plot visualization.
The <code>ggplot</code> function <code>autoplot</code> stores these data
in a more accessible way than the raw results from
<code>capscale</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">plot</span>(soil_funct_cap) </span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-86-1.png" width="624" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(soil_funct_cap, <span class="at">arrows =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt</span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-86-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Next, we need to grab capscale scores for the samples and create a
data frame of the first two dimensions. We will also need to add some of
the sample details to the data frame. For this we use the vegan function
<code>scores</code> which gets species or site scores from the
ordination.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> tmp_samp_scores <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">SampleID =</span> Label)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md_sub <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>soil_funct_plot_data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_md_sub, tmp_samp_scores, </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span></code></pre></div>
</details>
</div>
<p>Now we have a new data frame that contains sample details and
capscale values.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>          SampleID PLOT TREAT TREAT_T PAIR        CAP1        CAP2
1  P10_D00_010_C0E  P10     C       0    E -0.53163678  0.19467717
2  P02_D00_010_C0A  P02     C       0    A -0.49565928 -0.17246578
3  P04_D00_010_C0B  P04     C       0    B -0.58149488  0.04815608
4  P06_D00_010_C0C  P06     C       0    C -0.53700662  0.10581563
5  P08_D00_010_C0D  P08     C       0    D -0.69408551  0.15871504
6  P01_D00_010_W3A  P01     W       3    A -0.13789308 -0.32241637
7  P03_D00_010_W3B  P03     W       3    B -0.23991258 -0.02936566
8  P05_D00_010_W3C  P05     W       3    C -0.37861217 -0.07503400
9  P07_D00_010_W3D  P07     W       3    D -0.01748558 -0.49326034
10 P09_D00_010_W3E  P09     W       3    E -0.10498973 -0.54355896
11 P01_D00_010_W8A  P01     W       8    A  0.78557974  0.01332924
12 P03_D00_010_W8B  P03     W       8    B  0.89342218 -0.94105534
13 P05_D00_010_W8C  P05     W       8    C  1.07904998 -0.30014637
14 P07_D00_010_W8D  P07     W       8    D  0.41449841  0.74331915
15 P09_D00_010_W8E  P09     W       8    E  0.54622591  1.61329051</code></pre>
</div>
<p>We can then do the same with the metadata vectors. Here though we
only need the scores and parameter name.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>soil_funct_md_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;biplot&quot;</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>soil_funct_md_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>soil_funct_md_scores <span class="ot">&lt;-</span> soil_funct_md_scores <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>       parameters        CAP1       CAP2
micC         micC  0.05033428  0.3114850
micP         micP -0.28522874  0.2555622
micCN       micCN  0.18231162 -0.4195484
micCP       micCP  0.23124711 -0.2302962
AG_ase     AG_ase -0.26468219  0.6079572
BG_ase     BG_ase  0.42574674  0.6072615
S_ase       S_ase  0.29987944  0.7961890
XY_ase     XY_ase  0.64821470  0.3027833
PX_ase     PX_ase  0.80304377  0.3296233
CO2           CO2  0.68903357 -0.1628577
enzNP       enzNP -0.77637066  0.1324578</code></pre>
</div>
<p>Let’s run some quick correlations of metadata with ordination axes to
see which parameters are significant. For this we use the vegan function
<code>envfit</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> soil_funct_plot_data[, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_samp_scores_sub)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>tmp_param_list <span class="ot">&lt;-</span> soil_funct_md_scores<span class="sc">$</span>parameters</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp_md,  <span class="at">select =</span>  tmp_param_list)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>envfit_soil_funct_md <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, tmp_md_sub,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

           CAP1     CAP2     r2   Pr(&gt;r)    
micC    0.16467  0.98635 0.1012 0.511489    
micP   -0.74314  0.66913 0.1473 0.385614    
micCN   0.39228 -0.91985 0.2111 0.244755    
micCP   0.70633 -0.70788 0.1070 0.504496    
AG_ase -0.39292  0.91957 0.4435 0.025974 *  
BG_ase  0.57346  0.81923 0.5604 0.006993 ** 
S_ase   0.35512  0.93482 0.7371 0.001998 ** 
XY_ase  0.90321  0.42921 0.5193 0.008991 ** 
PX_ase  0.92246  0.38609 0.7640 0.000999 ***
CO2     0.97421 -0.22565 0.5041 0.012987 *  
enzNP  -0.98661  0.16307 0.6242 0.003996 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_soil_funct_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_soil_funct_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_soil_funct_md<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.4</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(soil_funct_md_signif_hits)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(soil_funct_md_signif_hits)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif <span class="ot">&lt;-</span> soil_funct_md_scores[soil_funct_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                                               soil_funct_md_signif_hits,]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif<span class="sc">$</span>parameters</span></code></pre></div>
</details>
</div>
<p><code>envfit</code> found that AG_ase, BG_ase, S_ase, XY_ase, PX_ase,
CO2, enzNP were significantly correlated.</p>
<p>Now let’s see if the same parameters are significant for the
<code>envfit</code> and <code>bioenv</code> analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Significant parameters from bioenv analysis.&quot;
[1] &quot;AG_ase&quot; &quot;enzNP&quot;  &quot;S_ase&quot;  &quot;PX_ase&quot; &quot;XY_ase&quot;
_____________________________________
[1] &quot;Significant parameters from envfit analysis.&quot;
[1] &quot;AG_ase&quot; &quot;BG_ase&quot; &quot;S_ase&quot;  &quot;XY_ase&quot; &quot;PX_ase&quot; &quot;CO2&quot;    &quot;enzNP&quot; 
_____________________________________
[1] &quot;Found in bioenv but not envfit.&quot;
character(0)
_____________________________________
[1] &quot;Found in envfit but not bioenv.&quot;
[1] &quot;BG_ase&quot; &quot;CO2&quot;   
_____________________________________
[1] &quot;Found in envfit and bioenv.&quot;
[1] &quot;AG_ase&quot; &quot;BG_ase&quot; &quot;S_ase&quot;  &quot;XY_ase&quot; &quot;PX_ase&quot; &quot;CO2&quot;    &quot;enzNP&quot; </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#new_soil_funct_md_signif_hits &lt;- append(soil_funct_md_signif_hits, soil_funct_sig_diff)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>new_soil_funct_md_signif_hits <span class="ot">&lt;-</span> soil_funct_sig_diff</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_all <span class="ot">&lt;-</span> soil_funct_md_scores[soil_funct_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                                                   new_soil_funct_md_signif_hits,]</span></code></pre></div>
</details>
</div>
<p>Check. Next, we run <code>envfit</code> for the ASVs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>envfit_soil_funct_asv <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                                tmp_comm[, <span class="fu">order</span>(<span class="fu">colSums</span>(<span class="sc">-</span>tmp_comm))][, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;species&quot;</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_scores <span class="ot">&lt;-</span> soil_funct_asv_scores <span class="sc">%&gt;%</span> </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

          CAP1     CAP2     r2   Pr(&gt;r)    
ASV1   0.99572  0.09244 0.6448 0.008991 ** 
ASV2   0.53392 -0.84554 0.9003 0.000999 ***
ASV3   0.80024  0.59968 0.9414 0.000999 ***
ASV4  -0.10124  0.99486 0.2814 0.142857    
ASV5  -0.56790 -0.82310 0.1663 0.313686    
ASV6  -0.08053  0.99675 0.7514 0.000999 ***
ASV8  -0.83447  0.55105 0.4303 0.017982 *  
ASV7  -0.57807 -0.81599 0.0697 0.619381    
ASV9   0.49314 -0.86995 0.2612 0.147852    
ASV10 -0.32480  0.94578 0.8408 0.000999 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_soil_funct_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_soil_funct_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_soil_funct_asv<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.5</span>))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(soil_funct_asv_signif_hits)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(soil_funct_asv_signif_hits)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif <span class="ot">&lt;-</span> soil_funct_asv_scores[soil_funct_asv_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                                                 soil_funct_asv_signif_hits,]</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      parameters        CAP1        CAP2 variable_type
ASV3        ASV3  0.49966533  0.50499834           ASV
ASV6        ASV6 -0.01098408  0.25326180           ASV
ASV2        ASV2  0.22435017 -0.49303800           ASV
ASV10      ASV10 -0.02420323  0.09642322           ASV
ASV1        ASV1  1.17846608  0.16123440           ASV</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_all<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;metadata&quot;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;ASV&quot;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>soil_funct_bioplot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(soil_funct_md_signif_all, soil_funct_asv_signif)</span></code></pre></div>
</details>
</div>
<p>The last thing to do is categorize parameters scores and ASV scores
into different variable types for plotting.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>soil_funct_bioplot_data_md <span class="ot">&lt;-</span> <span class="fu">subset</span>(soil_funct_bioplot_data, </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                                  soil_funct_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;metadata&quot;</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>soil_funct_bioplot_data_asv <span class="ot">&lt;-</span> <span class="fu">subset</span>(soil_funct_bioplot_data, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                                   soil_funct_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;ASV&quot;</span>)</span></code></pre></div>
</details>
</div>
<details>
<summary>
Show the code for the plot
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>soil_funct_cap_vals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(soil_funct_cap<span class="sc">$</span>CCA<span class="sc">$</span>eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>soil_funct_cap1 <span class="ot">&lt;-</span> <span class="fu">signif</span>((soil_funct_cap_vals[<span class="dv">1</span>,] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>soil_funct_cap2 <span class="ot">&lt;-</span> <span class="fu">signif</span>((soil_funct_cap_vals[<span class="dv">2</span>,] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>cpa1_lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;CAP1&quot;</span>, <span class="st">&quot; (&quot;</span>, soil_funct_cap1, <span class="st">&quot;%)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>cpa2_lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;CAP2&quot;</span>, <span class="st">&quot; (&quot;</span>, soil_funct_cap2, <span class="st">&quot;%)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>swel_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#2271B2&quot;</span>, <span class="st">&quot;#71B222&quot;</span>, <span class="st">&quot;#B22271&quot;</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>soil_funct_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(soil_funct_plot_data) <span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> CAP1, <span class="at">y =</span> CAP2, <span class="at">shape =</span> TREAT,</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">colour =</span> TREAT_T), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col) <span class="sc">+</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_text(data = soil_funct_plot_data, aes(x = CAP1, y = CAP2, #UNCOMMENT to add sample labels</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                              label = SampleID), size = 3) + </span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> CAP1, <span class="at">yend =</span> CAP2),</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> soil_funct_bioplot_data_md, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>,</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)), <span class="at">size =</span> <span class="fl">0.4</span>, </span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;#191919&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> soil_funct_bioplot_data_md, </span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> CAP1, <span class="at">y =</span> CAP2, <span class="at">label =</span> parameters), <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>, <span class="at">nudge_y =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">### This code adds ASV vectors, Uncomment to add</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_segment(aes(x = 0, y = 0, xend = CAP1, yend = CAP2),</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             data = soil_funct_bioplot_data_asv, linetype = &quot;solid&quot;,</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             arrow = arrow(length = unit(0.3, &quot;cm&quot;)), size = 0.2,</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             color = &quot;#676767&quot;) +</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(data = soil_funct_bioplot_data_asv, </span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          aes(x = CAP1, y = CAP2, label = parameters), size = 2.5,</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          nudge_x = 0.05, nudge_y = 0.05) +</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Capscale Analysis&quot;</span>,</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Soil Functional Response&quot;</span>, </span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> cpa1_lab, </span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> cpa2_lab)</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>soil_funct_plot <span class="ot">&lt;-</span> soil_funct_plot <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>soil_funct_plot</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;files/metadata/figures/ssu18_soil_funct_capscale.png&quot;</span>,</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">16</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">&#39;cm&#39;</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>soil_funct_plot</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">dev.off</span>())</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;files/metadata/figures/ssu18_soil_funct_capscale.pdf&quot;</span>,</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">5</span>, <span class="at">width =</span> <span class="dv">6</span>)</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>soil_funct_plot</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="temperature-adaptation-2">Temperature Adaptation</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>tmp_md <span class="ot">&lt;-</span> ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>temp_adapt</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>tmp_md<span class="sc">$</span>TREAT_T <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tmp_md<span class="sc">$</span>TREAT_T)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(ssu18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>temp_adapt_rank <span class="ot">&lt;-</span> <span class="fu">rankindex</span>(tmp_md[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_md)], tmp_comm, </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">indices =</span> <span class="fu">c</span>(<span class="st">&quot;euc&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;gow&quot;</span>,<span class="st">&quot;bra&quot;</span>, <span class="st">&quot;kul&quot;</span>), </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">stepacross =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      euc       man       gow       bra       kul 
0.2732117 0.3330085 0.3456355 0.3330085 0.3330085 </code></pre>
</div>
<p>Let’s run <code>capscale</code> using Bray-Curtis. Note, we have 13
metadata parameters in this group but, for some reason,
<code>capscale</code> only works with 13 parameters. This may have to do
with degrees of freedom?</p>
<ul>
<li>Starting properties: AG_Q10, BG_Q10, BP_Q10, CE_Q10, P_Q10, N_Q10,
S_Q10, XY_Q10, LP_Q10, PX_Q10, CUEcn, CUEcp, NUE, PUE, Tmin, SI</li>
<li>Autocorrelated removed: NUE, PUE, SI</li>
<li>Remove for capscale: NONE</li>
</ul>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_cap <span class="ot">&lt;-</span> <span class="fu">capscale</span>(tmp_comm <span class="sc">~</span>  AG_Q10 <span class="sc">+</span> BG_Q10 <span class="sc">+</span> BP_Q10 <span class="sc">+</span> CE_Q10 <span class="sc">+</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                                       P_Q10 <span class="sc">+</span> N_Q10 <span class="sc">+</span> S_Q10 <span class="sc">+</span> XY_Q10 <span class="sc">+</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                                       LP_Q10 <span class="sc">+</span> PX_Q10 <span class="sc">+</span> CUEcn <span class="sc">+</span> CUEcp <span class="sc">+</span> Tmin, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                             tmp_md, <span class="at">dist =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>Call: capscale(formula = tmp_comm ~ AG_Q10 + BG_Q10 + BP_Q10 +
CE_Q10 + P_Q10 + N_Q10 + S_Q10 + XY_Q10 + LP_Q10 + PX_Q10 +
CUEcn + CUEcp + Tmin, data = tmp_md, distance = &quot;bray&quot;)

              Inertia Proportion Rank
Total         1.67890    1.00000     
Constrained   1.57681    0.93919   13
Unconstrained 0.10209    0.06081    1
Inertia is squared Bray distance 
Species scores projected from &#39;tmp_comm&#39; 

Eigenvalues for constrained axes:
  CAP1   CAP2   CAP3   CAP4   CAP5   CAP6   CAP7   CAP8   CAP9  CAP10 
0.6298 0.2776 0.1985 0.1087 0.0849 0.0614 0.0528 0.0450 0.0352 0.0273 
 CAP11  CAP12  CAP13 
0.0244 0.0218 0.0095 

Eigenvalues for unconstrained axes:
   MDS1 
0.10209 </code></pre>
</div>
<p>Now we can look at the variance against each principal component.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="metadata_files/figure-html5/unnamed-chunk-110-1.png" width="624" /></p>
</div>
<p>And then make some quick and dirty plots. This will also come in
handy later when we need to parse out data a better plot visualization.
The <code>ggplot</code> function <code>autoplot</code> stores these data
in a more accessible way than the raw results from
<code>capscale</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">plot</span>(temp_adapt_cap) </span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-111-1.png" width="624" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(temp_adapt_cap, <span class="at">arrows =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt</span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-111-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Next, we need to grab capscale scores for the samples and create a
data frame of the first two dimensions. We will also need to add some of
the sample details to the data frame. For this we use the vegan function
<code>scores</code> which gets species or site scores from the
ordination.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> tmp_samp_scores <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">SampleID =</span> Label)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md_sub <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot_data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_md_sub, tmp_samp_scores, </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span></code></pre></div>
</details>
</div>
<p>Now we have a new data frame that contains sample details and
capscale values.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>          SampleID PLOT TREAT TREAT_T PAIR        CAP1        CAP2
1  P10_D00_010_C0E  P10     C       0    E -0.50625375  0.10348626
2  P02_D00_010_C0A  P02     C       0    A -0.48509579 -0.14580527
3  P04_D00_010_C0B  P04     C       0    B -0.57845671  0.03776429
4  P06_D00_010_C0C  P06     C       0    C -0.53336078  0.08936059
5  P08_D00_010_C0D  P08     C       0    D -0.68345909  0.10974979
6  P01_D00_010_W3A  P01     W       3    A -0.13776351 -0.22674265
7  P03_D00_010_W3B  P03     W       3    B -0.25679729  0.01972197
8  P05_D00_010_W3C  P05     W       3    C -0.38722889 -0.11236725
9  P07_D00_010_W3D  P07     W       3    D -0.01518359 -0.46741081
10 P09_D00_010_W3E  P09     W       3    E -0.11194937 -0.54460136
11 P01_D00_010_W8A  P01     W       8    A  0.78329851  0.09997647
12 P03_D00_010_W8B  P03     W       8    B  0.89642936 -1.09522700
13 P05_D00_010_W8C  P05     W       8    C  1.07566246 -0.26764258
14 P07_D00_010_W8D  P07     W       8    D  0.41185806  0.81673870
15 P09_D00_010_W8E  P09     W       8    E  0.52830039  1.58299886</code></pre>
</div>
<p>We can then do the same with the metadata vectors. Here though we
only need the scores and parameter name.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;biplot&quot;</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_scores <span class="ot">&lt;-</span> temp_adapt_md_scores <span class="sc">%&gt;%</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>       parameters        CAP1        CAP2
AG_Q10     AG_Q10 -0.07373951  0.23793282
BG_Q10     BG_Q10  0.72604945  0.10579764
BP_Q10     BP_Q10  0.07015779 -0.12413231
CE_Q10     CE_Q10 -0.37489864  0.55022094
P_Q10       P_Q10  0.87190011 -0.25252818
N_Q10       N_Q10  0.09422795 -0.32515404
S_Q10       S_Q10  0.91309230  0.55878516
XY_Q10     XY_Q10  0.92245895 -0.02395029
LP_Q10     LP_Q10 -0.90356227 -0.36479560
PX_Q10     PX_Q10 -0.87475774  0.18121787
CUEcn       CUEcn -0.23872665 -0.39707742
CUEcp       CUEcp  0.57949983 -0.62675335
Tmin         Tmin  0.99158847  0.19050834</code></pre>
</div>
<p>Let’s run some quick correlations of metadata with ordination axes to
see which parameters are significant. For this we use the vegan function
<code>envfit</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> temp_adapt_plot_data[, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_samp_scores_sub)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>tmp_param_list <span class="ot">&lt;-</span> temp_adapt_md_scores<span class="sc">$</span>parameters</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp_md,  <span class="at">select =</span>  tmp_param_list)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>envfit_temp_adapt_md <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, tmp_md_sub,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

           CAP1     CAP2     r2  Pr(&gt;r)  
AG_Q10 -0.30810  0.95136 0.0260 0.83117  
BG_Q10  0.99031  0.13889 0.2354 0.17782  
BP_Q10  0.50944 -0.86050 0.0086 0.95504  
CE_Q10 -0.58116  0.81379 0.1875 0.25075  
P_Q10   0.96427 -0.26494 0.3590 0.05395 .
N_Q10   0.28973 -0.95711 0.0479 0.76723  
S_Q10   0.86347  0.50440 0.4956 0.01499 *
XY_Q10  0.99973 -0.02334 0.3725 0.04895 *
LP_Q10 -0.93292 -0.36008 0.4131 0.04096 *
PX_Q10 -0.98131  0.19244 0.3483 0.07992 .
CUEcn  -0.53407 -0.84544 0.0908 0.55245  
CUEcp   0.69625 -0.71780 0.3103 0.12288  
Tmin    0.98341  0.18140 0.4456 0.02997 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_temp_adapt_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_temp_adapt_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_temp_adapt_md<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.4</span>))</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(temp_adapt_md_signif_hits)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(temp_adapt_md_signif_hits)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif <span class="ot">&lt;-</span> temp_adapt_md_scores[temp_adapt_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>                                               temp_adapt_md_signif_hits,]</span></code></pre></div>
</details>
</div>
<p><code>envfit</code> found that S_Q10, LP_Q10, Tmin were significantly
correlated.</p>
<p>Now let’s see if the same parameters are significant for the
<code>envfit</code> and <code>bioenv</code> analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Significant parameters from bioenv analysis.&quot;
[1] &quot;CUEcp&quot;  &quot;LP_Q10&quot; &quot;P_Q10&quot;  &quot;S_Q10&quot;  &quot;Tmin&quot;  
_____________________________________
[1] &quot;Significant parameters from envfit analysis.&quot;
[1] &quot;S_Q10&quot;  &quot;LP_Q10&quot; &quot;Tmin&quot;  
_____________________________________
[1] &quot;Found in bioenv but not envfit.&quot;
[1] &quot;CUEcp&quot; &quot;P_Q10&quot;
_____________________________________
[1] &quot;Found in envfit but not bioenv.&quot;
character(0)
_____________________________________
[1] &quot;Found in envfit and  bioenv.&quot;
[1] &quot;S_Q10&quot;  &quot;LP_Q10&quot; &quot;Tmin&quot;   &quot;CUEcp&quot;  &quot;P_Q10&quot; </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#new_temp_adapt_md_signif_hits &lt;- base::append(temp_adapt_md_signif_hits, temp_adapt_sig_diff)</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>new_temp_adapt_md_signif_hits <span class="ot">&lt;-</span> temp_adapt_sig_diff</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_all <span class="ot">&lt;-</span> temp_adapt_md_scores[temp_adapt_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                                                   new_temp_adapt_md_signif_hits,]</span></code></pre></div>
</details>
</div>
<p>Check. Next, we run <code>envfit</code> for the ASVs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>envfit_temp_adapt_asv <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                                tmp_comm[, <span class="fu">order</span>(<span class="fu">colSums</span>(<span class="sc">-</span>tmp_comm))][, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;species&quot;</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_scores <span class="ot">&lt;-</span> temp_adapt_asv_scores <span class="sc">%&gt;%</span> </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>                         tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

          CAP1     CAP2     r2   Pr(&gt;r)    
ASV1   0.98984  0.14217 0.6541 0.009990 ** 
ASV2   0.55070 -0.83470 0.8953 0.000999 ***
ASV3   0.79919  0.60108 0.9513 0.000999 ***
ASV4  -0.12171  0.99257 0.3110 0.118881    
ASV5  -0.67644 -0.73649 0.1181 0.487512    
ASV6  -0.10078  0.99491 0.7028 0.003996 ** 
ASV8  -0.85434  0.51972 0.4279 0.043956 *  
ASV7  -0.57853 -0.81566 0.0602 0.676324    
ASV9   0.53361 -0.84573 0.2425 0.185814    
ASV10 -0.34761  0.93764 0.8031 0.000999 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_temp_adapt_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_temp_adapt_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_temp_adapt_asv<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.5</span>))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(temp_adapt_asv_signif_hits)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(temp_adapt_asv_signif_hits)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif <span class="ot">&lt;-</span> temp_adapt_asv_scores[temp_adapt_asv_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                                                 temp_adapt_asv_signif_hits,]</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      parameters        CAP1        CAP2 variable_type
ASV3        ASV3  0.49583686  0.48216614           ASV
ASV6        ASV6 -0.01759546  0.20461984           ASV
ASV2        ASV2  0.23578207 -0.44144325           ASV
ASV10      ASV10 -0.02475900  0.08142465           ASV
ASV1        ASV1  1.18724098  0.33621587           ASV</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_all<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;metadata&quot;</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;ASV&quot;</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioplot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(temp_adapt_md_signif_all, temp_adapt_asv_signif)</span></code></pre></div>
</details>
</div>
<p>The last thing to do is categorize parameters scores and ASV scores
into different variable types for plotting.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioplot_data_md <span class="ot">&lt;-</span> <span class="fu">subset</span>(temp_adapt_bioplot_data, </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                                  temp_adapt_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;metadata&quot;</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioplot_data_asv <span class="ot">&lt;-</span> <span class="fu">subset</span>(temp_adapt_bioplot_data, </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>                                   temp_adapt_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;ASV&quot;</span>)</span></code></pre></div>
</details>
</div>
<details>
<summary>
Show the code for the plot
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_cap_vals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(temp_adapt_cap<span class="sc">$</span>CCA<span class="sc">$</span>eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>temp_adapt_cap1 <span class="ot">&lt;-</span> <span class="fu">signif</span>((temp_adapt_cap_vals[<span class="dv">1</span>,] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_cap2 <span class="ot">&lt;-</span> <span class="fu">signif</span>((temp_adapt_cap_vals[<span class="dv">2</span>,] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>cpa1_lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;CAP1&quot;</span>, <span class="st">&quot; (&quot;</span>, temp_adapt_cap1, <span class="st">&quot;%)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>cpa2_lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;CAP2&quot;</span>, <span class="st">&quot; (&quot;</span>, temp_adapt_cap2, <span class="st">&quot;%)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>swel_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#2271B2&quot;</span>, <span class="st">&quot;#71B222&quot;</span>, <span class="st">&quot;#B22271&quot;</span>)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(temp_adapt_plot_data) <span class="sc">+</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> CAP1, <span class="at">y =</span> CAP2, <span class="at">shape =</span> TREAT,</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">colour =</span> TREAT_T), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col) <span class="sc">+</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_text(data = temp_adapt_plot_data, aes(x = CAP1, y = CAP2, #UNCOMMENT to add sample labels</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                              label = SampleID), size = 3) + </span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> CAP1, <span class="at">yend =</span> CAP2),</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> temp_adapt_bioplot_data_md, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>,</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)), <span class="at">size =</span> <span class="fl">0.4</span>,</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;#191919&quot;</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> temp_adapt_bioplot_data_md, </span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> CAP1, <span class="at">y =</span> CAP2, <span class="at">label =</span> parameters), <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>, <span class="at">nudge_y =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">### This code adds ASV vectors, Uncomment to add</span></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_segment(aes(x = 0, y = 0, xend = CAP1, yend = CAP2),</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a><span class="co">#               data = temp_adapt_bioplot_data_asv, linetype = &quot;solid&quot;,</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="co">#               arrow = arrow(length = unit(0.3, &quot;cm&quot;)), size = 0.2,</span></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a><span class="co">#               color = &quot;#676767&quot;) +</span></span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_text(data = temp_adapt_bioplot_data_asv, </span></span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a><span class="co">#            aes(x = CAP1, y = CAP2, label = parameters), size = 2.5,</span></span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a><span class="co">#            nudge_x = 0.05, nudge_y = 0.05) +</span></span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Capscale Analysis&quot;</span>,</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Temperature Adaptation&quot;</span>,</span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> cpa1_lab, </span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> cpa2_lab)</span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot <span class="ot">&lt;-</span> temp_adapt_plot <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot</span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;files/metadata/figures/ssu18_temp_adapt_capscale.png&quot;</span>,</span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">16</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">&#39;cm&#39;</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot</span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">dev.off</span>())</span>
<span id="cb94-42"><a href="#cb94-42" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;files/metadata/figures/ssu18_temp_adapt_capscale.pdf&quot;</span>,</span>
<span id="cb94-43"><a href="#cb94-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">5</span>, <span class="at">width =</span> <span class="dv">6</span>)</span>
<span id="cb94-44"><a href="#cb94-44" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot</span>
<span id="cb94-45"><a href="#cb94-45" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="capscale-plots">Capscale Plots</h2>
<div class="l-body-outset">
<div class="panelset">
<section id="edaphic-properties-3" class="panel">
<h4>Edaphic properties</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-130-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 7 | Distance-based Redundancy
Analysis (db-RDA) of PIME filtered data based on Bray-Curtis
dissimilarity showing the relationships between community composition
change versus edaphic properties.</strong></small></p>
</section>
<section id="soil-functional-response-2" class="panel">
<h4>Soil Functional Response</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-131-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 8 | Distance-based Redundancy
Analysis (db-RDA) of PIME filtered data based on Bray-Curtis
dissimilarity showing the relationships between community composition
change versus microbial functional response.</strong></small></p>
</section>
<section id="temperature-adaptation-3" class="panel">
<h4>Temperature Adaptation</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-132-1.png" width="624" /></p>
</div>
<p><small><strong>(16S rRNA) Figure 9 | Distance-based Redundancy
Analysis (db-RDA) of PIME filtered data based on Bray-Curtis
dissimilarity showing the relationships between community composition
change versus temperature adaptation.</strong></small></p>
</section>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="its-1">ITS</h1>
<h2 id="data-formating-1">Data Formating</h2>
<ol type="1">
<li>Transform <code>ps</code> Objects</li>
</ol>
<p>The first step is to transform the phyloseq objects.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>samp_ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;its18_ps_work&quot;</span>, <span class="st">&quot;its18_ps_pime&quot;</span>, <span class="st">&quot;its18_ps_perfect&quot;</span>, </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;its18_ps_work_otu&quot;</span>, <span class="st">&quot;its18_ps_pime_otu&quot;</span>, <span class="st">&quot;its18_ps_perfect_otu&quot;</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps) {</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(tmp_get, <span class="cf">function</span>(otu) <span class="fl">1e5</span> <span class="sc">*</span> otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>     tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">prune_samples</span>(<span class="fu">sample_sums</span>(tmp_ps) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_ps)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_get))</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> tmp_samp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;TREAT_T&quot;</span> <span class="ot">=</span> <span class="st">&quot;TEMP&quot;</span>)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">sample_data</span>(tmp_ps) <span class="ot">&lt;-</span> tmp_samp</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_prop&quot;</span>))</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_ps)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Format for <code>mctoolsr</code></li>
</ol>
<p>Then a bit of formatting to make the data compatible with
<code>mctoolsr</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps) {</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_prop&quot;</span>)))</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>     tmp_tax <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tax_table</span>(tmp_get))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>     tmp_tax<span class="sc">$</span>ASV_SEQ <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>     tmp_col_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(tmp_tax)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>     tmp_tax_merge <span class="ot">&lt;-</span> tmp_tax <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">unite</span>(taxonomy, </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">all_of</span>(tmp_col_names), </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>     tmp_tax_merge <span class="ot">&lt;-</span> tmp_tax_merge <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;#OTU_ID&quot;</span>)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>     tmp_otu <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_get)))</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>     tmp_otu <span class="ot">&lt;-</span> tmp_otu <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;#OTU_ID&quot;</span>)</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>     tmp_otu_tax <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_otu, tmp_tax_merge, <span class="at">by =</span> <span class="st">&quot;#OTU_ID&quot;</span>)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_get))</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>     tmp_samp[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>     tmp_samp <span class="ot">&lt;-</span> tmp_samp <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;#SampleID&quot;</span>)</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>     tmp_metad <span class="ot">&lt;-</span> metad <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;#SampleID&quot;</span> <span class="ot">=</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>     tmp_metad[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>     tmp_md <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp, tmp_metad, <span class="at">by =</span> <span class="st">&quot;#SampleID&quot;</span>)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>     tmp_otu_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_otu_tax&quot;</span>))</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_otu_name)</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_otu_name, tmp_otu_tax)</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>     tmp_md_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_md&quot;</span>))</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_md_name)</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_md_name, tmp_md)</span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>     tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;files/metadata/tables/&quot;</span>)</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>     <span class="fu">write_delim</span>(tmp_otu_tax, <span class="fu">paste</span>(tmp_path, tmp_otu_name, <span class="st">&quot;.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>     <span class="fu">write_delim</span>(tmp_md, <span class="fu">paste</span>(tmp_path, tmp_md_name, <span class="st">&quot;.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps) {</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>     tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;files/metadata/tables/&quot;</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>     tmp_otu_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_otu_tax&quot;</span>))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>     tmp_md_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_md&quot;</span>))</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>     tmp_tax_table_fp <span class="ot">&lt;-</span> <span class="fu">paste</span>(tmp_path, tmp_otu_name, <span class="st">&quot;.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>     tmp_map_fp <span class="ot">&lt;-</span> <span class="fu">paste</span>(tmp_path, tmp_md_name, <span class="st">&quot;.txt&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>     tmp_input <span class="ot">&lt;-</span> <span class="fu">load_taxa_table</span>(tmp_tax_table_fp, tmp_map_fp)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>     tmp_input_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_mc&quot;</span>))</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_input_name)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_input_name, tmp_input)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_md&quot;</span>))</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_otu_tax&quot;</span>))</span></code></pre></div>
</details>
</div>
<h2 id="choose-data-set-1">Choose Data Set</h2>
<p>At this point in the code we need to choose a data set to use,
formatted with <code>mctoolsr</code>. Remember, there are four
choices:</p>
<ol type="1">
<li>Complete ASV data set.</li>
<li>Arbitrary filtered ASV data set.</li>
<li>PERfect filtered ASV data set.</li>
<li>PIME filtered ASV data set.</li>
</ol>
<p>This way, if we want to test other data sets we only need to change
the name here.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_mc&quot;</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>its18_select_mc <span class="ot">&lt;-</span> its18_ps_pime_mc</span></code></pre></div>
</div>
<h2 id="normality-tests-1">Normality Tests</h2>
<p>Before proceeding, we need to test each parameter in the metadata to
see which ones are and are not normally distributed. For that, we use
the Shapiro-Wilk Normality Test. Here we only need one of the metadata
files.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>temp_md <span class="ot">&lt;-</span> its18_select_mc<span class="sc">$</span>map_loaded</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>temp_md[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>shap_results <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(temp_md)) {</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  tmp_shap <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(temp_md[[i]])</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  tmp_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_shap<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">5</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_shap<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>))</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  shap_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(shap_results, <span class="fu">data.frame</span>(i, tmp_p, tmp_res))</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(shap_results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;tranform&quot;</span>)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>shap_results</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(shap_results, tranform <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span>)</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>md_to_tranform <span class="ot">&lt;-</span> shap_results<span class="sc">$</span>parameter[shap_results<span class="sc">$</span>tranform <span class="sc">==</span> <span class="cn">TRUE</span>]</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;temp_md&quot;</span>))</span></code></pre></div>
</details>
</div>
<details>
<summary>
<strong>Show the results</strong> of each normality test for metadata
parameters
</summary>
<p></br></p>
<p><small><strong>(ITS) Table 2 | Results of the Shapiro-Wilk Normality
Tests. P-values in red are significance (p-value &lt; 0.05) meaning the
parameter needs to be normalized.</strong></small></p>
<div class="layout-chunk" data-layout="l-body">
<div id="htmlwidget-692cbfe2fd0f28261429" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-692cbfe2fd0f28261429">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"parameter":["AST","H2O","N","P","Al","Ca","Fe","K","Mg","Mn","Na","TEB","ECEC","pH","minPO4","minNH4","minNO3","minTIN","NH4","NO3","PO4","DOC","DON","DOCN","micC","micN","micP","micCN","micCP","micNP","AG_ase","BG_ase","BP_ase","CE_ase","P_ase","N_ase","S_ase","XY_ase","AG_Q10","BG_Q10","BP_Q10","CE_Q10","P_Q10","N_Q10","S_Q10","XY_Q10","CO2","LP_ase","LP_Q10","PX_ase","PX_Q10","CUEcn","CUEcp","NUE","PUE","Tmin","SI","enzCN","enzCP","enzNP"],"p-value":[0.00288,0.00272,0.09024,0.46522,0.00063,0.11893,0.00088,0.18425,0.27096,0.26036,0.11161,0.0107,0.01083,0.62168,0.11512,0.66069,0.00112,0.00133,0.05982,0.74913,0.13322,0.02215,0.29704,0.33006,0.20336,0.61244,0.17886,0.07687,0.6622,0.39825,0.93318,0.00403,0.00669,0.14601,0.00981,0.00733,0.10815,0.02719,0.26659,0.01649,0.11576,0.03868,0.34975,0.76801,0.40364,0.18425,0.00011,0.77547,0.80669,0.01754,2e-05,0.96287,0.01163,0.49521,0.00081,0.134,0.09324,0.13857,0.8759,0.1143],"tranform":[true,true,false,false,true,false,true,false,false,false,false,true,true,false,false,false,true,true,false,false,false,true,false,false,false,false,false,false,false,false,false,true,true,false,true,true,false,true,false,true,false,true,false,false,false,false,true,false,false,true,true,false,true,false,true,false,false,false,false,false]},"columns":[{"accessor":"parameter","name":"Parameter","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["AST","H2O","N","P","Al","Ca","Fe","K","Mg","Mn","Na","TEB","ECEC","pH","minPO4","minNH4","minNO3","minTIN","NH4","NO3","PO4","DOC","DON","DOCN","micC","micN","micP","micCN","micCP","micNP","AG_ase","BG_ase","BP_ase","CE_ase","P_ase","N_ase","S_ase","XY_ase","AG_Q10","BG_Q10","BP_Q10","CE_Q10","P_Q10","N_Q10","S_Q10","XY_Q10","CO2","LP_ase","LP_Q10","PX_ase","PX_Q10","CUEcn","CUEcp","NUE","PUE","Tmin","SI","enzCN","enzCP","enzNP"],"header":"Parameter","align":"left","headerStyle":{"borderRight":"1px solid #eee","fontSize":"0.9em"},"footerStyle":{"fontWeight":"bold"},"minWidth":150,"sticky":"left","style":{"borderRight":"1px solid #eee"}},{"accessor":"p-value","name":"p-value","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.00288","0.00272","0.09024","0.46522","0.00063","0.11893","0.00088","0.18425","0.27096","0.26036","0.11161","0.0107","0.01083","0.62168","0.11512","0.66069","0.00112","0.00133","0.05982","0.74913","0.13322","0.02215","0.29704","0.33006","0.20336","0.61244","0.17886","0.07687","0.6622","0.39825","0.93318","0.00403","0.00669","0.14601","0.00981","0.00733","0.10815","0.02719","0.26659","0.01649","0.11576","0.03868","0.34975","0.76801","0.40364","0.18425","0.00011","0.77547","0.80669","0.01754","0.00002","0.96287","0.01163","0.49521","0.00081","0.134","0.09324","0.13857","0.8759","0.1143"],"header":"p-value","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"},"style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"}]},{"accessor":"tranform","name":"tranform","type":"logical","sortable":true,"resizable":true,"filterable":true,"cell":["TRUE","TRUE","FALSE","FALSE","TRUE","FALSE","TRUE","FALSE","FALSE","FALSE","FALSE","TRUE","TRUE","FALSE","FALSE","FALSE","TRUE","TRUE","FALSE","FALSE","FALSE","TRUE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","TRUE","TRUE","FALSE","TRUE","TRUE","FALSE","TRUE","FALSE","TRUE","FALSE","TRUE","FALSE","FALSE","FALSE","FALSE","TRUE","FALSE","FALSE","TRUE","TRUE","FALSE","TRUE","FALSE","TRUE","FALSE","FALSE","FALSE","FALSE","FALSE"],"header":"tranform","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":60,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"bc26461385648ff42e5213a4925456ab"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</details>
<p>Looks like we need to transform 21 metadata parameters.</p>
<h2 id="normalize-parameters-1">Normalize Parameters</h2>
<p>Here we use the R package <a
href="https://cran.r-project.org/web/packages/bestNormalize/vignettes/bestNormalize.html"><code>bestNormalize</code></a>
to find and execute the best normalizing transformation. The function
will test the following normalizing transformations:</p>
<ul>
<li><p><code>arcsinh_x</code> performs an arcsinh
transformation.</p></li>
<li><p><code>boxcox</code> Perform a Box-Cox transformation and
center/scale a vector to attempt normalization. <code>boxcox</code>
estimates the optimal value of lambda for the Box-Cox transformation.
The function will return an error if a user attempt to transform
nonpositive data.</p></li>
<li><p><code>yeojohnson</code> Perform a Yeo-Johnson Transformation and
center/scale a vector to attempt normalization. <code>yeojohnson</code>
estimates the optimal value of lambda for the Yeo-Johnson
transformation. The Yeo-Johnson is similar to the Box-Cox method,
however it allows for the transformation of nonpositive data as
well.</p></li>
<li><p><code>orderNorm</code> The Ordered Quantile (ORQ) normalization
transformation, <code>orderNorm()</code>, is a rank-based procedure by
which the values of a vector are mapped to their percentile, which is
then mapped to the same percentile of the normal distribution. Without
the presence of ties, this essentially guarantees that the
transformation leads to a uniform distribution.</p></li>
<li><p><code>log_x</code> performs a simple log transformation. The
parameter a is essentially estimated by the training set by default
(estimated as the minimum possible to some extent epsilon), while the
base must be specified beforehand. The default base of the log is
10.</p></li>
<li><p><code>sqrt_x</code> performs a simple square-root transformation.
The parameter a is essentially estimated by the training set by default
(estimated as the minimum possible), while the base must be specified
beforehand.</p></li>
<li><p><code>exp_x</code> performs a simple exponential
transformation.</p></li>
</ul>
<p>See this GitHub issue (<a
href="https://github.com/petersonR/bestNormalize/issues/5">#5</a>) for a
description on getting reproducible results. Apparently, you can get
different results because the <code>bestNormalize()</code> function uses
repeated cross-validation (and doesn’t automatically set the seed), so
the results will be slightly different each time the function is
executed.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> md_to_tranform) {</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  tmp_md <span class="ot">&lt;-</span> its18_select_mc<span class="sc">$</span>map_loaded</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  tmp_best_norm <span class="ot">&lt;-</span> <span class="fu">bestNormalize</span>(tmp_md[[i]], <span class="at">r =</span> <span class="dv">1</span>, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">loo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_best_norm_test&quot;</span>))</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_best_norm)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tmp_name)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<details>
<summary>
Show the chosen transformations
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
## bestNormalize Chosen transformation of AST ## 
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
   0%   25%   50%   75%  100% 
25.80 26.26 28.80 29.90 41.77 
_____________________________________

## bestNormalize Chosen transformation of H2O ## 
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
   0%   25%   50%   75%  100% 
0.204 0.261 0.377 0.385 0.401 
_____________________________________

## bestNormalize Chosen transformation of Al ## 
Standardized asinh(x) Transformation with 13 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 0.005384372 
 - sd (before standardization) = 0.007762057 
_____________________________________

## bestNormalize Chosen transformation of Fe ## 
Standardized asinh(x) Transformation with 13 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 0.01076821 
 - sd (before standardization) = 0.0103749 
_____________________________________

## bestNormalize Chosen transformation of TEB ## 
orderNorm Transformation with 13 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
41.6 43.3 45.1 48.7 61.7 
_____________________________________

## bestNormalize Chosen transformation of ECEC ## 
orderNorm Transformation with 13 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
41.7 43.3 45.3 48.8 61.8 
_____________________________________

## bestNormalize Chosen transformation of minNO3 ## 
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 11.31  19.67  22.71  37.33 106.42 
_____________________________________

## bestNormalize Chosen transformation of minTIN ## 
orderNorm Transformation with 13 nonmissing obs and ties
 - 12 unique values 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 12.96  21.50  23.99  42.08 110.75 
_____________________________________

## bestNormalize Chosen transformation of DOC ## 
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 33.20  44.30  56.68  63.79 118.74 
_____________________________________

## bestNormalize Chosen transformation of BG_ase ## 
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
  0%  25%  50%  75% 100% 
3.04 3.92 4.22 4.62 9.09 
_____________________________________

## bestNormalize Chosen transformation of BP_ase ## 
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
  0%  25%  50%  75% 100% 
1.77 2.33 3.02 3.50 7.28 
_____________________________________

## bestNormalize Chosen transformation of P_ase ## 
Standardized Box Cox Transformation with 13 nonmissing obs.:
 Estimated statistics:
 - lambda = -0.9999576 
 - mean (before standardization) = 0.9480149 
 - sd (before standardization) = 0.01593697 
_____________________________________

## bestNormalize Chosen transformation of N_ase ## 
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
  0%  25%  50%  75% 100% 
2.57 2.95 3.58 4.52 8.34 
_____________________________________

## bestNormalize Chosen transformation of XY_ase ## 
orderNorm Transformation with 13 nonmissing obs and ties
 - 11 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
0.66 0.76 1.11 1.36 2.52 
_____________________________________

## bestNormalize Chosen transformation of BG_Q10 ## 
orderNorm Transformation with 13 nonmissing obs and ties
 - 11 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
1.31 1.36 1.39 1.56 1.76 
_____________________________________

## bestNormalize Chosen transformation of CE_Q10 ## 
orderNorm Transformation with 13 nonmissing obs and ties
 - 12 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
1.76 1.87 1.95 2.00 2.36 
_____________________________________

## bestNormalize Chosen transformation of CO2 ## 
Standardized asinh(x) Transformation with 13 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 2.626573 
 - sd (before standardization) = 0.7396036 
_____________________________________

## bestNormalize Chosen transformation of PX_ase ## 
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 81.25  94.13 119.75 211.18 294.39 
_____________________________________

## bestNormalize Chosen transformation of PX_Q10 ## 
Standardized Yeo-Johnson Transformation with 13 nonmissing obs.:
 Estimated statistics:
 - lambda = -4.999963 
 - mean (before standardization) = 0.1968145 
 - sd (before standardization) = 0.001394949 
_____________________________________

## bestNormalize Chosen transformation of CUEcp ## 
orderNorm Transformation with 13 nonmissing obs and ties
 - 9 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
0.15 0.17 0.19 0.21 0.33 
_____________________________________

## bestNormalize Chosen transformation of PUE ## 
orderNorm Transformation with 13 nonmissing obs and ties
 - 6 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
0.77 0.88 0.90 0.91 0.92 
_____________________________________</code></pre>
</div>
</details>
<details>
<summary>
Show the complete <code>bestNormalize</code> results
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
## Results of bestNormalize for AST ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.2051
 - Box-Cox: 3.2051
 - Center+scale: 4.1282
 - Exp(x): 17.9744
 - Log_b(x+a): 3.2051
 - orderNorm (ORQ): 0.1282
 - sqrt(x + a): 4.1282
 - Yeo-Johnson: 2.2821
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
   0%   25%   50%   75%  100% 
25.80 26.26 28.80 29.90 41.77 
_____________________________________

## Results of bestNormalize for H2O ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 7.2051
 - Box-Cox: 6.2821
 - Center+scale: 8.1282
 - Exp(x): 6.2821
 - Log_b(x+a): 7.2051
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 7.2051
 - Yeo-Johnson: 6.2821
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
   0%   25%   50%   75%  100% 
0.204 0.261 0.377 0.385 0.401 
_____________________________________

## Results of bestNormalize for Al ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 7.5128
 - Center+scale: 7.5128
 - Exp(x): 7.5128
 - Log_b(x+a): 9.359
 - orderNorm (ORQ): 7.5128
 - sqrt(x + a): 7.5128
 - Yeo-Johnson: 7.5128
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized asinh(x) Transformation with 13 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 0.005384372 
 - sd (before standardization) = 0.007762057 
_____________________________________

## Results of bestNormalize for Fe ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 7.2051
 - Center+scale: 7.2051
 - Exp(x): 7.2051
 - Log_b(x+a): 7.2051
 - orderNorm (ORQ): 7.2051
 - sqrt(x + a): 7.2051
 - Yeo-Johnson: 7.2051
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized asinh(x) Transformation with 13 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 0.01076821 
 - sd (before standardization) = 0.0103749 
_____________________________________

## Results of bestNormalize for TEB ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.6667
 - Box-Cox: 1.6667
 - Center+scale: 4.7436
 - Exp(x): 17.9744
 - Log_b(x+a): 1.6667
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 3.2051
 - Yeo-Johnson: 1.359
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
41.6 43.3 45.1 48.7 61.7 
_____________________________________

## Results of bestNormalize for ECEC ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.6667
 - Box-Cox: 1.6667
 - Center+scale: 3.2051
 - Exp(x): 17.9744
 - Log_b(x+a): 1.6667
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 3.2051
 - Yeo-Johnson: 1.359
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and ties
 - 10 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
41.7 43.3 45.3 48.8 61.8 
_____________________________________

## Results of bestNormalize for minNO3 ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.5128
 - Box-Cox: 3.5128
 - Center+scale: 5.359
 - Exp(x): 17.9744
 - Log_b(x+a): 3.5128
 - orderNorm (ORQ): 0.7436
 - sqrt(x + a): 2.5897
 - Yeo-Johnson: 3.5128
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 11.31  19.67  22.71  37.33 106.42 
_____________________________________

## Results of bestNormalize for minTIN ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.359
 - Box-Cox: 2.2821
 - Center+scale: 4.1282
 - Exp(x): 17.9744
 - Log_b(x+a): 1.359
 - orderNorm (ORQ): 0.7436
 - sqrt(x + a): 2.2821
 - Yeo-Johnson: 2.2821
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and ties
 - 12 unique values 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 12.96  21.50  23.99  42.08 110.75 
_____________________________________

## Results of bestNormalize for DOC ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 2.8974
 - Box-Cox: 2.8974
 - Center+scale: 3.5128
 - Exp(x): 17.9744
 - Log_b(x+a): 2.8974
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 1.9744
 - Yeo-Johnson: 2.8974
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 33.20  44.30  56.68  63.79 118.74 
_____________________________________

## Results of bestNormalize for BG_ase ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.8205
 - Box-Cox: 2.2821
 - Center+scale: 4.1282
 - Exp(x): 14.8974
 - Log_b(x+a): 3.8205
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 3.5128
 - Yeo-Johnson: 1.6667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
  0%  25%  50%  75% 100% 
3.04 3.92 4.22 4.62 9.09 
_____________________________________

## Results of bestNormalize for BP_ase ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.6667
 - Box-Cox: 1.6667
 - Center+scale: 4.1282
 - Exp(x): 5.6667
 - Log_b(x+a): 1.6667
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 1.6667
 - Yeo-Johnson: 1.6667
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
  0%  25%  50%  75% 100% 
1.77 2.33 3.02 3.50 7.28 
_____________________________________

## Results of bestNormalize for P_ase ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.6667
 - Box-Cox: 0.4359
 - Center+scale: 3.2051
 - Exp(x): 17.9744
 - Log_b(x+a): 1.6667
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 1.9744
 - Yeo-Johnson: 0.4359
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized Box Cox Transformation with 13 nonmissing obs.:
 Estimated statistics:
 - lambda = -0.9999576 
 - mean (before standardization) = 0.9480149 
 - sd (before standardization) = 0.01593697 
_____________________________________

## Results of bestNormalize for N_ase ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.9744
 - Box-Cox: 2.2821
 - Center+scale: 2.8974
 - Exp(x): 17.9744
 - Log_b(x+a): 1.9744
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 2.8974
 - Yeo-Johnson: 0.4359
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
  0%  25%  50%  75% 100% 
2.57 2.95 3.58 4.52 8.34 
_____________________________________

## Results of bestNormalize for XY_ase ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.0513
 - Box-Cox: 0.4359
 - Center+scale: 2.8974
 - Exp(x): 9.0513
 - Log_b(x+a): 1.0513
 - orderNorm (ORQ): 0.1282
 - sqrt(x + a): 1.359
 - Yeo-Johnson: 0.4359
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and ties
 - 11 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
0.66 0.76 1.11 1.36 2.52 
_____________________________________

## Results of bestNormalize for BG_Q10 ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.9744
 - Box-Cox: 1.9744
 - Center+scale: 2.2821
 - Exp(x): 5.359
 - Log_b(x+a): 1.9744
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 1.9744
 - Yeo-Johnson: 1.9744
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and ties
 - 11 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
1.31 1.36 1.39 1.56 1.76 
_____________________________________

## Results of bestNormalize for CE_Q10 ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.6667
 - Box-Cox: 1.6667
 - Center+scale: 1.6667
 - Exp(x): 4.1282
 - Log_b(x+a): 1.6667
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 1.6667
 - Yeo-Johnson: 0.7436
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and ties
 - 12 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
1.76 1.87 1.95 2.00 2.36 
_____________________________________

## Results of bestNormalize for CO2 ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.0513
 - Box-Cox: 3.5128
 - Center+scale: 11.5128
 - Exp(x): 17.9744
 - Log_b(x+a): 1.0513
 - orderNorm (ORQ): 1.0513
 - sqrt(x + a): 2.8974
 - Yeo-Johnson: 1.9744
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized asinh(x) Transformation with 13 nonmissing obs.:
 Relevant statistics:
 - mean (before standardization) = 2.626573 
 - sd (before standardization) = 0.7396036 
_____________________________________

## Results of bestNormalize for PX_ase ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 1.9744
 - Box-Cox: 2.2821
 - Center+scale: 4.1282
 - Exp(x): 17.9744
 - Log_b(x+a): 1.9744
 - orderNorm (ORQ): 0.4359
 - sqrt(x + a): 1.9744
 - Yeo-Johnson: 2.2821
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and no ties 
 - Original quantiles:
    0%    25%    50%    75%   100% 
 81.25  94.13 119.75 211.18 294.39 
_____________________________________

## Results of bestNormalize for PX_Q10 ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 14.5897
 - Box-Cox: 3.2051
 - Center+scale: 17.9744
 - Exp(x): 17.9744
 - Log_b(x+a): 11.5128
 - orderNorm (ORQ): 2.2821
 - sqrt(x + a): 17.9744
 - Yeo-Johnson: 1.0513
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
Standardized Yeo-Johnson Transformation with 13 nonmissing obs.:
 Estimated statistics:
 - lambda = -4.999963 
 - mean (before standardization) = 0.1968145 
 - sd (before standardization) = 0.001394949 
_____________________________________

## Results of bestNormalize for CUEcp ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 3.5128
 - Box-Cox: 1.359
 - Center+scale: 3.5128
 - Exp(x): 4.4359
 - Log_b(x+a): 1.359
 - orderNorm (ORQ): 0.7436
 - sqrt(x + a): 3.5128
 - Yeo-Johnson: 2.5897
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and ties
 - 9 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
0.15 0.17 0.19 0.21 0.33 
_____________________________________

## Results of bestNormalize for PUE ## 
Best Normalizing transformation with 13 Observations
 Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
 - arcsinh(x): 5.9744
 - Box-Cox: 7.2051
 - Center+scale: 5.9744
 - Exp(x): 5.9744
 - Log_b(x+a): 7.2051
 - orderNorm (ORQ): 2.5897
 - sqrt(x + a): 5.9744
 - Yeo-Johnson: 5.9744
Estimation method: Out-of-sample via leave-one-out CV
 
Based off these, bestNormalize chose:
orderNorm Transformation with 13 nonmissing obs and ties
 - 6 unique values 
 - Original quantiles:
  0%  25%  50%  75% 100% 
0.77 0.88 0.90 0.91 0.92 
_____________________________________</code></pre>
</div>
</details>
<p>Great, now we can add the normalized transformed data back to our
<code>mctoolsr</code> metadata file.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>its18_select_mc_norm <span class="ot">&lt;-</span> its18_select_mc</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> md_to_tranform) {</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>      tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">&quot;_best_norm_test&quot;</span>)))</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>      tmp_new_data <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>x.t</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>      its18_select_mc_norm<span class="sc">$</span>map_loaded[[i]] <span class="ot">&lt;-</span> tmp_new_data</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>}     </span></code></pre></div>
</details>
</div>
<p>And rerun the Shapiro Tests.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>temp_md_norm <span class="ot">&lt;-</span> its18_select_mc_norm<span class="sc">$</span>map_loaded</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>temp_md_norm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>shap_results_norm <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(temp_md_norm)) {</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  tmp_shap <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(temp_md_norm[[i]])</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  tmp_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_shap<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">5</span>)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_shap<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>))</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  shap_results_norm <span class="ot">&lt;-</span> <span class="fu">rbind</span>(shap_results_norm, <span class="fu">data.frame</span>(i, tmp_p, tmp_res))</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(shap_results_norm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;tranform&quot;</span>)</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>shap_results_norm</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;temp_md_norm&quot;</span>))</span></code></pre></div>
</details>
</div>
<p>And check if there are any parameters that are still significant for
the normality test.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>shap_results<span class="sc">$</span>parameter[shap_results_norm<span class="sc">$</span>tranform <span class="sc">==</span> <span class="cn">TRUE</span>]</span></code></pre></div>
<pre><code>[1] &quot;Al&quot; &quot;Fe&quot;</code></pre>
</div>
<p>Ok. Looks like <code>bestNormalize</code> was unable to find a
suitable transformation for <code>Al</code> and <code>Fe</code>. This is
likely because there is very little variation in these metadata and/or
there are too few significant digits.</p>
<h2 id="normalized-metadata-1">Normalized Metadata</h2>
<p>Finally, here is a new summary table that includes all of the
normalized data.</p>
<p></br></p>
<div class="layout-chunk" data-layout="l-body">
<a onclick="fetch(&#39;data:text/csv;base64,U2FtcGxlX0lELEFUQVAsQVNULEgyTyxOLFAsQWwsQ2EsRmUsSyxNZyxNbixOYSxURUIsRUNFQyxwSCxtaW5QTzQsbWluTkg0LG1pbk5PMyxtaW5USU4sTkg0LE5PMyxQTzQsRE9DLERPTixET0NOLG1pY0MsbWljTixtaWNQLG1pY0NOLG1pY0NQLG1pY05QLEFHX2FzZSxCR19hc2UsQlBfYXNlLENFX2FzZSxQX2FzZSxOX2FzZSxTX2FzZSxYWV9hc2UsQUdfUTEwLEJHX1ExMCxCUF9RMTAsQ0VfUTEwLFBfUTEwLE5fUTEwLFNfUTEwLFhZX1ExMCxDTzIsTFBfYXNlLExQX1ExMCxQWF9hc2UsUFhfUTEwLENVRWNuLENVRWNwLE5VRSxQVUUsVG1pbixTSSxlbnpDTixlbnpDUCxlbnpOUApQMTBfRDAwXzAxMF9DMEUsMjYsLTEuMTk4Mzc5NzAyMzA2OTI0NSwtMC4xOTQwMjgxNDI0MjM5MjYzLDAuMjYsMC4zMiwxLjg4Mjc4NjMyNTAzMjE2MjEsMzcuMDYsLTAuMDc0MDYwNzE4NzkxOTU2OSwxLjM4LDIxLjQzLDAuMDcsMC4xMywxLjE5ODM3OTcwMjMwNjkyNDUsMS4xOTgzNzk3MDIzMDY5MjQ1LDYuMjgsNC4wOCw0Ljc1LDAuNjE1MTQxMTA0NTk1OTczNCwwLjYxNTE0MTEwNDU5NTk3MzQsMy40NCw0LjUzLDkuNDUsMC42MTUxNDExMDQ1OTU5NzM0LDQuOTEsMTQuNjcsMzM0LjkzLDcyLjY0LDY0LjIzLDQuNDksNS41NCwxLjE3LDAuMjgsMC42MTUxNDExMDQ1OTU5NzM0LC0xLjE5ODM3OTcwMjMwNjkyNDUsMC44NiwtMC45NzU3NTkxNzkzMzg1NTM3LC0wLjM5NTcyNTI5NTgxNDQ4NzMsNC41NCwtMC44Njk0MjM3NzMyODg4ODYsMS41NCwtMC4zOTU3MjUyOTU4MTQ0ODczLDEuNDEsLTEuMDIwMDc2MjMyNzg2MjAxNiwxLjI3LDEuNDcsMS4zMywxLjY1LC0wLjM3MDE0NDY0ODgxNjkyMzQsMzIuMjIsMS44LC0wLjE5NDAyODE0MjQyMzkyNjMsLTAuOTA5OTc2OTk0MTM4Mzk2NCwwLjIyLC0xLjAyMDA3NjIzMjc4NjIwMTYsMC44NywxLjE5ODM3OTcwMjMwNjkyNDUsLTIuNDYsMS4yOSwwLjUyMzEsMC42NjA3LDEuMjYzClAwMl9EMDBfMDEwX0MwQSwyNiwtMC44Njk0MjM3NzMyODg4ODYsMC4xOTQwMjgxNDI0MjM5MjYyLDAuMzM2NywwLjQzLDAuNTk0NjE4MzM1NDE5MTc5NCwzNi42NSwtMC4wNzQwNjA3MTg3OTE5NTY5LDAuNjksOC4xNiwwLjA0LDAuMTEsMC4xOTQwMjgxNDI0MjM5MjYyLDAuMTk0MDI4MTQyNDIzOTI2Miw2LjE4LDEuNDIsMy45MiwwLjE5NDAyODE0MjQyMzkyNjIsMC4xOTQwMjgxNDI0MjM5MjYyLDQuODEsMy4xMyw3LjU4LDEuMTk4Mzc5NzAyMzA2OTI0NSw4LjIyLDkuNDQsNDQ0LjcyLDExMC4xMyw2NS4wMyw0LjQyLDguMTMsMi4zNywwLjI0LDAsLTAuMzk1NzI1Mjk1ODE0NDg3MywxLjA5LC0wLjg5OTc5MDc4MzE4OTU4NCwtMC4xOTQwMjgxNDI0MjM5MjYzLDMuOCwtMC4yOTMzODEyMzIxMjExOTMyNywxLjUxLC0xLjQyNjA3Njg3MjI3Mjg0NzIsMS4zNCwtMC4zOTU3MjUyOTU4MTQ0ODczLDEuMjIsMS41NCwxLjIzLDEuNTksLTAuMzU0OTM3MTYyNDg4MTY1ODcsMzguNjEsMS44MSwtMC42MTUxNDExMDQ1OTU5NzM2LDEuMDMwMzY0NDYxNDc5ODc5NSwwLjIyLDAuMzk1NzI1Mjk1ODE0NDg3MywwLjg3LC0wLjUwMjQwMjIyMzM3MzM1NTQsMC4xNCwxLjQ0LDAuNTAyNCwwLjY1NTQsMS4zMDQ0ClAwNF9EMDBfMDEwX0MwQiwyNiwtMC4zOTU3MjUyOTU4MTQ0ODczLDAuMzk1NzI1Mjk1ODE0NDg3MywwLjMwMzMsMC4zMywtMC42OTM2Nzg0NTcwNDAyMzI4LDI5LjIzLDAuODg5NjkxNzUzNzUxOTM3NSwxLjE4LDE0LjU5LDAuMTIsMC4xNCwwLDAsNS43MywxLjUsMy4xNywtMC4zOTU3MjUyOTU4MTQ0ODczLC0wLjI5MzM4MTIzMjEyMTE5MzI3LDUuNTcsMy4yMiw3Ljk1LDAuMTk0MDI4MTQyNDIzOTI2Miw2LjMyLDEwLjY3LDQ0MC42LDg2LjE5LDgxLjQ1LDUuMTQsNS4zOSwxLjA5LDAuMjIsMC4zOTU3MjUyOTU4MTQ0ODczLDAsMS4wOSwwLjE2ODQ4NDcxMDI0NzgyMTQ3LDAuMTk0MDI4MTQyNDIzOTI2Miw0LjkyLDAuMDk2NTU4NjE1Mjg5NjM5MDgsMS41MSwwLjM5NTcyNTI5NTgxNDQ4NzMsMS41OCwxLjE5ODM3OTcwMjMwNjkyNDUsMS4zNywxLjg1LDEuMzksMS43NiwtMC42OTk1NzcyNzA1Mzg0MDU1LDI5LjUxLDIuMTQsLTEuNzY4ODI1MDM4NTE4NzA1OSwtMC4yNTc3ODY2OTc0OTg3NDYxLDAuMjUsMCwwLjg1LDAuMTk0MDI4MTQyNDIzOTI2MiwtMi42MywxLjI1LDAuNTU1LDAuNjE3MywxLjExMjMKUDA2X0QwMF8wMTBfQzBDLDI2LC0wLjYxNTE0MTEwNDU5NTk3MzYsMCwwLjMzMzMsMC4zLC0wLjY5MzY3ODQ1NzA0MDIzMjgsMzIuMDcsLTEuMDM3OTA5NTU2MTQ0NDE1NCwwLjU3LDIxLjMyLDAuMDYsMC4xNCwwLjg2OTQyMzc3MzI4ODg4NiwwLjg2OTQyMzc3MzI4ODg4Niw1LjkzLDAuNzUsMS44MywtMC42MTUxNDExMDQ1OTU5NzM2LC0wLjYxNTE0MTEwNDU5NTk3MzYsMi45MiwyLjI3LDcuMDQsMCw1LjQyLDExLjA5LDM5MC42Niw3Mi42MSw4NS43LDUuMjYsNC41LDAuODMsMC4yMSwtMS4xOTgzNzk3MDIzMDY5MjQ1LC0wLjYxNTE0MTEwNDU5NTk3MzYsMC43NSwtMC45Nzg2MjYwODk2MDMzODU5LC0xLjc2ODgyNTAzODUxODcwNTksNS40NSwtMS43Njg4MjUwMzg1MTg3MDU5LDEuODMsLTEuNDI2MDc2ODcyMjcyODQ3MiwxLjQ0LDEuNzY4ODI1MDM4NTE4NzA1OSwxLjI0LDEuNiwxLjQ3LDEuNjMsLTAuNjMwMTk3NDMwNzEyMTA4NCwyNy43OCwxLjg1LC0wLjg2OTQyMzc3MzI4ODg4NiwwLjkwMTQyODk5MjExNzg3ODksMC4yNywtMS4wMjAwNzYyMzI3ODYyMDE2LDAuODMsMS4xOTgzNzk3MDIzMDY5MjQ1LC0wLjEzLDEuNDIsMC40NjI0LDAuNTU1NiwxLjIwMTcKUDA4X0QwMF8wMTBfQzBELDI2LC0xLjc2ODgyNTAzODUxODcwNTksMS43Njg4MjUwMzg1MTg3MDU5LDAuMjQzMywwLjI3LC0wLjY5MzY3ODQ1NzA0MDIzMjgsMjUuNDksLTEuMDM3OTA5NTU2MTQ0NDE1NCwxLjg2LDE0LjkzLDAuMDIsMC4wOCwtMS4xOTgzNzk3MDIzMDY5MjQ1LC0xLjE5ODM3OTcwMjMwNjkyNDUsNi4wMSwzLjY3LDQuMzMsMS43Njg4MjUwMzg1MTg3MDU5LDEuNzY4ODI1MDM4NTE4NzA1OSwyLjA0LDMuNzEsNS45NywtMC4zOTU3MjUyOTU4MTQ0ODczLDUuMjIsMTEuNTcsMjc3LjM3LDU2LjU1LDMzLjQsNC43MiwxMS41NSwyLjQ1LDAuMTUsLTAuODY5NDIzNzczMjg4ODg2LC0xLjc2ODgyNTAzODUxODcwNTksMC42OCwtMS41NTU0NDE1NTAwNTQ5OTMyLC0wLjYxNTE0MTEwNDU5NTk3MzYsMy41NiwtMS4xOTgzNzk3MDIzMDY5MjQ1LDIuMDgsMS43Njg4MjUwMzg1MTg3MDU5LDEuNzQsMC42MTUxNDExMDQ1OTU5NzM0LDEuNDgsMS42OSwxLjQ4LDEuODMsLTEuNTUxODA3MTA4MjM3Mzc1OSwyMS45NiwyLjA3LC0xLjE5ODM3OTcwMjMwNjkyNDUsMi4yMTM0ODY1NTYyNTM4NTcsMC4yNCwwLjg2OTQyMzc3MzI4ODg4NiwwLjg1LC0wLjUwMjQwMjIyMzM3MzM1NTQsMCwxLjU0LDAuNTA1OCwwLjYwMzcsMS4xOTM1ClAwMV9EMDBfMDEwX1czQSwyOSwwLjM5NTcyNTI5NTgxNDQ4NzMsMC44Njk0MjM3NzMyODg4ODYsMC40MjY3LDAuMzUsLTAuNjkzNjc4NDU3MDQwMjMyOCwzMS40MywtMC4wNzQwNjA3MTg3OTE5NTY5LDEuNzIsOS45OCwwLjA0LDAuMTUsLTAuNzM2MzE1OTE3Mzc2MTI5NCwtMC43MzYzMTU5MTczNzYxMjk0LDYuMDEsMS4zMywzLjY3LDEuMTk4Mzc5NzAyMzA2OTI0NSwxLjE5ODM3OTcwMjMwNjkyNDUsOC4wMyw0LjY3LDkuNTIsMS43Njg4MjUwMzg1MTg3MDU5LDExLjY2LDExLjE1LDY5MC4xMSwxMzUuNDgsODcuOTgsNC42MSw4LjYxLDEuNzQsMC4yNiwtMC4zOTU3MjUyOTU4MTQ0ODczLDAuNjE1MTQxMTA0NTk1OTczNCwxLDAuMTkyNzMxMTM2MDAwOTYxOTUsMS4xOTgzNzk3MDIzMDY5MjQ1LDYuMDgsMC4zOTU3MjUyOTU4MTQ0ODczLDEuNzcsLTAuMTk0MDI4MTQyNDIzOTI2MywxLjM5LDAuODY5NDIzNzczMjg4ODg2LDEuMzcsMS40NiwxLjMsMS43MiwwLjcyMzA1NTMxMTMxNzA5MjEsNTIuOCwxLjc2LDAuMzk1NzI1Mjk1ODE0NDg3MywtMC4zNzQzOTE1MjgzNTU3NzA2LDAuMzIsMC4zOTU3MjUyOTU4MTQ0ODczLDAuNzcsLTAuNTAyNDAyMjIzMzczMzU1NCwwLjA3LDEuNTEsMC40NjE0LDAuNTkxMSwxLjI4MTIKUDAzX0QwMF8wMTBfVzNCLDI5LDAuMTk0MDI4MTQyNDIzOTI2MiwxLjE5ODM3OTcwMjMwNjkyNDUsMC4zMiwwLjM3LDAuNTk0NjE4MzM1NDE5MTc5NCwyNy4xOSwtMC4wNzQwNjA3MTg3OTE5NTY5LDAuODUsMTYuNTEsMC4wNiwwLjEyLC0wLjI5MzM4MTIzMjEyMTE5MzI3LC0wLjI5MzM4MTIzMjEyMTE5MzI3LDUuODYsMi44MywzLjMzLDAuODY5NDIzNzczMjg4ODg2LDAuODY5NDIzNzczMjg4ODg2LDMuMTEsMi41Nyw4LjY2LDAuMzk1NzI1Mjk1ODE0NDg3Myw2LjQ4LDEwLjEyLDM2NC42Miw2Ni40LDcwLjY4LDUuMDcsNi43LDEuMzEsMC4zMywwLjE5NDAyODE0MjQyMzkyNjIsMC4xOTQwMjgxNDI0MjM5MjYyLDEuMjYsLTAuMDAyMzQ5MTgzNTk1OTMxMTYxNSwwLDUuNzIsMC42MTUxNDExMDQ1OTU5NzM0LDIuNDgsLTAuNzM2MzE1OTE3Mzc2MTI5NCwxLjQyLDAuMzk1NzI1Mjk1ODE0NDg3MywxLjI3LDEuNTQsMS4yNywxLjcyLC0wLjU3NTkwMjA0MTQwMTgyMSwzMi4xLDIsMCwwLjUyMTAyMDkzMTM5MjA3NjYsMC4yNiwtMC4yOTMzODEyMzIxMjExOTMyNywwLjg0LDAuMTk0MDI4MTQyNDIzOTI2MiwtMC4yOSwxLjQ5LDAuNTU2NSwwLjY0MTIsMS4xNTIyClAwN19EMDBfMDEwX1czRCwyOSwtMC4xOTQwMjgxNDI0MjM5MjYzLDAuNjE1MTQxMTA0NTk1OTczNCwwLjQzNjcsMC4zNSwtMC42OTM2Nzg0NTcwNDAyMzI4LDI4LjEzLC0wLjA3NDA2MDcxODc5MTk1NjksMS42LDE4Ljg3LDAuMDcsMC4xLDAuNTAyNDAyMjIzMzczMzU1NCwwLjUwMjQwMjIyMzM3MzM1NTQsNi4yMSwxLDIuNDIsLTAuMTk0MDI4MTQyNDIzOTI2MywtMC4yOTMzODEyMzIxMjExOTMyNyw0LjI4LDUuMDcsOS4xNSwwLjg2OTQyMzc3MzI4ODg4Niw4LjQ3LDkuOTMsMzk2LjQyLDczLjczLDkzLjEzLDQuNzIsNC42NiwwLjk4LDAuMzIsLTAuMTk0MDI4MTQyNDIzOTI2MywwLjM5NTcyNTI5NTgxNDQ4NzMsMS4wNywwLjU2NjQ2MjQyNTQwNzE3NzQsMC4zOTU3MjUyOTU4MTQ0ODczLDUuODYsMC4wOTY1NTg2MTUyODk2MzkwOCwxLjcyLDAuMTk0MDI4MTQyNDIzOTI2MiwxLjQ2LC0xLjc2ODgyNTAzODUxODcwNTksMS4yOCwxLjM2LDEuMywxLjYzLC0wLjE0MDY1NDc2MDE0OTAwMSw0Mi40LDEuOTYsLTAuMzk1NzI1Mjk1ODE0NDg3MywtMC44MzYzNzIwOTY3NjczOTk5LDAuMjcsLTEuNzY4ODI1MDM4NTE4NzA1OSwwLjgzLDEuMTk4Mzc5NzAyMzA2OTI0NSwwLjY1LDEuNjEsMC40OTQxLDAuNTc2MiwxLjE2NjIKUDA5X0QwMF8wMTBfVzNFLDI5LDAsLTAuMzk1NzI1Mjk1ODE0NDg3MywwLjI4MzMsMC4zNiwxLjg4Mjc4NjMyNTAzMjE2MjEsMzkuNzksMi44MTY1MjI2NjUwMTY5NjQsMS4wOSwyMC42NCwwLjA4LDAuMTksMS43Njg4MjUwMzg1MTg3MDU5LDEuNzY4ODI1MDM4NTE4NzA1OSw2LjEsMi41OCwzLjUsLTEuMTk4Mzc5NzAyMzA2OTI0NSwtMC44Njk0MjM3NzMyODg4ODYsMi4wMywyLjksOC4yOCwtMC44Njk0MjM3NzMyODg4ODYsNS41NiwxMi4yMSwzOTIuNTYsNjIuMzcsNjYuNjUsNS43OCw3LjM0LDEuMTksMC4yLC0wLjYxNTE0MTEwNDU5NTk3MzYsLTAuODY5NDIzNzczMjg4ODg2LDAuODYsLTAuNDQ4ODczOTAwMzQzMTE4NiwtMS4xOTgzNzk3MDIzMDY5MjQ1LDUuMjYsLTAuMjkzMzgxMjMyMTIxMTkzMjcsMS42NywtMC43MzYzMTU5MTczNzYxMjk0LDEuNTYsLTEuMDIwMDc2MjMyNzg2MjAxNiwxLjM1LDEuNDgsMS4zMiwxLjg0LDAuNDE3ODQ5NjMzODEzODAwMjUsMzAuMzcsMS45LDAuMTk0MDI4MTQyNDIzOTI2MiwwLjQ0NTk4NDY4NjQwMjQyOTU1LDAuMjYsMC4zOTU3MjUyOTU4MTQ0ODczLDAuODQsLTAuNTAyNDAyMjIzMzczMzU1NCwtMC4yNCwxLjUxLDAuNTExMiwwLjYwNjQsMS4xODYyClAwMV9EMDBfMDEwX1c4QSwzNCwwLjg2OTQyMzc3MzI4ODg4NiwtMC42MTUxNDExMDQ1OTU5NzM2LDAuNDI2NywwLjM1LC0wLjY5MzY3ODQ1NzA0MDIzMjgsMzEuNDMsLTAuMDc0MDYwNzE4NzkxOTU2OSwxLjcyLDkuOTgsMC4wNCwwLjE1LC0wLjczNjMxNTkxNzM3NjEyOTQsLTAuNzM2MzE1OTE3Mzc2MTI5NCw2LjAxLDAuMTIsMS42NSwtMS43Njg4MjUwMzg1MTg3MDU5LC0xLjc2ODgyNTAzODUxODcwNTksNC4wOCwyLjY1LDguNTUsLTEuMTk4Mzc5NzAyMzA2OTI0NSw0LjIsOS40NSw0NjksODQsNTUsNS41OCw4LjQ4LDEuNTIsMC4xNSwwLjg2OTQyMzc3MzI4ODg4NiwwLjg2OTQyMzc3MzI4ODg4NiwyLjA3LDAuODE3ODU1OTE1OTY2NzM3NSwwLjYxNTE0MTEwNDU5NTk3MzQsNi43LDEuNzY4ODI1MDM4NTE4NzA1OSwyLjAxLDEuMTk4Mzc5NzAyMzA2OTI0NSwxLjUxLC0wLjYxNTE0MTEwNDU5NTk3MzYsMS4zOSwxLjU2LDEuNjUsMS44NiwtMC42MzAxOTc0MzA3MTIxMDg0LDQwLjY5LDEuNzEsMC42MTUxNDExMDQ1OTU5NzM0LC0xLjQ4NzkxMjc2ODk2MjAxODksMC4yMywtMC4yOTMzODEyMzIxMjExOTMyNywwLjg3LDAuMTk0MDI4MTQyNDIzOTI2MiwyLjE5LDIuMywwLjY0NTYsMC43MTY2LDEuMTEKUDAzX0QwMF8wMTBfVzhCLDM0LDEuNzY4ODI1MDM4NTE4NzA1OSwtMC44Njk0MjM3NzMyODg4ODYsMC4zMiwwLjM3LDAuNTk0NjE4MzM1NDE5MTc5NCwyNy4xOSwtMC4wNzQwNjA3MTg3OTE5NTY5LDAuODUsMTYuNTEsMC4wNiwwLjEyLC0wLjI5MzM4MTIzMjEyMTE5MzI3LC0wLjI5MzM4MTIzMjEyMTE5MzI3LDUuODYsMC4yLDEuMjgsMCwwLDIuNSwxLjA2LDIuOCwtMS43Njg4MjUwMzg1MTg3MDU5LDIuNSwxMy4yOSwxMTcsMjAsMTEsNS44NSwxMC41NCwxLjgsMC4wMiwtMS43Njg4MjUwMzg1MTg3MDU5LC0wLjE5NDAyODE0MjQyMzkyNjMsMC42NSwtMC4yMDA3NzM2MDM3MTY2Mzg1LC0wLjg2OTQyMzc3MzI4ODg4NiwxLjI4LC0wLjYxNTE0MTEwNDU5NTk3MzYsMS40OSwwLjYxNTE0MTEwNDU5NTk3MzQsMS41NSwtMC4xOTQwMjgxNDI0MjM5MjYzLDEuNTEsMS43NSwxLjM5LDEuODksMi4zODk1MDcwMDM2NDg2ODcsMTMuOTQsMS43NywwLjg2OTQyMzc3MzI4ODg4NiwtMC44MzYzNzIwOTY3NjczOTk5LDAuMjksMS43Njg4MjUwMzg1MTg3MDU5LDAuODEsLTEuNzY4ODI1MDM4NTE4NzA1OSwwLjYzLDEuNzIsMC41MzAyLDAuNDkxOCwwLjkyNzcKUDA1X0QwMF8wMTBfVzhDLDM0LDEuMTk4Mzc5NzAyMzA2OTI0NSwtMS4xOTgzNzk3MDIzMDY5MjQ1LDAuMzMzMywwLjMzLC0wLjY5MzY3ODQ1NzA0MDIzMjgsMjYuMTQsLTEuMDM3OTA5NTU2MTQ0NDE1NCwwLjY3LDE0LjgzLDAuMDUsMCwtMS43Njg4MjUwMzg1MTg3MDU5LC0xLjc2ODgyNTAzODUxODcwNTksNS44NywwLjExLDEuMTgsMC4zOTU3MjUyOTU4MTQ0ODczLDAuMzk1NzI1Mjk1ODE0NDg3MywzLjkxLDIuMyw0LjI1LC0wLjE5NDAyODE0MjQyMzkyNjMsNC4zLDEwLjQ2LDQ0MCw5Nyw1Niw0LjU0LDcuOTEsMS43NCwwLjE1LDEuNzY4ODI1MDM4NTE4NzA1OSwxLjc2ODgyNTAzODUxODcwNTksMS41LDEuODM5NTE0Mjk4OTk2MTY2NCwwLjg2OTQyMzc3MzI4ODg4Niw1LjU3LDEuMTk4Mzc5NzAyMzA2OTI0NSwxLjczLDAuODY5NDIzNzczMjg4ODg2LDEuNDIsMCwxLjQ4LDEuNjgsMS42LDEuODgsMS4wODE3MjYxNTY5ODkyNTk4LDMyLjY1LDEuNjcsMS4xOTgzNzk3MDIzMDY5MjQ1LC0wLjMxNTMwNDgxNzExMzU0OTIsMC4xOSwxLjE5ODM3OTcwMjMwNjkyNDUsMC45LC0xLjE5ODM3OTcwMjMwNjkyNDUsMC45NCwyLjA4LDAuNjkzMSwwLjY0MTIsMC45MjUxClAwN19EMDBfMDEwX1c4RCwzNCwwLjYxNTE0MTEwNDU5NTk3MzQsLTEuNzY4ODI1MDM4NTE4NzA1OSwwLjQzNjcsMC4zNSwtMC42OTM2Nzg0NTcwNDAyMzI4LDI4LjEzLC0wLjA3NDA2MDcxODc5MTk1NjksMS42LDE4Ljg3LDAuMDcsMC4xLDAuNTAyNDAyMjIzMzczMzU1NCwwLjUwMjQwMjIyMzM3MzM1NTQsNi4yMSwwLjAyLDIuNiwtMC44Njk0MjM3NzMyODg4ODYsLTEuMTk4Mzc5NzAyMzA2OTI0NSw4LjE5LDYuMzksNS42MiwtMC42MTUxNDExMDQ1OTU5NzM2LDMuNywxMS45OCw2NzYsMTQ3LDk0LDQuNiw3LjE4LDEuNTYsMC4zOSwxLjE5ODM3OTcwMjMwNjkyNDUsMS4xOTgzNzk3MDIzMDY5MjQ1LDEuNTMsMS40NzY1NjU4MDMyMjMzODI0LDEuNzY4ODI1MDM4NTE4NzA1OSwxMC42OCwwLjg2OTQyMzc3MzI4ODg4NiwxLjMxLDAsMS40MiwwLjE5NDAyODE0MjQyMzkyNjIsMS4zMywxLjU0LDEuNTEsMS45MSwwLjM0MTI3OTc0NzI4NzA2OTU2LDU3LjEzLDEuNCwxLjc2ODgyNTAzODUxODcwNTksLTAuMDk0MTY4NjI4MDQyODIwNzgsMC4yNiwtMC42MTUxNDExMDQ1OTU5NzM2LDAuODQsMC42MTUxNDExMDQ1OTU5NzM0LDEuNDgsMS44MSwwLjU5MzMsMC42NjI4LDEuMTE3Mwo=&#39;).then(res =&gt; res.blob()).then(blob =&gt; {&#10;      const downloadURL = window.URL.createObjectURL(blob);&#10;      const a = document.createElement(&#39;a&#39;);&#10;      document.body.appendChild(a);&#10;      a.href = downloadURL;&#10;      a.download = &#39;normalized_metadata.csv&#39;; a.click();&#10;      window.URL.revokeObjectURL(downloadURL);&#10;      document.body.removeChild(a);&#10;    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
<p><small><strong>(ITS) Table 3 | Results of bestNormalize function
applied to each parameter.</strong></small></p>
<div class="layout-chunk" data-layout="l-page">
<div id="htmlwidget-44a11444c376f1ec0e85" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-44a11444c376f1ec0e85">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P10_D00_010_C0E","P02_D00_010_C0A","P04_D00_010_C0B","P06_D00_010_C0C","P08_D00_010_C0D","P01_D00_010_W3A","P03_D00_010_W3B","P07_D00_010_W3D","P09_D00_010_W3E","P01_D00_010_W8A","P03_D00_010_W8B","P05_D00_010_W8C","P07_D00_010_W8D"],"ATAP":[26,26,26,26,26,29,29,29,29,34,34,34,34],"AST":[-1.198,-0.869,-0.396,-0.615,-1.769,0.396,0.194,-0.194,0,0.869,1.769,1.198,0.615],"H2O":[-0.194,0.194,0.396,0,1.769,0.869,1.198,0.615,-0.396,-0.615,-0.869,-1.198,-1.769],"N":[0.26,0.337,0.303,0.333,0.243,0.427,0.32,0.437,0.283,0.427,0.32,0.333,0.437],"P":[0.32,0.43,0.33,0.3,0.27,0.35,0.37,0.35,0.36,0.35,0.37,0.33,0.35],"Al":[1.883,0.595,-0.694,-0.694,-0.694,-0.694,0.595,-0.694,1.883,-0.694,0.595,-0.694,-0.694],"Ca":[37.06,36.65,29.23,32.07,25.49,31.43,27.19,28.13,39.79,31.43,27.19,26.14,28.13],"Fe":[-0.074,-0.074,0.89,-1.038,-1.038,-0.074,-0.074,-0.074,2.817,-0.074,-0.074,-1.038,-0.074],"K":[1.38,0.69,1.18,0.57,1.86,1.72,0.85,1.6,1.09,1.72,0.85,0.67,1.6],"Mg":[21.43,8.16,14.59,21.32,14.93,9.98,16.51,18.87,20.64,9.98,16.51,14.83,18.87],"Mn":[0.07,0.04,0.12,0.06,0.02,0.04,0.06,0.07,0.08,0.04,0.06,0.05,0.07],"Na":[0.13,0.11,0.14,0.14,0.08,0.15,0.12,0.1,0.19,0.15,0.12,0,0.1],"TEB":[1.198,0.194,0,0.869,-1.198,-0.736,-0.293,0.502,1.769,-0.736,-0.293,-1.769,0.502],"ECEC":[1.198,0.194,0,0.869,-1.198,-0.736,-0.293,0.502,1.769,-0.736,-0.293,-1.769,0.502],"pH":[6.28,6.18,5.73,5.93,6.01,6.01,5.86,6.21,6.1,6.01,5.86,5.87,6.21],"minPO4":[4.08,1.42,1.5,0.75,3.67,1.33,2.83,1,2.58,0.12,0.2,0.11,0.02],"minNH4":[4.75,3.92,3.17,1.83,4.33,3.67,3.33,2.42,3.5,1.65,1.28,1.18,2.6],"minNO3":[0.615,0.194,-0.396,-0.615,1.769,1.198,0.869,-0.194,-1.198,-1.769,0,0.396,-0.869],"minTIN":[0.615,0.194,-0.293,-0.615,1.769,1.198,0.869,-0.293,-0.869,-1.769,0,0.396,-1.198],"NH4":[3.44,4.81,5.57,2.92,2.04,8.03,3.11,4.28,2.03,4.08,2.5,3.91,8.19],"NO3":[4.53,3.13,3.22,2.27,3.71,4.67,2.57,5.07,2.9,2.65,1.06,2.3,6.39],"PO4":[9.45,7.58,7.95,7.04,5.97,9.52,8.66,9.15,8.28,8.55,2.8,4.25,5.62],"DOC":[0.615,1.198,0.194,0,-0.396,1.769,0.396,0.869,-0.869,-1.198,-1.769,-0.194,-0.615],"DON":[4.91,8.22,6.32,5.42,5.22,11.66,6.48,8.47,5.56,4.2,2.5,4.3,3.7],"DOCN":[14.67,9.44,10.67,11.09,11.57,11.15,10.12,9.93,12.21,9.45,13.29,10.46,11.98],"micC":[334.93,444.72,440.6,390.66,277.37,690.11,364.62,396.42,392.56,469,117,440,676],"micN":[72.64,110.13,86.19,72.61,56.55,135.48,66.4,73.73,62.37,84,20,97,147],"micP":[64.23,65.03,81.45,85.7,33.4,87.98,70.68,93.13,66.65,55,11,56,94],"micCN":[4.49,4.42,5.14,5.26,4.72,4.61,5.07,4.72,5.78,5.58,5.85,4.54,4.6],"micCP":[5.54,8.13,5.39,4.5,11.55,8.61,6.7,4.66,7.34,8.48,10.54,7.91,7.18],"micNP":[1.17,2.37,1.09,0.83,2.45,1.74,1.31,0.98,1.19,1.52,1.8,1.74,1.56],"AG_ase":[0.28,0.24,0.22,0.21,0.15,0.26,0.33,0.32,0.2,0.15,0.02,0.15,0.39],"BG_ase":[0.615,0,0.396,-1.198,-0.869,-0.396,0.194,-0.194,-0.615,0.869,-1.769,1.769,1.198],"BP_ase":[-1.198,-0.396,0,-0.615,-1.769,0.615,0.194,0.396,-0.869,0.869,-0.194,1.769,1.198],"CE_ase":[0.86,1.09,1.09,0.75,0.68,1,1.26,1.07,0.86,2.07,0.65,1.5,1.53],"P_ase":[-0.976,-0.9,0.168,-0.979,-1.555,0.193,-0.002,0.566,-0.449,0.818,-0.201,1.84,1.477],"N_ase":[-0.396,-0.194,0.194,-1.769,-0.615,1.198,0,0.396,-1.198,0.615,-0.869,0.869,1.769],"S_ase":[4.54,3.8,4.92,5.45,3.56,6.08,5.72,5.86,5.26,6.7,1.28,5.57,10.68],"XY_ase":[-0.869,-0.293,0.097,-1.769,-1.198,0.396,0.615,0.097,-0.293,1.769,-0.615,1.198,0.869],"AG_Q10":[1.54,1.51,1.51,1.83,2.08,1.77,2.48,1.72,1.67,2.01,1.49,1.73,1.31],"BG_Q10":[-0.396,-1.426,0.396,-1.426,1.769,-0.194,-0.736,0.194,-0.736,1.198,0.615,0.869,0],"BP_Q10":[1.41,1.34,1.58,1.44,1.74,1.39,1.42,1.46,1.56,1.51,1.55,1.42,1.42],"CE_Q10":[-1.0200762327862,-0.395725295814487,1.19837970230692,1.76882503851871,0.615141104595973,0.869423773288886,0.395725295814487,-1.76882503851871,-1.0200762327862,-0.615141104595974,-0.194028142423926,0,0.194028142423926],"P_Q10":[1.27,1.22,1.37,1.24,1.48,1.37,1.27,1.28,1.35,1.39,1.51,1.48,1.33],"N_Q10":[1.47,1.54,1.85,1.6,1.69,1.46,1.54,1.36,1.48,1.56,1.75,1.68,1.54],"S_Q10":[1.33,1.23,1.39,1.47,1.48,1.3,1.27,1.3,1.32,1.65,1.39,1.6,1.51],"XY_Q10":[1.65,1.59,1.76,1.63,1.83,1.72,1.72,1.63,1.84,1.86,1.89,1.88,1.91],"CO2":[-0.37,-0.355,-0.7,-0.63,-1.552,0.723,-0.576,-0.141,0.418,-0.63,2.39,1.082,0.341],"LP_ase":[32.22,38.61,29.51,27.78,21.96,52.8,32.1,42.4,30.37,40.69,13.94,32.65,57.13],"LP_Q10":[1.8,1.81,2.14,1.85,2.07,1.76,2,1.96,1.9,1.71,1.77,1.67,1.4],"PX_ase":[-0.194,-0.615,-1.769,-0.869,-1.198,0.396,0,-0.396,0.194,0.615,0.869,1.198,1.769],"PX_Q10":[-0.91,1.03,-0.258,0.901,2.213,-0.374,0.521,-0.836,0.446,-1.488,-0.836,-0.315,-0.094],"CUEcn":[0.22,0.22,0.25,0.27,0.24,0.32,0.26,0.27,0.26,0.23,0.29,0.19,0.26],"CUEcp":[-1.02,0.396,0,-1.02,0.869,0.396,-0.293,-1.769,0.396,-0.293,1.769,1.198,-0.615],"NUE":[0.87,0.87,0.85,0.83,0.85,0.77,0.84,0.83,0.84,0.87,0.81,0.9,0.84],"PUE":[1.198,-0.502,0.194,1.198,-0.502,-0.502,0.194,1.198,-0.502,0.194,-1.769,-1.198,0.615],"Tmin":[-2.46,0.14,-2.63,-0.13,0,0.07,-0.29,0.65,-0.24,2.19,0.63,0.94,1.48],"SI":[1.29,1.44,1.25,1.42,1.54,1.51,1.49,1.61,1.51,2.3,1.72,2.08,1.81],"enzCN":[0.523,0.502,0.555,0.462,0.506,0.461,0.556,0.494,0.511,0.646,0.53,0.693,0.593],"enzCP":[0.661,0.655,0.617,0.556,0.604,0.591,0.641,0.576,0.606,0.717,0.492,0.641,0.663],"enzNP":[1.263,1.304,1.112,1.202,1.194,1.281,1.152,1.166,1.186,1.11,0.928,0.925,1.117]},"columns":[{"accessor":"Sample_ID","name":"Sample ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P10_D00_010_C0E","P02_D00_010_C0A","P04_D00_010_C0B","P06_D00_010_C0C","P08_D00_010_C0D","P01_D00_010_W3A","P03_D00_010_W3B","P07_D00_010_W3D","P09_D00_010_W3E","P01_D00_010_W8A","P03_D00_010_W8B","P05_D00_010_W8C","P07_D00_010_W8D"],"header":"Sample ID","align":"left","headerStyle":{"borderRight":"1px solid #eee","fontSize":"0.9em"},"footerStyle":{"fontWeight":"bold"},"minWidth":150,"sticky":"left","style":{"borderRight":"1px solid #eee"}},{"accessor":"ATAP","name":"ATAP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["26","26","26","26","26","29","29","29","29","34","34","34","34"],"header":"ATAP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AST","name":"AST","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-1.198","-0.869","-0.396","-0.615","-1.769","0.396","0.194","-0.194","0.0","0.869","1.769","1.198","0.615"],"header":"AST","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"H2O","name":"H2O","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.194","0.194","0.396","0.0","1.769","0.869","1.198","0.615","-0.396","-0.615","-0.869","-1.198","-1.769"],"header":"H2O","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N","name":"N","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.26","0.337","0.303","0.333","0.243","0.427","0.32","0.437","0.283","0.427","0.32","0.333","0.437"],"header":"N","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P","name":"P","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.32","0.43","0.33","0.3","0.27","0.35","0.37","0.35","0.36","0.35","0.37","0.33","0.35"],"header":"P","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Al","name":"Al","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.883","0.595","-0.694","-0.694","-0.694","-0.694","0.595","-0.694","1.883","-0.694","0.595","-0.694","-0.694"],"header":"Al","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Ca","name":"Ca","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["37.06","36.65","29.23","32.07","25.49","31.43","27.19","28.13","39.79","31.43","27.19","26.14","28.13"],"header":"Ca","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Fe","name":"Fe","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.074","-0.074","0.89","-1.038","-1.038","-0.074","-0.074","-0.074","2.817","-0.074","-0.074","-1.038","-0.074"],"header":"Fe","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"K","name":"K","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.38","0.69","1.18","0.57","1.86","1.72","0.85","1.6","1.09","1.72","0.85","0.67","1.6"],"header":"K","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Mg","name":"Mg","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["21.43","8.16","14.59","21.32","14.93","9.98","16.51","18.87","20.64","9.98","16.51","14.83","18.87"],"header":"Mg","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Mn","name":"Mn","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.07","0.04","0.12","0.06","0.02","0.04","0.06","0.07","0.08","0.04","0.06","0.05","0.07"],"header":"Mn","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Na","name":"Na","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.13","0.11","0.14","0.14","0.08","0.15","0.12","0.1","0.19","0.15","0.12","0.0","0.1"],"header":"Na","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"TEB","name":"TEB","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.198","0.194","0.0","0.869","-1.198","-0.736","-0.293","0.502","1.769","-0.736","-0.293","-1.769","0.502"],"header":"TEB","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"ECEC","name":"ECEC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.198","0.194","0.0","0.869","-1.198","-0.736","-0.293","0.502","1.769","-0.736","-0.293","-1.769","0.502"],"header":"ECEC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"pH","name":"pH","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["6.28","6.18","5.73","5.93","6.01","6.01","5.86","6.21","6.1","6.01","5.86","5.87","6.21"],"header":"pH","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minPO4","name":"minPO4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.08","1.42","1.5","0.75","3.67","1.33","2.83","1.0","2.58","0.12","0.2","0.11","0.02"],"header":"minPO4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minNH4","name":"minNH4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.75","3.92","3.17","1.83","4.33","3.67","3.33","2.42","3.5","1.65","1.28","1.18","2.6"],"header":"minNH4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minNO3","name":"minNO3","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.615","0.194","-0.396","-0.615","1.769","1.198","0.869","-0.194","-1.198","-1.769","0.0","0.396","-0.869"],"header":"minNO3","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"minTIN","name":"minTIN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.615","0.194","-0.293","-0.615","1.769","1.198","0.869","-0.293","-0.869","-1.769","0.0","0.396","-1.198"],"header":"minTIN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NH4","name":"NH4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["3.44","4.81","5.57","2.92","2.04","8.03","3.11","4.28","2.03","4.08","2.5","3.91","8.19"],"header":"NH4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NO3","name":"NO3","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.53","3.13","3.22","2.27","3.71","4.67","2.57","5.07","2.9","2.65","1.06","2.3","6.39"],"header":"NO3","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PO4","name":"PO4","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["9.45","7.58","7.95","7.04","5.97","9.52","8.66","9.15","8.28","8.55","2.8","4.25","5.62"],"header":"PO4","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DOC","name":"DOC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.615","1.198","0.194","0.0","-0.396","1.769","0.396","0.869","-0.869","-1.198","-1.769","-0.194","-0.615"],"header":"DOC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DON","name":"DON","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.91","8.22","6.32","5.42","5.22","11.66","6.48","8.47","5.56","4.2","2.5","4.3","3.7"],"header":"DON","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"DOCN","name":"DOCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["14.67","9.44","10.67","11.09","11.57","11.15","10.12","9.93","12.21","9.45","13.29","10.46","11.98"],"header":"DOCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micC","name":"micC","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["334.93","444.72","440.6","390.66","277.37","690.11","364.62","396.42","392.56","469.0","117.0","440.0","676.0"],"header":"micC","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micN","name":"micN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["72.64","110.13","86.19","72.61","56.55","135.48","66.4","73.73","62.37","84.0","20.0","97.0","147.0"],"header":"micN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micP","name":"micP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["64.23","65.03","81.45","85.7","33.4","87.98","70.68","93.13","66.65","55.0","11.0","56.0","94.0"],"header":"micP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micCN","name":"micCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.49","4.42","5.14","5.26","4.72","4.61","5.07","4.72","5.78","5.58","5.85","4.54","4.6"],"header":"micCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micCP","name":"micCP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["5.54","8.13","5.39","4.5","11.55","8.61","6.7","4.66","7.34","8.48","10.54","7.91","7.18"],"header":"micCP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"micNP","name":"micNP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.17","2.37","1.09","0.83","2.45","1.74","1.31","0.98","1.19","1.52","1.8","1.74","1.56"],"header":"micNP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AG_ase","name":"AG_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.28","0.24","0.22","0.21","0.15","0.26","0.33","0.32","0.2","0.15","0.02","0.15","0.39"],"header":"AG ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BG_ase","name":"BG_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.615","0.0","0.396","-1.198","-0.869","-0.396","0.194","-0.194","-0.615","0.869","-1.769","1.769","1.198"],"header":"BG ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BP_ase","name":"BP_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-1.198","-0.396","0.0","-0.615","-1.769","0.615","0.194","0.396","-0.869","0.869","-0.194","1.769","1.198"],"header":"BP ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CE_ase","name":"CE_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.86","1.09","1.09","0.75","0.68","1.0","1.26","1.07","0.86","2.07","0.65","1.5","1.53"],"header":"CE ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P_ase","name":"P_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.976","-0.9","0.168","-0.979","-1.555","0.193","-0.002","0.566","-0.449","0.818","-0.201","1.84","1.477"],"header":"P ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N_ase","name":"N_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.396","-0.194","0.194","-1.769","-0.615","1.198","0.0","0.396","-1.198","0.615","-0.869","0.869","1.769"],"header":"N ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"S_ase","name":"S_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["4.54","3.8","4.92","5.45","3.56","6.08","5.72","5.86","5.26","6.7","1.28","5.57","10.68"],"header":"S ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"XY_ase","name":"XY_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.869","-0.293","0.097","-1.769","-1.198","0.396","0.615","0.097","-0.293","1.769","-0.615","1.198","0.869"],"header":"XY ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"AG_Q10","name":"AG_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.54","1.51","1.51","1.83","2.08","1.77","2.48","1.72","1.67","2.01","1.49","1.73","1.31"],"header":"AG Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BG_Q10","name":"BG_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.396","-1.426","0.396","-1.426","1.769","-0.194","-0.736","0.194","-0.736","1.198","0.615","0.869","0.0"],"header":"BG Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"BP_Q10","name":"BP_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.41","1.34","1.58","1.44","1.74","1.39","1.42","1.46","1.56","1.51","1.55","1.42","1.42"],"header":"BP Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CE_Q10","name":"CE_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-1.020076","-0.3957253","1.19838","1.768825","0.6151411","0.8694238","0.3957253","-1.768825","-1.020076","-0.6151411","-0.1940281","0.0","0.1940281"],"header":"CE Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"P_Q10","name":"P_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.27","1.22","1.37","1.24","1.48","1.37","1.27","1.28","1.35","1.39","1.51","1.48","1.33"],"header":"P Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"N_Q10","name":"N_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.47","1.54","1.85","1.6","1.69","1.46","1.54","1.36","1.48","1.56","1.75","1.68","1.54"],"header":"N Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"S_Q10","name":"S_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.33","1.23","1.39","1.47","1.48","1.3","1.27","1.3","1.32","1.65","1.39","1.6","1.51"],"header":"S Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"XY_Q10","name":"XY_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.65","1.59","1.76","1.63","1.83","1.72","1.72","1.63","1.84","1.86","1.89","1.88","1.91"],"header":"XY Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CO2","name":"CO2","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.37","-0.355","-0.7","-0.63","-1.552","0.723","-0.576","-0.141","0.418","-0.63","2.39","1.082","0.341"],"header":"CO2","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"LP_ase","name":"LP_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["32.22","38.61","29.51","27.78","21.96","52.8","32.1","42.4","30.37","40.69","13.94","32.65","57.13"],"header":"LP ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"LP_Q10","name":"LP_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.8","1.81","2.14","1.85","2.07","1.76","2.0","1.96","1.9","1.71","1.77","1.67","1.4"],"header":"LP Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PX_ase","name":"PX_ase","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.194","-0.615","-1.769","-0.869","-1.198","0.396","0.0","-0.396","0.194","0.615","0.869","1.198","1.769"],"header":"PX ase","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PX_Q10","name":"PX_Q10","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-0.91","1.03","-0.258","0.901","2.213","-0.374","0.521","-0.836","0.446","-1.488","-0.836","-0.315","-0.094"],"header":"PX Q10","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CUEcn","name":"CUEcn","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.22","0.22","0.25","0.27","0.24","0.32","0.26","0.27","0.26","0.23","0.29","0.19","0.26"],"header":"CUEcn","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"CUEcp","name":"CUEcp","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-1.02","0.396","0.0","-1.02","0.869","0.396","-0.293","-1.769","0.396","-0.293","1.769","1.198","-0.615"],"header":"CUEcp","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"NUE","name":"NUE","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.87","0.87","0.85","0.83","0.85","0.77","0.84","0.83","0.84","0.87","0.81","0.9","0.84"],"header":"NUE","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"PUE","name":"PUE","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.198","-0.502","0.194","1.198","-0.502","-0.502","0.194","1.198","-0.502","0.194","-1.769","-1.198","0.615"],"header":"PUE","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"Tmin","name":"Tmin","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["-2.46","0.14","-2.63","-0.13","0.0","0.07","-0.29","0.65","-0.24","2.19","0.63","0.94","1.48"],"header":"Tmin","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"SI","name":"SI","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.29","1.44","1.25","1.42","1.54","1.51","1.49","1.61","1.51","2.3","1.72","2.08","1.81"],"header":"SI","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzCN","name":"enzCN","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.523","0.502","0.555","0.462","0.506","0.461","0.556","0.494","0.511","0.646","0.53","0.693","0.593"],"header":"enzCN","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzCP","name":"enzCP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["0.661","0.655","0.617","0.556","0.604","0.591","0.641","0.576","0.606","0.717","0.492","0.641","0.663"],"header":"enzCP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}},{"accessor":"enzNP","name":"enzNP","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["1.263","1.304","1.112","1.202","1.194","1.281","1.152","1.166","1.186","1.11","0.928","0.925","1.117"],"header":"enzNP","align":"center","headerStyle":{"fontSize":"0.8em"},"footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,13],"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"8a4d641dcb3a670abee2f295258383fc"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="autocorrelation-tests-1">Autocorrelation Tests</h2>
<p>Next, we test the metadata for autocorrelations. Do we do this on the
original data or the transformed data? No idea, so let’s do both.</p>
<h3 id="split-metadata-1">Split Metadata</h3>
<p>We need to split the data into different groups.</p>
<ol type="A">
<li>Environmental and edaphic properties</li>
<li>Microbial functional responses</li>
<li>Temperature adaptation properties</li>
</ol>
<p>We first create lists of metadata parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>div <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PLOT&quot;</span>, <span class="st">&quot;TREAT&quot;</span>, <span class="st">&quot;TREAT_T&quot;</span>, <span class="st">&quot;PAIR&quot;</span>, <span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Shannon_exp&quot;</span>, </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;InvSimpson&quot;</span>, <span class="st">&quot;ATAP&quot;</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>edaphic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AST&quot;</span>, <span class="st">&quot;H2O&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;Al&quot;</span>, </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Ca&quot;</span>, <span class="st">&quot;Fe&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;Mg&quot;</span>, <span class="st">&quot;Mn&quot;</span>, <span class="st">&quot;Na&quot;</span>, <span class="st">&quot;TEB&quot;</span>, <span class="st">&quot;ECEC&quot;</span>, <span class="st">&quot;pH&quot;</span>, </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;NH4&quot;</span>, <span class="st">&quot;NO3&quot;</span>, <span class="st">&quot;PO4&quot;</span>, <span class="st">&quot;DOC&quot;</span>, <span class="st">&quot;DON&quot;</span>, <span class="st">&quot;DOCN&quot;</span>)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>soil_funct <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;micC&quot;</span>, <span class="st">&quot;micN&quot;</span>, <span class="st">&quot;micP&quot;</span>, <span class="st">&quot;micCN&quot;</span>, <span class="st">&quot;micCP&quot;</span>, <span class="st">&quot;micNP&quot;</span>, </span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;AG_ase&quot;</span>, <span class="st">&quot;BG_ase&quot;</span>, <span class="st">&quot;BP_ase&quot;</span>, <span class="st">&quot;CE_ase&quot;</span>, <span class="st">&quot;P_ase&quot;</span>, <span class="st">&quot;N_ase&quot;</span>, </span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;S_ase&quot;</span>, <span class="st">&quot;XY_ase&quot;</span>,  <span class="st">&quot;LP_ase&quot;</span>, <span class="st">&quot;PX_ase&quot;</span>, <span class="st">&quot;CO2&quot;</span>, </span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;enzCN&quot;</span>, <span class="st">&quot;enzCP&quot;</span>, <span class="st">&quot;enzNP&quot;</span>)</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>temp_adapt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AG_Q10&quot;</span>, <span class="st">&quot;BG_Q10&quot;</span>, <span class="st">&quot;BP_Q10&quot;</span>, <span class="st">&quot;CE_Q10&quot;</span>, <span class="st">&quot;P_Q10&quot;</span>, <span class="st">&quot;N_Q10&quot;</span>, </span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;S_Q10&quot;</span>, <span class="st">&quot;XY_Q10&quot;</span>, <span class="st">&quot;LP_Q10&quot;</span>, <span class="st">&quot;PX_Q10&quot;</span>, <span class="st">&quot;CUEcn&quot;</span>, <span class="st">&quot;CUEcp&quot;</span>, </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;NUE&quot;</span>, <span class="st">&quot;PUE&quot;</span>, <span class="st">&quot;Tmin&quot;</span>, <span class="st">&quot;SI&quot;</span>)</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>md_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;edaphic&quot;</span>, <span class="st">&quot;soil_funct&quot;</span>, <span class="st">&quot;temp_adapt&quot;</span>)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="co"># NoT uSed: minPO4, minNH4, minNO3, minTIN</span></span></code></pre></div>
</details>
</div>
<p>And then use the lists to split the data sets by metadata group.
Here, we do this for the original metadata and the metadata after
normalization.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb108"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>select_md <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;its18_select_mc&quot;</span>, <span class="st">&quot;its18_select_mc_norm&quot;</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> select_md) {</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>   <span class="co">#tmp_get &lt;- get(purrr::map_chr(i, ~ paste0(i, &quot;_mc&quot;)))</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>   tmp_md_all <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>map_loaded</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>   tmp_div <span class="ot">&lt;-</span> tmp_md_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(div))</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>   tmp_div <span class="ot">&lt;-</span> tmp_div <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="do">## edaphic      </span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>   tmp_sub_edaphic <span class="ot">&lt;-</span> tmp_md_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(edaphic))</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>   tmp_sub_edaphic <span class="ot">&lt;-</span> tmp_sub_edaphic <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>   tmp_edaphic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_div, tmp_sub_edaphic, <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>   tmp_edaphic <span class="ot">&lt;-</span> tmp_edaphic <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="do">## soil_funct</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>   tmp_sub_soil_funct <span class="ot">&lt;-</span> tmp_md_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(soil_funct))</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>   tmp_sub_soil_funct <span class="ot">&lt;-</span> tmp_sub_soil_funct <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>   tmp_soil_funct <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_div, tmp_sub_soil_funct, <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>   tmp_soil_funct <span class="ot">&lt;-</span> tmp_soil_funct <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;SampleID&quot;</span>)      </span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="do">## temp_adapt</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>   tmp_sub_temp_adapt <span class="ot">&lt;-</span> tmp_md_all <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(temp_adapt))</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>   tmp_sub_temp_adapt <span class="ot">&lt;-</span> tmp_sub_temp_adapt <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>   tmp_temp_adapt <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_div, tmp_sub_temp_adapt, <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>   tmp_temp_adapt <span class="ot">&lt;-</span> tmp_temp_adapt <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;SampleID&quot;</span>)      </span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="do">## combine</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>   tmp_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">data_loaded =</span> its18_select_mc<span class="sc">$</span>data_loaded, </span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">map_loaded =</span> its18_select_mc<span class="sc">$</span>map_loaded, </span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">taxonomy_loaded =</span> its18_select_mc<span class="sc">$</span>taxonomy_loaded,</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">edaphic =</span> tmp_edaphic, </span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">soil_funct =</span> tmp_soil_funct, </span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">temp_adapt =</span> tmp_temp_adapt)</span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_split&quot;</span>))</span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(tmp_name)</span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_list)</span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<h3 id="generate-autocorrelation-plots-1">Generate Autocorrelation
Plots</h3>
<p>A little housekeeping to get rid of parameters we don’t need (e.g.,
plot number, pair, etc.).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>edaphic_cor <span class="ot">&lt;-</span> its18_select_mc_split<span class="sc">$</span>edaphic</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>edaphic_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>edaphic_norm_cor <span class="ot">&lt;-</span> its18_select_mc_norm_split<span class="sc">$</span>edaphic</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>edaphic_norm_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>soil_funct_cor <span class="ot">&lt;-</span> its18_select_mc_split<span class="sc">$</span>soil_funct</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>soil_funct_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>soil_funct_norm_cor <span class="ot">&lt;-</span> its18_select_mc_norm_split<span class="sc">$</span>soil_funct</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>soil_funct_norm_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>temp_adapt_cor <span class="ot">&lt;-</span> its18_select_mc_split<span class="sc">$</span>temp_adapt</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>temp_adapt_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>temp_adapt_norm_cor <span class="ot">&lt;-</span> its18_select_mc_norm_split<span class="sc">$</span>temp_adapt</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>temp_adapt_norm_cor[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</details>
</div>
<p>And finally the code to create the plots.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb110"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_cor$&quot;</span>)) {</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  tmp_cormat <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(tmp_get), <span class="dv">2</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  tmp_melted_cormat <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(tmp_cormat)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  tmp_get_lower_tri <span class="ot">&lt;-</span> <span class="cf">function</span>(tmp_cormat){</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    tmp_cormat[<span class="fu">upper.tri</span>(tmp_cormat)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tmp_cormat)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get upper triangle of the correlation matrix</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  tmp_get_upper_tri <span class="ot">&lt;-</span> <span class="cf">function</span>(tmp_cormat){</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    tmp_cormat[<span class="fu">lower.tri</span>(tmp_cormat)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tmp_cormat)</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>  tmp_upper_tri <span class="ot">&lt;-</span> <span class="fu">tmp_get_upper_tri</span>(tmp_cormat)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  tmp_melted_cormat <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(tmp_upper_tri, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> tmp_melted_cormat, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span> </span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>()</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>  tmp_ggheatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> tmp_melted_cormat, <span class="fu">aes</span>(Var2, Var1, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">space =</span> <span class="st">&quot;Lab&quot;</span>, </span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name=</span><span class="st">&quot;Pearson</span><span class="sc">\n</span><span class="st">Correlation&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">7</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>() <span class="sc">+</span> </span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(Var2, Var1, <span class="at">label =</span> value), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">1.75</span>) <span class="sc">+</span></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.7</span>),</span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">barwidth =</span> <span class="dv">7</span>, <span class="at">barheight =</span> <span class="dv">1</span>,</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ggheatmap&quot;</span>))</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_ggheatmap)</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tmp_name)</span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_ggheatmap&quot;</span>)</span></code></pre></div>
</details>
</div>
<h2 id="autocorrelation-plots-1">Autocorrelation Plots</h2>
<p><br/></p>
<div class="l-body-outset">
<div class="panelset">
<section id="edaphic-properties-4" class="panel">
<h4>Edaphic properties</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-157-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 1 | Results of autocorrelation analysis
for non-normalized Environmental and edaphic
parameters.</strong></small></p>
</section>
<section id="edaphic-properties-normalized-1" class="panel">
<h4>Edaphic properties (normalized)</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-158-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 2 | Results of autocorrelation analysis
for normalized Environmental and edaphic
parameters.</strong></small></p>
</section>
<section id="functional-responses-1" class="panel">
<h4>Functional responses</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-159-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 3 | Results of autocorrelation analysis
for non-normalized Functional response parameters.</strong></small></p>
</section>
<section id="functional-responses-normalized-1" class="panel">
<h4>Functional responses (normalized)</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-160-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 4 | Results of autocorrelation analysis
for normalized Functional response parameters.</strong></small></p>
</section>
<section id="temperature-adaptation-4" class="panel">
<h4>Temperature adaptation</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-161-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 5 | Results of autocorrelation analysis
for non-normalized Temperature adaptation
parameters.</strong></small></p>
</section>
<section id="temperature-adaptation-normalized-1" class="panel">
<h4>Temperature adaptation (normalized)</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-162-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 6 | Results of autocorrelation analysis
for normalized Temperature adaptation parameters.</strong></small></p>
</section>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Now we can remove parameters based on the autocorrelation
analysis:</p>
<ol type="A">
<li>Environmental and edaphic properties: TEB, DON, Na, Al, Ca.</li>
<li>Microbial functional responses: micN, micNP, enzCN, enzCP, BP_ase,
CE_ase, LP_ase, N_ase, P_ase.</li>
<li>Temperature adaptation properties: NUE, PUE, P_Q10, SI.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>edaphic_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TEB&quot;</span>, <span class="st">&quot;DON&quot;</span>, <span class="st">&quot;Na&quot;</span>, <span class="st">&quot;Al&quot;</span>, <span class="st">&quot;Ca&quot;</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>soil_funct_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;micN&quot;</span>, <span class="st">&quot;micNP&quot;</span>, <span class="st">&quot;enzCN&quot;</span>, <span class="st">&quot;enzCP&quot;</span>, <span class="st">&quot;BP_ase&quot;</span>, </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;CE_ase&quot;</span>, <span class="st">&quot;LP_ase&quot;</span>, <span class="st">&quot;N_ase&quot;</span>, <span class="st">&quot;P_ase&quot;</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>temp_adapt_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;NUE&quot;</span>, <span class="st">&quot;PUE&quot;</span>, <span class="st">&quot;P_Q10&quot;</span>, <span class="st">&quot;SI&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> its18_select_mc_split</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>edaphic <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>edaphic[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>edaphic) <span class="sc">%in%</span>  edaphic_remove]</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>soil_funct <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>soil_funct[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>soil_funct) <span class="sc">%in%</span>  soil_funct_remove]</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>temp_adapt <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>temp_adapt[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>temp_adapt) <span class="sc">%in%</span>  temp_adapt_remove]</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>its18_select_mc_split_no_ac <span class="ot">&lt;-</span> tmp_df</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> its18_select_mc_norm_split</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>edaphic <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>edaphic[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>edaphic) <span class="sc">%in%</span>  edaphic_remove]</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>soil_funct <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>soil_funct[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>soil_funct) <span class="sc">%in%</span>  soil_funct_remove]</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>tmp_df<span class="sc">$</span>temp_adapt <span class="ot">&lt;-</span> tmp_df<span class="sc">$</span>temp_adapt[, <span class="sc">!</span> <span class="fu">names</span>(tmp_df<span class="sc">$</span>temp_adapt) <span class="sc">%in%</span>  temp_adapt_remove]</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>its18_select_mc_norm_split_no_ac <span class="ot">&lt;-</span> tmp_df</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span></code></pre></div>
</details>
</div>
<h2 id="dissimilarity-correlation-tests-1">Dissimilarity Correlation
Tests</h2>
<p>Let’s see if any on the metadata groups are significantly correlated
with the community data. Basically, we create distance matrices for the
community data and each metadata group and then run Mantel tests for all
comparisons. For the community data we calculate Bray-Curtis distances
for the community data and Euclidean distances for the metadata. We use
the function <code>mantel.test</code> from the <code>ape</code> package
and <code>mantel</code> from the <code>vegan</code> package for the
analyses.</p>
<p>In summary, we test both <code>mantel.test</code> and
<code>mantel</code> on Bray-Curtis distance community distances against
Euclidean distances for each metadata group (<code>edaphic</code>,
<code>soil_funct</code>, <code>temp_adapt</code>) <strong>a</strong>)
before normalizing and before removing autocorrelated parameters,
<strong>b</strong>) before normalizing and after removing autocorrelated
parameters, <strong>c</strong>) after normalizing and before removing
autocorrelated parameters, and <strong>d</strong>) after normalizing and
after removing autocorrelated parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb113"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>man_df <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;its18_select_mc_split&quot;</span>, <span class="st">&quot;its18_select_mc_split_no_ac&quot;</span>, </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;its18_select_mc_norm_split&quot;</span>, <span class="st">&quot;its18_select_mc_norm_split_no_ac&quot;</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> man_df) {</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  tmp_dm_otu <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(<span class="fu">t</span>(tmp_get<span class="sc">$</span>data_loaded), </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co"># EDAPHIC</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  tmp_dm_md_edaphic <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_get<span class="sc">$</span>edaphic[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_get<span class="sc">$</span>edaphic)], </span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">method =</span><span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>  tmp_man1_edaphic <span class="ot">&lt;-</span> <span class="fu">mantel.test</span>(tmp_dm_otu, tmp_dm_md_edaphic, <span class="at">nperm =</span> <span class="dv">999</span>, </span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>  tmp_man2_edaphic <span class="ot">&lt;-</span> <span class="fu">mantel</span>(tmp_dm_otu, tmp_dm_md_edaphic, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="co"># SOIL FUNCT</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>  tmp_dm_md_soil_funct <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_get<span class="sc">$</span>soil_funct[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_get<span class="sc">$</span>soil_funct)], </span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>  tmp_man1_soil_funct <span class="ot">&lt;-</span> <span class="fu">mantel.test</span>(tmp_dm_otu, tmp_dm_md_soil_funct, <span class="at">nperm =</span> <span class="dv">999</span>, </span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>  tmp_man2_soil_funct <span class="ot">&lt;-</span> <span class="fu">mantel</span>(tmp_dm_otu, tmp_dm_md_soil_funct, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a><span class="co"># TEMP ADAPT</span></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>  tmp_dm_md_temp_adapt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_get<span class="sc">$</span>temp_adapt[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_get<span class="sc">$</span>temp_adapt)], </span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a>  tmp_man1_temp_adapt <span class="ot">&lt;-</span> <span class="fu">mantel.test</span>(tmp_dm_otu, tmp_dm_md_temp_adapt, <span class="at">nperm =</span> <span class="dv">999</span>, </span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a>                                <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a>  tmp_man2_temp_adapt <span class="ot">&lt;-</span> <span class="fu">mantel</span>(tmp_dm_otu, tmp_dm_md_temp_adapt, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_mantel_tests&quot;</span>))</span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a>  tmp_df <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">edaphic_ape_man =</span> tmp_man1_edaphic, </span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edaphic_vegan_man =</span> tmp_man2_edaphic,</span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">soil_funct_ape_man =</span> tmp_man1_soil_funct, </span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">soil_funct_vegan_man =</span> tmp_man2_soil_funct,</span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">temp_adapt_ape_man =</span> tmp_man1_temp_adapt, </span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a>                 <span class="at">temp_adapt_vegan_man =</span> tmp_man2_temp_adapt)</span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tmp_name)</span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="dissimilarity-correlation-results-1">Dissimilarity Correlation
Results</h3>
<p><small><strong>(ITS) Table 4 | Summary of Dissimilarity Correlation
Tests using <code>mantel.test</code> from the ape package and
<code>mantel</code> from the vegan. P-values in red indicate
significance (p-value &lt; 0.05)</strong></small></p>
<div class="layout-chunk" data-layout="l-page">
<div id="htmlwidget-ae88d6572272c23fc065" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ae88d6572272c23fc065">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"normalized?":["no","no","yes","yes"],"AC removed?":["no","yes","no","yes"],"edaphic_ape":[0.119,0.081,0.151,0.003],"edaphic_vegan":[0.062,0.037,0.081,0.003],"soil_funct_ape":[0.097,0.095,0.345,0.357],"soil_funct_vegan":[0.047,0.037,0.163,0.18],"temp_adapt_ape":[0.001,0.001,0.001,0.001],"temp_adapt_vegan":[0.002,0.001,0.001,0.001]},"columns":[{"accessor":"normalized?","name":"normalized?","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["no","no","yes","yes"],"header":"normalized?","minWidth":70,"align":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"AC removed?","name":"AC removed?","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["no","yes","no","yes"],"header":"AC removed?","minWidth":70,"align":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"edaphic_ape","name":"ape","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.119","0.081","0.151","0.003"],"header":"ape","minWidth":50,"align":"center","style":[{"color":"#2271B2"},{"color":"#2271B2"},{"color":"#2271B2"},{"color":"#B22271"}]},{"accessor":"edaphic_vegan","name":"vegan","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.062","0.037","0.081","0.003"],"header":"vegan","minWidth":50,"align":"center","style":[{"color":"#2271B2"},{"color":"#B22271"},{"color":"#2271B2"},{"color":"#B22271"}]},{"accessor":"soil_funct_ape","name":"ape","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.097","0.095","0.345","0.357"],"header":"ape","minWidth":50,"align":"center","style":[{"color":"#2271B2"},{"color":"#2271B2"},{"color":"#2271B2"},{"color":"#2271B2"}]},{"accessor":"soil_funct_vegan","name":"vegan","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.047","0.037","0.163","0.180"],"header":"vegan","minWidth":50,"align":"center","style":[{"color":"#B22271"},{"color":"#B22271"},{"color":"#2271B2"},{"color":"#2271B2"}]},{"accessor":"temp_adapt_ape","name":"ape","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.001","0.001","0.001","0.001"],"header":"ape","minWidth":50,"align":"center","style":[{"color":"#B22271"},{"color":"#B22271"},{"color":"#B22271"},{"color":"#B22271"}]},{"accessor":"temp_adapt_vegan","name":"vegan","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["0.002","0.001","0.001","0.001"],"header":"vegan","minWidth":50,"align":"center","style":[{"color":"#B22271"},{"color":"#B22271"},{"color":"#B22271"},{"color":"#B22271"}]}],"columnGroups":[{"name":"Environmental & edaphic","headerStyle":{"fontSize":"1.2em"},"columns":["edaphic_ape","edaphic_vegan"]},{"name":"Functional responses","headerStyle":{"fontSize":"1.2em"},"columns":["soil_funct_ape","soil_funct_vegan"]},{"name":"Temperature adaptation","headerStyle":{"fontSize":"1.2em"},"columns":["temp_adapt_ape","temp_adapt_vegan"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[5,10,4],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"210b202e7958afc66573d023a0503fe5"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Moving on.</p>
<h2 id="best-subset-of-variables-1">Best Subset of Variables</h2>
<p>Now we want to know which of the metadata parameters are the most
strongly correlated with the community data. For this we use the
<code>bioenv</code> function from the <code>vegan</code> package.
<code>bioenv</code>—<em>Best Subset of Environmental Variables with
Maximum (Rank) Correlation with Community Dissimilarities</em>—finds the
best subset of environmental variables, so that the Euclidean distances
of scaled environmental variables have the maximum (rank) correlation
with community dissimilarities.</p>
<p>Since we know that each of the Mantel tests we ran above are
significant, here we will use the metadata set where autocorrelated
parameters were removed and the remainder of the parameters were
normalized (where applicable based on the Shapiro tests).</p>
<p>We run <code>bioenv</code> against the three groups of metadata
parameters. We then run <code>bioenv</code> again, but this time against
the individual parameters identified as significantly correlated.</p>
<h3 id="edaphic-properties-5">Edaphic Properties</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>tmp_env <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>edaphic)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>tmp_env[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>edaphic_bioenv <span class="ot">&lt;-</span> <span class="fu">bioenv</span>(<span class="fu">wisconsin</span>(tmp_comm), tmp_env, </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">index =</span> <span class="st">&quot;bray&quot;</span>, </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">upto =</span> <span class="fu">ncol</span>(tmp_env), <span class="at">metric =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>bioenv_list <span class="ot">&lt;-</span> edaphic_bioenv<span class="sc">$</span>models[[edaphic_bioenv<span class="sc">$</span>whichbest]]<span class="sc">$</span>best</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>bioenv_best <span class="ot">&lt;-</span> <span class="fu">bioenvdist</span>(edaphic_bioenv, <span class="at">which =</span> <span class="st">&quot;best&quot;</span>)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> bioenv_list) {</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>       tmp_dp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(edaphic_bioenv<span class="sc">$</span>x)</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>       tmp_md <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_dp[[i]], </span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>       tmp_man <span class="ot">&lt;-</span> <span class="fu">mantel</span>(bioenv_best, tmp_md, </span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>       tmp_md_name <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp_dp)[[i]]</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>       tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_md_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_name, tmp_man)</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>)</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>edaphic_bioenv_ind_mantel <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">AST =</span> AST_bioenv_mantel_test)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Call:
bioenv(comm = wisconsin(tmp_comm), env = tmp_env, method = &quot;spearman&quot;,      index = &quot;bray&quot;, upto = ncol(tmp_env), metric = &quot;euclidean&quot;) 

Subset of environmental variables with best correlation to community data.

Correlations:    spearman 
Dissimilarities: bray 
Metric:          euclidean 

Best model has 1 parameters (max. 15 allowed):
AST
with correlation  0.65665 </code></pre>
</div>
<details>
<summary>
Show the results of individual edaphic metadata Mantel tests
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$AST

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r:     1 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.192 0.242 0.272 0.339 
Permutation: free
Number of permutations: 999</code></pre>
</div>
</details>
<p><code>bioenv</code> found the following edaphic properties
significantly correlated with the community data:
<strong>AST</strong></p>
<h3 id="soil-functional-response-3">Soil Functional Response</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>tmp_env <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>soil_funct)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>tmp_env[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>soil_funct_bioenv <span class="ot">&lt;-</span> <span class="fu">bioenv</span>(<span class="fu">wisconsin</span>(tmp_comm), tmp_env, </span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">index =</span> <span class="st">&quot;bray&quot;</span>, </span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">upto =</span> <span class="fu">ncol</span>(tmp_env), <span class="at">metric =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>bioenv_list <span class="ot">&lt;-</span> soil_funct_bioenv<span class="sc">$</span>models[[soil_funct_bioenv<span class="sc">$</span>whichbest]]<span class="sc">$</span>best</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>bioenv_best <span class="ot">&lt;-</span> <span class="fu">bioenvdist</span>(soil_funct_bioenv, <span class="at">which =</span> <span class="st">&quot;best&quot;</span>)</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> bioenv_list) {</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>       tmp_dp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(soil_funct_bioenv<span class="sc">$</span>x)</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>       tmp_md <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_dp[[i]], </span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>       tmp_man <span class="ot">&lt;-</span> <span class="fu">mantel</span>(bioenv_best, tmp_md, </span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>       tmp_md_name <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp_dp)[[i]]</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>       tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_md_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_name, tmp_man)</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>)</span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>soil_funct_bioenv_ind_mantel <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">enzNP =</span> enzNP_bioenv_mantel_test, </span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">PX_ase =</span> PX_ase_bioenv_mantel_test,</span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">XY_ase =</span> XY_ase_bioenv_mantel_test)</span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Call:
bioenv(comm = wisconsin(tmp_comm), env = tmp_env, method = &quot;spearman&quot;,      index = &quot;bray&quot;, upto = ncol(tmp_env), metric = &quot;euclidean&quot;) 

Subset of environmental variables with best correlation to community data.

Correlations:    spearman 
Dissimilarities: bray 
Metric:          euclidean 

Best model has 3 parameters (max. 11 allowed):
XY_ase PX_ase enzNP
with correlation  0.7491622 </code></pre>
</div>
<details>
<summary>
Show the results of individual functional response metadata Mantel tests
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$enzNP

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.5529 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.202 0.277 0.330 0.417 
Permutation: free
Number of permutations: 999


$PX_ase

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.6854 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.209 0.282 0.361 0.412 
Permutation: free
Number of permutations: 999


$XY_ase

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.5054 
      Significance: 0.002 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.202 0.261 0.308 0.359 
Permutation: free
Number of permutations: 999</code></pre>
</div>
</details>
<p><code>bioenv</code> found the following soil functions significantly
correlated with the community data: <strong>enzNP, PX_ase,
XY_ase</strong></p>
<h3 id="temperature-adaptation-5">Temperature Adaptation</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb120"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>tmp_env <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>temp_adapt)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>tmp_env[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioenv <span class="ot">&lt;-</span> <span class="fu">bioenv</span>(<span class="fu">wisconsin</span>(tmp_comm), tmp_env, </span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">index =</span> <span class="st">&quot;bray&quot;</span>, </span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">upto =</span> <span class="fu">ncol</span>(tmp_env), <span class="at">metric =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>bioenv_list <span class="ot">&lt;-</span> temp_adapt_bioenv<span class="sc">$</span>models[[temp_adapt_bioenv<span class="sc">$</span>whichbest]]<span class="sc">$</span>best</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>bioenv_best <span class="ot">&lt;-</span> <span class="fu">bioenvdist</span>(temp_adapt_bioenv, <span class="at">which =</span> <span class="st">&quot;best&quot;</span>)</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> bioenv_list) {</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>       tmp_dp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(temp_adapt_bioenv<span class="sc">$</span>x)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>       tmp_md <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">vegdist</span>(tmp_dp[[i]], </span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">binary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>       tmp_man <span class="ot">&lt;-</span> <span class="fu">mantel</span>(bioenv_best, tmp_md, </span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">permutations =</span> <span class="dv">999</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>       tmp_md_name <span class="ot">&lt;-</span> <span class="fu">names</span>(tmp_dp)[[i]]</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>       tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_md_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">assign</span>(tmp_name, tmp_man)</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>)</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioenv_ind_mantel <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">XY_Q10 =</span> XY_Q10_bioenv_mantel_test,</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Tmin =</span> Tmin_bioenv_mantel_test)</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;_bioenv_mantel_test&quot;</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Call:
bioenv(comm = wisconsin(tmp_comm), env = tmp_env, method = &quot;spearman&quot;,      index = &quot;bray&quot;, upto = ncol(tmp_env), metric = &quot;euclidean&quot;) 

Subset of environmental variables with best correlation to community data.

Correlations:    spearman 
Dissimilarities: bray 
Metric:          euclidean 

Best model has 2 parameters (max. 12 allowed):
XY_Q10 Tmin
with correlation  0.5637527 </code></pre>
</div>
<details>
<summary>
Show the results of individual temperature adaptation metadata Mantel
tests
</summary>
<div class="layout-chunk" data-layout="l-body">
<pre><code>$XY_Q10

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.7258 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.134 0.200 0.241 0.316 
Permutation: free
Number of permutations: 999


$Tmin

Mantel statistic based on Spearman&#39;s rank correlation rho 

Call:
mantel(xdis = bioenv_best, ydis = tmp_md, method = &quot;spearman&quot;,      permutations = 999) 

Mantel statistic r: 0.616 
      Significance: 0.001 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.189 0.245 0.297 0.360 
Permutation: free
Number of permutations: 999</code></pre>
</div>
</details>
<p><code>bioenv</code> found the following temperature adaptations
significantly correlated with the community data: <strong>XY_Q10,
Tmin</strong></p>
<h2 id="distance-based-redundancy-1">Distance-based Redundancy</h2>
<p>Now we turn our attention to distance-based redundancy analysis
(dbRDA), an ordination method similar to Redundancy Analysis (rda) but
it allows non-Euclidean dissimilarity indices, such as Manhattan or
Bray–Curtis distance. For this, we use <code>capscale</code> from the
<code>vegan</code> package. <code>capscale</code> is a constrained
versions of metric scaling (principal coordinates analysis), which are
based on the Euclidean distance but can be used, and are more useful,
with other dissimilarity measures. The functions can also perform
unconstrained principal coordinates analysis, optionally using extended
dissimilarities.</p>
<p>For each of the three metadata subsets, we perform the following
steps:</p>
<ol type="1">
<li>Run <code>rankindex</code> to compare metadata and community
dissimilarity indices for gradient detection. This will help us select
the best dissimilarity metric to use.</li>
<li>Run <code>capscale</code> for distance-based redundancy
analysis.</li>
<li>Run <code>envfit</code> to fit environmental parameters onto the
ordination. This function basically calculates correlation scores
between the metadata parameters and the ordination axes.</li>
<li>Select metadata parameters significant for <code>bioenv</code> (see
above) and/or <code>envfit</code> analyses.</li>
<li>Run <code>envfit</code> on ASVs.</li>
<li>Plot the ordination and vector overlays.</li>
</ol>
<h3 id="edaphic-properties-6">Edaphic Properties</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb123"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>tmp_md <span class="ot">&lt;-</span> its18_select_mc_norm_split_no_ac<span class="sc">$</span>edaphic</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>tmp_md<span class="sc">$</span>TREAT_T <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tmp_md<span class="sc">$</span>TREAT_T)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>edaphic_rank <span class="ot">&lt;-</span> <span class="fu">rankindex</span>(tmp_md[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_md)], tmp_comm, </span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">indices =</span> <span class="fu">c</span>(<span class="st">&quot;euc&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;gow&quot;</span>,<span class="st">&quot;bra&quot;</span>, <span class="st">&quot;kul&quot;</span>), </span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">stepacross =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>        euc         man         gow         bra         kul 
 0.15398526  0.29983940 -0.02940098  0.29983940  0.29983940 </code></pre>
</div>
<p>Let’s run <code>capscale</code> using Bray-Curtis. Note, we have 15
metadata parameters in this group but, for some reason,
<code>capscale</code> only works with 13 parameters. This may have to do
with degrees of freedom?</p>
<ul>
<li>Starting properties: AST, H2O, N, P, Al, Ca, Fe, K, Mg, Mn, Na, TEB,
ECEC, pH, NH4, NO3, PO4, DOC, DON, DOCN.</li>
<li>Autocorrelated removed: TEB, DON, Na, Al, Ca.</li>
<li>Remove for capscale: Mg, Mn, Na, Al, Fe, K</li>
</ul>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb125"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>edaphic_cap <span class="ot">&lt;-</span> <span class="fu">capscale</span>(tmp_comm <span class="sc">~</span> AST <span class="sc">+</span> H2O <span class="sc">+</span> N <span class="sc">+</span> P <span class="sc">+</span> ECEC <span class="sc">+</span> pH <span class="sc">+</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>                                   NH4 <span class="sc">+</span> NO3 <span class="sc">+</span> PO4 <span class="sc">+</span> DOC <span class="sc">+</span> DOCN, </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>                        tmp_md, <span class="at">dist =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmp_md)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>Call: capscale(formula = tmp_comm ~ AST + H2O + N + P + ECEC +
pH + NH4 + NO3 + PO4 + DOC + DOCN, data = tmp_md, distance =
&quot;bray&quot;)

              Inertia Proportion Rank
Total         3.88624    1.00000     
Constrained   3.66503    0.94308   11
Unconstrained 0.22120    0.05692    1
Inertia is squared Bray distance 
Species scores projected from &#39;tmp_comm&#39; 

Eigenvalues for constrained axes:
  CAP1   CAP2   CAP3   CAP4   CAP5   CAP6   CAP7   CAP8   CAP9  CAP10 
0.9655 0.5791 0.4327 0.3671 0.2987 0.2608 0.2301 0.1867 0.1339 0.1135 
 CAP11 
0.0970 

Eigenvalues for unconstrained axes:
  MDS1 
0.2212 </code></pre>
</div>
<p>Now we can look at the variance against each principal component.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="metadata_files/figure-html5/unnamed-chunk-184-1.png" width="624" /></p>
</div>
<p>And then make some quick and dirty plots. This will also come in
handy later when we need to parse out data a better plot visualization.
The <code>ggplot</code> function <code>autoplot</code> stores these data
in a more accessible way than the raw results from
<code>capscale</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb127"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">plot</span>(edaphic_cap) </span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-185-1.png" width="624" /></p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(edaphic_cap, <span class="at">arrows =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt</span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-185-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Next, we need to grab capscale scores for the samples and create a
data frame of the first two dimensions. We will also need to add some of
the sample details to the data frame. For this we use the vegan function
<code>scores</code> which gets species or site scores from the
ordination.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb129"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> tmp_samp_scores <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">SampleID =</span> Label)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md_sub <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>edaphic_plot_data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_md_sub, tmp_samp_scores, <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span></code></pre></div>
</details>
</div>
<p>Now we have a new data frame that contains sample details and
capscale values.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>          SampleID PLOT TREAT TREAT_T PAIR        CAP1        CAP2
1  P10_D00_010_C0E  P10     C       0    E -0.67150210 -1.07183211
2  P02_D00_010_C0A  P02     C       0    A -0.91911652 -0.41647565
3  P04_D00_010_C0B  P04     C       0    B -0.95654588  0.64087450
4  P06_D00_010_C0C  P06     C       0    C -0.87992057  0.68082267
5  P08_D00_010_C0D  P08     C       0    D -0.07766291 -0.98166349
6  P01_D00_010_W3A  P01     W       3    A -0.79165161 -0.43340347
7  P03_D00_010_W3B  P03     W       3    B  0.24722812  0.81805851
8  P07_D00_010_W3D  P07     W       3    D  0.20151965  1.07639049
9  P09_D00_010_W3E  P09     W       3    E  0.58233467  0.46562279
10 P01_D00_010_W8A  P01     W       8    A  0.92158009 -0.06825914
11 P03_D00_010_W8B  P03     W       8    B  0.94079184 -0.52231363
12 P05_D00_010_W8C  P05     W       8    C  0.87642984 -0.89155825
13 P07_D00_010_W8D  P07     W       8    D  0.52651539  0.70373678</code></pre>
</div>
<p>We can then do the same with the metadata vectors. Here though we
only need the scores and parameter name.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>edaphic_md_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;biplot&quot;</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>edaphic_md_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>edaphic_md_scores <span class="ot">&lt;-</span> edaphic_md_scores <span class="sc">%&gt;%</span> </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>     parameters         CAP1         CAP2
AST         AST  0.834527196  0.117196419
H2O         H2O -0.596509128  0.006131247
N             N  0.245428273  0.506082992
P             P  0.097845581  0.205793005
ECEC       ECEC -0.304860202  0.538475609
pH           pH -0.081297235 -0.092037201
NH4         NH4 -0.297079795  0.210528906
NO3         NO3 -0.264254841  0.225782469
PO4         PO4 -0.583698114  0.354036263
DOC         DOC -0.884261492  0.025360275
DOCN       DOCN  0.007258364 -0.462404778</code></pre>
</div>
<p>Let’s run some quick correlations of metadata with ordination axes to
see which parameters are significant. For this we use the vegan function
<code>envfit</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb133"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> edaphic_plot_data[, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_samp_scores_sub)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>tmp_param_list <span class="ot">&lt;-</span> edaphic_md_scores<span class="sc">$</span>parameters</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp_md,  <span class="at">select =</span>  tmp_param_list)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>envfit_edaphic_md <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, tmp_md_sub,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

         CAP1     CAP2     r2  Pr(&gt;r)  
AST   0.99126  0.13189 0.4849 0.03696 *
H2O  -0.99989  0.01511 0.2434 0.25275  
N     0.43981  0.89809 0.2124 0.27473  
P     0.43273  0.90152 0.0349 0.86014  
ECEC -0.50151  0.86515 0.2595 0.21778  
pH   -0.66815 -0.74403 0.0102 0.94705  
NH4  -0.81970  0.57279 0.0906 0.60140  
NO3  -0.76538  0.64357 0.0824 0.64635  
PO4  -0.85783  0.51393 0.3187 0.15185  
DOC  -0.99945  0.03317 0.5354 0.02797 *
DOCN  0.02108 -0.99978 0.1437 0.47552  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb135"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_edaphic_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_edaphic_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_edaphic_md<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.4</span>))</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(edaphic_md_signif_hits)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(edaphic_md_signif_hits)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif <span class="ot">&lt;-</span> edaphic_md_scores[edaphic_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> edaphic_md_signif_hits,]</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif<span class="sc">$</span>parameters</span></code></pre></div>
</details>
</div>
<p><code>envfit</code> found that AST, DOC were significantly
correlated.</p>
<p>Now let’s see if the same parameters are significant for the
<code>envfit</code> and <code>bioenv</code> analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Significant parameters from bioenv analysis.&quot;
[1] &quot;AST&quot;
_____________________________________
[1] &quot;Significant parameters from envfit analysis.&quot;
[1] &quot;AST&quot; &quot;DOC&quot;
_____________________________________
[1] &quot;Found in bioenv but not envfit.&quot;
character(0)
_____________________________________
[1] &quot;Found in envfit but not bioenv.&quot;
[1] &quot;DOC&quot;
_____________________________________
[1] &quot;Found in envfit and bioenv.&quot;
[1] &quot;AST&quot; &quot;DOC&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>new_edaphic_md_signif_hits <span class="ot">&lt;-</span> edaphic_sig_diff</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co">#new_edaphic_md_signif_hits &lt;- append(edaphic_md_signif_hits, edaphic_sig_diff)</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_all <span class="ot">&lt;-</span> edaphic_md_scores[edaphic_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> new_edaphic_md_signif_hits,]</span></code></pre></div>
</details>
</div>
<p>Check. Next, we run <code>envfit</code> for the ASVs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>envfit_edaphic_asv <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>                             tmp_comm[, <span class="fu">order</span>(<span class="fu">colSums</span>(<span class="sc">-</span>tmp_comm))][, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>edaphic_asv_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;species&quot;</span>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>edaphic_asv_scores <span class="ot">&lt;-</span> edaphic_asv_scores <span class="sc">%&gt;%</span> </span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>edaphic_asv_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

          CAP1     CAP2     r2   Pr(&gt;r)   
ASV1  -0.61940 -0.78508 0.3539 0.010989 * 
ASV2   0.73098 -0.68240 0.5575 0.003996 **
ASV4  -0.33832 -0.94103 0.4713 0.010989 * 
ASV3  -0.89855  0.43888 0.4897 0.002997 **
ASV15  0.95614  0.29292 0.2269 0.192807   
ASV8  -0.87871 -0.47735 0.1267 0.795205   
ASV9   0.73176  0.68156 0.1410 0.468531   
ASV24  0.45502  0.89048 0.1661 0.459540   
ASV12  0.12678  0.99193 0.7513 0.001998 **
ASV13 -0.42157 -0.90680 0.4286 0.060939 . 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb140"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_edaphic_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_edaphic_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_edaphic_asv<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.5</span>))</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(edaphic_asv_signif_hits)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(edaphic_asv_signif_hits)</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif <span class="ot">&lt;-</span> edaphic_asv_scores[edaphic_asv_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> edaphic_asv_signif_hits,]</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      parameters       CAP1       CAP2 variable_type
ASV12      ASV12 0.03291551  0.2041479           ASV
ASV2        ASV2 0.48655008 -0.3456690           ASV</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>edaphic_md_signif_all<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;metadata&quot;</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>edaphic_asv_signif<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;ASV&quot;</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>edaphic_bioplot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(edaphic_md_signif_all, edaphic_asv_signif)</span></code></pre></div>
</details>
</div>
<p>The last thing to do is categorize parameters scores and ASV scores
into different variable types for plotting.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb143"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>edaphic_bioplot_data_md <span class="ot">&lt;-</span> <span class="fu">subset</span>(edaphic_bioplot_data, </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>                                  edaphic_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;metadata&quot;</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>edaphic_bioplot_data_asv <span class="ot">&lt;-</span> <span class="fu">subset</span>(edaphic_bioplot_data, </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>                                   edaphic_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;ASV&quot;</span>)</span></code></pre></div>
</details>
</div>
<details>
<summary>
Show the code for the plot
</summary>
<div class="layout-chunk" data-layout="l-body">

</div>
</details>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="soil-functional-response-4">Soil Functional Response</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb144"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>tmp_md <span class="ot">&lt;-</span> its18_select_mc_norm_split_no_ac<span class="sc">$</span>soil_funct</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>tmp_md<span class="sc">$</span>TREAT_T <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tmp_md<span class="sc">$</span>TREAT_T)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>soil_funct_rank <span class="ot">&lt;-</span> <span class="fu">rankindex</span>(tmp_md[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_md)], tmp_comm, </span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">indices =</span> <span class="fu">c</span>(<span class="st">&quot;euc&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;gow&quot;</span>, <span class="st">&quot;bra&quot;</span>, <span class="st">&quot;kul&quot;</span>), </span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">stepacross =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>        euc         man         gow         bra         kul 
 0.06025620  0.38790324 -0.06200129  0.38790324  0.38790324 </code></pre>
</div>
<p>Let’s run <code>capscale</code> using Bray-Curtis Note, we have 11
metadata parameters in this group but, for some reason,
<code>capscale</code> only works with 13 parameters. This may have to do
with degrees of freedom?</p>
<ul>
<li>Starting properties: micC, micN, micP, micCN, micCP, micNP, AG_ase,
BG_ase, BP_ase, CE_ase, P_ase, N_ase, S_ase, XY_ase, LP_ase, PX_ase,
CO2, enzCN, enzCP, enzNP</li>
<li>Autocorrelated removed: micN, micNP, enzCN, enzCP, BP_ase, CE_ase,
LP_ase, N_ase, P_ase</li>
<li>Remove for capscale: NONE</li>
</ul>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb146"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>soil_funct_cap <span class="ot">&lt;-</span> <span class="fu">capscale</span>(tmp_comm <span class="sc">~</span>  micC <span class="sc">+</span> micP <span class="sc">+</span> micCN <span class="sc">+</span> micCP <span class="sc">+</span> AG_ase <span class="sc">+</span> BG_ase <span class="sc">+</span> </span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>                                       S_ase <span class="sc">+</span> XY_ase <span class="sc">+</span> PX_ase <span class="sc">+</span> CO2 <span class="sc">+</span> enzNP, </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>                           tmp_md, <span class="at">dist =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>Call: capscale(formula = tmp_comm ~ micC + micP + micCN +
micCP + AG_ase + BG_ase + S_ase + XY_ase + PX_ase + CO2 +
enzNP, data = tmp_md, distance = &quot;bray&quot;)

              Inertia Proportion Rank
Total         3.88624    1.00000     
Constrained   3.59902    0.92609   11
Unconstrained 0.28722    0.07391    1
Inertia is squared Bray distance 
Species scores projected from &#39;tmp_comm&#39; 

Eigenvalues for constrained axes:
  CAP1   CAP2   CAP3   CAP4   CAP5   CAP6   CAP7   CAP8   CAP9  CAP10 
0.9666 0.5891 0.3939 0.3377 0.2686 0.2635 0.2306 0.1940 0.1389 0.1143 
 CAP11 
0.1018 

Eigenvalues for unconstrained axes:
   MDS1 
0.28722 </code></pre>
</div>
<p>Now we can look at the variance against each principal component.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="metadata_files/figure-html5/unnamed-chunk-209-1.png" width="624" /></p>
</div>
<p>And then make some quick and dirty plots. This will also come in
handy later when we need to parse out data a better plot visualization.
The <code>ggplot</code> function <code>autoplot</code> stores these data
in a more accessible way than the raw results from
<code>capscale</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb148"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">plot</span>(soil_funct_cap) </span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-210-1.png" width="624" /></p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(soil_funct_cap, <span class="at">arrows =</span> <span class="cn">TRUE</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt</span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-210-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Next, we need to grab capscale scores for the samples and create a
data frame of the first two dimensions. We will also need to add some of
the sample details to the data frame. For this we use the vegan function
<code>scores</code> which gets species or site scores from the
ordination.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb150"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> tmp_samp_scores <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">SampleID =</span> Label)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md_sub <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>soil_funct_plot_data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_md_sub, tmp_samp_scores, </span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span></code></pre></div>
</details>
</div>
<p>Now we have a new data frame that contains sample details and
capscale values.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>          SampleID PLOT TREAT TREAT_T PAIR        CAP1       CAP2
1  P10_D00_010_C0E  P10     C       0    E -0.69489162 -0.6675049
2  P02_D00_010_C0A  P02     C       0    A -0.91653485 -0.6229848
3  P04_D00_010_C0B  P04     C       0    B -0.95221897  0.3986135
4  P06_D00_010_C0C  P06     C       0    C -0.85713972  0.6268677
5  P08_D00_010_C0D  P08     C       0    D -0.09115803 -1.0802252
6  P01_D00_010_W3A  P01     W       3    A -0.80868973 -0.1643386
7  P03_D00_010_W3B  P03     W       3    B  0.27067347  0.9200087
8  P07_D00_010_W3D  P07     W       3    D  0.20427135  1.0264780
9  P09_D00_010_W3E  P09     W       3    E  0.57963547  0.4440199
10 P01_D00_010_W8A  P01     W       8    A  0.91663981 -0.1382072
11 P03_D00_010_W8B  P03     W       8    B  0.92199435 -0.6783194
12 P05_D00_010_W8C  P05     W       8    C  0.86406950 -0.9575454
13 P07_D00_010_W8D  P07     W       8    D  0.56334898  0.8931377</code></pre>
</div>
<p>We can then do the same with the metadata vectors. Here though we
only need the scores and parameter name.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb152"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>soil_funct_md_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;biplot&quot;</span>)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>soil_funct_md_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>soil_funct_md_scores <span class="ot">&lt;-</span> soil_funct_md_scores <span class="sc">%&gt;%</span> </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span> </span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>       parameters       CAP1         CAP2
micC         micC -0.2359175  0.400384343
micP         micP -0.4872005  0.846844390
micCN       micCN  0.5085406  0.215263003
micCP       micCP  0.4299937 -0.786734788
AG_ase     AG_ase -0.3381241  0.763769448
BG_ase     BG_ase  0.2150249  0.021210923
S_ase       S_ase  0.1648172  0.678698244
XY_ase     XY_ase  0.6119362  0.164529372
PX_ase     PX_ase  0.8280069 -0.009182309
CO2           CO2  0.5373302 -0.181241128
enzNP       enzNP -0.8493447  0.170758052</code></pre>
</div>
<p>Let’s run some quick correlations of metadata with ordination axes to
see which parameters are significant. For this we use the vegan function
<code>envfit</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb154"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> soil_funct_plot_data[, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_samp_scores_sub)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>tmp_param_list <span class="ot">&lt;-</span> soil_funct_md_scores<span class="sc">$</span>parameters</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp_md,  <span class="at">select =</span>  tmp_param_list)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>envfit_soil_funct_md <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, tmp_md_sub,</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

           CAP1     CAP2     r2   Pr(&gt;r)   
micC   -0.50911  0.86070 0.1567 0.442557   
micP   -0.50009  0.86597 0.6925 0.001998 **
micCN   0.92125  0.38897 0.2225 0.261738   
micCP   0.48092 -0.87676 0.5831 0.015984 * 
AG_ase -0.40574  0.91399 0.5060 0.036963 * 
BG_ase  0.99507  0.09917 0.0341 0.832168   
S_ase   0.23862  0.97111 0.3542 0.099900 . 
XY_ase  0.96571  0.25962 0.2931 0.170829   
PX_ase  0.99996 -0.00944 0.5002 0.034965 * 
CO2     0.94850 -0.31679 0.2342 0.250749   
enzNP  -0.98088  0.19460 0.5471 0.013986 * 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb156"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_soil_funct_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_soil_funct_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_soil_funct_md<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.4</span>))</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(soil_funct_md_signif_hits)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(soil_funct_md_signif_hits)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif <span class="ot">&lt;-</span> soil_funct_md_scores[soil_funct_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>                                               soil_funct_md_signif_hits,]</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif<span class="sc">$</span>parameters</span></code></pre></div>
</details>
</div>
<p><code>envfit</code> found that micP, micCP, AG_ase, PX_ase, enzNP
were significantly correlated.</p>
<p>Now let’s see if the same parameters are significant for the
<code>envfit</code> and <code>bioenv</code> analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Significant parameters from bioenv analysis.&quot;
[1] &quot;enzNP&quot;  &quot;PX_ase&quot; &quot;XY_ase&quot;
_____________________________________
[1] &quot;Significant parameters from envfit analysis.&quot;
[1] &quot;micP&quot;   &quot;micCP&quot;  &quot;AG_ase&quot; &quot;PX_ase&quot; &quot;enzNP&quot; 
_____________________________________
[1] &quot;Found in bioenv but not envfit.&quot;
[1] &quot;XY_ase&quot;
_____________________________________
[1] &quot;Found in envfit but not bioenv.&quot;
[1] &quot;micP&quot;   &quot;micCP&quot;  &quot;AG_ase&quot;
_____________________________________
[1] &quot;Found in envfit and bioenv.&quot;
[1] &quot;micP&quot;   &quot;micCP&quot;  &quot;AG_ase&quot; &quot;PX_ase&quot; &quot;enzNP&quot;  &quot;XY_ase&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb158"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#new_soil_funct_md_signif_hits &lt;- append(soil_funct_md_signif_hits, soil_funct_sig_diff)</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>new_soil_funct_md_signif_hits <span class="ot">&lt;-</span> soil_funct_sig_diff</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_all <span class="ot">&lt;-</span> soil_funct_md_scores[soil_funct_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>                                                   new_soil_funct_md_signif_hits,]</span></code></pre></div>
</details>
</div>
<p>Check. Next, we run <code>envfit</code> for the ASVs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb159"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>envfit_soil_funct_asv <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, </span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>                                tmp_comm[, <span class="fu">order</span>(<span class="fu">colSums</span>(<span class="sc">-</span>tmp_comm))][, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;species&quot;</span>)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_scores <span class="ot">&lt;-</span> soil_funct_asv_scores <span class="sc">%&gt;%</span> </span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span> </span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

          CAP1     CAP2     r2   Pr(&gt;r)    
ASV1  -0.79963 -0.60050 0.2256 0.245754    
ASV2   0.68178 -0.73156 0.6129 0.000999 ***
ASV4  -0.33208 -0.94325 0.5433 0.000999 ***
ASV3  -0.92213  0.38687 0.4516 0.010989 *  
ASV15  0.95847  0.28518 0.2287 0.159840    
ASV8  -0.97867 -0.20544 0.1064 0.930070    
ASV9   0.76380  0.64546 0.1326 0.481518    
ASV24  0.40983  0.91216 0.2438 0.065934 .  
ASV12  0.14788  0.98901 0.7872 0.000999 ***
ASV13 -0.42711 -0.90420 0.4546 0.044955 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb161"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_soil_funct_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_soil_funct_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_soil_funct_asv<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.5</span>))</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(soil_funct_asv_signif_hits)</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(soil_funct_asv_signif_hits)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif <span class="ot">&lt;-</span> soil_funct_asv_scores[soil_funct_asv_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>                                                 soil_funct_asv_signif_hits,]</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      parameters        CAP1       CAP2 variable_type
ASV4        ASV4 -0.10677580 -0.2996742           ASV
ASV12      ASV12  0.04088024  0.2662493           ASV
ASV2        ASV2  0.46539405 -0.4834130           ASV</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb163"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>soil_funct_md_signif_all<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;metadata&quot;</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>soil_funct_asv_signif<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;ASV&quot;</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>soil_funct_bioplot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(soil_funct_md_signif_all, soil_funct_asv_signif)</span></code></pre></div>
</details>
</div>
<p>The last thing to do is categorize parameters scores and ASV scores
into different variable types for plotting.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb164"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>soil_funct_bioplot_data_md <span class="ot">&lt;-</span> <span class="fu">subset</span>(soil_funct_bioplot_data, </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>                                  soil_funct_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;metadata&quot;</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>soil_funct_bioplot_data_asv <span class="ot">&lt;-</span> <span class="fu">subset</span>(soil_funct_bioplot_data, </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                                   soil_funct_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;ASV&quot;</span>)</span></code></pre></div>
</details>
</div>
<details>
<summary>
Show the code for the plot
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb165"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>soil_funct_cap_vals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(soil_funct_cap<span class="sc">$</span>CCA<span class="sc">$</span>eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>soil_funct_cap1 <span class="ot">&lt;-</span> <span class="fu">signif</span>((soil_funct_cap_vals[<span class="dv">1</span>,] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>soil_funct_cap2 <span class="ot">&lt;-</span> <span class="fu">signif</span>((soil_funct_cap_vals[<span class="dv">2</span>,] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>cpa1_lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;CAP1&quot;</span>, <span class="st">&quot; (&quot;</span>, soil_funct_cap1, <span class="st">&quot;%)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>cpa2_lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;CAP2&quot;</span>, <span class="st">&quot; (&quot;</span>, soil_funct_cap2, <span class="st">&quot;%)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>swel_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#2271B2&quot;</span>, <span class="st">&quot;#71B222&quot;</span>, <span class="st">&quot;#B22271&quot;</span>)</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>soil_funct_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(soil_funct_plot_data) <span class="sc">+</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> CAP1, <span class="at">y =</span> CAP2, <span class="at">shape =</span> TREAT,</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">colour =</span> TREAT_T), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col) <span class="sc">+</span></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_text(data = soil_funct_plot_data, aes(x = CAP1, y = CAP2, #UNCOMMENT to add sample labels</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                              label = SampleID), size = 3) + </span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> CAP1, <span class="at">yend =</span> CAP2),</span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> soil_funct_bioplot_data_md, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>,</span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)), <span class="at">size =</span> <span class="fl">0.4</span>, </span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;#191919&quot;</span>) <span class="sc">+</span></span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> soil_funct_bioplot_data_md, </span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> CAP1, <span class="at">y =</span> CAP2, <span class="at">label =</span> parameters), <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>, <span class="at">nudge_y =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">## USE this code to overlay ASV vestors</span></span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_segment(aes(x = 0, y = 0, xend = CAP1, yend = CAP2),</span></span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             data = soil_funct_bioplot_data_asv, linetype = &quot;solid&quot;,</span></span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             arrow = arrow(length = unit(0.3, &quot;cm&quot;)), size = 0.2,</span></span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             color = &quot;#676767&quot;) +</span></span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(data = soil_funct_bioplot_data_asv, </span></span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          aes(x = CAP1, y = CAP2, label = parameters), size = 2.5,</span></span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          nudge_x = 0.05, nudge_y = 0.05) +</span></span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb165-32"><a href="#cb165-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Capscale Analysis&quot;</span>,</span>
<span id="cb165-33"><a href="#cb165-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Soil Functional Response&quot;</span>, </span>
<span id="cb165-34"><a href="#cb165-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> cpa1_lab, </span>
<span id="cb165-35"><a href="#cb165-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> cpa2_lab)</span>
<span id="cb165-36"><a href="#cb165-36" aria-hidden="true" tabindex="-1"></a>soil_funct_plot <span class="ot">&lt;-</span> soil_funct_plot <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span>
<span id="cb165-37"><a href="#cb165-37" aria-hidden="true" tabindex="-1"></a>soil_funct_plot</span>
<span id="cb165-38"><a href="#cb165-38" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;files/metadata/figures/its18_soil_funct_capscale.png&quot;</span>,</span>
<span id="cb165-39"><a href="#cb165-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">16</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">&#39;cm&#39;</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb165-40"><a href="#cb165-40" aria-hidden="true" tabindex="-1"></a>soil_funct_plot</span>
<span id="cb165-41"><a href="#cb165-41" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">dev.off</span>())</span>
<span id="cb165-42"><a href="#cb165-42" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;files/metadata/figures/its18_soil_funct_capscale.pdf&quot;</span>,</span>
<span id="cb165-43"><a href="#cb165-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">5</span>, <span class="at">width =</span> <span class="dv">6</span>)</span>
<span id="cb165-44"><a href="#cb165-44" aria-hidden="true" tabindex="-1"></a>soil_funct_plot</span>
<span id="cb165-45"><a href="#cb165-45" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="temperature-adaptation-6">Temperature Adaptation</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb166"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>tmp_md <span class="ot">&lt;-</span> its18_select_mc_norm_split_no_ac<span class="sc">$</span>temp_adapt</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>tmp_md<span class="sc">$</span>TREAT_T <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tmp_md<span class="sc">$</span>TREAT_T)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>tmp_comm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(its18_select_mc_norm_split_no_ac<span class="sc">$</span>data_loaded))</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>temp_adapt_rank <span class="ot">&lt;-</span> <span class="fu">rankindex</span>(tmp_md[, <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_md)], tmp_comm, </span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">indices =</span> <span class="fu">c</span>(<span class="st">&quot;euc&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;gow&quot;</span>, <span class="st">&quot;bra&quot;</span>, <span class="st">&quot;kul&quot;</span>), </span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">stepacross =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>       euc        man        gow        bra        kul 
0.05132842 0.39465598 0.27457353 0.39465598 0.39465598 </code></pre>
</div>
<p>Let’s run <code>capscale</code> using Bray-Curtis. Note, we have 12
metadata parameters in this group but, for some reason,
<code>capscale</code> only works with 13 parameters. This may have to do
with degrees of freedom?</p>
<ul>
<li>Starting properties: AG_Q10, BG_Q10, BP_Q10, CE_Q10, P_Q10, N_Q10,
S_Q10, XY_Q10, LP_Q10, PX_Q10, CUEcn, CUEcp, NUE, PUE, Tmin, SI</li>
<li>Autocorrelated removed: NUE, PUE, P_Q10, SI<br />
</li>
<li>Remove for capscale: S_Q10</li>
</ul>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb168"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_cap <span class="ot">&lt;-</span> <span class="fu">capscale</span>(tmp_comm <span class="sc">~</span>  AG_Q10 <span class="sc">+</span> BG_Q10 <span class="sc">+</span> BP_Q10 <span class="sc">+</span> CE_Q10 <span class="sc">+</span> </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>                                       N_Q10 <span class="sc">+</span> XY_Q10 <span class="sc">+</span> LP_Q10 <span class="sc">+</span> PX_Q10 <span class="sc">+</span> </span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                                       CUEcn <span class="sc">+</span> CUEcp <span class="sc">+</span> Tmin, </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>                           tmp_md, <span class="at">dist =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>Call: capscale(formula = tmp_comm ~ AG_Q10 + BG_Q10 + BP_Q10 +
CE_Q10 + N_Q10 + XY_Q10 + LP_Q10 + PX_Q10 + CUEcn + CUEcp +
Tmin, data = tmp_md, distance = &quot;bray&quot;)

              Inertia Proportion Rank
Total         3.88624    1.00000     
Constrained   3.64416    0.93771   11
Unconstrained 0.24208    0.06229    1
Inertia is squared Bray distance 
Species scores projected from &#39;tmp_comm&#39; 

Eigenvalues for constrained axes:
  CAP1   CAP2   CAP3   CAP4   CAP5   CAP6   CAP7   CAP8   CAP9  CAP10 
0.9367 0.5976 0.4447 0.3685 0.3136 0.2644 0.2093 0.1488 0.1377 0.1235 
 CAP11 
0.0994 

Eigenvalues for unconstrained axes:
   MDS1 
0.24208 </code></pre>
</div>
<p>Now we can look at the variance against each principal component.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="metadata_files/figure-html5/unnamed-chunk-234-1.png" width="624" /></p>
</div>
<p>And then make some quick and dirty plots. This will also come in
handy later when we need to parse out data a better plot visualization.
The <code>ggplot</code> function <code>autoplot</code> stores these data
in a more accessible way than the raw results from
<code>capscale</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb170"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">plot</span>(temp_adapt_cap) </span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-235-1.png" width="624" /></p>
<div class="sourceCode" id="cb171"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(temp_adapt_cap, <span class="at">arrows =</span> <span class="cn">TRUE</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>tmp_auto_plt</span></code></pre></div>
<p><img src="metadata_files/figure-html5/unnamed-chunk-235-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Next, we need to grab capscale scores for the samples and create a
data frame of the first two dimensions. We will also need to add some of
the sample details to the data frame. For this we use the vegan function
<code>scores</code> which gets species or site scores from the
ordination.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb172"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores <span class="ot">&lt;-</span> tmp_samp_scores <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">SampleID =</span> Label)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> tmp_md_sub <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SampleID&quot;</span>)</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot_data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_md_sub, tmp_samp_scores, </span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">by =</span> <span class="st">&quot;SampleID&quot;</span>)</span></code></pre></div>
</details>
</div>
<p>Now we have a new data frame that contains sample details and
capscale values.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>          SampleID PLOT TREAT TREAT_T PAIR        CAP1       CAP2
1  P10_D00_010_C0E  P10     C       0    E -0.70909404  0.8884734
2  P02_D00_010_C0A  P02     C       0    A -0.88932428  0.4678685
3  P04_D00_010_C0B  P04     C       0    B -0.94720017 -0.5168746
4  P06_D00_010_C0C  P06     C       0    C -0.94117253 -0.7283971
5  P08_D00_010_C0D  P08     C       0    D -0.09697067  1.0013016
6  P01_D00_010_W3A  P01     W       3    A -0.79138504  0.3434287
7  P03_D00_010_W3B  P03     W       3    B  0.28447425 -0.8800769
8  P07_D00_010_W3D  P07     W       3    D  0.18992920 -0.9828048
9  P09_D00_010_W3E  P09     W       3    E  0.57704340 -0.4016378
10 P01_D00_010_W8A  P01     W       8    A  0.98434765  0.1432237
11 P03_D00_010_W8B  P03     W       8    B  0.88625427  0.6330378
12 P05_D00_010_W8C  P05     W       8    C  0.84253827  0.9056297
13 P07_D00_010_W8D  P07     W       8    D  0.61055970 -0.8731722</code></pre>
</div>
<p>We can then do the same with the metadata vectors. Here though we
only need the scores and parameter name.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb174"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;biplot&quot;</span>)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_scores <span class="ot">&lt;-</span> temp_adapt_md_scores <span class="sc">%&gt;%</span> </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span> </span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>       parameters         CAP1        CAP2
AG_Q10     AG_Q10  0.138111424 -0.09067317
BG_Q10     BG_Q10  0.529871661  0.44030269
BP_Q10     BP_Q10  0.213674949  0.18420563
CE_Q10     CE_Q10 -0.470374849 -0.07935444
N_Q10       N_Q10  0.002856862  0.28186886
XY_Q10     XY_Q10  0.826073837  0.18643092
LP_Q10     LP_Q10 -0.428296135 -0.07664534
PX_Q10     PX_Q10 -0.361920412  0.05606159
CUEcn       CUEcn -0.146194994 -0.40205479
CUEcp       CUEcp  0.318510258  0.66752667
Tmin         Tmin  0.740618311 -0.05737920</code></pre>
</div>
<p>Let’s run some quick correlations of metadata with ordination axes to
see which parameters are significant. For this we use the vegan function
<code>envfit</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb176"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> temp_adapt_plot_data[, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>tmp_samp_scores_sub <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_samp_scores_sub)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>tmp_param_list <span class="ot">&lt;-</span> temp_adapt_md_scores<span class="sc">$</span>parameters</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>tmp_md_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp_md,  <span class="at">select =</span>  tmp_param_list)</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>envfit_temp_adapt_md <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, tmp_md_sub,</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

           CAP1     CAP2     r2  Pr(&gt;r)   
AG_Q10  0.82904 -0.55918 0.0237 0.89710   
BG_Q10  0.76182  0.64778 0.4109 0.07792 . 
BP_Q10  0.74983  0.66163 0.0689 0.71528   
CE_Q10 -0.98593 -0.16714 0.1956 0.34865   
N_Q10   0.00657  0.99998 0.0700 0.71029   
XY_Q10  0.97498  0.22227 0.6166 0.00999 **
LP_Q10 -0.98418 -0.17719 0.1627 0.44955   
PX_Q10 -0.98713  0.15993 0.1155 0.54246   
CUEcn  -0.33206 -0.94326 0.1605 0.40460   
CUEcp   0.42027  0.90740 0.4786 0.03497 * 
Tmin    0.99659 -0.08248 0.4749 0.02797 * 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb178"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_temp_adapt_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_temp_adapt_md<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_temp_adapt_md<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.4</span>))</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(temp_adapt_md_signif_hits)</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(temp_adapt_md_signif_hits)</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif <span class="ot">&lt;-</span> temp_adapt_md_scores[temp_adapt_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>                                               temp_adapt_md_signif_hits,]</span></code></pre></div>
</details>
</div>
<p><code>envfit</code> found that XY_Q10, CUEcp, Tmin were significantly
correlated.</p>
<p>Now let’s see if the same parameters are significant for the
<code>envfit</code> and <code>bioenv</code> analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Significant parameters from bioenv analysis.&quot;
[1] &quot;XY_Q10&quot; &quot;Tmin&quot;  
_____________________________________
[1] &quot;Significant parameters from envfit analysis.&quot;
[1] &quot;XY_Q10&quot; &quot;CUEcp&quot;  &quot;Tmin&quot;  
_____________________________________
[1] &quot;Found in bioenv but not envfit.&quot;
character(0)
_____________________________________
[1] &quot;Found in envfit but not bioenv.&quot;
[1] &quot;CUEcp&quot;
_____________________________________
[1] &quot;Found in envfit and  bioenv.&quot;
[1] &quot;XY_Q10&quot; &quot;CUEcp&quot;  &quot;Tmin&quot;  </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb180"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#new_temp_adapt_md_signif_hits &lt;- base::append(temp_adapt_md_signif_hits, temp_adapt_sig_diff)</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>new_temp_adapt_md_signif_hits <span class="ot">&lt;-</span> temp_adapt_sig_diff[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_all <span class="ot">&lt;-</span> temp_adapt_md_scores[temp_adapt_md_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>                                                   new_temp_adapt_md_signif_hits,]</span></code></pre></div>
</details>
</div>
<p>Check. Next, we run <code>envfit</code> for the ASVs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb181"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>envfit_temp_adapt_asv <span class="ot">&lt;-</span> <span class="fu">envfit</span>(tmp_samp_scores_sub, </span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>                                tmp_comm[, <span class="fu">order</span>(<span class="fu">colSums</span>(<span class="sc">-</span>tmp_comm))][, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">perm =</span> <span class="dv">1000</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_scores <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(tmp_auto_plt<span class="sc">$</span>plot_env<span class="sc">$</span>obj, Score <span class="sc">==</span> <span class="st">&quot;species&quot;</span>)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_scores <span class="ot">&lt;-</span> temp_adapt_asv_scores <span class="sc">%&gt;%</span> </span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> Label, <span class="at">.before =</span> CAP1) <span class="sc">%&gt;%</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>                         tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Label&quot;</span>)</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_scores[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
***VECTORS

          CAP1     CAP2     r2   Pr(&gt;r)    
ASV1  -0.68969  0.72410 0.2975 0.051948 .  
ASV2   0.68393  0.72955 0.5592 0.003996 ** 
ASV4  -0.34226  0.93961 0.4935 0.005994 ** 
ASV3  -0.89727 -0.44148 0.5062 0.000999 ***
ASV15  0.96528 -0.26123 0.2497 0.122877    
ASV8  -0.90985  0.41495 0.1146 0.923077    
ASV9   0.76209 -0.64748 0.1338 0.474525    
ASV24  0.44129 -0.89736 0.2375 0.095904 .  
ASV12  0.14568 -0.98933 0.7737 0.002997 ** 
ASV13 -0.41856  0.90819 0.4357 0.056943 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
Permutation: free
Number of permutations: 1000</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb183"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif_hits <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">subset</span>(envfit_temp_adapt_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals, </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">c</span>(envfit_temp_adapt_asv<span class="sc">$</span>vectors<span class="sc">$</span>pvals </span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> envfit_temp_adapt_asv<span class="sc">$</span>vectors<span class="sc">$</span>r <span class="sc">&gt;</span> <span class="fl">0.5</span>))</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(temp_adapt_asv_signif_hits)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif_hits <span class="ot">&lt;-</span> <span class="fu">rownames</span>(temp_adapt_asv_signif_hits)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif <span class="ot">&lt;-</span> temp_adapt_asv_scores[temp_adapt_asv_scores<span class="sc">$</span>parameters <span class="sc">%in%</span> </span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>                                                 temp_adapt_asv_signif_hits,]</span></code></pre></div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      parameters        CAP1       CAP2 variable_type
ASV12      ASV12  0.03533894 -0.2327656           ASV
ASV2        ASV2  0.38413654  0.3977765           ASV
ASV3        ASV3 -0.45977392 -0.1843674           ASV</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb185"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_md_signif_all<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;metadata&quot;</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>temp_adapt_asv_signif<span class="sc">$</span>variable_type <span class="ot">&lt;-</span> <span class="st">&quot;ASV&quot;</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioplot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(temp_adapt_md_signif_all, temp_adapt_asv_signif)</span></code></pre></div>
</details>
</div>
<p>The last thing to do is categorize parameters scores and ASV scores
into different variable types for plotting.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode" id="cb186"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioplot_data_md <span class="ot">&lt;-</span> <span class="fu">subset</span>(temp_adapt_bioplot_data, </span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>                                  temp_adapt_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;metadata&quot;</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_bioplot_data_asv <span class="ot">&lt;-</span> <span class="fu">subset</span>(temp_adapt_bioplot_data, </span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>                                   temp_adapt_bioplot_data<span class="sc">$</span>variable_type <span class="sc">==</span> <span class="st">&quot;ASV&quot;</span>)</span></code></pre></div>
</details>
</div>
<details>
<summary>
Show the code for the plot
</summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb187"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>temp_adapt_cap_vals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(temp_adapt_cap<span class="sc">$</span>CCA<span class="sc">$</span>eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>temp_adapt_cap1 <span class="ot">&lt;-</span> <span class="fu">signif</span>((temp_adapt_cap_vals[<span class="dv">1</span>,] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>temp_adapt_cap2 <span class="ot">&lt;-</span> <span class="fu">signif</span>((temp_adapt_cap_vals[<span class="dv">2</span>,] <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>cpa1_lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;CAP1&quot;</span>, <span class="st">&quot; (&quot;</span>, temp_adapt_cap1, <span class="st">&quot;%)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>cpa2_lab <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;CAP2&quot;</span>, <span class="st">&quot; (&quot;</span>, temp_adapt_cap2, <span class="st">&quot;%)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>swel_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#2271B2&quot;</span>, <span class="st">&quot;#71B222&quot;</span>, <span class="st">&quot;#B22271&quot;</span>)</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(temp_adapt_plot_data) <span class="sc">+</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> CAP1, <span class="at">y =</span> CAP2, <span class="at">shape =</span> TREAT,</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">colour =</span> TREAT_T), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col) <span class="sc">+</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_text(data = temp_adapt_plot_data, aes(x = CAP1, y = CAP2, #UNCOMMENT to add sample labels</span></span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                              label = SampleID), size = 3) + </span></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> CAP1, <span class="at">yend =</span> CAP2),</span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> temp_adapt_bioplot_data_md, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>,</span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)), <span class="at">size =</span> <span class="fl">0.4</span>,</span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;#191919&quot;</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> temp_adapt_bioplot_data_md, </span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> CAP1, <span class="at">y =</span> CAP2, <span class="at">label =</span> parameters), <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>, <span class="at">nudge_y =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># uSe to include ASV vectors</span></span>
<span id="cb187-24"><a href="#cb187-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_segment(aes(x = 0, y = 0, xend = CAP1, yend = CAP2),</span></span>
<span id="cb187-25"><a href="#cb187-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             data = temp_adapt_bioplot_data_asv, linetype = &quot;solid&quot;,</span></span>
<span id="cb187-26"><a href="#cb187-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             arrow = arrow(length = unit(0.3, &quot;cm&quot;)), size = 0.2,</span></span>
<span id="cb187-27"><a href="#cb187-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             color = &quot;#676767&quot;) +</span></span>
<span id="cb187-28"><a href="#cb187-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(data = temp_adapt_bioplot_data_asv, </span></span>
<span id="cb187-29"><a href="#cb187-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          aes(x = CAP1, y = CAP2, label = parameters), size = 2.5,</span></span>
<span id="cb187-30"><a href="#cb187-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          nudge_x = 0.05, nudge_y = 0.05) +</span></span>
<span id="cb187-31"><a href="#cb187-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb187-32"><a href="#cb187-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Capscale Analysis&quot;</span>,</span>
<span id="cb187-33"><a href="#cb187-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Temperature Adaptation&quot;</span>,</span>
<span id="cb187-34"><a href="#cb187-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> cpa1_lab, </span>
<span id="cb187-35"><a href="#cb187-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> cpa2_lab)</span>
<span id="cb187-36"><a href="#cb187-36" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot <span class="ot">&lt;-</span> temp_adapt_plot <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span>
<span id="cb187-37"><a href="#cb187-37" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot</span>
<span id="cb187-38"><a href="#cb187-38" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;files/metadata/figures/its18_temp_adapt_capscale.png&quot;</span>,</span>
<span id="cb187-39"><a href="#cb187-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">16</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">&#39;cm&#39;</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb187-40"><a href="#cb187-40" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot</span>
<span id="cb187-41"><a href="#cb187-41" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">dev.off</span>())</span>
<span id="cb187-42"><a href="#cb187-42" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;files/metadata/figures/its18_temp_adapt_capscale.pdf&quot;</span>,</span>
<span id="cb187-43"><a href="#cb187-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">5</span>, <span class="at">width =</span> <span class="dv">6</span>)</span>
<span id="cb187-44"><a href="#cb187-44" aria-hidden="true" tabindex="-1"></a>temp_adapt_plot</span>
<span id="cb187-45"><a href="#cb187-45" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="capscale-plots-1">Capscale Plots</h2>
<div class="l-body-outset">
<div class="panelset">
<section id="edaphic-properties-7" class="panel">
<h4>Edaphic properties</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-254-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 7 | Distance-based Redundancy Analysis
(db-RDA) of PIME filtered data based on Bray-Curtis dissimilarity
showing the relationships between community composition change versus
edaphic properties.</strong></small></p>
</section>
<section id="soil-functional-response-5" class="panel">
<h4>Soil Functional Response</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-255-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 8 | Distance-based Redundancy Analysis
(db-RDA) of PIME filtered data based on Bray-Curtis dissimilarity
showing the relationships between community composition change versus
microbial functional response.</strong></small></p>
</section>
<section id="temperature-adaptation-7" class="panel">
<h4>Temperature Adaptation</h4>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="metadata_files/figure-html5/unnamed-chunk-256-1.png" width="624" /></p>
</div>
<p><small><strong>(ITS) Figure 9 | Distance-based Redundancy Analysis
(db-RDA) of PIME filtered data based on Bray-Curtis dissimilarity
showing the relationships between community composition change versus
temperature adaptation.</strong></small></p>
</section>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="workflow-output">Workflow Output</h1>
<p>Data products generated in this workflow can be downloaded from
figshare.</p>
<iframe src="https://widgets.figshare.com/articles/16828294/embed?show_title=1" width="568" height="251" allowfullscreen frameborder="0">
</iframe>
<p></br></p>
<p><a href="da.html" class="btnnav button_round" style="float: left;">Previous
workflow: <br> 7. Differentially Abundant ASVs &amp; Taxa</a></p>
<h2 class="appendix" id="source-code">Source Code</h2>
<p>You can find the source code for this page by <a
href="https://github.com/sweltr/high-temp/blob/master/metadata.Rmd">clicking
this link</a>.</p>
<h2 class="appendix" id="data-availability">Data Availability</h2>
<p>Data generated in this workflow and the Rdata need to run the
workflow can be accessed on figshare at <a
href="https://doi.org/10.25573/data.16828294">10.25573/data.16828294</a>.</p>
<h2 class="appendix" id="last-updated-on">Last updated on</h2>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;2022-06-02 11:48:04 EST&quot;</code></pre>
</div>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-oksanen2013community" class="csl-entry"
role="doc-biblioentry">
Oksanen, Jari, F. Guillaume Blanchet, Roeland Kindt, Pierre Legendre,
Peter R. Minchin, R. B. O’Hara, Gavin L. Simpson, Peter Sólymos, M.
Henry H. Stevens, and Helene Wagner. 2012. <span>“Vegan: Community
Ecology Package.”</span> <em>R Package Version</em> 2 (0). <a
href="https://cran.r-project.org/web/packages/vegan/index.html">https://cran.r-project.org/web/packages/vegan/index.html</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/sweltr/high-temp/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/sweltr/high-temp/">https://github.com/sweltr/high-temp/</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2022 metacrobe and The SWELTR Project.</p>
<p>Site constructed using <a
href="https://rstudio.github.io/distill/">Distill for R
Markdown</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
