<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.598">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Reproducible workflow to assess alpha diversity across temperature treatments using Hill numbers.">
<title>SWELTR - 5. Alpha Diversity Estimates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./beta.html" rel="next">
<link href="./taxa.html" rel="prev">
<link href="./assets/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>
    .quarto-title-block .quarto-title-banner {
      background: #113858;
    }
    </style>
<script src="site_libs/font-awesome-5.13.0/js/script.js"></script><script src="site_libs/core-js-2.5.3/shim.min.js"></script><script src="site_libs/react-17.0.0/react.min.js"></script><script src="site_libs/react-17.0.0/react-dom.min.js"></script><script src="site_libs/reactwidget-1.0.0/react-tools.js"></script><script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="site_libs/reactable-binding-0.2.3.9000/reactable.js"></script><link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <img src="./assets/icon.png" alt=""></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item compact">
    <a class="nav-link" href="./index.html"><i class="bi bi-home" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-a.-processing" role="button" data-bs-toggle="dropdown" aria-expanded="false">A. Processing</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-a.-processing">
<li class="dropdown-header">Workflows</li>
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="./dada2.html">
 <span class="dropdown-text">1. DADA2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./data-prep.html">
 <span class="dropdown-text">2. Data Set Prep</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./filtering.html">
 <span class="dropdown-text">3. Filtering</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-b.-diversity" role="button" data-bs-toggle="dropdown" aria-expanded="false">B. Diversity</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-b.-diversity">
<li class="dropdown-header">Workflows</li>
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="./taxa.html">
 <span class="dropdown-text">4. Taxonomic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./alpha.html">
 <span class="dropdown-text">5. Alpha Diversity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./beta.html">
 <span class="dropdown-text">6. Beta Diversity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./da.html">
 <span class="dropdown-text">7. DA ASVs &amp; Taxa</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./metadata.html">
 <span class="dropdown-text">8. Metadata</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link active" href="./data-availability.html" aria-current="page">DATA</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./pub.html">PAPER</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./som.html">SOM</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sweltr/high-temp/"><i class="bi bi-github" role="img" aria-label="Agua Salud GitHub">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="./about.html"><i class="bi bi-question" role="img">
</i> 
 </a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">5. Alpha Diversity Estimates</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">5. Alpha Diversity Estimates</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
                  <div>
        <div class="description">
          <p>Reproducible workflow to assess alpha diversity across temperature treatments using Hill numbers.</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">A. Processing</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dada2.html" class="sidebar-item-text sidebar-link">1. DADA2 Workflow</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-prep.html" class="sidebar-item-text sidebar-link">2. Data Set Preparation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./filtering.html" class="sidebar-item-text sidebar-link">3. Filtering</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">B. Diversity</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./taxa.html" class="sidebar-item-text sidebar-link">4. Taxonomic Diversity</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./alpha.html" class="sidebar-item-text sidebar-link active">5. Alpha Diversity Estimates</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./beta.html" class="sidebar-item-text sidebar-link">6. Beta Diversity &amp; Dispersion Estimates</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./da.html" class="sidebar-item-text sidebar-link">7. Differentially Abundant ASVs &amp; Taxa</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metadata.html" class="sidebar-item-text sidebar-link">8. Metadata Analysis</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">More</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-availability.html" class="sidebar-item-text sidebar-link">Data Availability</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./som.html" class="sidebar-item-text sidebar-link">Electronic Supplementary Material</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">Website Contruction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pub.html" class="sidebar-item-text sidebar-link">Code for Publication Figures</a>
  </div>
</li>
    </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#synopsis" id="toc-synopsis" class="nav-link active" data-scroll-target="#synopsis">Synopsis</a>
  <ul class="collapse">
<li><a href="#workflow-input" id="toc-workflow-input" class="nav-link" data-scroll-target="#workflow-input">Workflow Input</a></li>
  </ul>
</li>
  <li>
<a href="#s-rrna" id="toc-s-rrna" class="nav-link" data-scroll-target="#s-rrna">16s rRNA</a>
  <ul class="collapse">
<li><a href="#calculate-hill-numbers" id="toc-calculate-hill-numbers" class="nav-link" data-scroll-target="#calculate-hill-numbers">Calculate Hill Numbers</a></li>
  <li>
<a href="#hill-numbers-summary" id="toc-hill-numbers-summary" class="nav-link" data-scroll-target="#hill-numbers-summary">Hill Numbers Summary</a>
  <ul class="collapse">
<li><a href="#hill-summary" id="toc-hill-summary" class="nav-link" data-scroll-target="#hill-summary">Hill Summary</a></li>
  </ul>
</li>
  <li><a href="#normality-tests" id="toc-normality-tests" class="nav-link" data-scroll-target="#normality-tests">Normality Tests</a></li>
  <li><a href="#significance-tests" id="toc-significance-tests" class="nav-link" data-scroll-target="#significance-tests">Significance Tests</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#posthoc-analyses" id="toc-posthoc-analyses" class="nav-link" data-scroll-target="#posthoc-analyses">PostHoc Analyses</a></li>
  <li><a href="#alpha-diversity-plots" id="toc-alpha-diversity-plots" class="nav-link" data-scroll-target="#alpha-diversity-plots">Alpha Diversity Plots</a></li>
  </ul>
</li>
  <li>
<a href="#its" id="toc-its" class="nav-link" data-scroll-target="#its">ITS</a>
  <ul class="collapse">
<li><a href="#calculate-hill-numbers-1" id="toc-calculate-hill-numbers-1" class="nav-link" data-scroll-target="#calculate-hill-numbers-1">Calculate Hill Numbers</a></li>
  <li>
<a href="#hill-numbers-summary-1" id="toc-hill-numbers-summary-1" class="nav-link" data-scroll-target="#hill-numbers-summary-1">Hill Numbers Summary</a>
  <ul class="collapse">
<li><a href="#hill-summary-1" id="toc-hill-summary-1" class="nav-link" data-scroll-target="#hill-summary-1">Hill Summary</a></li>
  </ul>
</li>
  <li><a href="#normality-tests-1" id="toc-normality-tests-1" class="nav-link" data-scroll-target="#normality-tests-1">Normality Tests</a></li>
  <li><a href="#significance-tests-1" id="toc-significance-tests-1" class="nav-link" data-scroll-target="#significance-tests-1">Significance Tests</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">Summary</a></li>
  <li><a href="#posthoc-analyses-1" id="toc-posthoc-analyses-1" class="nav-link" data-scroll-target="#posthoc-analyses-1">PostHoc Analyses</a></li>
  <li><a href="#alpha-diversity-plots-1" id="toc-alpha-diversity-plots-1" class="nav-link" data-scroll-target="#alpha-diversity-plots-1">Alpha Diversity Plots</a></li>
  </ul>
</li>
  <li><a href="#workflow-output" id="toc-workflow-output" class="nav-link" data-scroll-target="#workflow-output">Workflow Output</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/sweltr/high-temp/edit/main/alpha.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/sweltr/high-temp/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><details><summary><strong>Click here</strong> for setup information.
</summary><div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span>, eval <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">119</span><span class="op">)</span>
<span class="co">#library(conflicted)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217">phyloseq</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"phyloseq"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biostrings">Biostrings</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"Biostrings"</span><span class="op">)</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">hilldiv</span>, 
               <span class="va">microbiome</span>, <span class="va">phytools</span>, <span class="va">phangorn</span>, 
               <span class="va">pairwiseAdonis</span>, <span class="va">naniar</span>, 
               <span class="va">labdsv</span>, <span class="va">patchwork</span>, <span class="va">agricolae</span>, <span class="va">ggpubr</span>,
               <span class="va">reactable</span>, <span class="va">downloadthis</span>, <span class="va">captioner</span>,
               install <span class="op">=</span> <span class="cn">FALSE</span>, update <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"hack_code/div_test_plot_jjs.R"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"hack_code/div_test_jjs.R"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_current</a></span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span>
  <span class="st">"cache"</span>,
  <span class="st">"cache.path"</span>,
  <span class="st">"cache.rebuild"</span>,
  <span class="st">"dependson"</span>,
  <span class="st">"autodep"</span>
<span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details><section id="synopsis" class="level1"><h1>Synopsis</h1>
<p>This workflow contains diversity assessments for the 2018 high temperature data sets. In order to run the workflow, you either need to first run the <a href="dada2.html">DADA2 Workflow</a> <strong>and</strong> the <a href="data-prep.html">Data Preparation workflow</a> <strong>or</strong> download the files linked below. See the <a href="data-availability.html">Data Availability</a> page for complete details.</p>
<section id="workflow-input" class="level2"><h2 class="anchored" data-anchor-id="workflow-input">Workflow Input</h2>
<p>Files needed to run this workflow can be downloaded from figshare.</p>
<iframe src="https://widgets.figshare.com/articles/14690739/embed?show_title=1" width="100%" height="251" allowfullscreen="" frameborder="0">
</iframe>
<iframe src="https://widgets.figshare.com/articles/14701440/embed?show_title=1" width="100%" height="351" allowfullscreen="" frameborder="0">
</iframe>
</section></section><section id="s-rrna" class="level1 page-columns page-full"><h1>16s rRNA</h1>
<div class="cell">

</div>
<p>To account for presence of rare sequence variants caused by sequencing errors or other technical artifacts, we use Hill numbers <span class="citation" data-cites="alberdi2019guide">(<a href="#ref-alberdi2019guide" role="doc-biblioref">Alberdi and Gilbert 2019a</a>)</span>. Hill numbers allow the weight put on rare versus abundant sequence variants to be scaled while providing intuitive comparisons of diversity levels using “effective number of ASVs” as a measuring unit. This approach allows for balancing the over representation of rare ASVs that might be inflated due to sequencing errors.</p>
<p>We will then use Shapiro-Wilk tests to test for normalcy and then, depending on the results, either use parametric ANOVA or non-parametric Kruskal-Wallis to compare alpha diversity among treatments.</p>
<section id="calculate-hill-numbers" class="level2"><h2 class="anchored" data-anchor-id="calculate-hill-numbers">Calculate Hill Numbers</h2>
<p>To calculate Hill numbers, we use the R package <code>hilldiv</code> <span class="citation" data-cites="alberdi2019hilldiv">(<a href="#ref-alberdi2019hilldiv" role="doc-biblioref">Alberdi and Gilbert 2019b</a>)</span>. We calculate three metrics that put more or less weight on common species:</p>
<ol type="1">
<li>Observed richness, where <code>q-value = 0</code>.</li>
<li>Shannon exponential, which weighs ASVs by their frequency, where <code>q-value = 1</code>.</li>
<li>Simpson multiplicative inverse, which over weighs abundant ASVs, where <code>q-value = 2</code>.</li>
</ol>
<p>We perform each analysis against the Full (unfiltered) data set as well as the Arbitrary, PERfect and PIME, filtered data sets using the function <code>hill_div</code>.</p>
<p>The command is as follows:</p>
<pre><code>hill_div(count = x, qvalue = i, tree = ultrametric_tree)</code></pre>
<p>where <code>x</code> is the sample by ASV table, <code>i</code> is the q-value corresponding to the metric of interest and <code>tree</code> is an ultrametric formatted phylogenetic tree if you choose to look at lineage, rather than ASV, diversity.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p>We first transform all the data to relative abundance values, and compute new trees.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_alpha_ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">ssu18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transformcounts.html">transform_sample_counts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">otu</span><span class="op">)</span> <span class="va">otu</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">otu</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_ps</span><span class="op">@</span><span class="va">phy_tree</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="va">tmp_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>,
                      tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_ps_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">tmp_ps</span>, <span class="va">sample_data</span>, <span class="va">tmp_tree</span><span class="op">)</span>
  <span class="va">tmp_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">tmp_ps_norm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_ps_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_norm"</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_ps_name</span>, <span class="va">tmp_ps_norm</span><span class="op">)</span>
  <span class="va">tmp_asv_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_tu"</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_asv_name</span>, <span class="va">tmp_asv</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we run the analysis for all three metrics on the data sets (without a tree).</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">qvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">qvalue</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">ssu18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">j</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_tu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu">hill_div</span><span class="op">(</span><span class="va">tmp_asv</span>, qvalue <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="va">tmp_df</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"tmp_name"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
                              <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"SamName"</span><span class="op">)</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">j</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_h"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tmp_name</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_df</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_h"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And make summary tables to add back into each <code>ps</code> object.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">ssu18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_h0"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_sha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_h1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_h2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_hill</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_obs</span>, <span class="va">tmp_sha</span>, by <span class="op">=</span> <span class="st">"SamName"</span><span class="op">)</span> <span class="op">%&gt;%</span>
       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">tmp_sim</span>, by <span class="op">=</span> <span class="st">"SamName"</span><span class="op">)</span> <span class="op">%&gt;%</span>
       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"Observed"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"Shannon_exp"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"InvSimpson"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_hill"</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_hill</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_hill"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And then create the new objects with the diversity data.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">ssu18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
     <span class="va">tmp_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>,
                      tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">tmp_ps</span>, <span class="va">sample_data</span>, <span class="va">tmp_tree</span><span class="op">)</span>
     <span class="va">tmp_hill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_hill"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_hill_samp</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>,
                                         <span class="va">tmp_hill</span>, by <span class="op">=</span> <span class="st">"SamName"</span><span class="op">)</span>
     <span class="va">tmp_hill_samp</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="va">tmp_hill_samp</span><span class="op">$</span><span class="va">SamName</span>
     <span class="va">tmp_hill_samp</span> <span class="op">&lt;-</span> <span class="va">tmp_hill_samp</span> <span class="op">%&gt;%</span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
     <span class="va">tmp_ps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_hill_samp</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html">tax_table</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/phy_tree-methods.html">phy_tree</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">tmp_ps2</span><span class="op">)</span>
     <span class="va">tmp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"files/alpha/rdata/"</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">tmp_ps2</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path</span>, <span class="va">i</span>, <span class="st">".rds"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
</section><section id="hill-numbers-summary" class="level2"><h2 class="anchored" data-anchor-id="hill-numbers-summary">Hill Numbers Summary</h2>
<p>Now we summarize the data for each sample against all three metrics. The table contains the results of ASV diversity estimates from the full data set and the three filtered data sets.</p>
<p>The suffix <code>_fi</code> indicates metrics for the Arbitrary data set. The suffix <code>_pe</code> indicates metrics for the PERfect data set and the suffix <code>_pet</code> indicates the lineage diversity for the PERfect data set.</p>
<p>The suffix <code>_pi</code> indicates metrics for the PIME data set and the suffix <code>_pit</code> indicates the lineage diversity for the PIME data set.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<section id="hill-summary" class="level3"><h3 class="anchored" data-anchor-id="hill-summary">Hill Summary</h3>
<p><small><strong>(16S rRNA) Table 1 | Hill numbers for samples in the unfiltered &amp; filtered data sets.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELE9ic2VydmVkLE9ic2VydmVkX2ZpLE9ic2VydmVkX3BlLE9ic2VydmVkX3BpLFNoYW5ub25fZXhwLFNoYW5ub25fZXhwX2ZpLFNoYW5ub25fZXhwX3BlLFNoYW5ub25fZXhwX3BpLEludlNpbXBzb24sSW52U2ltcHNvbl9maSxJbnZTaW1wc29uX3BlLEludlNpbXBzb25fcGkKUDAxX0QwMF8wMTBfVzNBLDIzNzEsODMxLDcwNyw1MDIsNzYwLjcsMzg1LjEsMzUzLjQsMjI2LjMsMjAwLjMsMTI4LDEyMy42LDg0LjIKUDAxX0QwMF8wMTBfVzhBLDE2MTAsNjIwLDU2MywzMjIsMjM2LjEsMTI3LjgsMTI2LjUsNTkuMiwyNS41LDE4LjksMTkuMSwxMgpQMDJfRDAwXzAxMF9DMEEsMjI3Miw4ODQsNzM3LDU5MCw3ODEuMSw0MzcuMSwzOTcuNCwyOTEuMiwyNjEuNSwxNzguNSwxNzEuNiwxMjkuMwpQMDNfRDAwXzAxMF9XM0IsMjM1Niw5MjIsNzY0LDU5Niw2ODYuOCwzNzMuNywzMzcuMywyMzUsMTU5LjQsMTA4LjcsMTAzLjgsNzUuOApQMDNfRDAwXzAxMF9XOEIsMTU3NSw0MjIsNDExLDIyNCw1MDEsMTgxLDIxMS45LDkwLjEsMTUzLjMsNjkuMiw4Mi42LDM4LjYKUDA0X0QwMF8wMTBfQzBCLDIwNDAsODAyLDY2Myw1NzAsNzk3LjgsNDM5LjQsMzg4LjQsMzA5LjIsMjcyLDE3OC44LDE2Ni44LDEzMC43ClAwNV9EMDBfMDEwX1czQywxNjYzLDY4MCw1NzQsNDk5LDU3OC44LDMyOS40LDI5OS4yLDI0Ni4xLDIwMS4yLDEzOS41LDEzMi42LDExMQpQMDVfRDAwXzAxMF9XOEMsMjEyNCw1NzIsNjYxLDI4OSwzMDcuMywxMDIuNCwxNDYuOSw0Ny45LDI3LjMsMTQuOSwxOC41LDkuNgpQMDZfRDAwXzAxMF9DMEMsMzA2NSwxMDExLDg1Nyw2NjQsMTA5OC40LDUxOC43LDQ4MS4zLDMyNC43LDMwOS40LDE4MiwxNzkuNywxMjAuNgpQMDdfRDAwXzAxMF9XM0QsMjAxMCw4NDMsNzI1LDUxNiw1OTguOCwzNTMuNCwzMjcuNSwyMDgsMTQ2LjgsMTAzLjcsOTkuNyw2Ny41ClAwN19EMDBfMDEwX1c4RCwyMTU3LDc3MSw2NzEsMjc2LDU2MC44LDI4NC4yLDI3MC4zLDg4LjEsOTEuNSw2MC4yLDYwLjIsMjQuNApQMDhfRDAwXzAxMF9DMEQsMjQ0MSw4MTMsNjgxLDU5NCw5NzMuMyw0NjQuOCw0MTkuOCwzMzEuMywzOTQuMiwyMzAsMjIwLjUsMTY4LjcKUDA5X0QwMF8wMTBfVzNFLDIzODYsODc0LDc1MSw1NjMsNjgwLjEsMzUyLjcsMzM0LjUsMjI0LjQsMTY4LjUsMTEwLjMsMTA5LjQsNzYuNQpQMDlfRDAwXzAxMF9XOEUsODEzLDM3NiwzMzIsMTcwLDM3NS4zLDE2NS42LDE0OS45LDY3LjksMTIwLjIsNTUuNyw1Ni44LDI2LjQKUDEwX0QwMF8wMTBfQzBFLDIwNjYsNjcwLDU3MSw0OTEsODg2LjgsNDE2LjUsMzc5LjQsMjk4LjMsNDI3LjYsMjQyLjgsMjMxLjQsMTc0LjcK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_tab_alpha_div.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-9eceb20dc2a931752ae4" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9eceb20dc2a931752ae4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"Observed":[2371,1610,2272,2356,1575,2040,1663,2124,3065,2010,2157,2441,2386,813,2066],"Observed_fi":[831,620,884,922,422,802,680,572,1011,843,771,813,874,376,670],"Observed_pe":[707,563,737,764,411,663,574,661,857,725,671,681,751,332,571],"Observed_pi":[502,322,590,596,224,570,499,289,664,516,276,594,563,170,491],"Shannon_exp":[760.7,236.1,781.1,686.8,501,797.8,578.8,307.3,1098.4,598.8,560.8,973.3,680.1,375.3,886.8],"Shannon_exp_fi":[385.1,127.8,437.1,373.7,181,439.4,329.4,102.4,518.7,353.4,284.2,464.8,352.7,165.6,416.5],"Shannon_exp_pe":[353.4,126.5,397.4,337.3,211.9,388.4,299.2,146.9,481.3,327.5,270.3,419.8,334.5,149.9,379.4],"Shannon_exp_pi":[226.3,59.2,291.2,235,90.1,309.2,246.1,47.9,324.7,208,88.1,331.3,224.4,67.9,298.3],"InvSimpson":[200.3,25.5,261.5,159.4,153.3,272,201.2,27.3,309.4,146.8,91.5,394.2,168.5,120.2,427.6],"InvSimpson_fi":[128,18.9,178.5,108.7,69.2,178.8,139.5,14.9,182,103.7,60.2,230,110.3,55.7,242.8],"InvSimpson_pe":[123.6,19.1,171.6,103.8,82.6,166.8,132.6,18.5,179.7,99.7,60.2,220.5,109.4,56.8,231.4],"InvSimpson_pi":[84.2,12,129.3,75.8,38.6,130.7,111,9.6,120.6,67.5,24.4,168.7,76.5,26.4,174.7]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"Observed","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["2371","1610","2272","2356","1575","2040","1663","2124","3065","2010","2157","2441","2386","813","2066"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Observed_fi","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["831","620","884","922","422","802","680","572","1011","843","771","813","874","376","670"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Observed_pe","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["707","563","737","764","411","663","574","661","857","725","671","681","751","332","571"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Observed_pi","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["502","322","590","596","224","570","499","289","664","516","276","594","563","170","491"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"},"style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"Shannon_exp","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["760.7","236.1","781.1","686.8","501","797.8","578.8","307.3","1098.4","598.8","560.8","973.3","680.1","375.3","886.8"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Shannon_exp_fi","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["385.1","127.8","437.1","373.7","181","439.4","329.4","102.4","518.7","353.4","284.2","464.8","352.7","165.6","416.5"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Shannon_exp_pe","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["353.4","126.5","397.4","337.3","211.9","388.4","299.2","146.9","481.3","327.5","270.3","419.8","334.5","149.9","379.4"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Shannon_exp_pi","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["226.3","59.2","291.2","235","90.1","309.2","246.1","47.9","324.7","208","88.1","331.3","224.4","67.9","298.3"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"},"style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"InvSimpson","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["200.3","25.5","261.5","159.4","153.3","272","201.2","27.3","309.4","146.8","91.5","394.2","168.5","120.2","427.6"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"InvSimpson_fi","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["128","18.9","178.5","108.7","69.2","178.8","139.5","14.9","182","103.7","60.2","230","110.3","55.7","242.8"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"InvSimpson_pe","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["123.6","19.1","171.6","103.8","82.6","166.8","132.6","18.5","179.7","99.7","60.2","220.5","109.4","56.8","231.4"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"InvSimpson_pi","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["84.2","12","129.3","75.8","38.6","130.7","111","9.6","120.6","67.5","24.4","168.7","76.5","26.4","174.7"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"columnGroups":[{"name":"Observed richness","headerStyle":{"borderRight":"5px solid #eee","fontSize":"1.1em"},"columns":["Observed","Observed_fi","Observed_pe","Observed_pi"]},{"name":"Shannon exponential","headerStyle":{"fontSize":"1.1em"},"columns":["Shannon_exp","Shannon_exp_fi","Shannon_exp_pe","Shannon_exp_pi"]},{"name":"Simpson multiplicative inverse","headerStyle":{"fontSize":"1.1em"},"columns":["InvSimpson","InvSimpson_fi","InvSimpson_pe","InvSimpson_pi"]}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,15],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"9e0e1d6b4f7db79bfc534bba13d02de4"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section id="normality-tests" class="level2"><h2 class="anchored" data-anchor-id="normality-tests">Normality Tests</h2>
<p>Before running significance tests, we need to know if data is normally distributed, which will tell use whether to use a parametric or non-parametric test. To test if the data are normally distributed, we use the Shapiro-Wilk Normality test and the Bartlett Test of Homogeneity of Variances.</p>
<p>If the p-values are both <strong>not significant</strong> (p &gt; 0.05) from the tests, we accept the null hypothesis (that the results are normally distributed) and test for significance between samples using an ANOVA. If the p-values are both <strong>significant</strong> (p &lt; 0.05), we reject the null hypothesis (that the results are normally distributed) and test for significance between samples using Kruskal-Wallis (non-parametric equivalent of ANOVA).</p>
<p>The commands are as follows:</p>
<p><code>shapiro.test(x)</code>, where <code>x</code> is a numeric vector of alpha diversity values from the sample data table.</p>
<p><code>bartlett.test(Value ~ Group, data = df)</code> Where <code>Value</code> is the metric of interest, <code>Group</code> in the treatment to compare, and <code>df</code> is the data frame.</p>
<p>First the Shapiro-Wilk Normality test.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu_tab_alpha_div</span>
<span class="va">ssu18_div_tab</span> <span class="op">&lt;-</span> <span class="va">ssu_tab_alpha_div</span>
<span class="va">ssu18_shap_tests_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">ssu18_div_tab</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ssu18_div_tab</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
   <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ssu18_shap_asv_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
   <span class="va">ssu18_shap_tests_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/append.html">append</a></span><span class="op">(</span><span class="va">ssu18_shap_tests_asv</span>, <span class="va">tmp_name</span><span class="op">)</span>
   <span class="va">tmp_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">ssu18_div_tab</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
   <span class="va">tmp_test</span><span class="op">$</span><span class="va">data.name</span> <span class="op">&lt;-</span> <span class="va">tmp_name</span>
   <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_test</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"shap_"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And then the Bartlett Test of Homogeneity of Variances.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_div_tab_asv</span> <span class="op">&lt;-</span> <span class="va">ssu_tab_alpha_div</span>
<span class="va">ssu18_bart_tests_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">ssu18_div_tab_asv</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ssu18_div_tab_asv</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
   <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ssu18_bart_asv_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
   <span class="va">ssu18_bart_tests_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/append.html">append</a></span><span class="op">(</span><span class="va">ssu18_bart_tests_asv</span>, <span class="va">tmp_name</span><span class="op">)</span>
   <span class="va">tmp_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">ssu18_div_tab_asv</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">~</span> <span class="va">TEMP</span>, data <span class="op">=</span> <span class="va">ssu18_div_tab_asv</span><span class="op">)</span><span class="op">)</span>
   <span class="va">tmp_test</span><span class="op">$</span><span class="va">data.name</span> <span class="op">&lt;-</span> <span class="va">tmp_name</span>
   <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_test</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_bart_"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here we see which Shapiro-Wilk Normality <strong>and</strong> Bartlett tests were significant and which were not. So wherever the value of both p-values in <code>&gt; 0.05</code> we can use an ANOVA, otherwise we use Kruskal-Wallis.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Missing pieces filled with `NA` in 3 rows [1, 5, 9].</code></pre>
</div>
</div>
<p><small><strong>(16S rRNA) Table 2 | Summary of Normality Tests for unfiltered &amp; filtered data sets. P-values in red indicate significance (p-value &lt; 0.05).</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,bWV0cmljLGRhdGFzZXQscC12YWx1ZSAobm9ybWFsaXR5KSxwLXZhbHVlIChob21vZ2VuZWl0eSksbWV0aG9kCk9ic2VydmVkLEZVTEwsMC4yNjgyLDAuNTk5MixBTk9WQQpPYnNlcnZlZCxGSUxULDAuMzY3MSwwLjU4NTEsQU5PVkEKT2JzZXJ2ZWQsUEVSZmVjdCwwLjE5MDUsMC40MzcsQU5PVkEKT2JzZXJ2ZWQsUElNRSwwLjA1NTIsMC43NTUxLEFOT1ZBClNoYW5ub24sRlVMTCwwLjk5NCwwLjQ5MDUsQU5PVkEKU2hhbm5vbixGSUxULDAuMjI5MywwLjEwNjQsQU5PVkEKU2hhbm5vbixQRVJmZWN0LDAuMzMxMSwwLjE1OTIsQU5PVkEKU2hhbm5vbixQSU1FLDAuMDM2NSwwLjg4MTIsS3J1c2thbC1XYWxsaXMKSW52U2ltcHNvbixGVUxMLDAuNTg0NCwwLjE1NDQsQU5PVkEKSW52U2ltcHNvbixGSUxULDAuNjczMSwwLjQxMTYsQU5PVkEKSW52U2ltcHNvbixQRVJmZWN0LDAuNzQ2NiwwLjM0OTcsQU5PVkEKSW52U2ltcHNvbixQSU1FLDAuMzcwOCwwLjM3MjcsQU5PVkEK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_norm_tests.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-f30d7598595affc4f25a" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f30d7598595affc4f25a">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"metric":["Observed","Observed","Observed","Observed","Shannon","Shannon","Shannon","Shannon","InvSimpson","InvSimpson","InvSimpson","InvSimpson"],"dataset":["FULL","FILT","PERfect","PIME","FULL","FILT","PERfect","PIME","FULL","FILT","PERfect","PIME"],"p-value (normality)":[0.2682,0.3671,0.1905,0.0552,0.994,0.2293,0.3311,0.0365,0.5844,0.6731,0.7466,0.3708],"p-value (homogeneity)":[0.5992,0.5851,0.437,0.7551,0.4905,0.1064,0.1592,0.8812,0.1544,0.4116,0.3497,0.3727],"method":["ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","Kruskal-Wallis","ANOVA","ANOVA","ANOVA","ANOVA"]},"columns":[{"accessor":"metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Observed","Observed","Observed","Observed","Shannon","Shannon","Shannon","Shannon","InvSimpson","InvSimpson","InvSimpson","InvSimpson"],"header":"Metric","minWidth":100,"align":"left","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"dataset","name":"dataset","type":"character","sortable":true,"resizable":false,"filterable":false,"cell":["FULL","FILT","PERfect","PIME","FULL","FILT","PERfect","PIME","FULL","FILT","PERfect","PIME"],"header":"dataset","minWidth":80,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"p-value (normality)","name":"p-value (normality)","type":"numeric","sortable":true,"resizable":false,"filterable":false,"cell":["0.2682","0.3671","0.1905","0.0552","0.994","0.2293","0.3311","0.0365","0.5844","0.6731","0.7466","0.3708"],"header":"p-value (normality)","minWidth":100,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"}]},{"accessor":"p-value (homogeneity)","name":"p-value (homogeneity)","type":"numeric","sortable":true,"resizable":false,"filterable":false,"cell":["0.5992","0.5851","0.437","0.7551","0.4905","0.1064","0.1592","0.8812","0.1544","0.4116","0.3497","0.3727"],"header":"p-value (homogeneity)","minWidth":130,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"}]},{"accessor":"method","name":"method","type":"character","sortable":true,"resizable":false,"filterable":false,"cell":["ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","Kruskal-Wallis","ANOVA","ANOVA","ANOVA","ANOVA"],"header":"method","minWidth":120,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":12,"showPageSizeOptions":true,"pageSizeOptions":[5,10,12],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"88811c9ba2d03ce860741156afc68a50"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="significance-tests" class="level2"><h2 class="anchored" data-anchor-id="significance-tests">Significance Tests</h2>
<p>To begin, we need to create a hierarchy variable; a two-column matrix specifying the relationship between samples (first column) and groups (second column).</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_hill_hier</span> <span class="op">&lt;-</span> <span class="va">ssu_tab_alpha_div</span>
<span class="va">ssu18_hill_hier</span> <span class="op">&lt;-</span> <span class="va">ssu18_hill_hier</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="st">"Sample_ID"</span>, <span class="st">"TEMP"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">remove_rownames</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">ssu18_hill_hier</span> <span class="op">&lt;-</span> <span class="va">ssu18_hill_hier</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html">order</a></span><span class="op">(</span><span class="va">ssu18_hill_hier</span><span class="op">$</span><span class="va">TEMP</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">ssu18_hill_hier</span><span class="op">$</span><span class="va">TEMP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">ssu18_hill_hier</span><span class="op">$</span><span class="va">TEMP</span>, <span class="st">'C'</span>, sep<span class="op">=</span><span class="st">''</span><span class="op">)</span>
<span class="va">ssu18_hill_hier</span> <span class="op">&lt;-</span> <span class="va">ssu18_hill_hier</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">remove_rownames</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">ssu18_hill_hier</span>, <span class="st">"files/alpha/rdata/ssu18_hill_hier.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Again, we start by testing significance of ASV diversity for the data sets against each of the three metrics using the <code>div_test</code> function.</p>
<p>The command is as follows:</p>
<pre><code>div_test(countable = x, qvalue = i, hierarchy = hier, 
         tree = ultrametric_tree, posthoc = TRUE)</code></pre>
<p>where <code>x</code> is ASV by sample table, <code>i</code> is the q-value corresponding to the metric of interest, <code>hier</code> is the hierarchy matrix, <code>tree</code> is an ultrametric formatted phylogenetic tree (if you choose to explore lineage diversity), and <code>posthoc</code> indicates whether to run post hoc pairwise analyses.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">qvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">ssu18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
     <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">qvalue</span><span class="op">)</span> <span class="op">{</span>
         <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_tu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
         <span class="va">tmp_test</span> <span class="op">&lt;-</span> <span class="fu">div_test</span><span class="op">(</span><span class="va">tmp_get</span>, qvalue <span class="op">=</span> <span class="va">j</span>,
                      hierarchy <span class="op">=</span> <span class="va">ssu18_hill_hier</span>,
                      posthoc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
         <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_q"</span>, <span class="va">j</span>, <span class="st">"_adt"</span><span class="op">)</span><span class="op">)</span>
         <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tmp_name</span><span class="op">)</span>
         <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_test</span><span class="op">)</span>
         <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
 <span class="op">}</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
</section><section id="summary" class="level2"><h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p><small><strong>(16S rRNA) Table 3 | Summary of significance tests for unfiltered &amp; filtered data sets. P-values in red for post hoc analysis indicate significance (p-value &lt; 0.05).</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,ZGF0YXNldCxtZXRyaWMscS12YWx1ZSxub3JtYWxpdHkgcC12YWx1ZSxob21vZ2VuZWl0eSBwLXZhbHVlLG1ldGhvZCxwb3N0aG9jIG1ldGhvZCxwb3N0aG9jIHAtdmFsdWUKRlVMTCxPYnNlcnZlZCwwLDAuMjY4MiwwLjU5OTIsQU5PVkEsVHVrZXkgcG9zdC1ob2MgdGVzdCwwLjA2MDUwNzM5OTMwNDE4ODEzNgpGVUxMLFNoYW5ub24gZXhwb25lbnRpYWwsMSwwLjk5NCwwLjQ5MDQsQU5PVkEsVHVrZXkgcG9zdC1ob2MgdGVzdCw2LjI3MTQ1MjExODg2MTMyNWUtNQpGVUxMLEludmVyc2UgU2ltcHNvbiwyLDAuNTg0LDAuMTU0NixBTk9WQSxUdWtleSBwb3N0LWhvYyB0ZXN0LDQuNjc0MjQzNzcyODg5NzMyNmUtNQpGSUxULE9ic2VydmVkLDAsMC4zNjcxLDAuNTg1MSxBTk9WQSxUdWtleSBwb3N0LWhvYyB0ZXN0LDAuMDA2MDc5NzkzMjU1NzQxMzQ1CkZJTFQsU2hhbm5vbiBleHBvbmVudGlhbCwxLDAuMjI5OSwwLjEwNjUsQU5PVkEsVHVrZXkgcG9zdC1ob2MgdGVzdCwyLjYxNjE5MjIyNjY5MTUwOGUtNgpGSUxULEludmVyc2UgU2ltcHNvbiwyLDAuNjczMywwLjQxMyxBTk9WQSxUdWtleSBwb3N0LWhvYyB0ZXN0LDEuMzAzNTc5ODA2MzcwMDc2OWUtNgpQSU1FLE9ic2VydmVkLDAsMC4wNTUyLDAuNzU1MSxBTk9WQSxUdWtleSBwb3N0LWhvYyB0ZXN0LDEuNDQxNTg1NTYzMTM3MDQxNGUtNgpQSU1FLFNoYW5ub24gZXhwb25lbnRpYWwsMSwwLjAzNjYsMC44OCxLcnVza2FsLVdhbGxpcyBUZXN0LER1bm4gdGVzdCB3aXRoIEJlbmphbWluaS1Ib2NoYmVyZyBjb3JyZWN0aW9uLDAuMDAxOTMwNDU0MTM2MjI3NzA5MwpQSU1FLEludmVyc2UgU2ltcHNvbiwyLDAuMzcwMSwwLjM3MTQsQU5PVkEsVHVrZXkgcG9zdC1ob2MgdGVzdCw5Ljg3MTU4MjcxNDAwNjcxM2UtNwpQRVJmZWN0LE9ic2VydmVkLDAsMC4xOTA1LDAuNDM3LEFOT1ZBLFR1a2V5IHBvc3QtaG9jIHRlc3QsMC4wNTA0NTQyNjg1OTE2NTQyNgpQRVJmZWN0LFNoYW5ub24gZXhwb25lbnRpYWwsMSwwLjMzMTEsMC4xNTkyLEFOT1ZBLFR1a2V5IHBvc3QtaG9jIHRlc3QsNy4xMzYwNzE2NDE2MTgyNjNlLTYKUEVSZmVjdCxJbnZlcnNlIFNpbXBzb24sMiwwLjc0NjgsMC4zNDg0LEFOT1ZBLFR1a2V5IHBvc3QtaG9jIHRlc3QsMy4xOTcxOTEwMzEzNzIyNjQ1ZS02Cg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_sign_tests.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-b85bf888dc62471906a9" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b85bf888dc62471906a9">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"dataset":["FULL","FULL","FULL","FILT","FILT","FILT","PIME","PIME","PIME","PERfect","PERfect","PERfect"],"metric":["Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson"],"q-value":["0","1","2","0","1","2","0","1","2","0","1","2"],"normality p-value":[0.2682,0.994,0.584,0.3671,0.2299,0.6733,0.0552,0.0366,0.3701,0.1905,0.3311,0.7468],"homogeneity p-value":[0.5992,0.4904,0.1546,0.5851,0.1065,0.413,0.7551,0.88,0.3714,0.437,0.1592,0.3484],"method":["ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","Kruskal-Wallis Test","ANOVA","ANOVA","ANOVA","ANOVA"],"posthoc method":["Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Dunn test with Benjamini-Hochberg correction","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test"],"posthoc p-value":[0.0605073993041881,6.27145211886132e-05,4.67424377288973e-05,0.00607979325574134,2.61619222669151e-06,1.30357980637008e-06,1.44158556313704e-06,0.00193045413622771,9.87158271400671e-07,0.0504542685916543,7.13607164161826e-06,3.19719103137226e-06]},"columns":[{"accessor":"dataset","name":"Dataset","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["FULL","FULL","FULL","FILT","FILT","FILT","PIME","PIME","PIME","PERfect","PERfect","PERfect"],"header":"Dataset","minWidth":80,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"metric","name":"metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson"],"header":"metric","minWidth":140,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"q-value","name":"q-value","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["0","1","2","0","1","2","0","1","2","0","1","2"],"header":"q-value","minWidth":70,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"normality p-value","name":"p-value (normality)","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.2682","0.994","0.584","0.3671","0.2299","0.6733","0.0552","0.0366","0.3701","0.1905","0.3311","0.7468"],"header":"p-value (normality)","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"homogeneity p-value","name":"p-value (homogeneity)","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.5992","0.4904","0.1546","0.5851","0.1065","0.413","0.7551","0.88","0.3714","0.437","0.1592","0.3484"],"header":"p-value (homogeneity)","minWidth":130,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"method","name":"method","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","Kruskal-Wallis Test","ANOVA","ANOVA","ANOVA","ANOVA"],"header":"method","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"posthoc method","name":"posthoc method","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Dunn test with Benjamini-Hochberg correction","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test"],"header":"posthoc method","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"posthoc p-value","name":"posthoc p-value","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["6.05e-02","6.27e-05","4.67e-05","6.08e-03","2.62e-06","1.3e-06","1.44e-06","1.93e-03","9.87e-07","5.05e-02","7.14e-06","3.2e-06"],"header":"posthoc p-value","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"}]}],"defaultPageSize":12,"showPageSizeOptions":true,"pageSizeOptions":[5,10,12],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.7em"}},"dataKey":"690f29c658c374e839a7e63b38ea970a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="posthoc-analyses" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="posthoc-analyses">PostHoc Analyses</h2>
<p>First let’s check the results of each posthoc analysis.</p>
<div class="column-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Observed (q-value = 0)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Shannon exp (q-value = 1)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Inverse Simpson (q-value = 2)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FULL (Observed)"
[1] "Tukey post-hoc test"
        diff       lwr       upr      p.adj
3C-0C -219.6  -956.946 517.74597 0.71329233
8C-0C -721.0 -1458.346  16.34597 0.05546473
8C-3C -501.4 -1238.746 235.94597 0.20658985</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FILT (Observed)"
[1] "Tukey post-hoc test"
        diff       lwr      upr      p.adj
3C-0C   -6.0 -221.6963 209.6963 0.99696904
8C-0C -283.8 -499.4963 -68.1037 0.01109212
8C-3C -277.8 -493.4963 -62.1037 0.01267274</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PIME (Observed)"
[1] "Tukey post-hoc test"
        diff       lwr       upr          p.adj
3C-0C  -46.6 -140.1306   46.9306 0.406733563435
8C-0C -325.6 -419.1306 -232.0694 0.000002206313
8C-3C -279.0 -372.5306 -185.4694 0.000011005557</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PERfect (Observed)"
[1] "Tukey post-hoc test"
        diff       lwr       upr      p.adj
3C-0C    2.4 -191.8227 196.62267 0.99940103
8C-0C -174.2 -368.4227  20.02267 0.08059254
8C-3C -176.6 -370.8227  17.62267 0.07616681</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FULL (Shannon exponential)"
[1] "Tukey post-hoc test"
           diff       lwr        upr         p.adj
3C-0C -246.4375 -442.9939  -49.88101 0.01492642034
8C-0C -511.4071 -707.9635 -314.85066 0.00004295672
8C-3C -264.9696 -461.5261  -68.41321 0.00950353162</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FILT (Shannon exponential)"
[1] "Tukey post-hoc test"
           diff       lwr        upr          p.adj
3C-0C  -96.4627 -177.3128  -15.61258 0.019965252769
8C-0C -283.1154 -363.9656 -202.26533 0.000002072881
8C-3C -186.6527 -267.5029 -105.80262 0.000133670064</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PIME (Shannon exponential)"
[1] "Dunn test with Benjamini-Hochberg correction"
             Z     P.unadj       P.adj
0C-3C 1.767767 0.077099872 0.077099872
0C-8C 3.535534 0.000406952 0.001220856
3C-8C 1.767767 0.077099872 0.115649808</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PERfect (Shannon exponential)"
[1] "Tukey post-hoc test"
            diff       lwr        upr          p.adj
3C-0C  -82.87871 -155.6134  -10.14407 0.025808833615
8C-0C -232.15045 -304.8851 -159.41581 0.000005488596
8C-3C -149.27174 -222.0064  -76.53710 0.000385348747</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FULL (Inverse Simpson)"
[1] "Tukey post-hoc test"
           diff       lwr        upr         p.adj
3C-0C -157.7331 -251.7760  -63.69027 0.00202540187
8C-0C -249.3938 -343.4367 -155.35097 0.00003566326
8C-3C  -91.6607 -185.7036    2.38217 0.05628905499</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FILT (Inverse Simpson)"
[1] "Tukey post-hoc test"
            diff       lwr        upr           p.adj
3C-0C  -84.38551 -126.1609  -42.61016 0.0004422940804
8C-0C -158.66732 -200.4427 -116.89197 0.0000008678593
8C-3C  -74.28181 -116.0572  -32.50646 0.0012804120273</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PIME (Inverse Simpson)"
[1] "Tukey post-hoc test"
            diff        lwr       upr          p.adj
3C-0C  -61.82853  -93.26452 -30.39255 0.000556162049
8C-0C -122.59975 -154.03574 -91.16377 0.000000651479
8C-3C  -60.77122  -92.20720 -29.33524 0.000643758728</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PERfect (Inverse Simpson)"
[1] "Tukey post-hoc test"
            diff       lwr        upr          p.adj
3C-0C  -80.17581 -122.1927  -38.15894 0.000718157610
8C-0C -146.57155 -188.5884 -104.55467 0.000002158578
8C-3C  -66.39574 -108.4126  -24.37887 0.003172202683</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now we can plot the results from the posthoc analyses for each metric and data set using the function <code>div_test_plot_jjs</code>. I modified the original function (<code>div_test_plot</code>) to control a little of the formatting.</p>
<p>The command is as follows:</p>
<pre><code>div_test_plot(divtest = x, chart = "type", colour = col.pal, 
              posthoc = TRUE, threshold = value))</code></pre>
<p>where <code>x</code> is the results from the <code>div_test</code> function, <code>"type"</code> is chart type (box, jitter, or violin), <code>colour</code> is is a color palette, <code>posthoc</code> indicates whether to run posthoc pairwise analyses, and <code>value</code> is the maximum p-value to show in pairwise posthoc results. <strong>WARNING</strong> if none of the posthoc results are below the specified threshold, the function will throw an error. Therefore, until this is fixed, all posthoc values are shown.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"hack_code/div_test_plot_jjs.R"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_adt_plot"</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_adt"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_plot"</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
     <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu">div_test_plot_jjs</span><span class="op">(</span><span class="va">tmp_get</span>, chart <span class="op">=</span> <span class="st">"box"</span>,
                                 colour <span class="op">=</span> <span class="va">swel_col</span>, posthoc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
     <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu">ggpar</span><span class="op">(</span><span class="va">tmp_df</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tmp_name</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_df</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
</section><section id="alpha-diversity-plots" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="alpha-diversity-plots">Alpha Diversity Plots</h2>
<p>Posthoc adjusted p-values given for each pairwise comparison.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-body-outset">
<p><img src="include/alpha/ssu18_alph_div_plots_asv.png" class="img-fluid" width="7086"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 1 | Alpha diversity plots. Top row = Observed; middle row = Shannon exponential; bottom row = Inverse Simpson. From left to right, Full (unfiltered) data, Arbitrary filtered, PERfect filtered, PIME filtered.</strong></small></p>
<div class="cell">

</div>
<div class="cell">

</div>
</section></section><section id="its" class="level1 page-columns page-full"><h1>ITS</h1>
<div class="cell">

</div>
<p>To account for presence of rare sequence variants caused by sequencing errors or other technical artifacts, we use Hill numbers <span class="citation" data-cites="alberdi2019guide">(<a href="#ref-alberdi2019guide" role="doc-biblioref">Alberdi and Gilbert 2019a</a>)</span>. Hill numbers allow the weight put on rare versus abundant sequence variants to be scaled while providing intuitive comparisons of diversity levels using “effective number of ASVs” as a measuring unit. This approach allows for balancing the over representation of rare ASVs that might be inflated due to sequencing errors.</p>
<p>We will then use Shapiro-Wilk tests to test for normalcy and then, depending on the results, either use parametric ANOVA or non-parametric Kruskal-Wallis to compare alpha diversity among treatments.</p>
<section id="calculate-hill-numbers-1" class="level2"><h2 class="anchored" data-anchor-id="calculate-hill-numbers-1">Calculate Hill Numbers</h2>
<p>To calculate Hill numbers, we use the R package <code>hilldiv</code> <span class="citation" data-cites="alberdi2019hilldiv">(<a href="#ref-alberdi2019hilldiv" role="doc-biblioref">Alberdi and Gilbert 2019b</a>)</span>. We calculate three metrics that put more or less weight on common species:</p>
<ol type="1">
<li>Observed richness, where <code>q-value = 0</code>.</li>
<li>Shannon exponential, which weighs ASVs by their frequency, where <code>q-value = 1</code>.</li>
<li>Simpson multiplicative inverse, which over weighs abundant ASVs, where <code>q-value = 2</code>.</li>
</ol>
<p>We perform each analysis against the Full (unfiltered) data set as well as the Arbitrary, PERfect and PIME, filtered data sets using the function <code>hill_div</code>.</p>
<p>The command is as follows:</p>
<pre><code>hill_div(count = x, qvalue = i, tree = ultrametric_tree)</code></pre>
<p>where <code>x</code> is the sample by ASV table, <code>i</code> is the q-value corresponding to the metric of interest and <code>tree</code> is an ultrametric formatted phylogenetic tree, however this really doesn’t apply for ITS data anyway.</p>
<p>We first transform all the data to relative abundance values, and compute new trees.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_alpha_ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, <span class="st">"its18_ps_perfect"</span>, <span class="st">"its18_ps_pime"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">its18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transformcounts.html">transform_sample_counts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">otu</span><span class="op">)</span> <span class="va">otu</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">otu</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_ps</span><span class="op">@</span><span class="va">phy_tree</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="va">tmp_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>,
                      tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_ps_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">tmp_ps</span>, <span class="va">sample_data</span>, <span class="va">tmp_tree</span><span class="op">)</span>
  <span class="va">tmp_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">tmp_ps_norm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_ps_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_norm"</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_ps_name</span>, <span class="va">tmp_ps_norm</span><span class="op">)</span>
  <span class="va">tmp_asv_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_tu"</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_asv_name</span>, <span class="va">tmp_asv</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we run the analysis for all three metrics on the data sets (without a tree).</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">qvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">qvalue</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">its18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">j</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_tu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu">hill_div</span><span class="op">(</span><span class="va">tmp_asv</span>, qvalue <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="va">tmp_df</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"tmp_name"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>
                              <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"SamName"</span><span class="op">)</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">j</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_h"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tmp_name</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_df</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_h"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And make summary tables to add back into each <code>ps</code> object.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">its18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_h0"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_sha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_h1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_h2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_hill</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_obs</span>, <span class="va">tmp_sha</span>, by <span class="op">=</span> <span class="st">"SamName"</span><span class="op">)</span> <span class="op">%&gt;%</span>
       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">tmp_sim</span>, by <span class="op">=</span> <span class="st">"SamName"</span><span class="op">)</span> <span class="op">%&gt;%</span>
       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"Observed"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"Shannon_exp"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"InvSimpson"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_hill"</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_hill</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_hill"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And then create the new objects with the diversity data.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">its18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
     <span class="va">tmp_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>,
                      tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">tmp_ps</span>, <span class="va">sample_data</span>, <span class="va">tmp_tree</span><span class="op">)</span>
     <span class="va">tmp_hill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_hill"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_hill_samp</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>,
                                         <span class="va">tmp_hill</span>, by <span class="op">=</span> <span class="st">"SamName"</span><span class="op">)</span>
     <span class="va">tmp_hill_samp</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="va">tmp_hill_samp</span><span class="op">$</span><span class="va">SamName</span>
     <span class="va">tmp_hill_samp</span> <span class="op">&lt;-</span> <span class="va">tmp_hill_samp</span> <span class="op">%&gt;%</span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
     <span class="va">tmp_ps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_hill_samp</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html">tax_table</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/phy_tree-methods.html">phy_tree</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">tmp_ps2</span><span class="op">)</span>
     <span class="va">tmp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"files/alpha/rdata/"</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">tmp_ps2</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path</span>, <span class="va">i</span>, <span class="st">".rds"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="hill-numbers-summary-1" class="level2"><h2 class="anchored" data-anchor-id="hill-numbers-summary-1">Hill Numbers Summary</h2>
<p>Now we summarize the data for each sample against all three metrics. The table contains the results of ASV diversity estimates from the full data set and the three filtered data sets.</p>
<p>The suffix <code>_fi</code> indicates metrics for the Arbitrary data set. The suffix <code>_pe</code> indicates metrics for the PERfect data set and the suffix <code>_pet</code> indicates the lineage diversity for the PERfect data set.</p>
<p>The suffix <code>_pi</code> indicates metrics for the PIME data set and the suffix <code>_pit</code> indicates the lineage diversity for the PIME data set.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<section id="hill-summary-1" class="level3"><h3 class="anchored" data-anchor-id="hill-summary-1">Hill Summary</h3>
<p><small><strong>(ITS) Table 1 | Hill numbers for samples in the unfiltered &amp; filtered data sets.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELE9ic2VydmVkLE9ic2VydmVkX2ZpLE9ic2VydmVkX3BlLE9ic2VydmVkX3BpLFNoYW5ub25fZXhwLFNoYW5ub25fZXhwX2ZpLFNoYW5ub25fZXhwX3BlLFNoYW5ub25fZXhwX3BpLEludlNpbXBzb24sSW52U2ltcHNvbl9maSxJbnZTaW1wc29uX3BlLEludlNpbXBzb25fcGkKUDAxX0QwMF8wMTBfVzNBLDk0NSw0OTksMTQ4LDE4MSw1NS45LDMzLjgsMTguNSwxNC44LDEwLjcsOC40LDYuOCw1LjYKUDAxX0QwMF8wMTBfVzhBLDcxOSwzNDQsOTgsMTIzLDE0MS41LDc5LDMxLjgsMzEuNiw0Mi40LDI4LjEsMTcuMywxMi41ClAwMl9EMDBfMDEwX0MwQSwxMDExLDQ5NCwxNDcsMjM4LDExMi41LDY0LDM4LjEsNDMuMywzNi4xLDI2LjIsMjEuOSwxOS45ClAwM19EMDBfMDEwX1czQiw3NjUsNDIzLDEzNiwxOTYsMTMyLjksODMsNDUuNyw1Ni41LDQ0LjEsMjkuMSwyNC40LDI2LjkKUDAzX0QwMF8wMTBfVzhCLDM0OSwyMDQsNjQsMTA5LDExMi4xLDcyLjIsMjYuMiw0Mi44LDQ5LDM2LjQsMTcuOCwyMy43ClAwNF9EMDBfMDEwX0MwQiwxMDE3LDQ3MSwxNjEsMjI5LDYwLjksNDMuMywyNS4yLDM5LjUsMTcuNiwxNS41LDEyLjUsMjAuNgpQMDVfRDAwXzAxMF9XOEMsNjE2LDI5Niw5MCwxMzEsMTU3LjUsNzYuNiwzNC4yLDM1LjEsNDEuOCwyMC43LDE1LjMsMTEuNQpQMDZfRDAwXzAxMF9DMEMsOTU0LDQ4NiwxNTcsMjQ2LDk5LjUsNTguNCwzNC4yLDM1LjIsMjMuOSwxNi41LDE0LjgsMTMuMQpQMDdfRDAwXzAxMF9XM0QsODY3LDQ5MiwxNDcsMjA1LDE2MC40LDEwMi45LDQ2LjMsNDgsNTYuMiw0Mi44LDI3LjIsMjIuNQpQMDdfRDAwXzAxMF9XOEQsMzM1LDIyMyw3Niw5NywzNSwyOCwxNi45LDE4LjEsMTMuNywxMi4zLDkuMSw5LjkKUDA4X0QwMF8wMTBfQzBELDcwMiwzNDUsMTA1LDE5OCw4Ny4yLDQ2LjcsMjUuNywzMC43LDI1LjUsMTcuOSwxNC4yLDE0LjIKUDA5X0QwMF8wMTBfVzNFLDc0NSwzOTAsMTE4LDE5NiwyMzIuNywxMzMuNiw1MS45LDY2LjYsOTYsNjEuNywzMy45LDM0LjkKUDEwX0QwMF8wMTBfQzBFLDgxMiw0MDQsMTQzLDIwMywyNC42LDE0LjcsMTEuMSw4LjEsNC45LDQsMy44LDIuNQo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_tab_alpha_div.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-88fdd2a34d502a66744b" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-88fdd2a34d502a66744b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"Observed":[945,719,1011,765,349,1017,616,954,867,335,702,745,812],"Observed_fi":[499,344,494,423,204,471,296,486,492,223,345,390,404],"Observed_pe":[148,98,147,136,64,161,90,157,147,76,105,118,143],"Observed_pi":[181,123,238,196,109,229,131,246,205,97,198,196,203],"Shannon_exp":[55.9,141.5,112.5,132.9,112.1,60.9,157.5,99.5,160.4,35,87.2,232.7,24.6],"Shannon_exp_fi":[33.8,79,64,83,72.2,43.3,76.6,58.4,102.9,28,46.7,133.6,14.7],"Shannon_exp_pe":[18.5,31.8,38.1,45.7,26.2,25.2,34.2,34.2,46.3,16.9,25.7,51.9,11.1],"Shannon_exp_pi":[14.8,31.6,43.3,56.5,42.8,39.5,35.1,35.2,48,18.1,30.7,66.6,8.1],"InvSimpson":[10.7,42.4,36.1,44.1,49,17.6,41.8,23.9,56.2,13.7,25.5,96,4.9],"InvSimpson_fi":[8.4,28.1,26.2,29.1,36.4,15.5,20.7,16.5,42.8,12.3,17.9,61.7,4],"InvSimpson_pe":[6.8,17.3,21.9,24.4,17.8,12.5,15.3,14.8,27.2,9.1,14.2,33.9,3.8],"InvSimpson_pi":[5.6,12.5,19.9,26.9,23.7,20.6,11.5,13.1,22.5,9.9,14.2,34.9,2.5]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"Observed","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["945","719","1011","765","349","1017","616","954","867","335","702","745","812"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Observed_fi","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["499","344","494","423","204","471","296","486","492","223","345","390","404"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Observed_pe","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["148","98","147","136","64","161","90","157","147","76","105","118","143"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Observed_pi","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["181","123","238","196","109","229","131","246","205","97","198","196","203"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"},"style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"Shannon_exp","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["55.9","141.5","112.5","132.9","112.1","60.9","157.5","99.5","160.4","35","87.2","232.7","24.6"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Shannon_exp_fi","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["33.8","79","64","83","72.2","43.3","76.6","58.4","102.9","28","46.7","133.6","14.7"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Shannon_exp_pe","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["18.5","31.8","38.1","45.7","26.2","25.2","34.2","34.2","46.3","16.9","25.7","51.9","11.1"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Shannon_exp_pi","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["14.8","31.6","43.3","56.5","42.8","39.5","35.1","35.2","48","18.1","30.7","66.6","8.1"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"},"style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"InvSimpson","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["10.7","42.4","36.1","44.1","49","17.6","41.8","23.9","56.2","13.7","25.5","96","4.9"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"InvSimpson_fi","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["8.4","28.1","26.2","29.1","36.4","15.5","20.7","16.5","42.8","12.3","17.9","61.7","4"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"InvSimpson_pe","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["6.8","17.3","21.9","24.4","17.8","12.5","15.3","14.8","27.2","9.1","14.2","33.9","3.8"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"InvSimpson_pi","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["5.6","12.5","19.9","26.9","23.7","20.6","11.5","13.1","22.5","9.9","14.2","34.9","2.5"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"columnGroups":[{"name":"Observed richness","headerStyle":{"borderRight":"5px solid #eee","fontSize":"1.1em"},"columns":["Observed","Observed_fi","Observed_pe","Observed_pi"]},{"name":"Shannon exponential","headerStyle":{"fontSize":"1.1em"},"columns":["Shannon_exp","Shannon_exp_fi","Shannon_exp_pe","Shannon_exp_pi"]},{"name":"Simpson multiplicative inverse","headerStyle":{"fontSize":"1.1em"},"columns":["InvSimpson","InvSimpson_fi","InvSimpson_pe","InvSimpson_pi"]}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,13],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"484a2a1d115ced7d1614beaeae762c62"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section id="normality-tests-1" class="level2"><h2 class="anchored" data-anchor-id="normality-tests-1">Normality Tests</h2>
<p>Before running significance tests, we need to know if data is normally distributed, which will tell use whether to use a parametric or non-parametric test. To test if the data are normally distributed, we use the Shapiro-Wilk Normality test and the Bartlett Test of Homogeneity of Variances.</p>
<p>If the p-values are both <strong>not significant</strong> (p &gt; 0.05) from the tests, we accept the null hypothesis (that the results are normally distributed) and test for significance between samples using an ANOVA. If the p-values are both <strong>significant</strong> (p &lt; 0.05), we reject the null hypothesis (that the results are normally distributed) and test for significance between samples using Kruskal-Wallis (non-parametric equivalent of ANOVA).</p>
<p>The commands are as follows:</p>
<p><code>shapiro.test(x)</code>, where <code>x</code> is a numeric vector of alpha diversity values from the sample data table.</p>
<p><code>bartlett.test(Value ~ Group, data = df)</code> Where <code>Value</code> is the metric of interest, <code>Group</code> in the treatment to compare, and <code>df</code> is the data frame.</p>
<p>First the Shapiro-Wilk Normality test.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its_tab_alpha_div</span>
<span class="va">its18_div_tab</span> <span class="op">&lt;-</span> <span class="va">its_tab_alpha_div</span>
<span class="va">its18_shap_tests_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">its18_div_tab</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">its18_div_tab</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
   <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"its18_shap_asv_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
   <span class="va">its18_shap_tests_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/append.html">append</a></span><span class="op">(</span><span class="va">its18_shap_tests_asv</span>, <span class="va">tmp_name</span><span class="op">)</span>
   <span class="va">tmp_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">its18_div_tab</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
   <span class="va">tmp_test</span><span class="op">$</span><span class="va">data.name</span> <span class="op">&lt;-</span> <span class="va">tmp_name</span>
   <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_test</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"shap_"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And then the Bartlett Test of Homogeneity of Variances.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_div_tab_asv</span> <span class="op">&lt;-</span> <span class="va">its_tab_alpha_div</span>
<span class="va">its18_bart_tests_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">its18_div_tab_asv</span><span class="op">[</span>,<span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">its18_div_tab_asv</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
   <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"its18_bart_asv_"</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
   <span class="va">its18_bart_tests_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/append.html">append</a></span><span class="op">(</span><span class="va">its18_bart_tests_asv</span>, <span class="va">tmp_name</span><span class="op">)</span>
   <span class="va">tmp_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">its18_div_tab_asv</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">~</span> <span class="va">TEMP</span>, data <span class="op">=</span> <span class="va">its18_div_tab_asv</span><span class="op">)</span><span class="op">)</span>
   <span class="va">tmp_test</span><span class="op">$</span><span class="va">data.name</span> <span class="op">&lt;-</span> <span class="va">tmp_name</span>
   <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_test</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_bart_"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here we see which Shapiro-Wilk Normality <strong>and</strong> Bartlett tests were significant and which were not. So wherever the value of both p-values in <code>&gt; 0.05</code> we can use an ANOVA, otherwise we use Kruskal-Wallis.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Missing pieces filled with `NA` in 3 rows [1, 5, 9].</code></pre>
</div>
</div>
<p><small><strong>(ITS) Table 2 | Summary of Normality Tests for unfiltered &amp; filtered data sets. P-values in red indicate significance (p-value &lt; 0.05).</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,bWV0cmljLGRhdGFzZXQscC12YWx1ZSAobm9ybWFsaXR5KSxwLXZhbHVlIChob21vZ2VuZWl0eSksbWV0aG9kCk9ic2VydmVkLEZVTEwsMC4xMjg0LDAuNTE2MSxBTk9WQQpPYnNlcnZlZCxGSUxULDAuMTE0OCwwLjkzODEsQU5PVkEKT2JzZXJ2ZWQsUEVSZmVjdCwwLjE2MTYsMC42Njc0LEFOT1ZBCk9ic2VydmVkLFBJTUUsMC4xMzQzLDAuNDU0MyxBTk9WQQpTaGFubm9uLEZVTEwsMC44NDY1LDAuNDQ1NSxBTk9WQQpTaGFubm9uLEZJTFQsMC45MzM5LDAuMzYzMixBTk9WQQpTaGFubm9uLFBFUmZlY3QsMC45MjEzLDAuNTU1MSxBTk9WQQpTaGFubm9uLFBJTUUsMC45NzI0LDAuNDMyNSxBTk9WQQpJbnZTaW1wc29uLEZVTEwsMC4xODM3LDAuMTI1NSxBTk9WQQpJbnZTaW1wc29uLEZJTFQsMC4zNTAzLDAuMTYwMSxBTk9WQQpJbnZTaW1wc29uLFBFUmZlY3QsMC45NjA3LDAuMjM3MixBTk9WQQpJbnZTaW1wc29uLFBJTUUsMC45NTgxLDAuNDc2MyxBTk9WQQo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_norm_tests.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-8e1fe96c0688a849169a" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8e1fe96c0688a849169a">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"metric":["Observed","Observed","Observed","Observed","Shannon","Shannon","Shannon","Shannon","InvSimpson","InvSimpson","InvSimpson","InvSimpson"],"dataset":["FULL","FILT","PERfect","PIME","FULL","FILT","PERfect","PIME","FULL","FILT","PERfect","PIME"],"p-value (normality)":[0.1284,0.1148,0.1616,0.1343,0.8465,0.9339,0.9213,0.9724,0.1837,0.3503,0.9607,0.9581],"p-value (homogeneity)":[0.5161,0.9381,0.6674,0.4543,0.4455,0.3632,0.5551,0.4325,0.1255,0.1601,0.2372,0.4763],"method":["ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA"]},"columns":[{"accessor":"metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Observed","Observed","Observed","Observed","Shannon","Shannon","Shannon","Shannon","InvSimpson","InvSimpson","InvSimpson","InvSimpson"],"header":"Metric","minWidth":100,"align":"left","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"dataset","name":"dataset","type":"character","sortable":true,"resizable":false,"filterable":false,"cell":["FULL","FILT","PERfect","PIME","FULL","FILT","PERfect","PIME","FULL","FILT","PERfect","PIME"],"header":"dataset","minWidth":80,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"p-value (normality)","name":"p-value (normality)","type":"numeric","sortable":true,"resizable":false,"filterable":false,"cell":["0.1284","0.1148","0.1616","0.1343","0.8465","0.9339","0.9213","0.9724","0.1837","0.3503","0.9607","0.9581"],"header":"p-value (normality)","minWidth":100,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"}]},{"accessor":"p-value (homogeneity)","name":"p-value (homogeneity)","type":"numeric","sortable":true,"resizable":false,"filterable":false,"cell":["0.5161","0.9381","0.6674","0.4543","0.4455","0.3632","0.5551","0.4325","0.1255","0.1601","0.2372","0.4763"],"header":"p-value (homogeneity)","minWidth":130,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"}]},{"accessor":"method","name":"method","type":"character","sortable":true,"resizable":false,"filterable":false,"cell":["ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA"],"header":"method","minWidth":120,"align":"center","headerVAlign":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":12,"showPageSizeOptions":true,"pageSizeOptions":[5,10,12],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"57ccf5f6f62b87e32127f70dae384abd"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="significance-tests-1" class="level2"><h2 class="anchored" data-anchor-id="significance-tests-1">Significance Tests</h2>
<p>To begin, we need to create a hierarchy variable; a two-column matrix specifying the relationship between samples (first column) and groups (second column).</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_hill_hier</span> <span class="op">&lt;-</span> <span class="va">its_tab_alpha_div</span>
<span class="va">its18_hill_hier</span> <span class="op">&lt;-</span> <span class="va">its18_hill_hier</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="st">"Sample_ID"</span>, <span class="st">"TEMP"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">remove_rownames</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">its18_hill_hier</span> <span class="op">&lt;-</span> <span class="va">its18_hill_hier</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html">order</a></span><span class="op">(</span><span class="va">its18_hill_hier</span><span class="op">$</span><span class="va">TEMP</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">its18_hill_hier</span><span class="op">$</span><span class="va">TEMP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">its18_hill_hier</span><span class="op">$</span><span class="va">TEMP</span>, <span class="st">'C'</span>, sep<span class="op">=</span><span class="st">''</span><span class="op">)</span>
<span class="va">its18_hill_hier</span> <span class="op">&lt;-</span> <span class="va">its18_hill_hier</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">remove_rownames</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">its18_hill_hier</span>, <span class="st">"files/alpha/rdata/its18_hill_hier.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Again, we start by testing significance of ASV diversity for the data sets against each of the three metrics using the <code>div_test</code> function.</p>
<p>The command is as follows:</p>
<pre><code>div_test(countable = x, qvalue = i, hierarchy = hier, 
         tree = ultrametric_tree, posthoc = TRUE)</code></pre>
<p>where <code>x</code> is ASV by sample table, <code>i</code> is the q-value corresponding to the metric of interest, <code>hier</code> is the hierarchy matrix, <code>tree</code> is an ultrametric formatted phylogenetic tree (if you choose to explore lineage diversity), and <code>posthoc</code> indicates whether to run post hoc pairwise analyses.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">qvalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">its18_alpha_ds</span><span class="op">)</span> <span class="op">{</span>
     <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">qvalue</span><span class="op">)</span> <span class="op">{</span>
         <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_tu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
         <span class="va">tmp_test</span> <span class="op">&lt;-</span> <span class="fu">div_test</span><span class="op">(</span><span class="va">tmp_get</span>, qvalue <span class="op">=</span> <span class="va">j</span>,
                      hierarchy <span class="op">=</span> <span class="va">its18_hill_hier</span>,
                      posthoc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
         <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_q"</span>, <span class="va">j</span>, <span class="st">"_adt"</span><span class="op">)</span><span class="op">)</span>
         <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tmp_name</span><span class="op">)</span>
         <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_test</span><span class="op">)</span>
         <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
 <span class="op">}</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
</section><section id="summary-1" class="level2"><h2 class="anchored" data-anchor-id="summary-1">Summary</h2>
<p><small><strong>(ITS) Table 3 | Summary of significance tests for unfiltered &amp; filtered data sets. P-values in red for post hoc analysis indicate significance (p-value &lt; 0.05).</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,ZGF0YXNldCxtZXRyaWMscS12YWx1ZSxub3JtYWxpdHkgcC12YWx1ZSxob21vZ2VuZWl0eSBwLXZhbHVlLG1ldGhvZCxwb3N0aG9jIG1ldGhvZCxwb3N0aG9jIHAtdmFsdWUKRlVMTCxPYnNlcnZlZCwwLDAuMTI4NCwwLjUxNjEsQU5PVkEsVHVrZXkgcG9zdC1ob2MgdGVzdCwwLjAwNjE0NDk1NTM3NjQ2MjIwMDUKRlVMTCxTaGFubm9uIGV4cG9uZW50aWFsLDEsMC44NDU2LDAuNDQ1NCxBTk9WQSxUdWtleSBwb3N0LWhvYyB0ZXN0LDAuMjIxMjE2MjgxMzQzMTM0MDYKRlVMTCxJbnZlcnNlIFNpbXBzb24sMiwwLjE4MzcsMC4xMjU4LEFOT1ZBLFR1a2V5IHBvc3QtaG9jIHRlc3QsMC4xODE4NzIyNjcwNjIwMDI5CkZJTFQsT2JzZXJ2ZWQsMCwwLjExNDgsMC45MzgxLEFOT1ZBLFR1a2V5IHBvc3QtaG9jIHRlc3QsMC4wMDIzNjM0NTAxMzk1MzMyNApGSUxULFNoYW5ub24gZXhwb25lbnRpYWwsMSwwLjkzNDQsMC4zNjMyLEFOT1ZBLFR1a2V5IHBvc3QtaG9jIHRlc3QsMC4xMzk0ODI0NDU4MzExNjQ3CkZJTFQsSW52ZXJzZSBTaW1wc29uLDIsMC4zNDkxLDAuMTU5NCxBTk9WQSxUdWtleSBwb3N0LWhvYyB0ZXN0LDAuMTgzMjM4OTkwNzcyODQ2MgpQSU1FLE9ic2VydmVkLDAsMC4xMzQzLDAuNDU0MyxBTk9WQSxUdWtleSBwb3N0LWhvYyB0ZXN0LDcuMzYyNjU1Nzk1OTY4ODUzZS02ClBJTUUsU2hhbm5vbiBleHBvbmVudGlhbCwxLDAuOTcyMSwwLjQzNjMsQU5PVkEsVHVrZXkgcG9zdC1ob2MgdGVzdCwwLjM0NjQ0MTkzNDQyMjY4NDgKUElNRSxJbnZlcnNlIFNpbXBzb24sMiwwLjk1NDksMC40NzY4LEFOT1ZBLFR1a2V5IHBvc3QtaG9jIHRlc3QsMC4zNDE3ODgzNDU5MzU5NjcKUEVSZmVjdCxPYnNlcnZlZCwwLDAuMTYxNiwwLjY2NzQsQU5PVkEsVHVrZXkgcG9zdC1ob2MgdGVzdCwwLjAwMTA4NzA1MDMwNDEwMTIzNgpQRVJmZWN0LFNoYW5ub24gZXhwb25lbnRpYWwsMSwwLjkxOTQsMC41NTU0LEFOT1ZBLFR1a2V5IHBvc3QtaG9jIHRlc3QsMC4xODY4OTMxMTQ4NDIzNjQ4NwpQRVJmZWN0LEludmVyc2UgU2ltcHNvbiwyLDAuOTYwOSwwLjIzNjIsQU5PVkEsVHVrZXkgcG9zdC1ob2MgdGVzdCwwLjIwNDg1MDM4MzcyNTYzMTMK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_sign_tests.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-bb3486349adfa5d821dc" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bb3486349adfa5d821dc">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"dataset":["FULL","FULL","FULL","FILT","FILT","FILT","PIME","PIME","PIME","PERfect","PERfect","PERfect"],"metric":["Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson"],"q-value":["0","1","2","0","1","2","0","1","2","0","1","2"],"normality p-value":[0.1284,0.8456,0.1837,0.1148,0.9344,0.3491,0.1343,0.9721,0.9549,0.1616,0.9194,0.9609],"homogeneity p-value":[0.5161,0.4454,0.1258,0.9381,0.3632,0.1594,0.4543,0.4363,0.4768,0.6674,0.5554,0.2362],"method":["ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA"],"posthoc method":["Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test"],"posthoc p-value":[0.0061449553764622,0.221216281343134,0.181872267062003,0.00236345013953324,0.139482445831165,0.183238990772846,7.36265579596885e-06,0.346441934422685,0.341788345935967,0.00108705030410124,0.186893114842365,0.204850383725631]},"columns":[{"accessor":"dataset","name":"Dataset","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["FULL","FULL","FULL","FILT","FILT","FILT","PIME","PIME","PIME","PERfect","PERfect","PERfect"],"header":"Dataset","minWidth":100,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"metric","name":"metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson","Observed","Shannon exponential","Inverse Simpson"],"header":"metric","minWidth":140,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"q-value","name":"q-value","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["0","1","2","0","1","2","0","1","2","0","1","2"],"header":"q-value","minWidth":70,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"normality p-value","name":"p-value (normality)","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.1284","0.8456","0.1837","0.1148","0.9344","0.3491","0.1343","0.9721","0.9549","0.1616","0.9194","0.9609"],"header":"p-value (normality)","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"homogeneity p-value","name":"p-value (homogeneity)","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.5161","0.4454","0.1258","0.9381","0.3632","0.1594","0.4543","0.4363","0.4768","0.6674","0.5554","0.2362"],"header":"p-value (homogeneity)","minWidth":130,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"method","name":"method","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA","ANOVA"],"header":"method","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"posthoc method","name":"posthoc method","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test","Tukey post-hoc test"],"header":"posthoc method","minWidth":80,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"posthoc p-value","name":"posthoc p-value","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["6.14e-03","2.21e-01","1.82e-01","2.36e-03","1.39e-01","1.83e-01","7.36e-06","3.46e-01","3.42e-01","1.09e-03","1.87e-01","2.05e-01"],"header":"posthoc p-value","minWidth":80,"align":"center","footerStyle":{"fontWeight":"bold"},"style":[{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#B22271","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"},{"color":"#2271B2","fontWeight":"bold"}]}],"defaultPageSize":12,"showPageSizeOptions":true,"pageSizeOptions":[5,10,12],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.7em"}},"dataKey":"2d57270ad06466148b20e356d69dc825"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="posthoc-analyses-1" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="posthoc-analyses-1">PostHoc Analyses</h2>
<p>First let’s check the results of each posthoc analysis.</p>
<div class="column-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Observed (q-value = 0)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Shannon exp (q-value = 1)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Inverse Simpson (q-value = 2)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FULL (Observed)"
[1] "Tukey post-hoc test"
         diff       lwr        upr       p.adj
3C-0C  -68.70 -337.2489  199.84893 0.768173881
8C-0C -394.45 -662.9989 -125.90107 0.006201167
8C-3C -325.75 -608.8254  -42.67457 0.025372568</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FILT (Observed)"
[1] "Tukey post-hoc test"
         diff       lwr       upr       p.adj
3C-0C   11.00 -101.5783 123.57828 0.961373753
8C-0C -173.25 -285.8283 -60.67172 0.004588355
8C-3C -184.25 -302.9179 -65.58208 0.004327805</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PIME (Observed)"
[1] "Tukey post-hoc test"
        diff        lwr        upr          p.adj
3C-0C  -28.3  -59.02587   2.425871 0.071121744588
8C-0C -107.8 -138.52587 -77.074129 0.000006170051
8C-3C  -79.5 -111.88791 -47.112088 0.000138893963</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PERfect (Observed)"
[1] "Tukey post-hoc test"
        diff       lwr       upr       p.adj
3C-0C  -5.35 -38.46046  27.76046 0.898558605
8C-0C -60.60 -93.71046 -27.48954 0.001378091
8C-3C -55.25 -90.15149 -20.34851 0.003804791</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FULL (Shannon exponential)"
[1] "Tukey post-hoc test"
           diff        lwr       upr     p.adj
3C-0C  68.52857  -31.79969 168.85684 0.1967805
8C-0C  34.59038  -65.73789 134.91864 0.6257554
8C-3C -33.93820 -139.69348  71.81708 0.6644870</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FILT (Shannon exponential)"
[1] "Tukey post-hoc test"
           diff       lwr      upr     p.adj
3C-0C  42.89239 -10.62278 96.40756 0.1199483
8C-0C  18.50838 -35.00679 72.02355 0.6240029
8C-3C -24.38401 -80.79395 32.02593 0.4878559</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PIME (Shannon exponential)"
[1] "Tukey post-hoc test"
             diff       lwr      upr     p.adj
3C-0C  15.1283988 -14.51712 44.77392 0.3777877
8C-0C   0.5613833 -29.08414 30.20690 0.9985157
8C-3C -14.5670155 -45.81614 16.68211 0.4381419</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PERfect (Shannon exponential)"
[1] "Tukey post-hoc test"
             diff        lwr       upr     p.adj
3C-0C  13.7449005  -7.058747 34.548549 0.2152611
8C-0C   0.3995566 -20.404091 21.203205 0.9984731
8C-3C -13.3453440 -35.274314  8.583626 0.2639185</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FULL (Inverse Simpson)"
[1] "Tukey post-hoc test"
           diff       lwr      upr     p.adj
3C-0C  30.12853 -10.93247 71.18953 0.1597780
8C-0C  15.09562 -25.96538 56.15662 0.5888250
8C-3C -15.03291 -58.31500 28.24918 0.6216188</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FILT (Inverse Simpson)"
[1] "Tukey post-hoc test"
            diff       lwr      upr     p.adj
3C-0C  19.474580  -7.08637 46.03553 0.1601425
8C-0C   8.362193 -18.19876 34.92314 0.6743506
8C-3C -11.112388 -39.11009 16.88531 0.5422962</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PIME (Inverse Simpson)"
[1] "Tukey post-hoc test"
            diff        lwr       upr     p.adj
3C-0C  8.4231399  -7.904659 24.750938 0.3705643
8C-0C  0.3894783 -15.938320 16.717277 0.9976460
8C-3C -8.0336616 -25.244672  9.177349 0.4372626</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PERfect (Inverse Simpson)"
[1] "Tukey post-hoc test"
           diff        lwr       upr     p.adj
3C-0C  9.662568  -4.771842 24.096979 0.2078889
8C-0C  1.449038 -12.985373 15.883449 0.9592809
8C-3C -8.213530 -23.428735  7.001674 0.3405328</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now we can plot the results from the posthoc analyses for each metric and data set using the function <code>div_test_plot_jjs</code>. I modified the original function (<code>div_test_plot</code>) to control a little of the formatting.</p>
<p>The command is as follows:</p>
<pre><code>div_test_plot(divtest = x, chart = "type", colour = col.pal, 
              posthoc = TRUE, threshold = value))</code></pre>
<p>where <code>x</code> is the results from the <code>div_test</code> function, <code>"type"</code> is chart type (box, jitter, or violin), <code>colour</code> is is a color palette, <code>posthoc</code> indicates whether to run posthoc pairwise analyses, and <code>value</code> is the maximum p-value to show in pairwise posthoc results. <strong>WARNING</strong> if none of the posthoc results are below the specified threshold, the function will throw an error. Therefore, until this is fixed, all posthoc values are shown.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"hack_code/div_test_plot_jjs.R"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_adt_plot"</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_adt"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
     <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_plot"</span><span class="op">)</span><span class="op">)</span>
     <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
     <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu">div_test_plot_jjs</span><span class="op">(</span><span class="va">tmp_get</span>, chart <span class="op">=</span> <span class="st">"box"</span>,
                                 colour <span class="op">=</span> <span class="va">swel_col</span>, posthoc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
     <span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="fu">ggpar</span><span class="op">(</span><span class="va">tmp_df</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tmp_name</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_df</span><span class="op">)</span>
     <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">its18_ps_work_q0_adt_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
</section><section id="alpha-diversity-plots-1" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="alpha-diversity-plots-1">Alpha Diversity Plots</h2>
<p>Posthoc adjusted p-values given for each pairwise comparison.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-body-outset">
<p><img src="include/alpha/its18_alph_div_plots_asv.png" class="img-fluid" width="7086"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 1 | Alpha diversity plots. Top row = Observed; middle row = Shannon exponential; bottom row = Inverse Simpson. From left to right, Full (unfiltered) data, Arbitrary filtered, PERfect filtered, PIME filtered.</strong></small></p>
<div class="cell">

</div>
<div class="cell">

</div>
</section></section><section id="workflow-output" class="level1"><h1>Workflow Output</h1>
<p>Data products generated in this workflow can be downloaded from figshare.</p>
<iframe src="https://widgets.figshare.com/articles/16826779/embed?show_title=1" width="100%" height="251" allowfullscreen="" frameborder="0">
</iframe>
<p></p>
<p><a href="beta.html" class="btnnav button_round" style="float: right;">Next workflow: <br> 6. Beta Diversity &amp; Dispersion Estimates</a> <a href="taxa.html" class="btnnav button_round" style="float: left;">Previous workflow: <br> 4. Taxonomic Diversity</a><br><br></p>
<div class="cell">

</div>
</section><div id="quarto-appendix" class="default"><section id="source-code" class="level4 appendix"><h2 class="quarto-appendix-heading">Source Code</h2><div class="quarto-appendix-contents">
<p>The source code for this page can be accessed on GitHub <svg aria-hidden="true" role="img" viewbox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> by <a href="https://github.com/sweltr/high-temp/blob/main/alpha.qmd">clicking this link</a>.</p>
</div></section><section id="data-availability" class="level4 appendix"><h2 class="quarto-appendix-heading">Data Availability</h2><div class="quarto-appendix-contents">
<p>Data generated in this workflow and the Rdata need to run the workflow can be accessed on figshare at <a href="https://doi.org/10.25573/data.16826779">10.25573/data.16826779</a>.</p>
</div></section><section id="last-updated-on" class="level4 appendix"><h2 class="quarto-appendix-heading">Last updated on</h2><div class="quarto-appendix-contents">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022-07-05 14:41:14 EST"</code></pre>
</div>
</div>


<!-- -->


</div></section><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-alberdi2019guide" class="csl-entry" role="doc-biblioentry">
Alberdi, Antton, and M Thomas P Gilbert. 2019a. <span>“A Guide to the Application of Hill Numbers to DNA-Based Diversity Analyses.”</span> <em>Molecular Ecology Resources</em> 19 (4): 804–17. <a href="https://doi.org/10.1111/1755%E2%80%900998.13014">https://doi.org/10.1111/1755‐0998.13014</a>.
</div>
<div id="ref-alberdi2019hilldiv" class="csl-entry" role="doc-biblioentry">
———. 2019b. <span>“Hilldiv: An r Package for the Integral Analysis of Diversity Based on Hill Numbers.”</span> <em>bioRxiv</em>, 545665. <a href="https://doi.org/10.1101/545665">https://doi.org/10.1101/545665</a>.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./taxa.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">4. Taxonomic Diversity</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./beta.html" class="pagination-link">
        <span class="nav-page-text">6. Beta Diversity &amp; Dispersion Estimates</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb53" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "5. Alpha Diversity Estimates"</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Reproducible workflow to assess alpha diversity across temperature treatments using Hill numbers.</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;&lt;strong&gt;</span>Click here<span class="kw">&lt;/strong&gt;</span> for setup information.<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">eval =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co">#library(conflicted)</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq); <span class="fu">packageVersion</span>(<span class="st">"phyloseq"</span>)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biostrings); <span class="fu">packageVersion</span>(<span class="st">"Biostrings"</span>)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, hilldiv, </span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>               microbiome, phytools, phangorn, </span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>               pairwiseAdonis, naniar, </span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>               labdsv, patchwork, agricolae, ggpubr,</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>               reactable, downloadthis, captioner,</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">install =</span> <span class="cn">FALSE</span>, <span class="at">update =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"hack_code/div_test_plot_jjs.R"</span>)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"hack_code/div_test_jjs.R"</span>)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_current<span class="sc">$</span><span class="fu">get</span>(<span class="fu">c</span>(</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache"</span>,</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache.path"</span>,</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache.rebuild"</span>,</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dependson"</span>,</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"autodep"</span></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Load to build page only #2</span></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"page_build/alpha_wf.rdata"</span>)</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the caption(s) with captioner</span></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>caption_tab_ssu <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(16S rRNA) Table"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>caption_fig_ssu <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(16S rRNA) Figure"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>caption_tab_its <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(ITS) Table"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>caption_fig_its <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(ITS) Figure"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function for referring to the tables in text</span></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">str_extract</span>(x, <span class="st">"[^|]*"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trimws</span>(<span class="at">which =</span> <span class="st">"right"</span>, <span class="at">whitespace =</span> <span class="st">"[ ]"</span>)</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">file.path</span>(<span class="st">"assets"</span>, <span class="st">"functions.R"</span>))</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"assets/captions/captions_alpha.R"</span>)</span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a><span class="fu"># Synopsis</span></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>This workflow contains diversity assessments for the 2018 high temperature data sets. In order to run the workflow, you either need to first run the  <span class="co">[</span><span class="ot">DADA2 Workflow</span><span class="co">](dada2.html)</span> **and** the [Data Preparation workflow](data-prep.html) **or** download the files linked below. See the <span class="co">[</span><span class="ot">Data Availability</span><span class="co">](data-availability.html)</span> page for complete details.</span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workflow Input</span></span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a>Files needed to run this workflow can be downloaded from figshare. </span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://widgets.figshare.com/articles/14690739/embed?show_title=1"</span> <span class="er">width</span><span class="ot">=</span><span class="st">"100%"</span> <span class="er">height</span><span class="ot">=</span><span class="st">"251"</span> <span class="er">allowfullscreen</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">"0"</span><span class="kw">&gt;&lt;/iframe&gt;</span></span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://widgets.figshare.com/articles/14701440/embed?show_title=1"</span> <span class="er">width</span><span class="ot">=</span><span class="st">"100%"</span> <span class="er">height</span><span class="ot">=</span><span class="st">"351"</span> <span class="er">allowfullscreen</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">"0"</span><span class="kw">&gt;&lt;/iframe&gt;</span></span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a><span class="fu"># 16s rRNA</span></span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial Load for  ANALYSIS #1</span></span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a><span class="do">## ASV FULL AND PIME AND PERfect</span></span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/ssu18_ps_work.rds"</span>)</span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/filtering/arbitrary/rdata/ssu18_ps_filt.rds"</span>)</span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/filtering/perfect/rdata/ssu18_ps_perfect.rds"</span>)</span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/filtering/pime/rdata/ssu18_ps_pime.rds"</span>)</span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a>swel_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2271B2"</span>, <span class="st">"#71B222"</span>, <span class="st">"#B22271"</span>)</span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a>To account for presence of rare sequence variants caused by sequencing errors or other technical artifacts, we use Hill numbers <span class="co">[</span><span class="ot">@alberdi2019guide</span><span class="co">]</span>. Hill numbers allow the weight put on rare versus abundant sequence variants to be scaled while providing intuitive comparisons of diversity levels using “effective number of ASVs” as a measuring unit. This approach allows for balancing the over representation of rare ASVs that might be inflated due to sequencing errors.</span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a>We will then use Shapiro-Wilk tests to test for normalcy and then, depending on the results, either use  parametric ANOVA or non-parametric Kruskal-Wallis to compare alpha diversity among treatments.</span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate Hill Numbers</span></span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a>To calculate Hill numbers, we use the R package <span class="in">`hilldiv`</span> <span class="co">[</span><span class="ot">@alberdi2019hilldiv</span><span class="co">]</span>. We calculate three metrics that put more or less weight on common species:</span>
<span id="cb53-123"><a href="#cb53-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a>1) Observed richness, where <span class="in">`q-value = 0`</span>.</span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a>2) Shannon exponential, which weighs ASVs by their frequency,  where <span class="in">`q-value = 1`</span>.</span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a>3) Simpson multiplicative inverse, which over weighs abundant ASVs,  where <span class="in">`q-value = 2`</span>.</span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a>We perform each analysis against the Full (unfiltered) data set as well as the Arbitrary, PERfect and PIME, filtered data sets using the function <span class="in">`hill_div`</span>.</span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a>The command is as follows:</span>
<span id="cb53-131"><a href="#cb53-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a><span class="in">hill_div(count = x, qvalue = i, tree = ultrametric_tree)</span></span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a>where <span class="in">`x`</span> is the sample by ASV table, <span class="in">`i`</span> is the q-value corresponding to the metric of interest and <span class="in">`tree`</span> is an ultrametric formatted phylogenetic tree if you choose to look at lineage, rather than ASV, diversity.</span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-141"><a href="#cb53-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-142"><a href="#cb53-142" aria-hidden="true" tabindex="-1"></a><span class="do">## this is for subsettig samples..</span></span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ssu18_asv_pime_sum)</span>
<span id="cb53-144"><a href="#cb53-144" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb53-145"><a href="#cb53-145" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"_0"</span>))</span>
<span id="cb53-146"><a href="#cb53-146" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"_3"</span>))</span>
<span id="cb53-147"><a href="#cb53-147" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"_8"</span>))</span>
<span id="cb53-148"><a href="#cb53-148" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb53-149"><a href="#cb53-149" aria-hidden="true" tabindex="-1"></a>  tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb53-150"><a href="#cb53-150" aria-hidden="true" tabindex="-1"></a>  tmp_0 <span class="ot">&lt;-</span> <span class="fu">prune_samples</span>(<span class="fu">c</span>(<span class="st">"P10_D00_010_C0E"</span>, <span class="st">"P02_D00_010_C0A"</span>, <span class="st">"P04_D00_010_C0B"</span>, <span class="st">"P06_D00_010_C0C"</span>, <span class="st">"P08_D00_010_C0D"</span>), tmp_get) </span>
<span id="cb53-151"><a href="#cb53-151" aria-hidden="true" tabindex="-1"></a>  tmp_3 <span class="ot">&lt;-</span> <span class="fu">prune_samples</span>(<span class="fu">c</span>(<span class="st">"P01_D00_010_W3A"</span>, <span class="st">"P03_D00_010_W3B"</span>, <span class="st">"P05_D00_010_W3C"</span>, <span class="st">"P07_D00_010_W3D"</span>, <span class="st">"P09_D00_010_W3E"</span>), tmp_get)</span>
<span id="cb53-152"><a href="#cb53-152" aria-hidden="true" tabindex="-1"></a>  tmp_8 <span class="ot">&lt;-</span> <span class="fu">prune_samples</span>(<span class="fu">c</span>(<span class="st">"P01_D00_010_W8A"</span>, <span class="st">"P03_D00_010_W8B"</span>, <span class="st">"P05_D00_010_W8C"</span>, <span class="st">"P07_D00_010_W8D"</span>, <span class="st">"P09_D00_010_W8E"</span>), tmp_get)</span>
<span id="cb53-153"><a href="#cb53-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-154"><a href="#cb53-154" aria-hidden="true" tabindex="-1"></a>  tmp_0 <span class="ot">&lt;-</span> <span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(tmp_0) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_0)</span>
<span id="cb53-155"><a href="#cb53-155" aria-hidden="true" tabindex="-1"></a>  tmp_3 <span class="ot">&lt;-</span> <span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(tmp_3) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_3)</span>
<span id="cb53-156"><a href="#cb53-156" aria-hidden="true" tabindex="-1"></a>  tmp_8 <span class="ot">&lt;-</span> <span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(tmp_8) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_8)</span>
<span id="cb53-157"><a href="#cb53-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-158"><a href="#cb53-158" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name_0 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_0"</span>))</span>
<span id="cb53-159"><a href="#cb53-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name_0, tmp_0)</span>
<span id="cb53-160"><a href="#cb53-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-161"><a href="#cb53-161" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name_3 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_3"</span>))</span>
<span id="cb53-162"><a href="#cb53-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name_3, tmp_3)</span>
<span id="cb53-163"><a href="#cb53-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-164"><a href="#cb53-164" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name_8 <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_8"</span>))</span>
<span id="cb53-165"><a href="#cb53-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name_8, tmp_8)</span>
<span id="cb53-166"><a href="#cb53-166" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-167"><a href="#cb53-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-168"><a href="#cb53-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-169"><a href="#cb53-169" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-170"><a href="#cb53-170" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"FULL data set (0C)"</span>, </span>
<span id="cb53-171"><a href="#cb53-171" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"FULL data set (3C)"</span>, </span>
<span id="cb53-172"><a href="#cb53-172" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"FULL data set (8C)"</span>, </span>
<span id="cb53-173"><a href="#cb53-173" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Arbitrary filter data (0C)"</span>, </span>
<span id="cb53-174"><a href="#cb53-174" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Arbitrary filter data (3C)"</span>, </span>
<span id="cb53-175"><a href="#cb53-175" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Arbitrary filter data (8C)"</span>, </span>
<span id="cb53-176"><a href="#cb53-176" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PERfect filtered data (0C)"</span>,</span>
<span id="cb53-177"><a href="#cb53-177" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PERfect filtered data (3C)"</span>,</span>
<span id="cb53-178"><a href="#cb53-178" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PERfect filtered data (8C)"</span>,</span>
<span id="cb53-179"><a href="#cb53-179" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PIME (0C)"</span>,</span>
<span id="cb53-180"><a href="#cb53-180" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PIME (3C)"</span>, </span>
<span id="cb53-181"><a href="#cb53-181" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PIME (8C)"</span>))</span>
<span id="cb53-182"><a href="#cb53-182" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work_0"</span>, <span class="st">"ssu18_ps_work_3"</span>, <span class="st">"ssu18_ps_work_8"</span>,</span>
<span id="cb53-183"><a href="#cb53-183" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ssu18_ps_filt_0"</span>, <span class="st">"ssu18_ps_filt_3"</span>, <span class="st">"ssu18_ps_filt_8"</span>,</span>
<span id="cb53-184"><a href="#cb53-184" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ssu18_ps_perfect_0"</span>, <span class="st">"ssu18_ps_perfect_3"</span>, <span class="st">"ssu18_ps_perfect_8"</span>,</span>
<span id="cb53-185"><a href="#cb53-185" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ssu18_ps_pime_0"</span>, <span class="st">"ssu18_ps_pime_3"</span>, <span class="st">"ssu18_ps_pime_8"</span>)</span>
<span id="cb53-186"><a href="#cb53-186" aria-hidden="true" tabindex="-1"></a>tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-187"><a href="#cb53-187" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb53-188"><a href="#cb53-188" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">nsamples</span>(<span class="fu">get</span>(i))</span>
<span id="cb53-189"><a href="#cb53-189" aria-hidden="true" tabindex="-1"></a>   tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_no_samp, tmp_get))</span>
<span id="cb53-190"><a href="#cb53-190" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-191"><a href="#cb53-191" aria-hidden="true" tabindex="-1"></a>tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_no_samp)</span>
<span id="cb53-192"><a href="#cb53-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-193"><a href="#cb53-193" aria-hidden="true" tabindex="-1"></a>tmp_rc <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-194"><a href="#cb53-194" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb53-195"><a href="#cb53-195" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb53-196"><a href="#cb53-196" aria-hidden="true" tabindex="-1"></a>   tmp_rc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_rc, tmp_get))</span>
<span id="cb53-197"><a href="#cb53-197" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-198"><a href="#cb53-198" aria-hidden="true" tabindex="-1"></a>tmp_rc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_rc)</span>
<span id="cb53-199"><a href="#cb53-199" aria-hidden="true" tabindex="-1"></a>tmp_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-200"><a href="#cb53-200" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb53-201"><a href="#cb53-201" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb53-202"><a href="#cb53-202" aria-hidden="true" tabindex="-1"></a>   tmp_asv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_asv, tmp_get))</span>
<span id="cb53-203"><a href="#cb53-203" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-204"><a href="#cb53-204" aria-hidden="true" tabindex="-1"></a>tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_asv)</span>
<span id="cb53-205"><a href="#cb53-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-206"><a href="#cb53-206" aria-hidden="true" tabindex="-1"></a>ssu18_asv_pime_sum <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_samples) <span class="sc">%&gt;%</span></span>
<span id="cb53-207"><a href="#cb53-207" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_no_samp) <span class="sc">%&gt;%</span></span>
<span id="cb53-208"><a href="#cb53-208" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_rc) <span class="sc">%&gt;%</span></span>
<span id="cb53-209"><a href="#cb53-209" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_asv) <span class="sc">%&gt;%</span></span>
<span id="cb53-210"><a href="#cb53-210" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Description"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"object name"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"no. samples"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-211"><a href="#cb53-211" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total reads"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"total asvs"</span> <span class="ot">=</span> <span class="dv">5</span>)</span>
<span id="cb53-212"><a href="#cb53-212" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-213"><a href="#cb53-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-214"><a href="#cb53-214" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(ssu18_asv_pime_sum, <span class="st">"ssu_split_by_temp.txt"</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-215"><a href="#cb53-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-216"><a href="#cb53-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-219"><a href="#cb53-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-220"><a href="#cb53-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-221"><a href="#cb53-221" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb53-222"><a href="#cb53-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-223"><a href="#cb53-223" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"FULL data set"</span>, </span>
<span id="cb53-224"><a href="#cb53-224" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Arbitrary filter"</span>, </span>
<span id="cb53-225"><a href="#cb53-225" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PERfect filtered"</span>,</span>
<span id="cb53-226"><a href="#cb53-226" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PIME filtered"</span>))</span>
<span id="cb53-227"><a href="#cb53-227" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>,</span>
<span id="cb53-228"><a href="#cb53-228" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ssu18_ps_filt"</span>,</span>
<span id="cb53-229"><a href="#cb53-229" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ssu18_ps_perfect"</span>,</span>
<span id="cb53-230"><a href="#cb53-230" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb53-231"><a href="#cb53-231" aria-hidden="true" tabindex="-1"></a>tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-232"><a href="#cb53-232" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb53-233"><a href="#cb53-233" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">nsamples</span>(<span class="fu">get</span>(i))</span>
<span id="cb53-234"><a href="#cb53-234" aria-hidden="true" tabindex="-1"></a>   tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_no_samp, tmp_get))</span>
<span id="cb53-235"><a href="#cb53-235" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-236"><a href="#cb53-236" aria-hidden="true" tabindex="-1"></a>tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_no_samp)</span>
<span id="cb53-237"><a href="#cb53-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-238"><a href="#cb53-238" aria-hidden="true" tabindex="-1"></a>tmp_rc <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-239"><a href="#cb53-239" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb53-240"><a href="#cb53-240" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb53-241"><a href="#cb53-241" aria-hidden="true" tabindex="-1"></a>   tmp_rc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_rc, tmp_get))</span>
<span id="cb53-242"><a href="#cb53-242" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-243"><a href="#cb53-243" aria-hidden="true" tabindex="-1"></a>tmp_rc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_rc)</span>
<span id="cb53-244"><a href="#cb53-244" aria-hidden="true" tabindex="-1"></a>tmp_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-245"><a href="#cb53-245" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb53-246"><a href="#cb53-246" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb53-247"><a href="#cb53-247" aria-hidden="true" tabindex="-1"></a>   tmp_asv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_asv, tmp_get))</span>
<span id="cb53-248"><a href="#cb53-248" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-249"><a href="#cb53-249" aria-hidden="true" tabindex="-1"></a>tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_asv)</span>
<span id="cb53-250"><a href="#cb53-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-251"><a href="#cb53-251" aria-hidden="true" tabindex="-1"></a>ssu18_asv_pime_sum <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_samples) <span class="sc">%&gt;%</span></span>
<span id="cb53-252"><a href="#cb53-252" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_no_samp) <span class="sc">%&gt;%</span></span>
<span id="cb53-253"><a href="#cb53-253" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_rc) <span class="sc">%&gt;%</span></span>
<span id="cb53-254"><a href="#cb53-254" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_asv) <span class="sc">%&gt;%</span></span>
<span id="cb53-255"><a href="#cb53-255" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Description"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"object name"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"no. samples"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-256"><a href="#cb53-256" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total reads"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"total asvs"</span> <span class="ot">=</span> <span class="dv">5</span>)</span>
<span id="cb53-257"><a href="#cb53-257" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-258"><a href="#cb53-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-259"><a href="#cb53-259" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(ssu18_asv_pime_sum, <span class="st">"ssu_filter_summmary.txt"</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-260"><a href="#cb53-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-261"><a href="#cb53-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-264"><a href="#cb53-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-265"><a href="#cb53-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-266"><a href="#cb53-266" aria-hidden="true" tabindex="-1"></a>mergedGP <span class="ot">&lt;-</span> <span class="fu">merge_samples</span>(ssu18_ps_perfect_3, <span class="st">"TEMP"</span>)</span>
<span id="cb53-267"><a href="#cb53-267" aria-hidden="true" tabindex="-1"></a>SD <span class="ot">&lt;-</span> <span class="fu">merge_samples</span>(<span class="fu">sample_data</span>(ssu18_ps_perfect_3), <span class="st">"TEMP"</span>)</span>
<span id="cb53-268"><a href="#cb53-268" aria-hidden="true" tabindex="-1"></a>mergedGP</span>
<span id="cb53-269"><a href="#cb53-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-270"><a href="#cb53-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-271"><a href="#cb53-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-274"><a href="#cb53-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-275"><a href="#cb53-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-276"><a href="#cb53-276" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb53-277"><a href="#cb53-277" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-278"><a href="#cb53-278" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-279"><a href="#cb53-279" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-280"><a href="#cb53-280" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-281"><a href="#cb53-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-282"><a href="#cb53-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-283"><a href="#cb53-283" aria-hidden="true" tabindex="-1"></a>We first transform all the data to relative abundance values, and compute new trees.</span>
<span id="cb53-284"><a href="#cb53-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-287"><a href="#cb53-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-288"><a href="#cb53-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-289"><a href="#cb53-289" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb53-290"><a href="#cb53-290" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb53-291"><a href="#cb53-291" aria-hidden="true" tabindex="-1"></a>  tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(<span class="fu">get</span>(i), <span class="cf">function</span>(otu) otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb53-292"><a href="#cb53-292" aria-hidden="true" tabindex="-1"></a>  tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-293"><a href="#cb53-293" aria-hidden="true" tabindex="-1"></a>  tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-294"><a href="#cb53-294" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb53-295"><a href="#cb53-295" aria-hidden="true" tabindex="-1"></a>  tmp_ps_norm <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb53-296"><a href="#cb53-296" aria-hidden="true" tabindex="-1"></a>  tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_ps_norm)))</span>
<span id="cb53-297"><a href="#cb53-297" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_norm"</span>))</span>
<span id="cb53-298"><a href="#cb53-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name, tmp_ps_norm)</span>
<span id="cb53-299"><a href="#cb53-299" aria-hidden="true" tabindex="-1"></a>  tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>))</span>
<span id="cb53-300"><a href="#cb53-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_asv_name, tmp_asv)</span>
<span id="cb53-301"><a href="#cb53-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-302"><a href="#cb53-302" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-303"><a href="#cb53-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-304"><a href="#cb53-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-305"><a href="#cb53-305" aria-hidden="true" tabindex="-1"></a>Next, we run the analysis for all three metrics on the data sets (without a tree).</span>
<span id="cb53-306"><a href="#cb53-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-309"><a href="#cb53-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-310"><a href="#cb53-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb53-311"><a href="#cb53-311" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-312"><a href="#cb53-312" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb53-313"><a href="#cb53-313" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb53-314"><a href="#cb53-314" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb53-315"><a href="#cb53-315" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>)))</span>
<span id="cb53-316"><a href="#cb53-316" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i))</span>
<span id="cb53-317"><a href="#cb53-317" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"tmp_name"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-318"><a href="#cb53-318" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb53-319"><a href="#cb53-319" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_h"</span>, i))</span>
<span id="cb53-320"><a href="#cb53-320" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb53-321"><a href="#cb53-321" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb53-322"><a href="#cb53-322" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-323"><a href="#cb53-323" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-324"><a href="#cb53-324" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-325"><a href="#cb53-325" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_h"</span>)</span>
<span id="cb53-326"><a href="#cb53-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-327"><a href="#cb53-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-328"><a href="#cb53-328" aria-hidden="true" tabindex="-1"></a>And make summary tables to add back into each <span class="in">`ps`</span> object.</span>
<span id="cb53-329"><a href="#cb53-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-332"><a href="#cb53-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-333"><a href="#cb53-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-334"><a href="#cb53-334" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb53-335"><a href="#cb53-335" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_h0"</span>)))</span>
<span id="cb53-336"><a href="#cb53-336" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_h1"</span>)))</span>
<span id="cb53-337"><a href="#cb53-337" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_h2"</span>)))</span>
<span id="cb53-338"><a href="#cb53-338" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-339"><a href="#cb53-339" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-340"><a href="#cb53-340" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Shannon_exp"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"InvSimpson"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-341"><a href="#cb53-341" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_hill"</span>))</span>
<span id="cb53-342"><a href="#cb53-342" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb53-343"><a href="#cb53-343" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-344"><a href="#cb53-344" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-345"><a href="#cb53-345" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_hill"</span>)</span>
<span id="cb53-346"><a href="#cb53-346" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb53-347"><a href="#cb53-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-348"><a href="#cb53-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-349"><a href="#cb53-349" aria-hidden="true" tabindex="-1"></a>And then create the new objects with the diversity data.</span>
<span id="cb53-350"><a href="#cb53-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-353"><a href="#cb53-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-354"><a href="#cb53-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-355"><a href="#cb53-355" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb53-356"><a href="#cb53-356" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb53-357"><a href="#cb53-357" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-358"><a href="#cb53-358" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb53-359"><a href="#cb53-359" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb53-360"><a href="#cb53-360" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_hill"</span>)))</span>
<span id="cb53-361"><a href="#cb53-361" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_ps)),</span>
<span id="cb53-362"><a href="#cb53-362" aria-hidden="true" tabindex="-1"></a>                                         tmp_hill, <span class="at">by =</span> <span class="st">"SamName"</span>)</span>
<span id="cb53-363"><a href="#cb53-363" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp<span class="sc">$</span>ID <span class="ot">&lt;-</span> tmp_hill_samp<span class="sc">$</span>SamName</span>
<span id="cb53-364"><a href="#cb53-364" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp <span class="ot">&lt;-</span> tmp_hill_samp <span class="sc">%&gt;%</span>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"ID"</span>)</span>
<span id="cb53-365"><a href="#cb53-365" aria-hidden="true" tabindex="-1"></a>     tmp_ps2 <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(<span class="fu">otu_table</span>(tmp_ps),</span>
<span id="cb53-366"><a href="#cb53-366" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">sample_data</span>(tmp_hill_samp),</span>
<span id="cb53-367"><a href="#cb53-367" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">tax_table</span>(tmp_ps),</span>
<span id="cb53-368"><a href="#cb53-368" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">phy_tree</span>(tmp_ps))</span>
<span id="cb53-369"><a href="#cb53-369" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(i, tmp_ps2)</span>
<span id="cb53-370"><a href="#cb53-370" aria-hidden="true" tabindex="-1"></a>     tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"files/alpha/rdata/"</span>)</span>
<span id="cb53-371"><a href="#cb53-371" aria-hidden="true" tabindex="-1"></a>     <span class="fu">saveRDS</span>(tmp_ps2, <span class="fu">paste</span>(tmp_path, i, <span class="st">".rds"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-372"><a href="#cb53-372" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-373"><a href="#cb53-373" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-374"><a href="#cb53-374" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb53-375"><a href="#cb53-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-376"><a href="#cb53-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-379"><a href="#cb53-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-380"><a href="#cb53-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-381"><a href="#cb53-381" aria-hidden="true" tabindex="-1"></a><span class="do">## THIS is legacy code for using trees. Not included in this analysis</span></span>
<span id="cb53-382"><a href="#cb53-382" aria-hidden="true" tabindex="-1"></a><span class="do">#### With a phylogenetic tree</span></span>
<span id="cb53-383"><a href="#cb53-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-384"><a href="#cb53-384" aria-hidden="true" tabindex="-1"></a><span class="do">## We can also run the tests using the phylogenetic tree to assess **lineage** diversity rather than ASV diversity for the filtered data sets. We do a quick check  to ensure   the ASV names   in  the ASV table   and the tip names   in  the new phylogenetic tree   are identical.</span></span>
<span id="cb53-385"><a href="#cb53-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-386"><a href="#cb53-386" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_tree_ult <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_pime_tree_ult.rds"</span>)</span>
<span id="cb53-387"><a href="#cb53-387" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_otu_tree_ult <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_pime_otu_tree_ult.rds"</span>)</span>
<span id="cb53-388"><a href="#cb53-388" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_tree_ult <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_perfect_tree_ult.rds"</span>)</span>
<span id="cb53-389"><a href="#cb53-389" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_otu_tree_ult <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_perfect_otu_tree_ult.rds"</span>)</span>
<span id="cb53-390"><a href="#cb53-390" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_tree_ult <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/alpha/rdata/ssu18_ps_filt_tree_ult.rds"</span>)</span>
<span id="cb53-391"><a href="#cb53-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-392"><a href="#cb53-392" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ultrametric</span>(ssu18_ps_pime_tree_ult) </span>
<span id="cb53-393"><a href="#cb53-393" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ultrametric</span>(ssu18_ps_pime_otu_tree_ult)</span>
<span id="cb53-394"><a href="#cb53-394" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ultrametric</span>(ssu18_ps_perfect_tree_ult) </span>
<span id="cb53-395"><a href="#cb53-395" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ultrametric</span>(ssu18_ps_perfect_otu_tree_ult)</span>
<span id="cb53-396"><a href="#cb53-396" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ultrametric</span>(ssu18_ps_filt_tree_ult) </span>
<span id="cb53-397"><a href="#cb53-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-398"><a href="#cb53-398" aria-hidden="true" tabindex="-1"></a><span class="do">## To generate trees, we used the R-package [`phytools`](https://github.com/liamrevell/phytools), specifically the function `force.ultrametric` since `hill_div` requires ultrametric trees. </span></span>
<span id="cb53-399"><a href="#cb53-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-400"><a href="#cb53-400" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i)</span>
<span id="cb53-401"><a href="#cb53-401" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb53-402"><a href="#cb53-402" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree) {</span>
<span id="cb53-403"><a href="#cb53-403" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb53-404"><a href="#cb53-404" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> tmp_ps<span class="sc">@</span>phy_tree</span>
<span id="cb53-405"><a href="#cb53-405" aria-hidden="true" tabindex="-1"></a>     tmp_tree_ult <span class="ot">&lt;-</span> <span class="fu">force.ultrametric</span>(tmp_tree, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"nnls"</span>))</span>
<span id="cb53-406"><a href="#cb53-406" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(<span class="fu">is.ultrametric</span>(tmp_tree_ult))</span>
<span id="cb53-407"><a href="#cb53-407" aria-hidden="true" tabindex="-1"></a>     tmp_tree_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tree_ult"</span>))</span>
<span id="cb53-408"><a href="#cb53-408" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_tree_name, tmp_tree_ult)</span>
<span id="cb53-409"><a href="#cb53-409" aria-hidden="true" tabindex="-1"></a>     tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"files/alpha/rdata/"</span>)</span>
<span id="cb53-410"><a href="#cb53-410" aria-hidden="true" tabindex="-1"></a>     <span class="fu">saveRDS</span>(tmp_tree_ult, <span class="fu">paste</span>(tmp_path, tmp_tree_name, <span class="st">".rds"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-411"><a href="#cb53-411" aria-hidden="true" tabindex="-1"></a>     tmp_tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>)))</span>
<span id="cb53-412"><a href="#cb53-412" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(<span class="fu">identical</span>(<span class="fu">sort</span>(<span class="fu">rownames</span>(tmp_tmp_asv)), <span class="fu">sort</span>(tmp_tree_ult<span class="sc">$</span>tip.label)))</span>
<span id="cb53-413"><a href="#cb53-413" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-414"><a href="#cb53-414" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-415"><a href="#cb53-415" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb53-416"><a href="#cb53-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-417"><a href="#cb53-417" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i, j)</span>
<span id="cb53-418"><a href="#cb53-418" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb53-419"><a href="#cb53-419" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb53-420"><a href="#cb53-420" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> ssu18_alpha_ds_tree) {</span>
<span id="cb53-421"><a href="#cb53-421" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>)))</span>
<span id="cb53-422"><a href="#cb53-422" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tree_ult"</span>)))</span>
<span id="cb53-423"><a href="#cb53-423" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i, <span class="at">tree =</span> tmp_tree))</span>
<span id="cb53-424"><a href="#cb53-424" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"tmp_name"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-425"><a href="#cb53-425" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb53-426"><a href="#cb53-426" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht"</span>, i))</span>
<span id="cb53-427"><a href="#cb53-427" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb53-428"><a href="#cb53-428" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb53-429"><a href="#cb53-429" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-430"><a href="#cb53-430" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-431"><a href="#cb53-431" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-432"><a href="#cb53-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-433"><a href="#cb53-433" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree_filt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_filt"</span>)</span>
<span id="cb53-434"><a href="#cb53-434" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree_filt) {</span>
<span id="cb53-435"><a href="#cb53-435" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht0"</span>)))</span>
<span id="cb53-436"><a href="#cb53-436" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht1"</span>)))</span>
<span id="cb53-437"><a href="#cb53-437" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht2"</span>)))</span>
<span id="cb53-438"><a href="#cb53-438" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-439"><a href="#cb53-439" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-440"><a href="#cb53-440" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_fit"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Shannon_exp_fit"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"InvSimpson_fit"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-441"><a href="#cb53-441" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_hill_t"</span>))</span>
<span id="cb53-442"><a href="#cb53-442" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb53-443"><a href="#cb53-443" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-444"><a href="#cb53-444" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-445"><a href="#cb53-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-446"><a href="#cb53-446" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree_perfect <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_perfect"</span>)</span>
<span id="cb53-447"><a href="#cb53-447" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree_perfect) {</span>
<span id="cb53-448"><a href="#cb53-448" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht0"</span>)))</span>
<span id="cb53-449"><a href="#cb53-449" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht1"</span>)))</span>
<span id="cb53-450"><a href="#cb53-450" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht2"</span>)))</span>
<span id="cb53-451"><a href="#cb53-451" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-452"><a href="#cb53-452" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-453"><a href="#cb53-453" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_pet"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Shannon_exp_pet"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"InvSimpson_pet"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-454"><a href="#cb53-454" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_hill_t"</span>))</span>
<span id="cb53-455"><a href="#cb53-455" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb53-456"><a href="#cb53-456" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-457"><a href="#cb53-457" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-458"><a href="#cb53-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-459"><a href="#cb53-459" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree_pime <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb53-460"><a href="#cb53-460" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree_pime) {</span>
<span id="cb53-461"><a href="#cb53-461" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht0"</span>)))</span>
<span id="cb53-462"><a href="#cb53-462" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht1"</span>)))</span>
<span id="cb53-463"><a href="#cb53-463" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ht2"</span>)))</span>
<span id="cb53-464"><a href="#cb53-464" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-465"><a href="#cb53-465" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-466"><a href="#cb53-466" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_pit"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Shannon_exp_pit"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"InvSimpson_pit"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-467"><a href="#cb53-467" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_hill_t"</span>))</span>
<span id="cb53-468"><a href="#cb53-468" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb53-469"><a href="#cb53-469" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-470"><a href="#cb53-470" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-471"><a href="#cb53-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-472"><a href="#cb53-472" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(i)</span>
<span id="cb53-473"><a href="#cb53-473" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree) {</span>
<span id="cb53-474"><a href="#cb53-474" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb53-475"><a href="#cb53-475" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_hill_t"</span>)))</span>
<span id="cb53-476"><a href="#cb53-476" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_ps)),</span>
<span id="cb53-477"><a href="#cb53-477" aria-hidden="true" tabindex="-1"></a>                                         tmp_hill, <span class="at">by =</span> <span class="st">"SamName"</span>)</span>
<span id="cb53-478"><a href="#cb53-478" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp<span class="sc">$</span>ID <span class="ot">&lt;-</span> tmp_hill_samp<span class="sc">$</span>SamName</span>
<span id="cb53-479"><a href="#cb53-479" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp <span class="ot">&lt;-</span> tmp_hill_samp <span class="sc">%&gt;%</span>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"ID"</span>)</span>
<span id="cb53-480"><a href="#cb53-480" aria-hidden="true" tabindex="-1"></a>     tmp_ps2 <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(<span class="fu">otu_table</span>(tmp_ps),</span>
<span id="cb53-481"><a href="#cb53-481" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">sample_data</span>(tmp_hill_samp),</span>
<span id="cb53-482"><a href="#cb53-482" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">tax_table</span>(tmp_ps),</span>
<span id="cb53-483"><a href="#cb53-483" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">phy_tree</span>(tmp_ps))</span>
<span id="cb53-484"><a href="#cb53-484" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(i, tmp_ps2)</span>
<span id="cb53-485"><a href="#cb53-485" aria-hidden="true" tabindex="-1"></a>     tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"files/alpha/rdata/"</span>)</span>
<span id="cb53-486"><a href="#cb53-486" aria-hidden="true" tabindex="-1"></a>     <span class="fu">saveRDS</span>(tmp_ps2, <span class="fu">paste</span>(tmp_path, i, <span class="st">".rds"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-487"><a href="#cb53-487" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-488"><a href="#cb53-488" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-489"><a href="#cb53-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-490"><a href="#cb53-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-491"><a href="#cb53-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hill Numbers Summary</span></span>
<span id="cb53-492"><a href="#cb53-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-493"><a href="#cb53-493" aria-hidden="true" tabindex="-1"></a>Now we summarize the data for each sample against all three metrics. The table contains the results of ASV diversity estimates from the full data set and the three filtered data sets.</span>
<span id="cb53-494"><a href="#cb53-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-495"><a href="#cb53-495" aria-hidden="true" tabindex="-1"></a>The suffix <span class="in">`_fi`</span> indicates metrics for the Arbitrary data set.  The suffix <span class="in">`_pe`</span> indicates metrics for the PERfect data set and the suffix <span class="in">`_pet`</span> indicates the lineage diversity for the PERfect data set.</span>
<span id="cb53-496"><a href="#cb53-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-497"><a href="#cb53-497" aria-hidden="true" tabindex="-1"></a>The suffix <span class="in">`_pi`</span> indicates metrics for the PIME data set and the suffix <span class="in">`_pit`</span> indicates the lineage diversity for the PIME data set.</span>
<span id="cb53-498"><a href="#cb53-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-499"><a href="#cb53-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-502"><a href="#cb53-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-503"><a href="#cb53-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-504"><a href="#cb53-504" aria-hidden="true" tabindex="-1"></a><span class="do">######################### FULL ASV</span></span>
<span id="cb53-505"><a href="#cb53-505" aria-hidden="true" tabindex="-1"></a>ssu18_work_hill_samp <span class="ot">&lt;-</span> ssu18_ps_work_hill <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb53-506"><a href="#cb53-506" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"Shannon_exp"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-507"><a href="#cb53-507" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"InvSimpson"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-508"><a href="#cb53-508" aria-hidden="true" tabindex="-1"></a>ssu18_work_hill_samp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ssu18_ps_work)), ssu18_work_hill_samp)</span>
<span id="cb53-509"><a href="#cb53-509" aria-hidden="true" tabindex="-1"></a>ssu18_work_hill_samp <span class="ot">&lt;-</span> ssu18_work_hill_samp[<span class="fu">order</span>(ssu18_work_hill_samp<span class="sc">$</span>PLOT, ssu18_work_hill_samp<span class="sc">$</span>TEMP),]</span>
<span id="cb53-510"><a href="#cb53-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-511"><a href="#cb53-511" aria-hidden="true" tabindex="-1"></a><span class="do">######################### Filt ASV</span></span>
<span id="cb53-512"><a href="#cb53-512" aria-hidden="true" tabindex="-1"></a>ssu18_filt_hill_samp <span class="ot">&lt;-</span> ssu18_ps_filt_hill <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_fi"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb53-513"><a href="#cb53-513" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"Shannon_exp_fi"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-514"><a href="#cb53-514" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"InvSimpson_fi"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-515"><a href="#cb53-515" aria-hidden="true" tabindex="-1"></a><span class="do">######################### PERfect ASV</span></span>
<span id="cb53-516"><a href="#cb53-516" aria-hidden="true" tabindex="-1"></a>ssu18_perfect_hill_samp <span class="ot">&lt;-</span> ssu18_ps_perfect_hill <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_pe"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb53-517"><a href="#cb53-517" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"Shannon_exp_pe"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-518"><a href="#cb53-518" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"InvSimpson_pe"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-519"><a href="#cb53-519" aria-hidden="true" tabindex="-1"></a><span class="do">######################### PIME ASV</span></span>
<span id="cb53-520"><a href="#cb53-520" aria-hidden="true" tabindex="-1"></a>ssu18_pime_hill_samp <span class="ot">&lt;-</span> ssu18_ps_pime_hill <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_pi"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb53-521"><a href="#cb53-521" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"Shannon_exp_pi"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-522"><a href="#cb53-522" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"InvSimpson_pi"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-523"><a href="#cb53-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-524"><a href="#cb53-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-527"><a href="#cb53-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-528"><a href="#cb53-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-529"><a href="#cb53-529" aria-hidden="true" tabindex="-1"></a><span class="do">######################### ASV TABLE</span></span>
<span id="cb53-530"><a href="#cb53-530" aria-hidden="true" tabindex="-1"></a>ssu_tab_alpha_div <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(ssu18_work_hill_samp, ssu18_filt_hill_samp) <span class="sc">%&gt;%</span></span>
<span id="cb53-531"><a href="#cb53-531" aria-hidden="true" tabindex="-1"></a>                       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ssu18_perfect_hill_samp) <span class="sc">%&gt;%</span></span>
<span id="cb53-532"><a href="#cb53-532" aria-hidden="true" tabindex="-1"></a>                       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ssu18_pime_hill_samp) <span class="sc">%&gt;%</span> </span>
<span id="cb53-533"><a href="#cb53-533" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Observed_fi"</span>, <span class="st">"Observed_pe"</span>, <span class="st">"Observed_pi"</span>), <span class="at">.after =</span> <span class="st">"PAIR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-534"><a href="#cb53-534" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">"Shannon_exp"</span>, <span class="st">"Shannon_exp_fi"</span>, <span class="st">"Shannon_exp_pe"</span>, <span class="st">"Shannon_exp_pi"</span>), <span class="at">.after =</span> <span class="st">"Observed_pi"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-535"><a href="#cb53-535" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="st">"SamName"</span>) </span>
<span id="cb53-536"><a href="#cb53-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-537"><a href="#cb53-537" aria-hidden="true" tabindex="-1"></a>ssu_tab_alpha_div <span class="ot">&lt;-</span> ssu_tab_alpha_div<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="fu">ncol</span>(ssu_tab_alpha_div)), </span>
<span id="cb53-538"><a href="#cb53-538" aria-hidden="true" tabindex="-1"></a>                                                               round, <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb53-539"><a href="#cb53-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-540"><a href="#cb53-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-541"><a href="#cb53-541" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hill Summary</span></span>
<span id="cb53-542"><a href="#cb53-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-543"><a href="#cb53-543" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_alpha_div")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb53-544"><a href="#cb53-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-547"><a href="#cb53-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-548"><a href="#cb53-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-549"><a href="#cb53-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-550"><a href="#cb53-550" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu_tab_alpha_div</span>
<span id="cb53-551"><a href="#cb53-551" aria-hidden="true" tabindex="-1"></a>seq_table[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-552"><a href="#cb53-552" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb53-553"><a href="#cb53-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb53-554"><a href="#cb53-554" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_tab_alpha_div"</span>,</span>
<span id="cb53-555"><a href="#cb53-555" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb53-556"><a href="#cb53-556" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb53-557"><a href="#cb53-557" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb53-558"><a href="#cb53-558" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-559"><a href="#cb53-559" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-560"><a href="#cb53-560" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb53-561"><a href="#cb53-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-562"><a href="#cb53-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-565"><a href="#cb53-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-566"><a href="#cb53-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-567"><a href="#cb53-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-568"><a href="#cb53-568" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb53-569"><a href="#cb53-569" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb53-570"><a href="#cb53-570" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb53-571"><a href="#cb53-571" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb53-572"><a href="#cb53-572" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb53-573"><a href="#cb53-573" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>), </span>
<span id="cb53-574"><a href="#cb53-574" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb53-575"><a href="#cb53-575" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb53-576"><a href="#cb53-576" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observed =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb53-577"><a href="#cb53-577" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observed_fi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb53-578"><a href="#cb53-578" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observed_pe =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb53-579"><a href="#cb53-579" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observed_pi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>, </span>
<span id="cb53-580"><a href="#cb53-580" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb53-581"><a href="#cb53-581" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>)),</span>
<span id="cb53-582"><a href="#cb53-582" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon_exp =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb53-583"><a href="#cb53-583" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon_exp_fi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb53-584"><a href="#cb53-584" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon_exp_pe =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb53-585"><a href="#cb53-585" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon_exp_pi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>, </span>
<span id="cb53-586"><a href="#cb53-586" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb53-587"><a href="#cb53-587" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>)),</span>
<span id="cb53-588"><a href="#cb53-588" aria-hidden="true" tabindex="-1"></a>    <span class="at">InvSimpson =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb53-589"><a href="#cb53-589" aria-hidden="true" tabindex="-1"></a>    <span class="at">InvSimpson_fi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb53-590"><a href="#cb53-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">InvSimpson_pe =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb53-591"><a href="#cb53-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">InvSimpson_pi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>)</span>
<span id="cb53-592"><a href="#cb53-592" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb53-593"><a href="#cb53-593" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb53-594"><a href="#cb53-594" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Observed richness"</span>, </span>
<span id="cb53-595"><a href="#cb53-595" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Observed_fi"</span>, <span class="st">"Observed_pe"</span>, <span class="st">"Observed_pi"</span>),</span>
<span id="cb53-596"><a href="#cb53-596" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>, <span class="at">fontSize =</span> <span class="st">"1.1em"</span>)),</span>
<span id="cb53-597"><a href="#cb53-597" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Shannon exponential"</span>, </span>
<span id="cb53-598"><a href="#cb53-598" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Shannon_exp"</span>, <span class="st">"Shannon_exp_fi"</span>, <span class="st">"Shannon_exp_pe"</span>, <span class="st">"Shannon_exp_pi"</span>),</span>
<span id="cb53-599"><a href="#cb53-599" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"1.1em"</span>)),</span>
<span id="cb53-600"><a href="#cb53-600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Simpson multiplicative inverse"</span>, </span>
<span id="cb53-601"><a href="#cb53-601" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"InvSimpson"</span>, <span class="st">"InvSimpson_fi"</span>, <span class="st">"InvSimpson_pe"</span>, <span class="st">"InvSimpson_pi"</span>),</span>
<span id="cb53-602"><a href="#cb53-602" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"1.1em"</span>))</span>
<span id="cb53-603"><a href="#cb53-603" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb53-604"><a href="#cb53-604" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb53-605"><a href="#cb53-605" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-606"><a href="#cb53-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb53-607"><a href="#cb53-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-608"><a href="#cb53-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb53-609"><a href="#cb53-609" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-610"><a href="#cb53-610" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-611"><a href="#cb53-611" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb53-612"><a href="#cb53-612" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-613"><a href="#cb53-613" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-614"><a href="#cb53-614" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-615"><a href="#cb53-615" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb53-616"><a href="#cb53-616" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb53-617"><a href="#cb53-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-618"><a href="#cb53-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-619"><a href="#cb53-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-620"><a href="#cb53-620" aria-hidden="true" tabindex="-1"></a><span class="fu">## Normality Tests</span></span>
<span id="cb53-621"><a href="#cb53-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-622"><a href="#cb53-622" aria-hidden="true" tabindex="-1"></a>Before running significance tests, we need to know if data is normally distributed, which will tell use whether to use a parametric or non-parametric test. To test if the data are normally distributed, we use the Shapiro-Wilk Normality test and the Bartlett Test of Homogeneity of Variances.</span>
<span id="cb53-623"><a href="#cb53-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-624"><a href="#cb53-624" aria-hidden="true" tabindex="-1"></a>If the p-values are both **not significant** (p &gt; 0.05) from the tests, we accept the null hypothesis (that the results are normally distributed) and test for significance between samples using an ANOVA. If the p-values are both **significant** (p &lt; 0.05), we reject the null hypothesis (that the results are normally distributed) and test for significance between samples using Kruskal-Wallis (non-parametric equivalent of ANOVA).</span>
<span id="cb53-625"><a href="#cb53-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-626"><a href="#cb53-626" aria-hidden="true" tabindex="-1"></a>The commands are as follows:</span>
<span id="cb53-627"><a href="#cb53-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-628"><a href="#cb53-628" aria-hidden="true" tabindex="-1"></a><span class="in">`shapiro.test(x)`</span>, where <span class="in">`x`</span> is a numeric vector of alpha diversity  values from the sample data table.</span>
<span id="cb53-629"><a href="#cb53-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-630"><a href="#cb53-630" aria-hidden="true" tabindex="-1"></a><span class="in">`bartlett.test(Value ~ Group, data = df)`</span> Where <span class="in">`Value`</span> is the metric of interest, <span class="in">`Group`</span> in the treatment to compare, and <span class="in">`df`</span> is the data frame.  </span>
<span id="cb53-631"><a href="#cb53-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-632"><a href="#cb53-632" aria-hidden="true" tabindex="-1"></a>First the Shapiro-Wilk Normality test.</span>
<span id="cb53-633"><a href="#cb53-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-636"><a href="#cb53-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-637"><a href="#cb53-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-638"><a href="#cb53-638" aria-hidden="true" tabindex="-1"></a>ssu_tab_alpha_div</span>
<span id="cb53-639"><a href="#cb53-639" aria-hidden="true" tabindex="-1"></a>ssu18_div_tab <span class="ot">&lt;-</span> ssu_tab_alpha_div</span>
<span id="cb53-640"><a href="#cb53-640" aria-hidden="true" tabindex="-1"></a>ssu18_shap_tests_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-641"><a href="#cb53-641" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(ssu18_div_tab)])) {</span>
<span id="cb53-642"><a href="#cb53-642" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"ssu18_shap_asv_"</span>, .))</span>
<span id="cb53-643"><a href="#cb53-643" aria-hidden="true" tabindex="-1"></a>   ssu18_shap_tests_asv <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu18_shap_tests_asv, tmp_name)</span>
<span id="cb53-644"><a href="#cb53-644" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">shapiro.test</span>(ssu18_div_tab[[i]]))</span>
<span id="cb53-645"><a href="#cb53-645" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb53-646"><a href="#cb53-646" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb53-647"><a href="#cb53-647" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-648"><a href="#cb53-648" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-649"><a href="#cb53-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-650"><a href="#cb53-650" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"shap_"</span>)</span>
<span id="cb53-651"><a href="#cb53-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-652"><a href="#cb53-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-653"><a href="#cb53-653" aria-hidden="true" tabindex="-1"></a>And then the Bartlett Test of Homogeneity of Variances.</span>
<span id="cb53-654"><a href="#cb53-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-657"><a href="#cb53-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-658"><a href="#cb53-658" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-659"><a href="#cb53-659" aria-hidden="true" tabindex="-1"></a>ssu18_div_tab_asv <span class="ot">&lt;-</span> ssu_tab_alpha_div</span>
<span id="cb53-660"><a href="#cb53-660" aria-hidden="true" tabindex="-1"></a>ssu18_bart_tests_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-661"><a href="#cb53-661" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab_asv[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(ssu18_div_tab_asv)])) {</span>
<span id="cb53-662"><a href="#cb53-662" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"ssu18_bart_asv_"</span>, .))</span>
<span id="cb53-663"><a href="#cb53-663" aria-hidden="true" tabindex="-1"></a>   ssu18_bart_tests_asv <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu18_bart_tests_asv, tmp_name)</span>
<span id="cb53-664"><a href="#cb53-664" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">bartlett.test</span>(ssu18_div_tab_asv[[i]] <span class="sc">~</span> TEMP, <span class="at">data =</span> ssu18_div_tab_asv))</span>
<span id="cb53-665"><a href="#cb53-665" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb53-666"><a href="#cb53-666" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb53-667"><a href="#cb53-667" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-668"><a href="#cb53-668" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-669"><a href="#cb53-669" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_bart_"</span>)</span>
<span id="cb53-670"><a href="#cb53-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-671"><a href="#cb53-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-672"><a href="#cb53-672" aria-hidden="true" tabindex="-1"></a>Here we see which Shapiro-Wilk Normality **and** Bartlett tests were significant and which were not. So wherever the value of both p-values in <span class="in">`&gt; 0.05`</span> we can use an ANOVA, otherwise we use Kruskal-Wallis.</span>
<span id="cb53-673"><a href="#cb53-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-676"><a href="#cb53-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-677"><a href="#cb53-677" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-678"><a href="#cb53-678" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-679"><a href="#cb53-679" aria-hidden="true" tabindex="-1"></a>ssu18_norm_res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb53-680"><a href="#cb53-680" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu18_div_tab_asv[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(ssu18_div_tab_asv)])) {</span>
<span id="cb53-681"><a href="#cb53-681" aria-hidden="true" tabindex="-1"></a>  tmp_get_shap <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"ssu18_shap_asv_"</span>, .)))</span>
<span id="cb53-682"><a href="#cb53-682" aria-hidden="true" tabindex="-1"></a>  tmp_shap_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_shap[[<span class="dv">2</span>]], <span class="dv">4</span>)</span>
<span id="cb53-683"><a href="#cb53-683" aria-hidden="true" tabindex="-1"></a>  tmp_get_bart <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"ssu18_bart_asv_"</span>, .)))</span>
<span id="cb53-684"><a href="#cb53-684" aria-hidden="true" tabindex="-1"></a>  tmp_bart_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_bart[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb53-685"><a href="#cb53-685" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-686"><a href="#cb53-686" aria-hidden="true" tabindex="-1"></a>  tmp_test <span class="ot">&lt;-</span> <span class="cf">if</span>(tmp_shap_p <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tmp_bart_p <span class="sc">&gt;</span> <span class="fl">0.05</span> ){</span>
<span id="cb53-687"><a href="#cb53-687" aria-hidden="true" tabindex="-1"></a>            tmp_test <span class="ot">&lt;-</span> <span class="st">"ANOVA"</span></span>
<span id="cb53-688"><a href="#cb53-688" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb53-689"><a href="#cb53-689" aria-hidden="true" tabindex="-1"></a>            tmp_test <span class="ot">&lt;-</span> <span class="st">"Kruskal-Wallis"</span></span>
<span id="cb53-690"><a href="#cb53-690" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb53-691"><a href="#cb53-691" aria-hidden="true" tabindex="-1"></a>  tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(i, tmp_shap_p, tmp_bart_p, tmp_test)</span>
<span id="cb53-692"><a href="#cb53-692" aria-hidden="true" tabindex="-1"></a>  ssu18_norm_res <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(ssu18_norm_res, tmp_df)</span>
<span id="cb53-693"><a href="#cb53-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-694"><a href="#cb53-694" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-695"><a href="#cb53-695" aria-hidden="true" tabindex="-1"></a>ssu18_norm_res[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'_exp'</span>, <span class="st">''</span>, ssu18_norm_res[,<span class="dv">1</span>])</span>
<span id="cb53-696"><a href="#cb53-696" aria-hidden="true" tabindex="-1"></a>ssu18_norm_res <span class="ot">&lt;-</span> ssu18_norm_res <span class="sc">%&gt;%</span> <span class="fu">separate</span>(<span class="at">col =</span> <span class="dv">1</span>, </span>
<span id="cb53-697"><a href="#cb53-697" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"metric"</span>, <span class="st">"dataset"</span>), </span>
<span id="cb53-698"><a href="#cb53-698" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-699"><a href="#cb53-699" aria-hidden="true" tabindex="-1"></a>ssu18_norm_res <span class="ot">&lt;-</span> ssu18_norm_res <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">dataset =</span> <span class="st">"FULL"</span>))</span>
<span id="cb53-700"><a href="#cb53-700" aria-hidden="true" tabindex="-1"></a>ssu18_norm_res<span class="sc">$</span>dataset <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(ssu18_norm_res<span class="sc">$</span>dataset, <span class="st">"^fi$"</span>, <span class="st">"FILT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-701"><a href="#cb53-701" aria-hidden="true" tabindex="-1"></a>                          stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"^pi$"</span>, <span class="st">"PIME"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-702"><a href="#cb53-702" aria-hidden="true" tabindex="-1"></a>                          stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"^pe$"</span>, <span class="st">"PERfect"</span>)</span>
<span id="cb53-703"><a href="#cb53-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-704"><a href="#cb53-704" aria-hidden="true" tabindex="-1"></a>ssu18_norm_res <span class="ot">&lt;-</span> ssu18_norm_res <span class="sc">%&gt;%</span> </span>
<span id="cb53-705"><a href="#cb53-705" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"p-value (normality)"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"p-value (homogeneity)"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"method"</span> <span class="ot">=</span> <span class="dv">5</span>))</span>
<span id="cb53-706"><a href="#cb53-706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-707"><a href="#cb53-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-708"><a href="#cb53-708" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_norm_tests")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb53-709"><a href="#cb53-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-712"><a href="#cb53-712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-713"><a href="#cb53-713" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-714"><a href="#cb53-714" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-715"><a href="#cb53-715" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_norm_res</span>
<span id="cb53-716"><a href="#cb53-716" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb53-717"><a href="#cb53-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb53-718"><a href="#cb53-718" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_norm_tests"</span>,</span>
<span id="cb53-719"><a href="#cb53-719" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb53-720"><a href="#cb53-720" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb53-721"><a href="#cb53-721" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb53-722"><a href="#cb53-722" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-723"><a href="#cb53-723" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-724"><a href="#cb53-724" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb53-725"><a href="#cb53-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-726"><a href="#cb53-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-729"><a href="#cb53-729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-730"><a href="#cb53-730" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-731"><a href="#cb53-731" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-732"><a href="#cb53-732" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb53-733"><a href="#cb53-733" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb53-734"><a href="#cb53-734" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-735"><a href="#cb53-735" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb53-736"><a href="#cb53-736" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-737"><a href="#cb53-737" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">headerVAlign =</span> <span class="st">"center"</span></span>
<span id="cb53-738"><a href="#cb53-738" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-739"><a href="#cb53-739" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb53-740"><a href="#cb53-740" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb53-741"><a href="#cb53-741" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb53-742"><a href="#cb53-742" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb53-743"><a href="#cb53-743" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb53-744"><a href="#cb53-744" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb53-745"><a href="#cb53-745" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">100</span>),</span>
<span id="cb53-746"><a href="#cb53-746" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value (normality)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value (normality)"</span>, <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-747"><a href="#cb53-747" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb53-748"><a href="#cb53-748" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-749"><a href="#cb53-749" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span></span>
<span id="cb53-750"><a href="#cb53-750" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-751"><a href="#cb53-751" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span></span>
<span id="cb53-752"><a href="#cb53-752" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb53-753"><a href="#cb53-753" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb53-754"><a href="#cb53-754" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb53-755"><a href="#cb53-755" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb53-756"><a href="#cb53-756" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb53-757"><a href="#cb53-757" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value (homogeneity)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value (homogeneity)"</span>, <span class="at">minWidth =</span> <span class="dv">130</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-758"><a href="#cb53-758" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb53-759"><a href="#cb53-759" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-760"><a href="#cb53-760" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span> <span class="co">#green "#", "#"</span></span>
<span id="cb53-761"><a href="#cb53-761" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-762"><a href="#cb53-762" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span> <span class="co">#RED</span></span>
<span id="cb53-763"><a href="#cb53-763" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb53-764"><a href="#cb53-764" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb53-765"><a href="#cb53-765" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb53-766"><a href="#cb53-766" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb53-767"><a href="#cb53-767" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb53-768"><a href="#cb53-768" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">dataset</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"dataset"</span>, <span class="at">minWidth =</span> <span class="dv">80</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>),</span>
<span id="cb53-769"><a href="#cb53-769" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"method"</span>, <span class="at">minWidth =</span> <span class="dv">120</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-770"><a href="#cb53-770" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-771"><a href="#cb53-771" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">12</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-772"><a href="#cb53-772" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb53-773"><a href="#cb53-773" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-774"><a href="#cb53-774" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-775"><a href="#cb53-775" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">TRUE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-776"><a href="#cb53-776" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb53-777"><a href="#cb53-777" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb53-778"><a href="#cb53-778" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-779"><a href="#cb53-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-780"><a href="#cb53-780" aria-hidden="true" tabindex="-1"></a><span class="fu">## Significance Tests</span></span>
<span id="cb53-781"><a href="#cb53-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-782"><a href="#cb53-782" aria-hidden="true" tabindex="-1"></a>To begin, we need to create a hierarchy variable; a two-column matrix specifying the relationship between samples (first column) and groups (second column).</span>
<span id="cb53-783"><a href="#cb53-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-786"><a href="#cb53-786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-787"><a href="#cb53-787" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-788"><a href="#cb53-788" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier <span class="ot">&lt;-</span> ssu_tab_alpha_div</span>
<span id="cb53-789"><a href="#cb53-789" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier <span class="ot">&lt;-</span> ssu18_hill_hier <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"Sample_ID"</span>, <span class="st">"TEMP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-790"><a href="#cb53-790" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb53-791"><a href="#cb53-791" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier <span class="ot">&lt;-</span> ssu18_hill_hier[<span class="fu">order</span>(ssu18_hill_hier<span class="sc">$</span>TEMP), ]</span>
<span id="cb53-792"><a href="#cb53-792" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier<span class="sc">$</span>TEMP <span class="ot">=</span> <span class="fu">paste</span>(ssu18_hill_hier<span class="sc">$</span>TEMP, <span class="st">'C'</span>, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb53-793"><a href="#cb53-793" aria-hidden="true" tabindex="-1"></a>ssu18_hill_hier <span class="ot">&lt;-</span> ssu18_hill_hier <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb53-794"><a href="#cb53-794" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_hill_hier, <span class="st">"files/alpha/rdata/ssu18_hill_hier.rds"</span>)</span>
<span id="cb53-795"><a href="#cb53-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-796"><a href="#cb53-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-797"><a href="#cb53-797" aria-hidden="true" tabindex="-1"></a>Again, we start by testing significance of ASV diversity for the data sets against each of the three metrics using the <span class="in">`div_test`</span> function.</span>
<span id="cb53-798"><a href="#cb53-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-799"><a href="#cb53-799" aria-hidden="true" tabindex="-1"></a>The command is as follows:</span>
<span id="cb53-800"><a href="#cb53-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-801"><a href="#cb53-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-802"><a href="#cb53-802" aria-hidden="true" tabindex="-1"></a><span class="in">div_test(countable = x, qvalue = i, hierarchy = hier, </span></span>
<span id="cb53-803"><a href="#cb53-803" aria-hidden="true" tabindex="-1"></a><span class="in">         tree = ultrametric_tree, posthoc = TRUE)</span></span>
<span id="cb53-804"><a href="#cb53-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-805"><a href="#cb53-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-806"><a href="#cb53-806" aria-hidden="true" tabindex="-1"></a>where <span class="in">`x`</span> is ASV by sample table, <span class="in">`i`</span> is the q-value corresponding to the metric of interest, <span class="in">`hier`</span> is the hierarchy matrix, <span class="in">`tree`</span> is an ultrametric formatted phylogenetic tree (if you choose to explore lineage diversity), and <span class="in">`posthoc`</span> indicates whether to run post hoc pairwise analyses.</span>
<span id="cb53-807"><a href="#cb53-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-810"><a href="#cb53-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-811"><a href="#cb53-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb53-812"><a href="#cb53-812" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-813"><a href="#cb53-813" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb53-814"><a href="#cb53-814" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds) {</span>
<span id="cb53-815"><a href="#cb53-815" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-816"><a href="#cb53-816" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>)))</span>
<span id="cb53-817"><a href="#cb53-817" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb53-818"><a href="#cb53-818" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> ssu18_hill_hier,</span>
<span id="cb53-819"><a href="#cb53-819" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-820"><a href="#cb53-820" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-821"><a href="#cb53-821" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb53-822"><a href="#cb53-822" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb53-823"><a href="#cb53-823" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-824"><a href="#cb53-824" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb53-825"><a href="#cb53-825" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-826"><a href="#cb53-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-827"><a href="#cb53-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-828"><a href="#cb53-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-831"><a href="#cb53-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-832"><a href="#cb53-832" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-833"><a href="#cb53-833" aria-hidden="true" tabindex="-1"></a><span class="do">## Legacy code for lineage diversity</span></span>
<span id="cb53-834"><a href="#cb53-834" aria-hidden="true" tabindex="-1"></a><span class="do">## And then test significance of lineage diversity for the filtered data sets.</span></span>
<span id="cb53-835"><a href="#cb53-835" aria-hidden="true" tabindex="-1"></a>ssu18_alpha_ds_tree <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb53-836"><a href="#cb53-836" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb53-837"><a href="#cb53-837" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu18_alpha_ds_tree) {</span>
<span id="cb53-838"><a href="#cb53-838" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-839"><a href="#cb53-839" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>)))</span>
<span id="cb53-840"><a href="#cb53-840" aria-hidden="true" tabindex="-1"></a>         tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tree_ult"</span>)))</span>
<span id="cb53-841"><a href="#cb53-841" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb53-842"><a href="#cb53-842" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> ssu18_hill_hier,</span>
<span id="cb53-843"><a href="#cb53-843" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-844"><a href="#cb53-844" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tree =</span> tmp_tree)</span>
<span id="cb53-845"><a href="#cb53-845" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_t_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-846"><a href="#cb53-846" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb53-847"><a href="#cb53-847" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb53-848"><a href="#cb53-848" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-849"><a href="#cb53-849" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb53-850"><a href="#cb53-850" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-851"><a href="#cb53-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-852"><a href="#cb53-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-853"><a href="#cb53-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-856"><a href="#cb53-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-857"><a href="#cb53-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-858"><a href="#cb53-858" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_perfect"</span>, <span class="st">"ssu18_ps_pime"</span>)</span>
<span id="cb53-859"><a href="#cb53-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-860"><a href="#cb53-860" aria-hidden="true" tabindex="-1"></a>tmp_metric <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon exponential"</span>, <span class="st">"Inverse Simpson"</span>))</span>
<span id="cb53-861"><a href="#cb53-861" aria-hidden="true" tabindex="-1"></a>tmp_qvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>))</span>
<span id="cb53-862"><a href="#cb53-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-863"><a href="#cb53-863" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb53-864"><a href="#cb53-864" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_objects) {</span>
<span id="cb53-865"><a href="#cb53-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-866"><a href="#cb53-866" aria-hidden="true" tabindex="-1"></a>  tmp_h_pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-867"><a href="#cb53-867" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-868"><a href="#cb53-868" aria-hidden="true" tabindex="-1"></a>          tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-869"><a href="#cb53-869" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)<span class="sc">$</span>homogeneity.pvalue</span>
<span id="cb53-870"><a href="#cb53-870" aria-hidden="true" tabindex="-1"></a>          tmp_h_pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_h_pvalue, tmp_get))</span>
<span id="cb53-871"><a href="#cb53-871" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb53-872"><a href="#cb53-872" aria-hidden="true" tabindex="-1"></a>  tmp_h_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_h_pvalue)</span>
<span id="cb53-873"><a href="#cb53-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-874"><a href="#cb53-874" aria-hidden="true" tabindex="-1"></a>  tmp_n_pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-875"><a href="#cb53-875" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-876"><a href="#cb53-876" aria-hidden="true" tabindex="-1"></a>          tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-877"><a href="#cb53-877" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)<span class="sc">$</span>normality.pvalue</span>
<span id="cb53-878"><a href="#cb53-878" aria-hidden="true" tabindex="-1"></a>          tmp_n_pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_n_pvalue, tmp_get))</span>
<span id="cb53-879"><a href="#cb53-879" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb53-880"><a href="#cb53-880" aria-hidden="true" tabindex="-1"></a>  tmp_n_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_n_pvalue)</span>
<span id="cb53-881"><a href="#cb53-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-882"><a href="#cb53-882" aria-hidden="true" tabindex="-1"></a>  tmp_method <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-883"><a href="#cb53-883" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-884"><a href="#cb53-884" aria-hidden="true" tabindex="-1"></a>          tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-885"><a href="#cb53-885" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)<span class="sc">$</span>method</span>
<span id="cb53-886"><a href="#cb53-886" aria-hidden="true" tabindex="-1"></a>          tmp_method <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_method, tmp_get))</span>
<span id="cb53-887"><a href="#cb53-887" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb53-888"><a href="#cb53-888" aria-hidden="true" tabindex="-1"></a>  tmp_method <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_method)</span>
<span id="cb53-889"><a href="#cb53-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-890"><a href="#cb53-890" aria-hidden="true" tabindex="-1"></a>  tmp_phoc_method <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-891"><a href="#cb53-891" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-892"><a href="#cb53-892" aria-hidden="true" tabindex="-1"></a>          tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-893"><a href="#cb53-893" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)<span class="sc">$</span>posthoc.method</span>
<span id="cb53-894"><a href="#cb53-894" aria-hidden="true" tabindex="-1"></a>          tmp_phoc_method <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_phoc_method, tmp_get))</span>
<span id="cb53-895"><a href="#cb53-895" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb53-896"><a href="#cb53-896" aria-hidden="true" tabindex="-1"></a>  tmp_phoc_method <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_phoc_method)</span>
<span id="cb53-897"><a href="#cb53-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-898"><a href="#cb53-898" aria-hidden="true" tabindex="-1"></a>  tmp_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_metric, tmp_qvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-899"><a href="#cb53-899" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_n_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-900"><a href="#cb53-900" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_h_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-901"><a href="#cb53-901" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_method) <span class="sc">%&gt;%</span></span>
<span id="cb53-902"><a href="#cb53-902" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_phoc_method) <span class="sc">%&gt;%</span></span>
<span id="cb53-903"><a href="#cb53-903" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"q-value"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"normality p-value"</span> <span class="ot">=</span> <span class="dv">3</span>, </span>
<span id="cb53-904"><a href="#cb53-904" aria-hidden="true" tabindex="-1"></a>                <span class="st">"homogeneity p-value"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"method"</span> <span class="ot">=</span> <span class="dv">5</span>, <span class="st">"posthoc method"</span> <span class="ot">=</span> <span class="dv">6</span>)</span>
<span id="cb53-905"><a href="#cb53-905" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_sig_tab"</span>))</span>
<span id="cb53-906"><a href="#cb53-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb53-907"><a href="#cb53-907" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-908"><a href="#cb53-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-909"><a href="#cb53-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-910"><a href="#cb53-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-913"><a href="#cb53-913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-914"><a href="#cb53-914" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-915"><a href="#cb53-915" aria-hidden="true" tabindex="-1"></a><span class="do">## Format as follows:</span></span>
<span id="cb53-916"><a href="#cb53-916" aria-hidden="true" tabindex="-1"></a><span class="do">## FALSE Kruskal-Wallis Test = its18_pime_q1_adt$test[[3]]</span></span>
<span id="cb53-917"><a href="#cb53-917" aria-hidden="true" tabindex="-1"></a><span class="do">## TRUE Tukey post-hoc  = its18_ps_work_q0_adt$test[[1]][[1, 5]]</span></span>
<span id="cb53-918"><a href="#cb53-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-919"><a href="#cb53-919" aria-hidden="true" tabindex="-1"></a><span class="do">############################### WORK ##################################################</span></span>
<span id="cb53-920"><a href="#cb53-920" aria-hidden="true" tabindex="-1"></a>tmp_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ssu18_ps_work_q0_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-921"><a href="#cb53-921" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_work_q1_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-922"><a href="#cb53-922" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_work_q2_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]]))</span>
<span id="cb53-923"><a href="#cb53-923" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_sig_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(ssu18_ps_work_sig_tab, tmp_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-924"><a href="#cb53-924" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"posthoc p-value"</span> <span class="ot">=</span> <span class="dv">7</span>)</span>
<span id="cb53-925"><a href="#cb53-925" aria-hidden="true" tabindex="-1"></a><span class="do">####################################Filt#############################################</span></span>
<span id="cb53-926"><a href="#cb53-926" aria-hidden="true" tabindex="-1"></a>tmp_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ssu18_ps_filt_q0_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-927"><a href="#cb53-927" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_filt_q1_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-928"><a href="#cb53-928" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_filt_q2_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]]))</span>
<span id="cb53-929"><a href="#cb53-929" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_sig_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(ssu18_ps_filt_sig_tab, tmp_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-930"><a href="#cb53-930" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"posthoc p-value"</span> <span class="ot">=</span> <span class="dv">7</span>)</span>
<span id="cb53-931"><a href="#cb53-931" aria-hidden="true" tabindex="-1"></a><span class="do">####################################PERfect##########################################</span></span>
<span id="cb53-932"><a href="#cb53-932" aria-hidden="true" tabindex="-1"></a>tmp_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ssu18_ps_perfect_q0_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-933"><a href="#cb53-933" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_perfect_q1_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-934"><a href="#cb53-934" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_perfect_q2_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]]))</span>
<span id="cb53-935"><a href="#cb53-935" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_sig_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(ssu18_ps_perfect_sig_tab, tmp_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-936"><a href="#cb53-936" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"posthoc p-value"</span> <span class="ot">=</span> <span class="dv">7</span>)</span>
<span id="cb53-937"><a href="#cb53-937" aria-hidden="true" tabindex="-1"></a><span class="do">################################ PIME ################################################</span></span>
<span id="cb53-938"><a href="#cb53-938" aria-hidden="true" tabindex="-1"></a>tmp_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(ssu18_ps_pime_q0_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-939"><a href="#cb53-939" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_pime_q1_adt<span class="sc">$</span>test[[<span class="dv">3</span>]],</span>
<span id="cb53-940"><a href="#cb53-940" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_pime_q2_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]]))</span>
<span id="cb53-941"><a href="#cb53-941" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_sig_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(ssu18_ps_pime_sig_tab, tmp_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-942"><a href="#cb53-942" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"posthoc p-value"</span> <span class="ot">=</span> <span class="dv">7</span>)</span>
<span id="cb53-943"><a href="#cb53-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-944"><a href="#cb53-944" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-945"><a href="#cb53-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-946"><a href="#cb53-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-949"><a href="#cb53-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-950"><a href="#cb53-950" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-951"><a href="#cb53-951" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_sig_tab<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="st">"FULL"</span></span>
<span id="cb53-952"><a href="#cb53-952" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_sig_tab<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"ASV"</span></span>
<span id="cb53-953"><a href="#cb53-953" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_sig_tab<span class="sc">$</span>lineage <span class="ot">&lt;-</span> <span class="st">"No"</span></span>
<span id="cb53-954"><a href="#cb53-954" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_sig_tab <span class="ot">&lt;-</span> ssu18_ps_work_sig_tab[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]</span>
<span id="cb53-955"><a href="#cb53-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-956"><a href="#cb53-956" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_sig_tab<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="st">"PIME"</span></span>
<span id="cb53-957"><a href="#cb53-957" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_sig_tab<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"ASV"</span></span>
<span id="cb53-958"><a href="#cb53-958" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_sig_tab<span class="sc">$</span>lineage <span class="ot">&lt;-</span> <span class="st">"No"</span></span>
<span id="cb53-959"><a href="#cb53-959" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_sig_tab <span class="ot">&lt;-</span> ssu18_ps_pime_sig_tab[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]</span>
<span id="cb53-960"><a href="#cb53-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-961"><a href="#cb53-961" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_sig_tab<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="st">"PERfect"</span></span>
<span id="cb53-962"><a href="#cb53-962" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_sig_tab<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"ASV"</span></span>
<span id="cb53-963"><a href="#cb53-963" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_sig_tab<span class="sc">$</span>lineage <span class="ot">&lt;-</span> <span class="st">"No"</span></span>
<span id="cb53-964"><a href="#cb53-964" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_sig_tab <span class="ot">&lt;-</span> ssu18_ps_perfect_sig_tab[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]</span>
<span id="cb53-965"><a href="#cb53-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-966"><a href="#cb53-966" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_sig_tab<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="st">"FILT"</span></span>
<span id="cb53-967"><a href="#cb53-967" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_sig_tab<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"ASV"</span></span>
<span id="cb53-968"><a href="#cb53-968" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_sig_tab<span class="sc">$</span>lineage <span class="ot">&lt;-</span> <span class="st">"No"</span></span>
<span id="cb53-969"><a href="#cb53-969" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_sig_tab <span class="ot">&lt;-</span> ssu18_ps_filt_sig_tab[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]</span>
<span id="cb53-970"><a href="#cb53-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-971"><a href="#cb53-971" aria-hidden="true" tabindex="-1"></a>ssu18_sig_tab_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ssu18_ps_work_sig_tab, </span>
<span id="cb53-972"><a href="#cb53-972" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_filt_sig_tab, </span>
<span id="cb53-973"><a href="#cb53-973" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_pime_sig_tab, </span>
<span id="cb53-974"><a href="#cb53-974" aria-hidden="true" tabindex="-1"></a>                           ssu18_ps_perfect_sig_tab</span>
<span id="cb53-975"><a href="#cb53-975" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb53-976"><a href="#cb53-976" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-977"><a href="#cb53-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-978"><a href="#cb53-978" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb53-979"><a href="#cb53-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-980"><a href="#cb53-980" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_sign_tests")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb53-981"><a href="#cb53-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-984"><a href="#cb53-984" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-985"><a href="#cb53-985" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-986"><a href="#cb53-986" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-987"><a href="#cb53-987" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_sig_tab_all</span>
<span id="cb53-988"><a href="#cb53-988" aria-hidden="true" tabindex="-1"></a>seq_table[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-989"><a href="#cb53-989" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span>  seq_table <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>), round, <span class="at">digits =</span> <span class="dv">4</span>)) </span>
<span id="cb53-990"><a href="#cb53-990" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb53-991"><a href="#cb53-991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb53-992"><a href="#cb53-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_sign_tests"</span>,</span>
<span id="cb53-993"><a href="#cb53-993" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb53-994"><a href="#cb53-994" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb53-995"><a href="#cb53-995" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb53-996"><a href="#cb53-996" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-997"><a href="#cb53-997" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-998"><a href="#cb53-998" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb53-999"><a href="#cb53-999" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1000"><a href="#cb53-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1003"><a href="#cb53-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1004"><a href="#cb53-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1005"><a href="#cb53-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1006"><a href="#cb53-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb53-1007"><a href="#cb53-1007" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb53-1008"><a href="#cb53-1008" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-1009"><a href="#cb53-1009" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb53-1010"><a href="#cb53-1010" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1011"><a href="#cb53-1011" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb53-1012"><a href="#cb53-1012" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-1013"><a href="#cb53-1013" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb53-1014"><a href="#cb53-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Dataset"</span>, </span>
<span id="cb53-1015"><a href="#cb53-1015" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb53-1016"><a href="#cb53-1016" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb53-1017"><a href="#cb53-1017" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb53-1018"><a href="#cb53-1018" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb53-1019"><a href="#cb53-1019" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">80</span>),</span>
<span id="cb53-1020"><a href="#cb53-1020" aria-hidden="true" tabindex="-1"></a>     <span class="st">`</span><span class="at">posthoc p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"posthoc p-value"</span>, </span>
<span id="cb53-1021"><a href="#cb53-1021" aria-hidden="true" tabindex="-1"></a>                                <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb53-1022"><a href="#cb53-1022" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-1023"><a href="#cb53-1023" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span> <span class="co">#green</span></span>
<span id="cb53-1024"><a href="#cb53-1024" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-1025"><a href="#cb53-1025" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span> <span class="co">#RED "#", "#"</span></span>
<span id="cb53-1026"><a href="#cb53-1026" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb53-1027"><a href="#cb53-1027" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb53-1028"><a href="#cb53-1028" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb53-1029"><a href="#cb53-1029" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb53-1030"><a href="#cb53-1030" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-1031"><a href="#cb53-1031" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-1032"><a href="#cb53-1032" aria-hidden="true" tabindex="-1"></a>     <span class="at">metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"metric"</span>, <span class="at">minWidth =</span> <span class="dv">140</span>, <span class="at">align =</span> <span class="st">"left"</span>),</span>
<span id="cb53-1033"><a href="#cb53-1033" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">q-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"q-value"</span>, <span class="at">minWidth =</span> <span class="dv">70</span>, <span class="at">align =</span> <span class="st">"center"</span>),</span>
<span id="cb53-1034"><a href="#cb53-1034" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">normality p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value (normality)"</span>, <span class="at">minWidth =</span> <span class="dv">100</span>,),</span>
<span id="cb53-1035"><a href="#cb53-1035" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">homogeneity p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value (homogeneity)"</span>, <span class="at">minWidth =</span> <span class="dv">130</span>),</span>
<span id="cb53-1036"><a href="#cb53-1036" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">dataset</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"dataset"</span>, <span class="at">minWidth =</span> <span class="dv">80</span>),</span>
<span id="cb53-1037"><a href="#cb53-1037" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"method"</span>, <span class="at">minWidth =</span> <span class="dv">120</span>)</span>
<span id="cb53-1038"><a href="#cb53-1038" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-1039"><a href="#cb53-1039" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">12</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-1040"><a href="#cb53-1040" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb53-1041"><a href="#cb53-1041" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-1042"><a href="#cb53-1042" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-1043"><a href="#cb53-1043" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1044"><a href="#cb53-1044" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.7em"</span>)))</span>
<span id="cb53-1045"><a href="#cb53-1045" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(seq_table)</span></span>
<span id="cb53-1046"><a href="#cb53-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1047"><a href="#cb53-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1048"><a href="#cb53-1048" aria-hidden="true" tabindex="-1"></a><span class="fu">## PostHoc Analyses </span></span>
<span id="cb53-1049"><a href="#cb53-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1050"><a href="#cb53-1050" aria-hidden="true" tabindex="-1"></a>First let's check the results of each posthoc analysis.</span>
<span id="cb53-1051"><a href="#cb53-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1052"><a href="#cb53-1052" aria-hidden="true" tabindex="-1"></a>::: {.column-body}</span>
<span id="cb53-1053"><a href="#cb53-1053" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb53-1054"><a href="#cb53-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1055"><a href="#cb53-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observed (q-value = 0)</span></span>
<span id="cb53-1056"><a href="#cb53-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1059"><a href="#cb53-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1060"><a href="#cb53-1060" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1061"><a href="#cb53-1061" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1062"><a href="#cb53-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1063"><a href="#cb53-1063" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1064"><a href="#cb53-1064" aria-hidden="true" tabindex="-1"></a>ssu18_asvf0_lab <span class="ot">&lt;-</span> <span class="st">"FULL (Observed)"</span></span>
<span id="cb53-1065"><a href="#cb53-1065" aria-hidden="true" tabindex="-1"></a>ssu18_asvf0_lab</span>
<span id="cb53-1066"><a href="#cb53-1066" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_q0_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1067"><a href="#cb53-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_work_q0_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1068"><a href="#cb53-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1069"><a href="#cb53-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1072"><a href="#cb53-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1073"><a href="#cb53-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1074"><a href="#cb53-1074" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1075"><a href="#cb53-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1076"><a href="#cb53-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1077"><a href="#cb53-1077" aria-hidden="true" tabindex="-1"></a>ssu18_asvl0_lab <span class="ot">&lt;-</span> <span class="st">"FILT (Observed)"</span></span>
<span id="cb53-1078"><a href="#cb53-1078" aria-hidden="true" tabindex="-1"></a>ssu18_asvl0_lab</span>
<span id="cb53-1079"><a href="#cb53-1079" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_q0_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1080"><a href="#cb53-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_filt_q0_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1081"><a href="#cb53-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1082"><a href="#cb53-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1085"><a href="#cb53-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1086"><a href="#cb53-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1087"><a href="#cb53-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1088"><a href="#cb53-1088" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1089"><a href="#cb53-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1090"><a href="#cb53-1090" aria-hidden="true" tabindex="-1"></a>ssu18_asvp0_lab <span class="ot">&lt;-</span> <span class="st">"PIME (Observed)"</span></span>
<span id="cb53-1091"><a href="#cb53-1091" aria-hidden="true" tabindex="-1"></a>ssu18_asvp0_lab</span>
<span id="cb53-1092"><a href="#cb53-1092" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_q0_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1093"><a href="#cb53-1093" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_pime_q0_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1094"><a href="#cb53-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1095"><a href="#cb53-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1098"><a href="#cb53-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1099"><a href="#cb53-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1100"><a href="#cb53-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1101"><a href="#cb53-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1102"><a href="#cb53-1102" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1103"><a href="#cb53-1103" aria-hidden="true" tabindex="-1"></a>ssu18_asvr0_lab <span class="ot">&lt;-</span> <span class="st">"PERfect (Observed)"</span></span>
<span id="cb53-1104"><a href="#cb53-1104" aria-hidden="true" tabindex="-1"></a>ssu18_asvr0_lab</span>
<span id="cb53-1105"><a href="#cb53-1105" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_q0_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1106"><a href="#cb53-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_perfect_q0_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1107"><a href="#cb53-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1108"><a href="#cb53-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1109"><a href="#cb53-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">### Shannon exp  (q-value = 1)</span></span>
<span id="cb53-1110"><a href="#cb53-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1113"><a href="#cb53-1113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1114"><a href="#cb53-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1115"><a href="#cb53-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1116"><a href="#cb53-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1117"><a href="#cb53-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1118"><a href="#cb53-1118" aria-hidden="true" tabindex="-1"></a>ssu18_asvf1_lab <span class="ot">&lt;-</span> <span class="st">"FULL (Shannon exponential)"</span></span>
<span id="cb53-1119"><a href="#cb53-1119" aria-hidden="true" tabindex="-1"></a>ssu18_asvf1_lab</span>
<span id="cb53-1120"><a href="#cb53-1120" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_q1_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1121"><a href="#cb53-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_work_q1_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1122"><a href="#cb53-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1123"><a href="#cb53-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1126"><a href="#cb53-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1127"><a href="#cb53-1127" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1128"><a href="#cb53-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1129"><a href="#cb53-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1130"><a href="#cb53-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1131"><a href="#cb53-1131" aria-hidden="true" tabindex="-1"></a>ssu18_asvl1_lab <span class="ot">&lt;-</span> <span class="st">"FILT (Shannon exponential)"</span></span>
<span id="cb53-1132"><a href="#cb53-1132" aria-hidden="true" tabindex="-1"></a>ssu18_asvl1_lab</span>
<span id="cb53-1133"><a href="#cb53-1133" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_q1_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1134"><a href="#cb53-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_filt_q1_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1135"><a href="#cb53-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1136"><a href="#cb53-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1139"><a href="#cb53-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1140"><a href="#cb53-1140" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1141"><a href="#cb53-1141" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1142"><a href="#cb53-1142" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1143"><a href="#cb53-1143" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1144"><a href="#cb53-1144" aria-hidden="true" tabindex="-1"></a>ssu18_asvp1_lab <span class="ot">&lt;-</span> <span class="st">"PIME (Shannon exponential)"</span></span>
<span id="cb53-1145"><a href="#cb53-1145" aria-hidden="true" tabindex="-1"></a>ssu18_asvp1_lab</span>
<span id="cb53-1146"><a href="#cb53-1146" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_q1_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1147"><a href="#cb53-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_pime_q1_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1148"><a href="#cb53-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1149"><a href="#cb53-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1152"><a href="#cb53-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1153"><a href="#cb53-1153" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1154"><a href="#cb53-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1155"><a href="#cb53-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1156"><a href="#cb53-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1157"><a href="#cb53-1157" aria-hidden="true" tabindex="-1"></a>ssu18_asvr1_lab <span class="ot">&lt;-</span> <span class="st">"PERfect (Shannon exponential)"</span></span>
<span id="cb53-1158"><a href="#cb53-1158" aria-hidden="true" tabindex="-1"></a>ssu18_asvr1_lab</span>
<span id="cb53-1159"><a href="#cb53-1159" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_q1_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1160"><a href="#cb53-1160" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_perfect_q1_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1161"><a href="#cb53-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1162"><a href="#cb53-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1163"><a href="#cb53-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inverse Simpson (q-value = 2)</span></span>
<span id="cb53-1164"><a href="#cb53-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1167"><a href="#cb53-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1168"><a href="#cb53-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1169"><a href="#cb53-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1170"><a href="#cb53-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1171"><a href="#cb53-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1172"><a href="#cb53-1172" aria-hidden="true" tabindex="-1"></a>ssu18_asvf2_lab <span class="ot">&lt;-</span> <span class="st">"FULL (Inverse Simpson)"</span></span>
<span id="cb53-1173"><a href="#cb53-1173" aria-hidden="true" tabindex="-1"></a>ssu18_asvf2_lab</span>
<span id="cb53-1174"><a href="#cb53-1174" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_q2_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1175"><a href="#cb53-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_work_q2_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1176"><a href="#cb53-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1177"><a href="#cb53-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1180"><a href="#cb53-1180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1181"><a href="#cb53-1181" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1182"><a href="#cb53-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1183"><a href="#cb53-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1184"><a href="#cb53-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1185"><a href="#cb53-1185" aria-hidden="true" tabindex="-1"></a>ssu18_asvl2_lab <span class="ot">&lt;-</span> <span class="st">"FILT (Inverse Simpson)"</span></span>
<span id="cb53-1186"><a href="#cb53-1186" aria-hidden="true" tabindex="-1"></a>ssu18_asvl2_lab</span>
<span id="cb53-1187"><a href="#cb53-1187" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_q2_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1188"><a href="#cb53-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_filt_q2_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1189"><a href="#cb53-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1190"><a href="#cb53-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1193"><a href="#cb53-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1194"><a href="#cb53-1194" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1195"><a href="#cb53-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1196"><a href="#cb53-1196" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1197"><a href="#cb53-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1198"><a href="#cb53-1198" aria-hidden="true" tabindex="-1"></a>ssu18_asvp2_lab <span class="ot">&lt;-</span> <span class="st">"PIME (Inverse Simpson)"</span></span>
<span id="cb53-1199"><a href="#cb53-1199" aria-hidden="true" tabindex="-1"></a>ssu18_asvp2_lab</span>
<span id="cb53-1200"><a href="#cb53-1200" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_q2_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1201"><a href="#cb53-1201" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_pime_q2_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1202"><a href="#cb53-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1203"><a href="#cb53-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1206"><a href="#cb53-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1207"><a href="#cb53-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1208"><a href="#cb53-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1209"><a href="#cb53-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-1210"><a href="#cb53-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-1211"><a href="#cb53-1211" aria-hidden="true" tabindex="-1"></a>ssu18_asvr2_lab <span class="ot">&lt;-</span> <span class="st">"PERfect (Inverse Simpson)"</span></span>
<span id="cb53-1212"><a href="#cb53-1212" aria-hidden="true" tabindex="-1"></a>ssu18_asvr2_lab</span>
<span id="cb53-1213"><a href="#cb53-1213" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_q2_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1214"><a href="#cb53-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ssu18_ps_perfect_q2_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-1215"><a href="#cb53-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1216"><a href="#cb53-1216" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1217"><a href="#cb53-1217" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1218"><a href="#cb53-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1219"><a href="#cb53-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1220"><a href="#cb53-1220" aria-hidden="true" tabindex="-1"></a>Now we can plot the results from the posthoc analyses for each metric and data set using the function <span class="in">`div_test_plot_jjs`</span>. I modified the original function (<span class="in">`div_test_plot`</span>) to control a little of the formatting.</span>
<span id="cb53-1221"><a href="#cb53-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1222"><a href="#cb53-1222" aria-hidden="true" tabindex="-1"></a>The command is as follows:</span>
<span id="cb53-1223"><a href="#cb53-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1224"><a href="#cb53-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1225"><a href="#cb53-1225" aria-hidden="true" tabindex="-1"></a><span class="in">div_test_plot(divtest = x, chart = "type", colour = col.pal, </span></span>
<span id="cb53-1226"><a href="#cb53-1226" aria-hidden="true" tabindex="-1"></a><span class="in">              posthoc = TRUE, threshold = value))</span></span>
<span id="cb53-1227"><a href="#cb53-1227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1228"><a href="#cb53-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1229"><a href="#cb53-1229" aria-hidden="true" tabindex="-1"></a>where <span class="in">`x`</span> is the results from the <span class="in">`div_test`</span> function, <span class="in">`"type"`</span> is chart type (box, jitter, or violin), <span class="in">`colour`</span> is is a color palette, <span class="in">`posthoc`</span> indicates whether to run posthoc pairwise analyses, and <span class="in">`value`</span> is the maximum p-value to show in pairwise posthoc results. **WARNING** if none of the posthoc results are below the specified threshold, the function will throw an error. Therefore, until this is fixed, all posthoc values are shown.</span>
<span id="cb53-1230"><a href="#cb53-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1233"><a href="#cb53-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1234"><a href="#cb53-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1235"><a href="#cb53-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"hack_code/div_test_plot_jjs.R"</span>)</span>
<span id="cb53-1236"><a href="#cb53-1236" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"_adt_plot"</span>))</span>
<span id="cb53-1237"><a href="#cb53-1237" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_adt"</span>)) {</span>
<span id="cb53-1238"><a href="#cb53-1238" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_plot"</span>))</span>
<span id="cb53-1239"><a href="#cb53-1239" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb53-1240"><a href="#cb53-1240" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">div_test_plot_jjs</span>(tmp_get, <span class="at">chart =</span> <span class="st">"box"</span>,</span>
<span id="cb53-1241"><a href="#cb53-1241" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">colour =</span> swel_col, <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-1242"><a href="#cb53-1242" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">ggpar</span>(tmp_df, <span class="at">legend =</span> <span class="st">"none"</span>)</span>
<span id="cb53-1243"><a href="#cb53-1243" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb53-1244"><a href="#cb53-1244" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb53-1245"><a href="#cb53-1245" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1246"><a href="#cb53-1246" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1247"><a href="#cb53-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1248"><a href="#cb53-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1251"><a href="#cb53-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1252"><a href="#cb53-1252" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1253"><a href="#cb53-1253" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb53-1254"><a href="#cb53-1254" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_q0_adt_plot <span class="ot">&lt;-</span> ssu18_ps_work_q0_adt_plot <span class="sc">+</span></span>
<span id="cb53-1255"><a href="#cb53-1255" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1256"><a href="#cb53-1256" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvf0_lab) <span class="sc">+</span> </span>
<span id="cb53-1257"><a href="#cb53-1257" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1258"><a href="#cb53-1258" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_q0_adt_plot <span class="ot">&lt;-</span> ssu18_ps_filt_q0_adt_plot <span class="sc">+</span></span>
<span id="cb53-1259"><a href="#cb53-1259" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-1260"><a href="#cb53-1260" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1261"><a href="#cb53-1261" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvl0_lab) <span class="sc">+</span> </span>
<span id="cb53-1262"><a href="#cb53-1262" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1263"><a href="#cb53-1263" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_q0_adt_plot <span class="ot">&lt;-</span> ssu18_ps_perfect_q0_adt_plot <span class="sc">+</span></span>
<span id="cb53-1264"><a href="#cb53-1264" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-1265"><a href="#cb53-1265" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1266"><a href="#cb53-1266" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvr0_lab) <span class="sc">+</span> </span>
<span id="cb53-1267"><a href="#cb53-1267" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1268"><a href="#cb53-1268" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_q0_adt_plot <span class="ot">&lt;-</span> ssu18_ps_pime_q0_adt_plot <span class="sc">+</span></span>
<span id="cb53-1269"><a href="#cb53-1269" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-1270"><a href="#cb53-1270" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1271"><a href="#cb53-1271" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvp0_lab)<span class="sc">+</span> </span>
<span id="cb53-1272"><a href="#cb53-1272" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1273"><a href="#cb53-1273" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb53-1274"><a href="#cb53-1274" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_q1_adt_plot <span class="ot">&lt;-</span> ssu18_ps_work_q1_adt_plot <span class="sc">+</span></span>
<span id="cb53-1275"><a href="#cb53-1275" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1276"><a href="#cb53-1276" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvf1_lab)<span class="sc">+</span> </span>
<span id="cb53-1277"><a href="#cb53-1277" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1278"><a href="#cb53-1278" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_q1_adt_plot <span class="ot">&lt;-</span> ssu18_ps_filt_q1_adt_plot <span class="sc">+</span></span>
<span id="cb53-1279"><a href="#cb53-1279" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-1280"><a href="#cb53-1280" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1281"><a href="#cb53-1281" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvl1_lab) <span class="sc">+</span> </span>
<span id="cb53-1282"><a href="#cb53-1282" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1283"><a href="#cb53-1283" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_q1_adt_plot <span class="ot">&lt;-</span> ssu18_ps_perfect_q1_adt_plot <span class="sc">+</span></span>
<span id="cb53-1284"><a href="#cb53-1284" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-1285"><a href="#cb53-1285" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1286"><a href="#cb53-1286" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvr1_lab) <span class="sc">+</span> </span>
<span id="cb53-1287"><a href="#cb53-1287" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1288"><a href="#cb53-1288" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_q1_adt_plot <span class="ot">&lt;-</span> ssu18_ps_pime_q1_adt_plot <span class="sc">+</span></span>
<span id="cb53-1289"><a href="#cb53-1289" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-1290"><a href="#cb53-1290" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1291"><a href="#cb53-1291" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvp1_lab) <span class="sc">+</span> </span>
<span id="cb53-1292"><a href="#cb53-1292" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1293"><a href="#cb53-1293" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb53-1294"><a href="#cb53-1294" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work_q2_adt_plot <span class="ot">&lt;-</span> ssu18_ps_work_q2_adt_plot <span class="sc">+</span></span>
<span id="cb53-1295"><a href="#cb53-1295" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvf2_lab) <span class="sc">+</span> </span>
<span id="cb53-1296"><a href="#cb53-1296" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1297"><a href="#cb53-1297" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt_q2_adt_plot <span class="ot">&lt;-</span> ssu18_ps_filt_q2_adt_plot <span class="sc">+</span></span>
<span id="cb53-1298"><a href="#cb53-1298" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1299"><a href="#cb53-1299" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvl2_lab) <span class="sc">+</span> </span>
<span id="cb53-1300"><a href="#cb53-1300" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1301"><a href="#cb53-1301" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect_q2_adt_plot <span class="ot">&lt;-</span> ssu18_ps_perfect_q2_adt_plot <span class="sc">+</span></span>
<span id="cb53-1302"><a href="#cb53-1302" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1303"><a href="#cb53-1303" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvr2_lab) <span class="sc">+</span> </span>
<span id="cb53-1304"><a href="#cb53-1304" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1305"><a href="#cb53-1305" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_q2_adt_plot <span class="ot">&lt;-</span> ssu18_ps_pime_q2_adt_plot <span class="sc">+</span></span>
<span id="cb53-1306"><a href="#cb53-1306" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-1307"><a href="#cb53-1307" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(ssu18_asvp2_lab) <span class="sc">+</span> </span>
<span id="cb53-1308"><a href="#cb53-1308" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-1309"><a href="#cb53-1309" aria-hidden="true" tabindex="-1"></a>ssu18_alph_div_plots_asv <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb53-1310"><a href="#cb53-1310" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_work_q0_adt_plot, </span>
<span id="cb53-1311"><a href="#cb53-1311" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_filt_q0_adt_plot,   </span>
<span id="cb53-1312"><a href="#cb53-1312" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_perfect_q0_adt_plot, </span>
<span id="cb53-1313"><a href="#cb53-1313" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_pime_q0_adt_plot, </span>
<span id="cb53-1314"><a href="#cb53-1314" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_work_q1_adt_plot, </span>
<span id="cb53-1315"><a href="#cb53-1315" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_filt_q1_adt_plot, </span>
<span id="cb53-1316"><a href="#cb53-1316" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_perfect_q1_adt_plot, </span>
<span id="cb53-1317"><a href="#cb53-1317" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_pime_q1_adt_plot, </span>
<span id="cb53-1318"><a href="#cb53-1318" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_work_q2_adt_plot, </span>
<span id="cb53-1319"><a href="#cb53-1319" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_filt_q2_adt_plot, </span>
<span id="cb53-1320"><a href="#cb53-1320" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_perfect_q2_adt_plot, </span>
<span id="cb53-1321"><a href="#cb53-1321" aria-hidden="true" tabindex="-1"></a>  ssu18_ps_pime_q2_adt_plot, </span>
<span id="cb53-1322"><a href="#cb53-1322" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb53-1323"><a href="#cb53-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1324"><a href="#cb53-1324" aria-hidden="true" tabindex="-1"></a>ssu18_alph_div_plots_asv</span>
<span id="cb53-1325"><a href="#cb53-1325" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-1326"><a href="#cb53-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"files/alpha/figures/ssu18_alph_div_plots_asv.png"</span>,</span>
<span id="cb53-1327"><a href="#cb53-1327" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">32</span>, <span class="at">width =</span> <span class="dv">60</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb53-1328"><a href="#cb53-1328" aria-hidden="true" tabindex="-1"></a>ssu18_alph_div_plots_asv</span>
<span id="cb53-1329"><a href="#cb53-1329" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-1330"><a href="#cb53-1330" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">"files/alpha/figures/ssu18_alph_div_plots_asv.pdf"</span>,</span>
<span id="cb53-1331"><a href="#cb53-1331" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">11</span>)</span>
<span id="cb53-1332"><a href="#cb53-1332" aria-hidden="true" tabindex="-1"></a>ssu18_alph_div_plots_asv</span>
<span id="cb53-1333"><a href="#cb53-1333" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-1334"><a href="#cb53-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/alpha/figures/ssu18_alph_div_plots_asv.png include/alpha/ssu18_alph_div_plots_asv.png"</span>)</span>
<span id="cb53-1335"><a href="#cb53-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1336"><a href="#cb53-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1337"><a href="#cb53-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">## Alpha Diversity Plots</span></span>
<span id="cb53-1338"><a href="#cb53-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1339"><a href="#cb53-1339" aria-hidden="true" tabindex="-1"></a>Posthoc adjusted p-values given for each pairwise comparison.</span>
<span id="cb53-1340"><a href="#cb53-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1343"><a href="#cb53-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1344"><a href="#cb53-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1345"><a href="#cb53-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1346"><a href="#cb53-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb53-1347"><a href="#cb53-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb53-1348"><a href="#cb53-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: body-outset</span></span>
<span id="cb53-1349"><a href="#cb53-1349" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/alpha/ssu18_alph_div_plots_asv.png"</span>)</span>
<span id="cb53-1350"><a href="#cb53-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1351"><a href="#cb53-1351" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_alpha_div_plots")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb53-1352"><a href="#cb53-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1355"><a href="#cb53-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1356"><a href="#cb53-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1357"><a href="#cb53-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"page_build/alpha_ssu18_alpha_wf.rdata"</span>)</span>
<span id="cb53-1358"><a href="#cb53-1358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1359"><a href="#cb53-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1362"><a href="#cb53-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1363"><a href="#cb53-1363" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1364"><a href="#cb53-1364" aria-hidden="true" tabindex="-1"></a>samp_ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>, <span class="st">"ssu18_ps_pime"</span>, <span class="st">"ssu18_ps_perfect"</span>)</span>
<span id="cb53-1365"><a href="#cb53-1365" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps) {</span>
<span id="cb53-1366"><a href="#cb53-1366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(<span class="st">"files/alpha/figures/ssu/"</span>, i, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-1367"><a href="#cb53-1367" aria-hidden="true" tabindex="-1"></a>  tmp_get_q0 <span class="ot">&lt;-</span> <span class="fu">get</span>(<span class="fu">paste0</span>(i, <span class="st">"_q0_adt_plot"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-1368"><a href="#cb53-1368" aria-hidden="true" tabindex="-1"></a>  tmp_get_q1 <span class="ot">&lt;-</span> <span class="fu">get</span>(<span class="fu">paste0</span>(i, <span class="st">"_q1_adt_plot"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-1369"><a href="#cb53-1369" aria-hidden="true" tabindex="-1"></a>  tmp_get_q2 <span class="ot">&lt;-</span> <span class="fu">get</span>(<span class="fu">paste0</span>(i, <span class="st">"_q2_adt_plot"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-1370"><a href="#cb53-1370" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-1371"><a href="#cb53-1371" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q0, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/ssu/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q0_adt_plot"</span>, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-1372"><a href="#cb53-1372" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q0, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/ssu/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q0_adt_plot"</span>, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-1373"><a href="#cb53-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1374"><a href="#cb53-1374" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q1, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/ssu/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q1_adt_plot"</span>, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-1375"><a href="#cb53-1375" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q1, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/ssu/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q1_adt_plot"</span>, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-1376"><a href="#cb53-1376" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-1377"><a href="#cb53-1377" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q2, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/ssu/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q2_adt_plot"</span>, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-1378"><a href="#cb53-1378" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q2, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/ssu/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q2_adt_plot"</span>, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-1379"><a href="#cb53-1379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1380"><a href="#cb53-1380" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb53-1381"><a href="#cb53-1381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1382"><a href="#cb53-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1383"><a href="#cb53-1383" aria-hidden="true" tabindex="-1"></a><span class="fu"># ITS</span></span>
<span id="cb53-1384"><a href="#cb53-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1387"><a href="#cb53-1387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1388"><a href="#cb53-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-1389"><a href="#cb53-1389" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial Load for  ANALYSIS #1</span></span>
<span id="cb53-1390"><a href="#cb53-1390" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb53-1391"><a href="#cb53-1391" aria-hidden="true" tabindex="-1"></a><span class="do">## ASV FULL AND PIME AND PERfect</span></span>
<span id="cb53-1392"><a href="#cb53-1392" aria-hidden="true" tabindex="-1"></a>its18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/its18_ps_work.rds"</span>)</span>
<span id="cb53-1393"><a href="#cb53-1393" aria-hidden="true" tabindex="-1"></a>its18_ps_filt <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/filtering/arbitrary/rdata/its18_ps_filt.rds"</span>)</span>
<span id="cb53-1394"><a href="#cb53-1394" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/filtering/perfect/rdata/its18_ps_perfect.rds"</span>)</span>
<span id="cb53-1395"><a href="#cb53-1395" aria-hidden="true" tabindex="-1"></a>its18_ps_pime <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/filtering/pime/rdata/its18_ps_pime.rds"</span>)</span>
<span id="cb53-1396"><a href="#cb53-1396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1397"><a href="#cb53-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1400"><a href="#cb53-1400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1401"><a href="#cb53-1401" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1402"><a href="#cb53-1402" aria-hidden="true" tabindex="-1"></a>swel_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2271B2"</span>, <span class="st">"#71B222"</span>, <span class="st">"#B22271"</span>)</span>
<span id="cb53-1403"><a href="#cb53-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1404"><a href="#cb53-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1405"><a href="#cb53-1405" aria-hidden="true" tabindex="-1"></a>To account for presence of rare sequence variants caused by sequencing errors or other technical artifacts, we use Hill numbers <span class="co">[</span><span class="ot">@alberdi2019guide</span><span class="co">]</span>. Hill numbers allow the weight put on rare versus abundant sequence variants to be scaled while providing intuitive comparisons of diversity levels using “effective number of ASVs” as a measuring unit. This approach allows for balancing the over representation of rare ASVs that might be inflated due to sequencing errors.</span>
<span id="cb53-1406"><a href="#cb53-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1407"><a href="#cb53-1407" aria-hidden="true" tabindex="-1"></a>We will then use Shapiro-Wilk tests to test for normalcy and then, depending on the results, either use  parametric ANOVA or non-parametric Kruskal-Wallis to compare alpha diversity among treatments.</span>
<span id="cb53-1408"><a href="#cb53-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1409"><a href="#cb53-1409" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculate Hill Numbers</span></span>
<span id="cb53-1410"><a href="#cb53-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1411"><a href="#cb53-1411" aria-hidden="true" tabindex="-1"></a>To calculate Hill numbers, we use the R package <span class="in">`hilldiv`</span> <span class="co">[</span><span class="ot">@alberdi2019hilldiv</span><span class="co">]</span>. We calculate three metrics that put more or less weight on common species:</span>
<span id="cb53-1412"><a href="#cb53-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1413"><a href="#cb53-1413" aria-hidden="true" tabindex="-1"></a>1) Observed richness, where <span class="in">`q-value = 0`</span>.</span>
<span id="cb53-1414"><a href="#cb53-1414" aria-hidden="true" tabindex="-1"></a>2) Shannon exponential, which weighs ASVs by their frequency,  where <span class="in">`q-value = 1`</span>.</span>
<span id="cb53-1415"><a href="#cb53-1415" aria-hidden="true" tabindex="-1"></a>3) Simpson multiplicative inverse, which over weighs abundant ASVs,  where <span class="in">`q-value = 2`</span>.</span>
<span id="cb53-1416"><a href="#cb53-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1417"><a href="#cb53-1417" aria-hidden="true" tabindex="-1"></a>We perform each analysis against the Full (unfiltered) data set as well as the Arbitrary, PERfect and PIME, filtered data sets using the function <span class="in">`hill_div`</span>.</span>
<span id="cb53-1418"><a href="#cb53-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1419"><a href="#cb53-1419" aria-hidden="true" tabindex="-1"></a>The command is as follows:</span>
<span id="cb53-1420"><a href="#cb53-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1421"><a href="#cb53-1421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1422"><a href="#cb53-1422" aria-hidden="true" tabindex="-1"></a><span class="in">hill_div(count = x, qvalue = i, tree = ultrametric_tree)</span></span>
<span id="cb53-1423"><a href="#cb53-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb53-1424"><a href="#cb53-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1425"><a href="#cb53-1425" aria-hidden="true" tabindex="-1"></a>where <span class="in">`x`</span> is the sample by ASV table, <span class="in">`i`</span> is the q-value corresponding to the metric of interest and <span class="in">`tree`</span> is an ultrametric formatted phylogenetic tree, however this really doesn't apply for ITS data anyway.</span>
<span id="cb53-1426"><a href="#cb53-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1427"><a href="#cb53-1427" aria-hidden="true" tabindex="-1"></a>We first transform all the data to relative abundance values, and compute new trees.</span>
<span id="cb53-1428"><a href="#cb53-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1431"><a href="#cb53-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1432"><a href="#cb53-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1433"><a href="#cb53-1433" aria-hidden="true" tabindex="-1"></a>its18_alpha_ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, <span class="st">"its18_ps_perfect"</span>, <span class="st">"its18_ps_pime"</span>)</span>
<span id="cb53-1434"><a href="#cb53-1434" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb53-1435"><a href="#cb53-1435" aria-hidden="true" tabindex="-1"></a>  tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(<span class="fu">get</span>(i), <span class="cf">function</span>(otu) otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb53-1436"><a href="#cb53-1436" aria-hidden="true" tabindex="-1"></a>  tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-1437"><a href="#cb53-1437" aria-hidden="true" tabindex="-1"></a>  tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1438"><a href="#cb53-1438" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb53-1439"><a href="#cb53-1439" aria-hidden="true" tabindex="-1"></a>  tmp_ps_norm <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb53-1440"><a href="#cb53-1440" aria-hidden="true" tabindex="-1"></a>  tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_ps_norm)))</span>
<span id="cb53-1441"><a href="#cb53-1441" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_norm"</span>))</span>
<span id="cb53-1442"><a href="#cb53-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name, tmp_ps_norm)</span>
<span id="cb53-1443"><a href="#cb53-1443" aria-hidden="true" tabindex="-1"></a>  tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>))</span>
<span id="cb53-1444"><a href="#cb53-1444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_asv_name, tmp_asv)</span>
<span id="cb53-1445"><a href="#cb53-1445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1446"><a href="#cb53-1446" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1447"><a href="#cb53-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1448"><a href="#cb53-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1449"><a href="#cb53-1449" aria-hidden="true" tabindex="-1"></a>Next, we run the analysis for all three metrics on the data sets (without a tree).</span>
<span id="cb53-1450"><a href="#cb53-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1453"><a href="#cb53-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1454"><a href="#cb53-1454" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb53-1455"><a href="#cb53-1455" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1456"><a href="#cb53-1456" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb53-1457"><a href="#cb53-1457" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb53-1458"><a href="#cb53-1458" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb53-1459"><a href="#cb53-1459" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>)))</span>
<span id="cb53-1460"><a href="#cb53-1460" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i))</span>
<span id="cb53-1461"><a href="#cb53-1461" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"tmp_name"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1462"><a href="#cb53-1462" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb53-1463"><a href="#cb53-1463" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_h"</span>, i))</span>
<span id="cb53-1464"><a href="#cb53-1464" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb53-1465"><a href="#cb53-1465" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb53-1466"><a href="#cb53-1466" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1467"><a href="#cb53-1467" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-1468"><a href="#cb53-1468" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1469"><a href="#cb53-1469" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_h"</span>)</span>
<span id="cb53-1470"><a href="#cb53-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1471"><a href="#cb53-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1472"><a href="#cb53-1472" aria-hidden="true" tabindex="-1"></a>And make summary tables to add back into each <span class="in">`ps`</span> object.</span>
<span id="cb53-1473"><a href="#cb53-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1476"><a href="#cb53-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1477"><a href="#cb53-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1478"><a href="#cb53-1478" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb53-1479"><a href="#cb53-1479" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_h0"</span>)))</span>
<span id="cb53-1480"><a href="#cb53-1480" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_h1"</span>)))</span>
<span id="cb53-1481"><a href="#cb53-1481" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_h2"</span>)))</span>
<span id="cb53-1482"><a href="#cb53-1482" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1483"><a href="#cb53-1483" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1484"><a href="#cb53-1484" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Shannon_exp"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"InvSimpson"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-1485"><a href="#cb53-1485" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_hill"</span>))</span>
<span id="cb53-1486"><a href="#cb53-1486" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb53-1487"><a href="#cb53-1487" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1488"><a href="#cb53-1488" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1489"><a href="#cb53-1489" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_hill"</span>)</span>
<span id="cb53-1490"><a href="#cb53-1490" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb53-1491"><a href="#cb53-1491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1492"><a href="#cb53-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1493"><a href="#cb53-1493" aria-hidden="true" tabindex="-1"></a>And then create the new objects with the diversity data.</span>
<span id="cb53-1494"><a href="#cb53-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1497"><a href="#cb53-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1498"><a href="#cb53-1498" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1499"><a href="#cb53-1499" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb53-1500"><a href="#cb53-1500" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb53-1501"><a href="#cb53-1501" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1502"><a href="#cb53-1502" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb53-1503"><a href="#cb53-1503" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb53-1504"><a href="#cb53-1504" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_hill"</span>)))</span>
<span id="cb53-1505"><a href="#cb53-1505" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">data.frame</span>(<span class="fu">sample_data</span>(tmp_ps)),</span>
<span id="cb53-1506"><a href="#cb53-1506" aria-hidden="true" tabindex="-1"></a>                                         tmp_hill, <span class="at">by =</span> <span class="st">"SamName"</span>)</span>
<span id="cb53-1507"><a href="#cb53-1507" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp<span class="sc">$</span>ID <span class="ot">&lt;-</span> tmp_hill_samp<span class="sc">$</span>SamName</span>
<span id="cb53-1508"><a href="#cb53-1508" aria-hidden="true" tabindex="-1"></a>     tmp_hill_samp <span class="ot">&lt;-</span> tmp_hill_samp <span class="sc">%&gt;%</span>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"ID"</span>)</span>
<span id="cb53-1509"><a href="#cb53-1509" aria-hidden="true" tabindex="-1"></a>     tmp_ps2 <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(<span class="fu">otu_table</span>(tmp_ps),</span>
<span id="cb53-1510"><a href="#cb53-1510" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">sample_data</span>(tmp_hill_samp),</span>
<span id="cb53-1511"><a href="#cb53-1511" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">tax_table</span>(tmp_ps),</span>
<span id="cb53-1512"><a href="#cb53-1512" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">phy_tree</span>(tmp_ps))</span>
<span id="cb53-1513"><a href="#cb53-1513" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(i, tmp_ps2)</span>
<span id="cb53-1514"><a href="#cb53-1514" aria-hidden="true" tabindex="-1"></a>     tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"files/alpha/rdata/"</span>)</span>
<span id="cb53-1515"><a href="#cb53-1515" aria-hidden="true" tabindex="-1"></a>     <span class="fu">saveRDS</span>(tmp_ps2, <span class="fu">paste</span>(tmp_path, i, <span class="st">".rds"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-1516"><a href="#cb53-1516" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1517"><a href="#cb53-1517" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1518"><a href="#cb53-1518" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb53-1519"><a href="#cb53-1519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1520"><a href="#cb53-1520" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hill Numbers Summary</span></span>
<span id="cb53-1521"><a href="#cb53-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1522"><a href="#cb53-1522" aria-hidden="true" tabindex="-1"></a>Now we summarize the data for each sample against all three metrics. The table contains the results of ASV diversity estimates from the full data set and the three filtered data sets.</span>
<span id="cb53-1523"><a href="#cb53-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1524"><a href="#cb53-1524" aria-hidden="true" tabindex="-1"></a>The suffix <span class="in">`_fi`</span> indicates metrics for the Arbitrary data set.  The suffix <span class="in">`_pe`</span> indicates metrics for the PERfect data set and the suffix <span class="in">`_pet`</span> indicates the lineage diversity for the PERfect data set.</span>
<span id="cb53-1525"><a href="#cb53-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1526"><a href="#cb53-1526" aria-hidden="true" tabindex="-1"></a>The suffix <span class="in">`_pi`</span> indicates metrics for the PIME data set and the suffix <span class="in">`_pit`</span> indicates the lineage diversity for the PIME data set.</span>
<span id="cb53-1527"><a href="#cb53-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1528"><a href="#cb53-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1531"><a href="#cb53-1531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1532"><a href="#cb53-1532" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1533"><a href="#cb53-1533" aria-hidden="true" tabindex="-1"></a><span class="do">######################### FULL ASV</span></span>
<span id="cb53-1534"><a href="#cb53-1534" aria-hidden="true" tabindex="-1"></a>its18_work_hill_samp <span class="ot">&lt;-</span> its18_ps_work_hill <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb53-1535"><a href="#cb53-1535" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"Shannon_exp"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-1536"><a href="#cb53-1536" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"InvSimpson"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-1537"><a href="#cb53-1537" aria-hidden="true" tabindex="-1"></a>its18_work_hill_samp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">data.frame</span>(<span class="fu">sample_data</span>(its18_ps_work)), its18_work_hill_samp)</span>
<span id="cb53-1538"><a href="#cb53-1538" aria-hidden="true" tabindex="-1"></a>its18_work_hill_samp <span class="ot">&lt;-</span> its18_work_hill_samp[<span class="fu">order</span>(its18_work_hill_samp<span class="sc">$</span>PLOT, its18_work_hill_samp<span class="sc">$</span>TEMP),]</span>
<span id="cb53-1539"><a href="#cb53-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1540"><a href="#cb53-1540" aria-hidden="true" tabindex="-1"></a><span class="do">######################### Filt ASV</span></span>
<span id="cb53-1541"><a href="#cb53-1541" aria-hidden="true" tabindex="-1"></a>its18_filt_hill_samp <span class="ot">&lt;-</span> its18_ps_filt_hill <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_fi"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb53-1542"><a href="#cb53-1542" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"Shannon_exp_fi"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-1543"><a href="#cb53-1543" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"InvSimpson_fi"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-1544"><a href="#cb53-1544" aria-hidden="true" tabindex="-1"></a><span class="do">######################### PERfect ASV</span></span>
<span id="cb53-1545"><a href="#cb53-1545" aria-hidden="true" tabindex="-1"></a>its18_perfect_hill_samp <span class="ot">&lt;-</span> its18_ps_perfect_hill <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_pe"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb53-1546"><a href="#cb53-1546" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"Shannon_exp_pe"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-1547"><a href="#cb53-1547" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"InvSimpson_pe"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-1548"><a href="#cb53-1548" aria-hidden="true" tabindex="-1"></a><span class="do">######################### PIME ASV</span></span>
<span id="cb53-1549"><a href="#cb53-1549" aria-hidden="true" tabindex="-1"></a>its18_pime_hill_samp <span class="ot">&lt;-</span> its18_ps_pime_hill <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Observed_pi"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb53-1550"><a href="#cb53-1550" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"Shannon_exp_pi"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb53-1551"><a href="#cb53-1551" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">"InvSimpson_pi"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb53-1552"><a href="#cb53-1552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1553"><a href="#cb53-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1556"><a href="#cb53-1556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1557"><a href="#cb53-1557" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1558"><a href="#cb53-1558" aria-hidden="true" tabindex="-1"></a><span class="do">######################### ASV TABLE</span></span>
<span id="cb53-1559"><a href="#cb53-1559" aria-hidden="true" tabindex="-1"></a>its_tab_alpha_div <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(its18_work_hill_samp, its18_filt_hill_samp) <span class="sc">%&gt;%</span></span>
<span id="cb53-1560"><a href="#cb53-1560" aria-hidden="true" tabindex="-1"></a>                       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., its18_perfect_hill_samp) <span class="sc">%&gt;%</span></span>
<span id="cb53-1561"><a href="#cb53-1561" aria-hidden="true" tabindex="-1"></a>                       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., its18_pime_hill_samp) <span class="sc">%&gt;%</span> </span>
<span id="cb53-1562"><a href="#cb53-1562" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Observed_fi"</span>, <span class="st">"Observed_pe"</span>, <span class="st">"Observed_pi"</span>), <span class="at">.after =</span> <span class="st">"PAIR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-1563"><a href="#cb53-1563" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">"Shannon_exp"</span>, <span class="st">"Shannon_exp_fi"</span>, <span class="st">"Shannon_exp_pe"</span>, <span class="st">"Shannon_exp_pi"</span>), <span class="at">.after =</span> <span class="st">"Observed_pi"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1564"><a href="#cb53-1564" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="st">"SamName"</span>) </span>
<span id="cb53-1565"><a href="#cb53-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1566"><a href="#cb53-1566" aria-hidden="true" tabindex="-1"></a>its_tab_alpha_div <span class="ot">&lt;-</span> its_tab_alpha_div<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="fu">ncol</span>(its_tab_alpha_div)), </span>
<span id="cb53-1567"><a href="#cb53-1567" aria-hidden="true" tabindex="-1"></a>                                                               round, <span class="at">digits =</span> <span class="dv">1</span>))</span>
<span id="cb53-1568"><a href="#cb53-1568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1569"><a href="#cb53-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1570"><a href="#cb53-1570" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hill Summary</span></span>
<span id="cb53-1571"><a href="#cb53-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1572"><a href="#cb53-1572" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_alpha_div")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb53-1573"><a href="#cb53-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1576"><a href="#cb53-1576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1577"><a href="#cb53-1577" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1578"><a href="#cb53-1578" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1579"><a href="#cb53-1579" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its_tab_alpha_div</span>
<span id="cb53-1580"><a href="#cb53-1580" aria-hidden="true" tabindex="-1"></a>seq_table[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-1581"><a href="#cb53-1581" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb53-1582"><a href="#cb53-1582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb53-1583"><a href="#cb53-1583" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_tab_alpha_div"</span>,</span>
<span id="cb53-1584"><a href="#cb53-1584" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb53-1585"><a href="#cb53-1585" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb53-1586"><a href="#cb53-1586" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb53-1587"><a href="#cb53-1587" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-1588"><a href="#cb53-1588" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1589"><a href="#cb53-1589" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb53-1590"><a href="#cb53-1590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1591"><a href="#cb53-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1594"><a href="#cb53-1594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1595"><a href="#cb53-1595" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1596"><a href="#cb53-1596" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1597"><a href="#cb53-1597" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb53-1598"><a href="#cb53-1598" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb53-1599"><a href="#cb53-1599" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb53-1600"><a href="#cb53-1600" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb53-1601"><a href="#cb53-1601" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb53-1602"><a href="#cb53-1602" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>), </span>
<span id="cb53-1603"><a href="#cb53-1603" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb53-1604"><a href="#cb53-1604" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb53-1605"><a href="#cb53-1605" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observed =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb53-1606"><a href="#cb53-1606" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observed_fi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb53-1607"><a href="#cb53-1607" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observed_pe =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb53-1608"><a href="#cb53-1608" aria-hidden="true" tabindex="-1"></a>    <span class="at">Observed_pi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>, </span>
<span id="cb53-1609"><a href="#cb53-1609" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb53-1610"><a href="#cb53-1610" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>)),</span>
<span id="cb53-1611"><a href="#cb53-1611" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon_exp =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb53-1612"><a href="#cb53-1612" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon_exp_fi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb53-1613"><a href="#cb53-1613" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon_exp_pe =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb53-1614"><a href="#cb53-1614" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shannon_exp_pi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>, </span>
<span id="cb53-1615"><a href="#cb53-1615" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb53-1616"><a href="#cb53-1616" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>)),</span>
<span id="cb53-1617"><a href="#cb53-1617" aria-hidden="true" tabindex="-1"></a>    <span class="at">InvSimpson =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb53-1618"><a href="#cb53-1618" aria-hidden="true" tabindex="-1"></a>    <span class="at">InvSimpson_fi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb53-1619"><a href="#cb53-1619" aria-hidden="true" tabindex="-1"></a>    <span class="at">InvSimpson_pe =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb53-1620"><a href="#cb53-1620" aria-hidden="true" tabindex="-1"></a>    <span class="at">InvSimpson_pi =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>)</span>
<span id="cb53-1621"><a href="#cb53-1621" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb53-1622"><a href="#cb53-1622" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb53-1623"><a href="#cb53-1623" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Observed richness"</span>, </span>
<span id="cb53-1624"><a href="#cb53-1624" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Observed_fi"</span>, <span class="st">"Observed_pe"</span>, <span class="st">"Observed_pi"</span>),</span>
<span id="cb53-1625"><a href="#cb53-1625" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>, <span class="at">fontSize =</span> <span class="st">"1.1em"</span>)),</span>
<span id="cb53-1626"><a href="#cb53-1626" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Shannon exponential"</span>, </span>
<span id="cb53-1627"><a href="#cb53-1627" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Shannon_exp"</span>, <span class="st">"Shannon_exp_fi"</span>, <span class="st">"Shannon_exp_pe"</span>, <span class="st">"Shannon_exp_pi"</span>),</span>
<span id="cb53-1628"><a href="#cb53-1628" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"1.1em"</span>)),</span>
<span id="cb53-1629"><a href="#cb53-1629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Simpson multiplicative inverse"</span>, </span>
<span id="cb53-1630"><a href="#cb53-1630" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"InvSimpson"</span>, <span class="st">"InvSimpson_fi"</span>, <span class="st">"InvSimpson_pe"</span>, <span class="st">"InvSimpson_pi"</span>),</span>
<span id="cb53-1631"><a href="#cb53-1631" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"1.1em"</span>))</span>
<span id="cb53-1632"><a href="#cb53-1632" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb53-1633"><a href="#cb53-1633" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb53-1634"><a href="#cb53-1634" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-1635"><a href="#cb53-1635" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb53-1636"><a href="#cb53-1636" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1637"><a href="#cb53-1637" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb53-1638"><a href="#cb53-1638" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-1639"><a href="#cb53-1639" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1640"><a href="#cb53-1640" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb53-1641"><a href="#cb53-1641" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-1642"><a href="#cb53-1642" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-1643"><a href="#cb53-1643" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1644"><a href="#cb53-1644" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb53-1645"><a href="#cb53-1645" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb53-1646"><a href="#cb53-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1647"><a href="#cb53-1647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1648"><a href="#cb53-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1649"><a href="#cb53-1649" aria-hidden="true" tabindex="-1"></a><span class="fu">## Normality Tests</span></span>
<span id="cb53-1650"><a href="#cb53-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1651"><a href="#cb53-1651" aria-hidden="true" tabindex="-1"></a>Before running significance tests, we need to know if data is normally distributed, which will tell use whether to use a parametric or non-parametric test. To test if the data are normally distributed, we use the Shapiro-Wilk Normality test and the Bartlett Test of Homogeneity of Variances.</span>
<span id="cb53-1652"><a href="#cb53-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1653"><a href="#cb53-1653" aria-hidden="true" tabindex="-1"></a>If the p-values are both **not significant** (p &gt; 0.05) from the tests, we accept the null hypothesis (that the results are normally distributed) and test for significance between samples using an ANOVA. If the p-values are both **significant** (p &lt; 0.05), we reject the null hypothesis (that the results are normally distributed) and test for significance between samples using Kruskal-Wallis (non-parametric equivalent of ANOVA).</span>
<span id="cb53-1654"><a href="#cb53-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1655"><a href="#cb53-1655" aria-hidden="true" tabindex="-1"></a>The commands are as follows:</span>
<span id="cb53-1656"><a href="#cb53-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1657"><a href="#cb53-1657" aria-hidden="true" tabindex="-1"></a><span class="in">`shapiro.test(x)`</span>, where <span class="in">`x`</span> is a numeric vector of alpha diversity  values from the sample data table.</span>
<span id="cb53-1658"><a href="#cb53-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1659"><a href="#cb53-1659" aria-hidden="true" tabindex="-1"></a><span class="in">`bartlett.test(Value ~ Group, data = df)`</span> Where <span class="in">`Value`</span> is the metric of interest, <span class="in">`Group`</span> in the treatment to compare, and <span class="in">`df`</span> is the data frame.  </span>
<span id="cb53-1660"><a href="#cb53-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1661"><a href="#cb53-1661" aria-hidden="true" tabindex="-1"></a>First the Shapiro-Wilk Normality test.</span>
<span id="cb53-1662"><a href="#cb53-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1665"><a href="#cb53-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1666"><a href="#cb53-1666" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1667"><a href="#cb53-1667" aria-hidden="true" tabindex="-1"></a>its_tab_alpha_div</span>
<span id="cb53-1668"><a href="#cb53-1668" aria-hidden="true" tabindex="-1"></a>its18_div_tab <span class="ot">&lt;-</span> its_tab_alpha_div</span>
<span id="cb53-1669"><a href="#cb53-1669" aria-hidden="true" tabindex="-1"></a>its18_shap_tests_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-1670"><a href="#cb53-1670" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(its18_div_tab)])) {</span>
<span id="cb53-1671"><a href="#cb53-1671" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"its18_shap_asv_"</span>, .))</span>
<span id="cb53-1672"><a href="#cb53-1672" aria-hidden="true" tabindex="-1"></a>   its18_shap_tests_asv <span class="ot">&lt;-</span> <span class="fu">append</span>(its18_shap_tests_asv, tmp_name)</span>
<span id="cb53-1673"><a href="#cb53-1673" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">shapiro.test</span>(its18_div_tab[[i]]))</span>
<span id="cb53-1674"><a href="#cb53-1674" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb53-1675"><a href="#cb53-1675" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb53-1676"><a href="#cb53-1676" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1677"><a href="#cb53-1677" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1678"><a href="#cb53-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1679"><a href="#cb53-1679" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"shap_"</span>)</span>
<span id="cb53-1680"><a href="#cb53-1680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1681"><a href="#cb53-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1682"><a href="#cb53-1682" aria-hidden="true" tabindex="-1"></a>And then the Bartlett Test of Homogeneity of Variances.</span>
<span id="cb53-1683"><a href="#cb53-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1686"><a href="#cb53-1686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1687"><a href="#cb53-1687" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1688"><a href="#cb53-1688" aria-hidden="true" tabindex="-1"></a>its18_div_tab_asv <span class="ot">&lt;-</span> its_tab_alpha_div</span>
<span id="cb53-1689"><a href="#cb53-1689" aria-hidden="true" tabindex="-1"></a>its18_bart_tests_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-1690"><a href="#cb53-1690" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab_asv[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(its18_div_tab_asv)])) {</span>
<span id="cb53-1691"><a href="#cb53-1691" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"its18_bart_asv_"</span>, .))</span>
<span id="cb53-1692"><a href="#cb53-1692" aria-hidden="true" tabindex="-1"></a>   its18_bart_tests_asv <span class="ot">&lt;-</span> <span class="fu">append</span>(its18_bart_tests_asv, tmp_name)</span>
<span id="cb53-1693"><a href="#cb53-1693" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">bartlett.test</span>(its18_div_tab_asv[[i]] <span class="sc">~</span> TEMP, <span class="at">data =</span> its18_div_tab_asv))</span>
<span id="cb53-1694"><a href="#cb53-1694" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb53-1695"><a href="#cb53-1695" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb53-1696"><a href="#cb53-1696" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1697"><a href="#cb53-1697" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1698"><a href="#cb53-1698" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_bart_"</span>)</span>
<span id="cb53-1699"><a href="#cb53-1699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1700"><a href="#cb53-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1701"><a href="#cb53-1701" aria-hidden="true" tabindex="-1"></a>Here we see which Shapiro-Wilk Normality **and** Bartlett tests were significant and which were not. So wherever the value of both p-values in <span class="in">`&gt; 0.05`</span> we can use an ANOVA, otherwise we use Kruskal-Wallis.</span>
<span id="cb53-1702"><a href="#cb53-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1705"><a href="#cb53-1705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1706"><a href="#cb53-1706" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1707"><a href="#cb53-1707" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1708"><a href="#cb53-1708" aria-hidden="true" tabindex="-1"></a>its18_norm_res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb53-1709"><a href="#cb53-1709" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(its18_div_tab_asv[,<span class="dv">7</span><span class="sc">:</span><span class="fu">ncol</span>(its18_div_tab_asv)])) {</span>
<span id="cb53-1710"><a href="#cb53-1710" aria-hidden="true" tabindex="-1"></a>  tmp_get_shap <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"its18_shap_asv_"</span>, .)))</span>
<span id="cb53-1711"><a href="#cb53-1711" aria-hidden="true" tabindex="-1"></a>  tmp_shap_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_shap[[<span class="dv">2</span>]], <span class="dv">4</span>)</span>
<span id="cb53-1712"><a href="#cb53-1712" aria-hidden="true" tabindex="-1"></a>  tmp_get_bart <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"its18_bart_asv_"</span>, .)))</span>
<span id="cb53-1713"><a href="#cb53-1713" aria-hidden="true" tabindex="-1"></a>  tmp_bart_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_bart[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb53-1714"><a href="#cb53-1714" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-1715"><a href="#cb53-1715" aria-hidden="true" tabindex="-1"></a>  tmp_test <span class="ot">&lt;-</span> <span class="cf">if</span>(tmp_shap_p <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tmp_bart_p <span class="sc">&gt;</span> <span class="fl">0.05</span> ){</span>
<span id="cb53-1716"><a href="#cb53-1716" aria-hidden="true" tabindex="-1"></a>            tmp_test <span class="ot">&lt;-</span> <span class="st">"ANOVA"</span></span>
<span id="cb53-1717"><a href="#cb53-1717" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb53-1718"><a href="#cb53-1718" aria-hidden="true" tabindex="-1"></a>            tmp_test <span class="ot">&lt;-</span> <span class="st">"Kruskal-Wallis"</span></span>
<span id="cb53-1719"><a href="#cb53-1719" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb53-1720"><a href="#cb53-1720" aria-hidden="true" tabindex="-1"></a>  tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(i, tmp_shap_p, tmp_bart_p, tmp_test)</span>
<span id="cb53-1721"><a href="#cb53-1721" aria-hidden="true" tabindex="-1"></a>  its18_norm_res <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(its18_norm_res, tmp_df)</span>
<span id="cb53-1722"><a href="#cb53-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1723"><a href="#cb53-1723" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1724"><a href="#cb53-1724" aria-hidden="true" tabindex="-1"></a>its18_norm_res[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'_exp'</span>, <span class="st">''</span>, its18_norm_res[,<span class="dv">1</span>])</span>
<span id="cb53-1725"><a href="#cb53-1725" aria-hidden="true" tabindex="-1"></a>its18_norm_res <span class="ot">&lt;-</span> its18_norm_res <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">separate</span>(<span class="at">col =</span> <span class="dv">1</span>, </span>
<span id="cb53-1726"><a href="#cb53-1726" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"metric"</span>, <span class="st">"dataset"</span>), </span>
<span id="cb53-1727"><a href="#cb53-1727" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-1728"><a href="#cb53-1728" aria-hidden="true" tabindex="-1"></a>its18_norm_res <span class="ot">&lt;-</span> its18_norm_res <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">dataset =</span> <span class="st">"FULL"</span>))</span>
<span id="cb53-1729"><a href="#cb53-1729" aria-hidden="true" tabindex="-1"></a>its18_norm_res<span class="sc">$</span>dataset <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(its18_norm_res<span class="sc">$</span>dataset, <span class="st">"^fi$"</span>, <span class="st">"FILT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1730"><a href="#cb53-1730" aria-hidden="true" tabindex="-1"></a>                          stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"^pi$"</span>, <span class="st">"PIME"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1731"><a href="#cb53-1731" aria-hidden="true" tabindex="-1"></a>                          stringr<span class="sc">::</span><span class="fu">str_replace</span>(., <span class="st">"^pe$"</span>, <span class="st">"PERfect"</span>)</span>
<span id="cb53-1732"><a href="#cb53-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1733"><a href="#cb53-1733" aria-hidden="true" tabindex="-1"></a>its18_norm_res <span class="ot">&lt;-</span> its18_norm_res <span class="sc">%&gt;%</span> </span>
<span id="cb53-1734"><a href="#cb53-1734" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"p-value (normality)"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"p-value (homogeneity)"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"method"</span> <span class="ot">=</span> <span class="dv">5</span>))</span>
<span id="cb53-1735"><a href="#cb53-1735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1736"><a href="#cb53-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1737"><a href="#cb53-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1738"><a href="#cb53-1738" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_norm_tests")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb53-1739"><a href="#cb53-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1742"><a href="#cb53-1742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1743"><a href="#cb53-1743" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1744"><a href="#cb53-1744" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1745"><a href="#cb53-1745" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_norm_res</span>
<span id="cb53-1746"><a href="#cb53-1746" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb53-1747"><a href="#cb53-1747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb53-1748"><a href="#cb53-1748" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_norm_tests"</span>,</span>
<span id="cb53-1749"><a href="#cb53-1749" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb53-1750"><a href="#cb53-1750" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb53-1751"><a href="#cb53-1751" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb53-1752"><a href="#cb53-1752" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-1753"><a href="#cb53-1753" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1754"><a href="#cb53-1754" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb53-1755"><a href="#cb53-1755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1756"><a href="#cb53-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1759"><a href="#cb53-1759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1760"><a href="#cb53-1760" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1761"><a href="#cb53-1761" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1762"><a href="#cb53-1762" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb53-1763"><a href="#cb53-1763" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb53-1764"><a href="#cb53-1764" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-1765"><a href="#cb53-1765" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb53-1766"><a href="#cb53-1766" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1767"><a href="#cb53-1767" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">headerVAlign =</span> <span class="st">"center"</span></span>
<span id="cb53-1768"><a href="#cb53-1768" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-1769"><a href="#cb53-1769" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb53-1770"><a href="#cb53-1770" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb53-1771"><a href="#cb53-1771" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb53-1772"><a href="#cb53-1772" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb53-1773"><a href="#cb53-1773" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb53-1774"><a href="#cb53-1774" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb53-1775"><a href="#cb53-1775" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">100</span>),</span>
<span id="cb53-1776"><a href="#cb53-1776" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value (normality)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value (normality)"</span>, <span class="at">minWidth =</span> <span class="dv">100</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-1777"><a href="#cb53-1777" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb53-1778"><a href="#cb53-1778" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-1779"><a href="#cb53-1779" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span></span>
<span id="cb53-1780"><a href="#cb53-1780" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-1781"><a href="#cb53-1781" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span></span>
<span id="cb53-1782"><a href="#cb53-1782" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb53-1783"><a href="#cb53-1783" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb53-1784"><a href="#cb53-1784" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb53-1785"><a href="#cb53-1785" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb53-1786"><a href="#cb53-1786" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb53-1787"><a href="#cb53-1787" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value (homogeneity)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value (homogeneity)"</span>, <span class="at">minWidth =</span> <span class="dv">130</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-1788"><a href="#cb53-1788" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb53-1789"><a href="#cb53-1789" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-1790"><a href="#cb53-1790" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span> <span class="co">#green "#", "#"</span></span>
<span id="cb53-1791"><a href="#cb53-1791" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-1792"><a href="#cb53-1792" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span> <span class="co">#RED</span></span>
<span id="cb53-1793"><a href="#cb53-1793" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb53-1794"><a href="#cb53-1794" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb53-1795"><a href="#cb53-1795" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb53-1796"><a href="#cb53-1796" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb53-1797"><a href="#cb53-1797" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb53-1798"><a href="#cb53-1798" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">dataset</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"dataset"</span>, <span class="at">minWidth =</span> <span class="dv">80</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>),</span>
<span id="cb53-1799"><a href="#cb53-1799" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"method"</span>, <span class="at">minWidth =</span> <span class="dv">120</span>, <span class="at">resizable =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1800"><a href="#cb53-1800" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-1801"><a href="#cb53-1801" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">12</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-1802"><a href="#cb53-1802" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb53-1803"><a href="#cb53-1803" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-1804"><a href="#cb53-1804" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-1805"><a href="#cb53-1805" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">TRUE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-1806"><a href="#cb53-1806" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb53-1807"><a href="#cb53-1807" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb53-1808"><a href="#cb53-1808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1809"><a href="#cb53-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1810"><a href="#cb53-1810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Significance Tests</span></span>
<span id="cb53-1811"><a href="#cb53-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1812"><a href="#cb53-1812" aria-hidden="true" tabindex="-1"></a>To begin, we need to create a hierarchy variable; a two-column matrix specifying the relationship between samples (first column) and groups (second column).</span>
<span id="cb53-1813"><a href="#cb53-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1816"><a href="#cb53-1816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1817"><a href="#cb53-1817" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1818"><a href="#cb53-1818" aria-hidden="true" tabindex="-1"></a>its18_hill_hier <span class="ot">&lt;-</span> its_tab_alpha_div</span>
<span id="cb53-1819"><a href="#cb53-1819" aria-hidden="true" tabindex="-1"></a>its18_hill_hier <span class="ot">&lt;-</span> its18_hill_hier <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"Sample_ID"</span>, <span class="st">"TEMP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1820"><a href="#cb53-1820" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb53-1821"><a href="#cb53-1821" aria-hidden="true" tabindex="-1"></a>its18_hill_hier <span class="ot">&lt;-</span> its18_hill_hier[<span class="fu">order</span>(its18_hill_hier<span class="sc">$</span>TEMP), ]</span>
<span id="cb53-1822"><a href="#cb53-1822" aria-hidden="true" tabindex="-1"></a>its18_hill_hier<span class="sc">$</span>TEMP <span class="ot">=</span> <span class="fu">paste</span>(its18_hill_hier<span class="sc">$</span>TEMP, <span class="st">'C'</span>, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb53-1823"><a href="#cb53-1823" aria-hidden="true" tabindex="-1"></a>its18_hill_hier <span class="ot">&lt;-</span> its18_hill_hier <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb53-1824"><a href="#cb53-1824" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_hill_hier, <span class="st">"files/alpha/rdata/its18_hill_hier.rds"</span>)</span>
<span id="cb53-1825"><a href="#cb53-1825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1826"><a href="#cb53-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1827"><a href="#cb53-1827" aria-hidden="true" tabindex="-1"></a>Again, we start by testing significance of ASV diversity for the data sets against each of the three metrics using the <span class="in">`div_test`</span> function.</span>
<span id="cb53-1828"><a href="#cb53-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1829"><a href="#cb53-1829" aria-hidden="true" tabindex="-1"></a>The command is as follows:</span>
<span id="cb53-1830"><a href="#cb53-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1831"><a href="#cb53-1831" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1832"><a href="#cb53-1832" aria-hidden="true" tabindex="-1"></a><span class="in">div_test(countable = x, qvalue = i, hierarchy = hier, </span></span>
<span id="cb53-1833"><a href="#cb53-1833" aria-hidden="true" tabindex="-1"></a><span class="in">         tree = ultrametric_tree, posthoc = TRUE)</span></span>
<span id="cb53-1834"><a href="#cb53-1834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1835"><a href="#cb53-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1836"><a href="#cb53-1836" aria-hidden="true" tabindex="-1"></a>where <span class="in">`x`</span> is ASV by sample table, <span class="in">`i`</span> is the q-value corresponding to the metric of interest, <span class="in">`hier`</span> is the hierarchy matrix, <span class="in">`tree`</span> is an ultrametric formatted phylogenetic tree (if you choose to explore lineage diversity), and <span class="in">`posthoc`</span> indicates whether to run post hoc pairwise analyses.</span>
<span id="cb53-1837"><a href="#cb53-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1840"><a href="#cb53-1840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1841"><a href="#cb53-1841" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb53-1842"><a href="#cb53-1842" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-1843"><a href="#cb53-1843" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb53-1844"><a href="#cb53-1844" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> its18_alpha_ds) {</span>
<span id="cb53-1845"><a href="#cb53-1845" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-1846"><a href="#cb53-1846" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_tu"</span>)))</span>
<span id="cb53-1847"><a href="#cb53-1847" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb53-1848"><a href="#cb53-1848" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> its18_hill_hier,</span>
<span id="cb53-1849"><a href="#cb53-1849" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-1850"><a href="#cb53-1850" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-1851"><a href="#cb53-1851" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb53-1852"><a href="#cb53-1852" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb53-1853"><a href="#cb53-1853" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1854"><a href="#cb53-1854" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb53-1855"><a href="#cb53-1855" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1856"><a href="#cb53-1856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1857"><a href="#cb53-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1860"><a href="#cb53-1860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1861"><a href="#cb53-1861" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1862"><a href="#cb53-1862" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, <span class="st">"its18_ps_perfect"</span>, <span class="st">"its18_ps_pime"</span>)</span>
<span id="cb53-1863"><a href="#cb53-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1864"><a href="#cb53-1864" aria-hidden="true" tabindex="-1"></a>tmp_metric <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Shannon exponential"</span>, <span class="st">"Inverse Simpson"</span>))</span>
<span id="cb53-1865"><a href="#cb53-1865" aria-hidden="true" tabindex="-1"></a>tmp_qvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>))</span>
<span id="cb53-1866"><a href="#cb53-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1867"><a href="#cb53-1867" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb53-1868"><a href="#cb53-1868" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_objects) {</span>
<span id="cb53-1869"><a href="#cb53-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1870"><a href="#cb53-1870" aria-hidden="true" tabindex="-1"></a>  tmp_h_pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-1871"><a href="#cb53-1871" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-1872"><a href="#cb53-1872" aria-hidden="true" tabindex="-1"></a>          tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-1873"><a href="#cb53-1873" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)<span class="sc">$</span>homogeneity.pvalue</span>
<span id="cb53-1874"><a href="#cb53-1874" aria-hidden="true" tabindex="-1"></a>          tmp_h_pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_h_pvalue, tmp_get))</span>
<span id="cb53-1875"><a href="#cb53-1875" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb53-1876"><a href="#cb53-1876" aria-hidden="true" tabindex="-1"></a>  tmp_h_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_h_pvalue)</span>
<span id="cb53-1877"><a href="#cb53-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1878"><a href="#cb53-1878" aria-hidden="true" tabindex="-1"></a>  tmp_n_pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-1879"><a href="#cb53-1879" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-1880"><a href="#cb53-1880" aria-hidden="true" tabindex="-1"></a>          tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-1881"><a href="#cb53-1881" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)<span class="sc">$</span>normality.pvalue</span>
<span id="cb53-1882"><a href="#cb53-1882" aria-hidden="true" tabindex="-1"></a>          tmp_n_pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_n_pvalue, tmp_get))</span>
<span id="cb53-1883"><a href="#cb53-1883" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb53-1884"><a href="#cb53-1884" aria-hidden="true" tabindex="-1"></a>  tmp_n_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_n_pvalue)</span>
<span id="cb53-1885"><a href="#cb53-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1886"><a href="#cb53-1886" aria-hidden="true" tabindex="-1"></a>  tmp_method <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-1887"><a href="#cb53-1887" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-1888"><a href="#cb53-1888" aria-hidden="true" tabindex="-1"></a>          tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-1889"><a href="#cb53-1889" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)<span class="sc">$</span>method</span>
<span id="cb53-1890"><a href="#cb53-1890" aria-hidden="true" tabindex="-1"></a>          tmp_method <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_method, tmp_get))</span>
<span id="cb53-1891"><a href="#cb53-1891" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb53-1892"><a href="#cb53-1892" aria-hidden="true" tabindex="-1"></a>  tmp_method <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_method)</span>
<span id="cb53-1893"><a href="#cb53-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1894"><a href="#cb53-1894" aria-hidden="true" tabindex="-1"></a>  tmp_phoc_method <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-1895"><a href="#cb53-1895" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb53-1896"><a href="#cb53-1896" aria-hidden="true" tabindex="-1"></a>          tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_q"</span>, j, <span class="st">"_adt"</span>))</span>
<span id="cb53-1897"><a href="#cb53-1897" aria-hidden="true" tabindex="-1"></a>          tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)<span class="sc">$</span>posthoc.method</span>
<span id="cb53-1898"><a href="#cb53-1898" aria-hidden="true" tabindex="-1"></a>          tmp_phoc_method <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_phoc_method, tmp_get))</span>
<span id="cb53-1899"><a href="#cb53-1899" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb53-1900"><a href="#cb53-1900" aria-hidden="true" tabindex="-1"></a>  tmp_phoc_method <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_phoc_method)</span>
<span id="cb53-1901"><a href="#cb53-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1902"><a href="#cb53-1902" aria-hidden="true" tabindex="-1"></a>  tmp_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_metric, tmp_qvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-1903"><a href="#cb53-1903" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_n_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-1904"><a href="#cb53-1904" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_h_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-1905"><a href="#cb53-1905" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_method) <span class="sc">%&gt;%</span></span>
<span id="cb53-1906"><a href="#cb53-1906" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_phoc_method) <span class="sc">%&gt;%</span></span>
<span id="cb53-1907"><a href="#cb53-1907" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"q-value"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"normality p-value"</span> <span class="ot">=</span> <span class="dv">3</span>, </span>
<span id="cb53-1908"><a href="#cb53-1908" aria-hidden="true" tabindex="-1"></a>                <span class="st">"homogeneity p-value"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"method"</span> <span class="ot">=</span> <span class="dv">5</span>, <span class="st">"posthoc method"</span> <span class="ot">=</span> <span class="dv">6</span>)</span>
<span id="cb53-1909"><a href="#cb53-1909" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(i, <span class="st">"_sig_tab"</span>))</span>
<span id="cb53-1910"><a href="#cb53-1910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb53-1911"><a href="#cb53-1911" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-1912"><a href="#cb53-1912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1913"><a href="#cb53-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1914"><a href="#cb53-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1917"><a href="#cb53-1917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1918"><a href="#cb53-1918" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1919"><a href="#cb53-1919" aria-hidden="true" tabindex="-1"></a><span class="do">## Format as follows:</span></span>
<span id="cb53-1920"><a href="#cb53-1920" aria-hidden="true" tabindex="-1"></a><span class="do">## FALSE Kruskal-Wallis Test = its18_pime_q1_adt$test[[3]]</span></span>
<span id="cb53-1921"><a href="#cb53-1921" aria-hidden="true" tabindex="-1"></a><span class="do">## TRUE Tukey post-hoc  = its18_ps_work_q0_adt$test[[1]][[1, 5]]</span></span>
<span id="cb53-1922"><a href="#cb53-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1923"><a href="#cb53-1923" aria-hidden="true" tabindex="-1"></a><span class="do">############################### WORK ##################################################</span></span>
<span id="cb53-1924"><a href="#cb53-1924" aria-hidden="true" tabindex="-1"></a>tmp_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(its18_ps_work_q0_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-1925"><a href="#cb53-1925" aria-hidden="true" tabindex="-1"></a>                           its18_ps_work_q1_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-1926"><a href="#cb53-1926" aria-hidden="true" tabindex="-1"></a>                           its18_ps_work_q2_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]]))</span>
<span id="cb53-1927"><a href="#cb53-1927" aria-hidden="true" tabindex="-1"></a>its18_ps_work_sig_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(its18_ps_work_sig_tab, tmp_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-1928"><a href="#cb53-1928" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"posthoc p-value"</span> <span class="ot">=</span> <span class="dv">7</span>)</span>
<span id="cb53-1929"><a href="#cb53-1929" aria-hidden="true" tabindex="-1"></a><span class="do">####################################Filt#############################################</span></span>
<span id="cb53-1930"><a href="#cb53-1930" aria-hidden="true" tabindex="-1"></a>tmp_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(its18_ps_filt_q0_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-1931"><a href="#cb53-1931" aria-hidden="true" tabindex="-1"></a>                           its18_ps_filt_q1_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-1932"><a href="#cb53-1932" aria-hidden="true" tabindex="-1"></a>                           its18_ps_filt_q2_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]]))</span>
<span id="cb53-1933"><a href="#cb53-1933" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_sig_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(its18_ps_filt_sig_tab, tmp_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-1934"><a href="#cb53-1934" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"posthoc p-value"</span> <span class="ot">=</span> <span class="dv">7</span>)</span>
<span id="cb53-1935"><a href="#cb53-1935" aria-hidden="true" tabindex="-1"></a><span class="do">####################################PERfect##########################################</span></span>
<span id="cb53-1936"><a href="#cb53-1936" aria-hidden="true" tabindex="-1"></a>tmp_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(its18_ps_perfect_q0_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-1937"><a href="#cb53-1937" aria-hidden="true" tabindex="-1"></a>                           its18_ps_perfect_q1_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-1938"><a href="#cb53-1938" aria-hidden="true" tabindex="-1"></a>                           its18_ps_perfect_q2_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]]))</span>
<span id="cb53-1939"><a href="#cb53-1939" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_sig_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(its18_ps_perfect_sig_tab, tmp_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-1940"><a href="#cb53-1940" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"posthoc p-value"</span> <span class="ot">=</span> <span class="dv">7</span>)</span>
<span id="cb53-1941"><a href="#cb53-1941" aria-hidden="true" tabindex="-1"></a><span class="do">################################ PIME ################################################</span></span>
<span id="cb53-1942"><a href="#cb53-1942" aria-hidden="true" tabindex="-1"></a>tmp_pvalue <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(its18_ps_pime_q0_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-1943"><a href="#cb53-1943" aria-hidden="true" tabindex="-1"></a>                           its18_ps_pime_q1_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]],</span>
<span id="cb53-1944"><a href="#cb53-1944" aria-hidden="true" tabindex="-1"></a>                           its18_ps_pime_q2_adt<span class="sc">$</span>test[[<span class="dv">1</span>]][[<span class="dv">1</span>, <span class="dv">5</span>]]))</span>
<span id="cb53-1945"><a href="#cb53-1945" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_sig_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(its18_ps_pime_sig_tab, tmp_pvalue) <span class="sc">%&gt;%</span></span>
<span id="cb53-1946"><a href="#cb53-1946" aria-hidden="true" tabindex="-1"></a>                         dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"posthoc p-value"</span> <span class="ot">=</span> <span class="dv">7</span>)</span>
<span id="cb53-1947"><a href="#cb53-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1948"><a href="#cb53-1948" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-1949"><a href="#cb53-1949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1950"><a href="#cb53-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1953"><a href="#cb53-1953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1954"><a href="#cb53-1954" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1955"><a href="#cb53-1955" aria-hidden="true" tabindex="-1"></a>its18_ps_work_sig_tab<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="st">"FULL"</span></span>
<span id="cb53-1956"><a href="#cb53-1956" aria-hidden="true" tabindex="-1"></a>its18_ps_work_sig_tab<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"ASV"</span></span>
<span id="cb53-1957"><a href="#cb53-1957" aria-hidden="true" tabindex="-1"></a>its18_ps_work_sig_tab<span class="sc">$</span>lineage <span class="ot">&lt;-</span> <span class="st">"No"</span></span>
<span id="cb53-1958"><a href="#cb53-1958" aria-hidden="true" tabindex="-1"></a>its18_ps_work_sig_tab <span class="ot">&lt;-</span> its18_ps_work_sig_tab[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]</span>
<span id="cb53-1959"><a href="#cb53-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1960"><a href="#cb53-1960" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_sig_tab<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="st">"PIME"</span></span>
<span id="cb53-1961"><a href="#cb53-1961" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_sig_tab<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"ASV"</span></span>
<span id="cb53-1962"><a href="#cb53-1962" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_sig_tab<span class="sc">$</span>lineage <span class="ot">&lt;-</span> <span class="st">"No"</span></span>
<span id="cb53-1963"><a href="#cb53-1963" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_sig_tab <span class="ot">&lt;-</span> its18_ps_pime_sig_tab[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]</span>
<span id="cb53-1964"><a href="#cb53-1964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1965"><a href="#cb53-1965" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_sig_tab<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="st">"PERfect"</span></span>
<span id="cb53-1966"><a href="#cb53-1966" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_sig_tab<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"ASV"</span></span>
<span id="cb53-1967"><a href="#cb53-1967" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_sig_tab<span class="sc">$</span>lineage <span class="ot">&lt;-</span> <span class="st">"No"</span></span>
<span id="cb53-1968"><a href="#cb53-1968" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_sig_tab <span class="ot">&lt;-</span> its18_ps_perfect_sig_tab[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]</span>
<span id="cb53-1969"><a href="#cb53-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1970"><a href="#cb53-1970" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_sig_tab<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="st">"FILT"</span></span>
<span id="cb53-1971"><a href="#cb53-1971" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_sig_tab<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"ASV"</span></span>
<span id="cb53-1972"><a href="#cb53-1972" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_sig_tab<span class="sc">$</span>lineage <span class="ot">&lt;-</span> <span class="st">"No"</span></span>
<span id="cb53-1973"><a href="#cb53-1973" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_sig_tab <span class="ot">&lt;-</span> its18_ps_filt_sig_tab[,<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]</span>
<span id="cb53-1974"><a href="#cb53-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1975"><a href="#cb53-1975" aria-hidden="true" tabindex="-1"></a>its18_sig_tab_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(its18_ps_work_sig_tab, </span>
<span id="cb53-1976"><a href="#cb53-1976" aria-hidden="true" tabindex="-1"></a>                           its18_ps_filt_sig_tab, </span>
<span id="cb53-1977"><a href="#cb53-1977" aria-hidden="true" tabindex="-1"></a>                           its18_ps_pime_sig_tab, </span>
<span id="cb53-1978"><a href="#cb53-1978" aria-hidden="true" tabindex="-1"></a>                           its18_ps_perfect_sig_tab</span>
<span id="cb53-1979"><a href="#cb53-1979" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb53-1980"><a href="#cb53-1980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1981"><a href="#cb53-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1982"><a href="#cb53-1982" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb53-1983"><a href="#cb53-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1984"><a href="#cb53-1984" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_sign_tests")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb53-1985"><a href="#cb53-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1988"><a href="#cb53-1988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1989"><a href="#cb53-1989" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-1990"><a href="#cb53-1990" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-1991"><a href="#cb53-1991" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_sig_tab_all</span>
<span id="cb53-1992"><a href="#cb53-1992" aria-hidden="true" tabindex="-1"></a>seq_table[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-1993"><a href="#cb53-1993" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span>  seq_table <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>), round, <span class="at">digits =</span> <span class="dv">4</span>)) </span>
<span id="cb53-1994"><a href="#cb53-1994" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb53-1995"><a href="#cb53-1995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb53-1996"><a href="#cb53-1996" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_sign_tests"</span>,</span>
<span id="cb53-1997"><a href="#cb53-1997" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb53-1998"><a href="#cb53-1998" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb53-1999"><a href="#cb53-1999" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb53-2000"><a href="#cb53-2000" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-2001"><a href="#cb53-2001" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-2002"><a href="#cb53-2002" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb53-2003"><a href="#cb53-2003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2004"><a href="#cb53-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2007"><a href="#cb53-2007" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2008"><a href="#cb53-2008" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2009"><a href="#cb53-2009" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2010"><a href="#cb53-2010" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb53-2011"><a href="#cb53-2011" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb53-2012"><a href="#cb53-2012" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-2013"><a href="#cb53-2013" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb53-2014"><a href="#cb53-2014" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-2015"><a href="#cb53-2015" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">80</span></span>
<span id="cb53-2016"><a href="#cb53-2016" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-2017"><a href="#cb53-2017" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb53-2018"><a href="#cb53-2018" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Dataset"</span>, </span>
<span id="cb53-2019"><a href="#cb53-2019" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb53-2020"><a href="#cb53-2020" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb53-2021"><a href="#cb53-2021" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb53-2022"><a href="#cb53-2022" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb53-2023"><a href="#cb53-2023" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">100</span>),</span>
<span id="cb53-2024"><a href="#cb53-2024" aria-hidden="true" tabindex="-1"></a>     <span class="st">`</span><span class="at">posthoc p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"posthoc p-value"</span>, </span>
<span id="cb53-2025"><a href="#cb53-2025" aria-hidden="true" tabindex="-1"></a>                                <span class="at">style =</span> <span class="cf">function</span>(value) {</span>
<span id="cb53-2026"><a href="#cb53-2026" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">if</span> (value <span class="sc">&gt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-2027"><a href="#cb53-2027" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#2271B2"</span> <span class="co">#green</span></span>
<span id="cb53-2028"><a href="#cb53-2028" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> <span class="cf">if</span> (value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb53-2029"><a href="#cb53-2029" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#B22271"</span> <span class="co">#RED "#", "#"</span></span>
<span id="cb53-2030"><a href="#cb53-2030" aria-hidden="true" tabindex="-1"></a>                                         } <span class="cf">else</span> {</span>
<span id="cb53-2031"><a href="#cb53-2031" aria-hidden="true" tabindex="-1"></a>                                           color <span class="ot">&lt;-</span> <span class="st">"#777"</span></span>
<span id="cb53-2032"><a href="#cb53-2032" aria-hidden="true" tabindex="-1"></a>                                         }</span>
<span id="cb53-2033"><a href="#cb53-2033" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">fontWeight =</span> <span class="st">"bold"</span>)</span>
<span id="cb53-2034"><a href="#cb53-2034" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-2035"><a href="#cb53-2035" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-2036"><a href="#cb53-2036" aria-hidden="true" tabindex="-1"></a>     <span class="at">metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"metric"</span>, <span class="at">minWidth =</span> <span class="dv">140</span>, <span class="at">align =</span> <span class="st">"left"</span>),</span>
<span id="cb53-2037"><a href="#cb53-2037" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">q-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"q-value"</span>, <span class="at">minWidth =</span> <span class="dv">70</span>, <span class="at">align =</span> <span class="st">"center"</span>),</span>
<span id="cb53-2038"><a href="#cb53-2038" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">normality p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value (normality)"</span>, <span class="at">minWidth =</span> <span class="dv">100</span>,),</span>
<span id="cb53-2039"><a href="#cb53-2039" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">homogeneity p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"p-value (homogeneity)"</span>, <span class="at">minWidth =</span> <span class="dv">130</span>),</span>
<span id="cb53-2040"><a href="#cb53-2040" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">dataset</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"dataset"</span>, <span class="at">minWidth =</span> <span class="dv">80</span>),</span>
<span id="cb53-2041"><a href="#cb53-2041" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"method"</span>, <span class="at">minWidth =</span> <span class="dv">120</span>)</span>
<span id="cb53-2042"><a href="#cb53-2042" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb53-2043"><a href="#cb53-2043" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">12</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-2044"><a href="#cb53-2044" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb53-2045"><a href="#cb53-2045" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-2046"><a href="#cb53-2046" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-2047"><a href="#cb53-2047" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-2048"><a href="#cb53-2048" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.7em"</span>)))</span>
<span id="cb53-2049"><a href="#cb53-2049" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb53-2050"><a href="#cb53-2050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2051"><a href="#cb53-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2052"><a href="#cb53-2052" aria-hidden="true" tabindex="-1"></a><span class="fu">## PostHoc Analyses </span></span>
<span id="cb53-2053"><a href="#cb53-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2054"><a href="#cb53-2054" aria-hidden="true" tabindex="-1"></a>First let's check the results of each posthoc analysis.</span>
<span id="cb53-2055"><a href="#cb53-2055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2056"><a href="#cb53-2056" aria-hidden="true" tabindex="-1"></a>::: {.column-body}</span>
<span id="cb53-2057"><a href="#cb53-2057" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb53-2058"><a href="#cb53-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2059"><a href="#cb53-2059" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observed (q-value = 0)</span></span>
<span id="cb53-2060"><a href="#cb53-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2063"><a href="#cb53-2063" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2064"><a href="#cb53-2064" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2065"><a href="#cb53-2065" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2066"><a href="#cb53-2066" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2067"><a href="#cb53-2067" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2068"><a href="#cb53-2068" aria-hidden="true" tabindex="-1"></a>its18_asvf0_lab <span class="ot">&lt;-</span> <span class="st">"FULL (Observed)"</span></span>
<span id="cb53-2069"><a href="#cb53-2069" aria-hidden="true" tabindex="-1"></a>its18_asvf0_lab</span>
<span id="cb53-2070"><a href="#cb53-2070" aria-hidden="true" tabindex="-1"></a>its18_ps_work_q0_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2071"><a href="#cb53-2071" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_work_q0_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2072"><a href="#cb53-2072" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2073"><a href="#cb53-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2076"><a href="#cb53-2076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2077"><a href="#cb53-2077" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2078"><a href="#cb53-2078" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2079"><a href="#cb53-2079" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2080"><a href="#cb53-2080" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2081"><a href="#cb53-2081" aria-hidden="true" tabindex="-1"></a>its18_asvl0_lab <span class="ot">&lt;-</span> <span class="st">"FILT (Observed)"</span></span>
<span id="cb53-2082"><a href="#cb53-2082" aria-hidden="true" tabindex="-1"></a>its18_asvl0_lab</span>
<span id="cb53-2083"><a href="#cb53-2083" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_q0_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2084"><a href="#cb53-2084" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_filt_q0_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2085"><a href="#cb53-2085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2086"><a href="#cb53-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2089"><a href="#cb53-2089" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2090"><a href="#cb53-2090" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2091"><a href="#cb53-2091" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2092"><a href="#cb53-2092" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2093"><a href="#cb53-2093" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2094"><a href="#cb53-2094" aria-hidden="true" tabindex="-1"></a>its18_asvp0_lab <span class="ot">&lt;-</span> <span class="st">"PIME (Observed)"</span></span>
<span id="cb53-2095"><a href="#cb53-2095" aria-hidden="true" tabindex="-1"></a>its18_asvp0_lab</span>
<span id="cb53-2096"><a href="#cb53-2096" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_q0_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2097"><a href="#cb53-2097" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_pime_q0_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2098"><a href="#cb53-2098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2099"><a href="#cb53-2099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2102"><a href="#cb53-2102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2103"><a href="#cb53-2103" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2104"><a href="#cb53-2104" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2105"><a href="#cb53-2105" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2106"><a href="#cb53-2106" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2107"><a href="#cb53-2107" aria-hidden="true" tabindex="-1"></a>its18_asvr0_lab <span class="ot">&lt;-</span> <span class="st">"PERfect (Observed)"</span></span>
<span id="cb53-2108"><a href="#cb53-2108" aria-hidden="true" tabindex="-1"></a>its18_asvr0_lab</span>
<span id="cb53-2109"><a href="#cb53-2109" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_q0_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2110"><a href="#cb53-2110" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_perfect_q0_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2111"><a href="#cb53-2111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2112"><a href="#cb53-2112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2113"><a href="#cb53-2113" aria-hidden="true" tabindex="-1"></a><span class="fu">### Shannon exp  (q-value = 1)</span></span>
<span id="cb53-2114"><a href="#cb53-2114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2117"><a href="#cb53-2117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2118"><a href="#cb53-2118" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2119"><a href="#cb53-2119" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2120"><a href="#cb53-2120" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2121"><a href="#cb53-2121" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2122"><a href="#cb53-2122" aria-hidden="true" tabindex="-1"></a>its18_asvf1_lab <span class="ot">&lt;-</span> <span class="st">"FULL (Shannon exponential)"</span></span>
<span id="cb53-2123"><a href="#cb53-2123" aria-hidden="true" tabindex="-1"></a>its18_asvf1_lab</span>
<span id="cb53-2124"><a href="#cb53-2124" aria-hidden="true" tabindex="-1"></a>its18_ps_work_q1_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2125"><a href="#cb53-2125" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_work_q1_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2126"><a href="#cb53-2126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2127"><a href="#cb53-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2130"><a href="#cb53-2130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2131"><a href="#cb53-2131" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2132"><a href="#cb53-2132" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2133"><a href="#cb53-2133" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2134"><a href="#cb53-2134" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2135"><a href="#cb53-2135" aria-hidden="true" tabindex="-1"></a>its18_asvl1_lab <span class="ot">&lt;-</span> <span class="st">"FILT (Shannon exponential)"</span></span>
<span id="cb53-2136"><a href="#cb53-2136" aria-hidden="true" tabindex="-1"></a>its18_asvl1_lab</span>
<span id="cb53-2137"><a href="#cb53-2137" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_q1_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2138"><a href="#cb53-2138" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_filt_q1_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2139"><a href="#cb53-2139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2140"><a href="#cb53-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2143"><a href="#cb53-2143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2144"><a href="#cb53-2144" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2145"><a href="#cb53-2145" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2146"><a href="#cb53-2146" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2147"><a href="#cb53-2147" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2148"><a href="#cb53-2148" aria-hidden="true" tabindex="-1"></a>its18_asvp1_lab <span class="ot">&lt;-</span> <span class="st">"PIME (Shannon exponential)"</span></span>
<span id="cb53-2149"><a href="#cb53-2149" aria-hidden="true" tabindex="-1"></a>its18_asvp1_lab</span>
<span id="cb53-2150"><a href="#cb53-2150" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_q1_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2151"><a href="#cb53-2151" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_pime_q1_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2152"><a href="#cb53-2152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2153"><a href="#cb53-2153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2156"><a href="#cb53-2156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2157"><a href="#cb53-2157" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2158"><a href="#cb53-2158" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2159"><a href="#cb53-2159" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2160"><a href="#cb53-2160" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2161"><a href="#cb53-2161" aria-hidden="true" tabindex="-1"></a>its18_asvr1_lab <span class="ot">&lt;-</span> <span class="st">"PERfect (Shannon exponential)"</span></span>
<span id="cb53-2162"><a href="#cb53-2162" aria-hidden="true" tabindex="-1"></a>its18_asvr1_lab</span>
<span id="cb53-2163"><a href="#cb53-2163" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_q1_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2164"><a href="#cb53-2164" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_perfect_q1_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2165"><a href="#cb53-2165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2166"><a href="#cb53-2166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2167"><a href="#cb53-2167" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inverse Simpson (q-value = 2)</span></span>
<span id="cb53-2168"><a href="#cb53-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2171"><a href="#cb53-2171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2172"><a href="#cb53-2172" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2173"><a href="#cb53-2173" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2174"><a href="#cb53-2174" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2175"><a href="#cb53-2175" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2176"><a href="#cb53-2176" aria-hidden="true" tabindex="-1"></a>its18_asvf2_lab <span class="ot">&lt;-</span> <span class="st">"FULL (Inverse Simpson)"</span></span>
<span id="cb53-2177"><a href="#cb53-2177" aria-hidden="true" tabindex="-1"></a>its18_asvf2_lab</span>
<span id="cb53-2178"><a href="#cb53-2178" aria-hidden="true" tabindex="-1"></a>its18_ps_work_q2_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2179"><a href="#cb53-2179" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_work_q2_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2180"><a href="#cb53-2180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2181"><a href="#cb53-2181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2184"><a href="#cb53-2184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2185"><a href="#cb53-2185" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2186"><a href="#cb53-2186" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2187"><a href="#cb53-2187" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2188"><a href="#cb53-2188" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2189"><a href="#cb53-2189" aria-hidden="true" tabindex="-1"></a>its18_asvl2_lab <span class="ot">&lt;-</span> <span class="st">"FILT (Inverse Simpson)"</span></span>
<span id="cb53-2190"><a href="#cb53-2190" aria-hidden="true" tabindex="-1"></a>its18_asvl2_lab</span>
<span id="cb53-2191"><a href="#cb53-2191" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_q2_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2192"><a href="#cb53-2192" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_filt_q2_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2193"><a href="#cb53-2193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2194"><a href="#cb53-2194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2197"><a href="#cb53-2197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2198"><a href="#cb53-2198" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2199"><a href="#cb53-2199" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2200"><a href="#cb53-2200" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2201"><a href="#cb53-2201" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2202"><a href="#cb53-2202" aria-hidden="true" tabindex="-1"></a>its18_asvp2_lab <span class="ot">&lt;-</span> <span class="st">"PIME (Inverse Simpson)"</span></span>
<span id="cb53-2203"><a href="#cb53-2203" aria-hidden="true" tabindex="-1"></a>its18_asvp2_lab</span>
<span id="cb53-2204"><a href="#cb53-2204" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_q2_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2205"><a href="#cb53-2205" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_pime_q2_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2206"><a href="#cb53-2206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2207"><a href="#cb53-2207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2210"><a href="#cb53-2210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2211"><a href="#cb53-2211" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2212"><a href="#cb53-2212" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2213"><a href="#cb53-2213" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb53-2214"><a href="#cb53-2214" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: '' </span></span>
<span id="cb53-2215"><a href="#cb53-2215" aria-hidden="true" tabindex="-1"></a>its18_asvr2_lab <span class="ot">&lt;-</span> <span class="st">"PERfect (Inverse Simpson)"</span></span>
<span id="cb53-2216"><a href="#cb53-2216" aria-hidden="true" tabindex="-1"></a>its18_asvr2_lab</span>
<span id="cb53-2217"><a href="#cb53-2217" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_q2_adt<span class="sc">$</span>posthoc.method</span>
<span id="cb53-2218"><a href="#cb53-2218" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(its18_ps_perfect_q2_adt<span class="sc">$</span>posthoc)</span>
<span id="cb53-2219"><a href="#cb53-2219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2220"><a href="#cb53-2220" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-2221"><a href="#cb53-2221" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-2222"><a href="#cb53-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2223"><a href="#cb53-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2224"><a href="#cb53-2224" aria-hidden="true" tabindex="-1"></a>Now we can plot the results from the posthoc analyses for each metric and data set using the function <span class="in">`div_test_plot_jjs`</span>. I modified the original function (<span class="in">`div_test_plot`</span>) to control a little of the formatting.</span>
<span id="cb53-2225"><a href="#cb53-2225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2226"><a href="#cb53-2226" aria-hidden="true" tabindex="-1"></a>The command is as follows:</span>
<span id="cb53-2227"><a href="#cb53-2227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2228"><a href="#cb53-2228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2229"><a href="#cb53-2229" aria-hidden="true" tabindex="-1"></a><span class="in">div_test_plot(divtest = x, chart = "type", colour = col.pal, </span></span>
<span id="cb53-2230"><a href="#cb53-2230" aria-hidden="true" tabindex="-1"></a><span class="in">              posthoc = TRUE, threshold = value))</span></span>
<span id="cb53-2231"><a href="#cb53-2231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2232"><a href="#cb53-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2233"><a href="#cb53-2233" aria-hidden="true" tabindex="-1"></a>where <span class="in">`x`</span> is the results from the <span class="in">`div_test`</span> function, <span class="in">`"type"`</span> is chart type (box, jitter, or violin), <span class="in">`colour`</span> is is a color palette, <span class="in">`posthoc`</span> indicates whether to run posthoc pairwise analyses, and <span class="in">`value`</span> is the maximum p-value to show in pairwise posthoc results. **WARNING** if none of the posthoc results are below the specified threshold, the function will throw an error. Therefore, until this is fixed, all posthoc values are shown.</span>
<span id="cb53-2234"><a href="#cb53-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2237"><a href="#cb53-2237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2238"><a href="#cb53-2238" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb53-2239"><a href="#cb53-2239" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"hack_code/div_test_plot_jjs.R"</span>)</span>
<span id="cb53-2240"><a href="#cb53-2240" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"_adt_plot"</span>))</span>
<span id="cb53-2241"><a href="#cb53-2241" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_adt"</span>)) {</span>
<span id="cb53-2242"><a href="#cb53-2242" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_plot"</span>))</span>
<span id="cb53-2243"><a href="#cb53-2243" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb53-2244"><a href="#cb53-2244" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">div_test_plot_jjs</span>(tmp_get, <span class="at">chart =</span> <span class="st">"box"</span>,</span>
<span id="cb53-2245"><a href="#cb53-2245" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">colour =</span> swel_col, <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-2246"><a href="#cb53-2246" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">ggpar</span>(tmp_df, <span class="at">legend =</span> <span class="st">"none"</span>)</span>
<span id="cb53-2247"><a href="#cb53-2247" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb53-2248"><a href="#cb53-2248" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb53-2249"><a href="#cb53-2249" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-2250"><a href="#cb53-2250" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-2251"><a href="#cb53-2251" aria-hidden="true" tabindex="-1"></a>its18_ps_work_q0_adt_plot</span>
<span id="cb53-2252"><a href="#cb53-2252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2253"><a href="#cb53-2253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2256"><a href="#cb53-2256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2257"><a href="#cb53-2257" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2258"><a href="#cb53-2258" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb53-2259"><a href="#cb53-2259" aria-hidden="true" tabindex="-1"></a>its18_ps_work_q0_adt_plot <span class="ot">&lt;-</span> its18_ps_work_q0_adt_plot <span class="sc">+</span></span>
<span id="cb53-2260"><a href="#cb53-2260" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2261"><a href="#cb53-2261" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvf0_lab) <span class="sc">+</span> </span>
<span id="cb53-2262"><a href="#cb53-2262" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2263"><a href="#cb53-2263" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_q0_adt_plot <span class="ot">&lt;-</span> its18_ps_filt_q0_adt_plot <span class="sc">+</span></span>
<span id="cb53-2264"><a href="#cb53-2264" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-2265"><a href="#cb53-2265" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2266"><a href="#cb53-2266" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvl0_lab) <span class="sc">+</span> </span>
<span id="cb53-2267"><a href="#cb53-2267" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2268"><a href="#cb53-2268" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_q0_adt_plot <span class="ot">&lt;-</span> its18_ps_perfect_q0_adt_plot <span class="sc">+</span></span>
<span id="cb53-2269"><a href="#cb53-2269" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-2270"><a href="#cb53-2270" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2271"><a href="#cb53-2271" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvr0_lab) <span class="sc">+</span> </span>
<span id="cb53-2272"><a href="#cb53-2272" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2273"><a href="#cb53-2273" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_q0_adt_plot <span class="ot">&lt;-</span> its18_ps_pime_q0_adt_plot <span class="sc">+</span></span>
<span id="cb53-2274"><a href="#cb53-2274" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-2275"><a href="#cb53-2275" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2276"><a href="#cb53-2276" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvp0_lab)<span class="sc">+</span> </span>
<span id="cb53-2277"><a href="#cb53-2277" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2278"><a href="#cb53-2278" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb53-2279"><a href="#cb53-2279" aria-hidden="true" tabindex="-1"></a>its18_ps_work_q1_adt_plot <span class="ot">&lt;-</span> its18_ps_work_q1_adt_plot <span class="sc">+</span></span>
<span id="cb53-2280"><a href="#cb53-2280" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2281"><a href="#cb53-2281" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvf1_lab)<span class="sc">+</span> </span>
<span id="cb53-2282"><a href="#cb53-2282" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2283"><a href="#cb53-2283" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_q1_adt_plot <span class="ot">&lt;-</span> its18_ps_filt_q1_adt_plot <span class="sc">+</span></span>
<span id="cb53-2284"><a href="#cb53-2284" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-2285"><a href="#cb53-2285" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2286"><a href="#cb53-2286" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvl1_lab) <span class="sc">+</span> </span>
<span id="cb53-2287"><a href="#cb53-2287" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2288"><a href="#cb53-2288" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_q1_adt_plot <span class="ot">&lt;-</span> its18_ps_perfect_q1_adt_plot <span class="sc">+</span></span>
<span id="cb53-2289"><a href="#cb53-2289" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-2290"><a href="#cb53-2290" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2291"><a href="#cb53-2291" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvr1_lab) <span class="sc">+</span> </span>
<span id="cb53-2292"><a href="#cb53-2292" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2293"><a href="#cb53-2293" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_q1_adt_plot <span class="ot">&lt;-</span> its18_ps_pime_q1_adt_plot <span class="sc">+</span></span>
<span id="cb53-2294"><a href="#cb53-2294" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-2295"><a href="#cb53-2295" aria-hidden="true" tabindex="-1"></a>                             <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2296"><a href="#cb53-2296" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvp1_lab) <span class="sc">+</span> </span>
<span id="cb53-2297"><a href="#cb53-2297" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2298"><a href="#cb53-2298" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb53-2299"><a href="#cb53-2299" aria-hidden="true" tabindex="-1"></a>its18_ps_work_q2_adt_plot <span class="ot">&lt;-</span> its18_ps_work_q2_adt_plot <span class="sc">+</span></span>
<span id="cb53-2300"><a href="#cb53-2300" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvf2_lab) <span class="sc">+</span> </span>
<span id="cb53-2301"><a href="#cb53-2301" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2302"><a href="#cb53-2302" aria-hidden="true" tabindex="-1"></a>its18_ps_filt_q2_adt_plot <span class="ot">&lt;-</span> its18_ps_filt_q2_adt_plot <span class="sc">+</span></span>
<span id="cb53-2303"><a href="#cb53-2303" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2304"><a href="#cb53-2304" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvl2_lab) <span class="sc">+</span> </span>
<span id="cb53-2305"><a href="#cb53-2305" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2306"><a href="#cb53-2306" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect_q2_adt_plot <span class="ot">&lt;-</span> its18_ps_perfect_q2_adt_plot <span class="sc">+</span></span>
<span id="cb53-2307"><a href="#cb53-2307" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2308"><a href="#cb53-2308" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvr2_lab) <span class="sc">+</span> </span>
<span id="cb53-2309"><a href="#cb53-2309" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2310"><a href="#cb53-2310" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_q2_adt_plot <span class="ot">&lt;-</span> its18_ps_pime_q2_adt_plot <span class="sc">+</span></span>
<span id="cb53-2311"><a href="#cb53-2311" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-2312"><a href="#cb53-2312" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(its18_asvp2_lab) <span class="sc">+</span> </span>
<span id="cb53-2313"><a href="#cb53-2313" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb53-2314"><a href="#cb53-2314" aria-hidden="true" tabindex="-1"></a>its18_alph_div_plots_asv <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb53-2315"><a href="#cb53-2315" aria-hidden="true" tabindex="-1"></a>  its18_ps_work_q0_adt_plot, </span>
<span id="cb53-2316"><a href="#cb53-2316" aria-hidden="true" tabindex="-1"></a>  its18_ps_filt_q0_adt_plot,   </span>
<span id="cb53-2317"><a href="#cb53-2317" aria-hidden="true" tabindex="-1"></a>  its18_ps_perfect_q0_adt_plot, </span>
<span id="cb53-2318"><a href="#cb53-2318" aria-hidden="true" tabindex="-1"></a>  its18_ps_pime_q0_adt_plot, </span>
<span id="cb53-2319"><a href="#cb53-2319" aria-hidden="true" tabindex="-1"></a>  its18_ps_work_q1_adt_plot, </span>
<span id="cb53-2320"><a href="#cb53-2320" aria-hidden="true" tabindex="-1"></a>  its18_ps_filt_q1_adt_plot, </span>
<span id="cb53-2321"><a href="#cb53-2321" aria-hidden="true" tabindex="-1"></a>  its18_ps_perfect_q1_adt_plot, </span>
<span id="cb53-2322"><a href="#cb53-2322" aria-hidden="true" tabindex="-1"></a>  its18_ps_pime_q1_adt_plot, </span>
<span id="cb53-2323"><a href="#cb53-2323" aria-hidden="true" tabindex="-1"></a>  its18_ps_work_q2_adt_plot, </span>
<span id="cb53-2324"><a href="#cb53-2324" aria-hidden="true" tabindex="-1"></a>  its18_ps_filt_q2_adt_plot, </span>
<span id="cb53-2325"><a href="#cb53-2325" aria-hidden="true" tabindex="-1"></a>  its18_ps_perfect_q2_adt_plot, </span>
<span id="cb53-2326"><a href="#cb53-2326" aria-hidden="true" tabindex="-1"></a>  its18_ps_pime_q2_adt_plot, </span>
<span id="cb53-2327"><a href="#cb53-2327" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span><span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb53-2328"><a href="#cb53-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2329"><a href="#cb53-2329" aria-hidden="true" tabindex="-1"></a>its18_alph_div_plots_asv</span>
<span id="cb53-2330"><a href="#cb53-2330" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-2331"><a href="#cb53-2331" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"files/alpha/figures/its18_alph_div_plots_asv.png"</span>,</span>
<span id="cb53-2332"><a href="#cb53-2332" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">32</span>, <span class="at">width=</span><span class="dv">60</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>)</span>
<span id="cb53-2333"><a href="#cb53-2333" aria-hidden="true" tabindex="-1"></a>its18_alph_div_plots_asv</span>
<span id="cb53-2334"><a href="#cb53-2334" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-2335"><a href="#cb53-2335" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">"files/alpha/figures/its18_alph_div_plots_asv.pdf"</span>,</span>
<span id="cb53-2336"><a href="#cb53-2336" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="dv">11</span>)</span>
<span id="cb53-2337"><a href="#cb53-2337" aria-hidden="true" tabindex="-1"></a>its18_alph_div_plots_asv</span>
<span id="cb53-2338"><a href="#cb53-2338" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb53-2339"><a href="#cb53-2339" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">"cp files/alpha/figures/its18_alph_div_plots_asv.png include/alpha/its18_alph_div_plots_asv.png"</span>)</span>
<span id="cb53-2340"><a href="#cb53-2340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2341"><a href="#cb53-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2342"><a href="#cb53-2342" aria-hidden="true" tabindex="-1"></a><span class="fu">## Alpha Diversity Plots</span></span>
<span id="cb53-2343"><a href="#cb53-2343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2344"><a href="#cb53-2344" aria-hidden="true" tabindex="-1"></a>Posthoc adjusted p-values given for each pairwise comparison.</span>
<span id="cb53-2345"><a href="#cb53-2345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2348"><a href="#cb53-2348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2349"><a href="#cb53-2349" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2350"><a href="#cb53-2350" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2351"><a href="#cb53-2351" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb53-2352"><a href="#cb53-2352" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb53-2353"><a href="#cb53-2353" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: body-outset</span></span>
<span id="cb53-2354"><a href="#cb53-2354" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"include/alpha/its18_alph_div_plots_asv.png"</span>)</span>
<span id="cb53-2355"><a href="#cb53-2355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2356"><a href="#cb53-2356" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_alpha_div_plots")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb53-2357"><a href="#cb53-2357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2360"><a href="#cb53-2360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2361"><a href="#cb53-2361" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2362"><a href="#cb53-2362" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"page_build/alpha_wf.rdata"</span>)</span>
<span id="cb53-2363"><a href="#cb53-2363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2364"><a href="#cb53-2364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2367"><a href="#cb53-2367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2368"><a href="#cb53-2368" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2369"><a href="#cb53-2369" aria-hidden="true" tabindex="-1"></a>samp_ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>, <span class="st">"its18_ps_pime"</span>, <span class="st">"its18_ps_perfect"</span>)</span>
<span id="cb53-2370"><a href="#cb53-2370" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps) {</span>
<span id="cb53-2371"><a href="#cb53-2371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">paste</span>(<span class="st">"files/alpha/figures/its/"</span>, i, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-2372"><a href="#cb53-2372" aria-hidden="true" tabindex="-1"></a>  tmp_get_q0 <span class="ot">&lt;-</span> <span class="fu">get</span>(<span class="fu">paste0</span>(i, <span class="st">"_q0_adt_plot"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-2373"><a href="#cb53-2373" aria-hidden="true" tabindex="-1"></a>  tmp_get_q1 <span class="ot">&lt;-</span> <span class="fu">get</span>(<span class="fu">paste0</span>(i, <span class="st">"_q1_adt_plot"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-2374"><a href="#cb53-2374" aria-hidden="true" tabindex="-1"></a>  tmp_get_q2 <span class="ot">&lt;-</span> <span class="fu">get</span>(<span class="fu">paste0</span>(i, <span class="st">"_q2_adt_plot"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb53-2375"><a href="#cb53-2375" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-2376"><a href="#cb53-2376" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q0, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/its/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q0_adt_plot"</span>, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-2377"><a href="#cb53-2377" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q0, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/its/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q0_adt_plot"</span>, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-2378"><a href="#cb53-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2379"><a href="#cb53-2379" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q1, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/its/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q1_adt_plot"</span>, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-2380"><a href="#cb53-2380" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q1, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/its/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q1_adt_plot"</span>, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-2381"><a href="#cb53-2381" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-2382"><a href="#cb53-2382" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q2, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/its/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q2_adt_plot"</span>, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-2383"><a href="#cb53-2383" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(tmp_get_q2, <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"files/alpha/figures/its/"</span>, i, <span class="st">"/"</span>, i, <span class="st">"_q2_adt_plot"</span>, <span class="st">".pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span>
<span id="cb53-2384"><a href="#cb53-2384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb53-2385"><a href="#cb53-2385" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb53-2386"><a href="#cb53-2386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2387"><a href="#cb53-2387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2390"><a href="#cb53-2390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2391"><a href="#cb53-2391" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-2392"><a href="#cb53-2392" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2393"><a href="#cb53-2393" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb53-2394"><a href="#cb53-2394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2395"><a href="#cb53-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2396"><a href="#cb53-2396" aria-hidden="true" tabindex="-1"></a><span class="fu"># Workflow Output </span></span>
<span id="cb53-2397"><a href="#cb53-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2398"><a href="#cb53-2398" aria-hidden="true" tabindex="-1"></a>Data products generated in this workflow can be downloaded from figshare.</span>
<span id="cb53-2399"><a href="#cb53-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2400"><a href="#cb53-2400" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://widgets.figshare.com/articles/16826779/embed?show_title=1"</span> <span class="er">width</span><span class="ot">=</span><span class="st">"100%"</span> <span class="er">height</span><span class="ot">=</span><span class="st">"251"</span> <span class="er">allowfullscreen</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">"0"</span><span class="kw">&gt;&lt;/iframe&gt;</span></span>
<span id="cb53-2401"><a href="#cb53-2401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2402"><a href="#cb53-2402" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/br&gt;</span></span>
<span id="cb53-2403"><a href="#cb53-2403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2404"><a href="#cb53-2404" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"beta.html"</span> <span class="er">class</span><span class="ot">=</span><span class="st">"btnnav button_round"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"float: right;"</span><span class="kw">&gt;</span>Next workflow:</span>
<span id="cb53-2405"><a href="#cb53-2405" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span> 6. Beta Diversity &amp; Dispersion Estimates<span class="kw">&lt;/a&gt;</span></span>
<span id="cb53-2406"><a href="#cb53-2406" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"taxa.html"</span> <span class="er">class</span><span class="ot">=</span><span class="st">"btnnav button_round"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"float: left;"</span><span class="kw">&gt;</span>Previous workflow:</span>
<span id="cb53-2407"><a href="#cb53-2407" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span> 4. Taxonomic Diversity<span class="kw">&lt;/a&gt;&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb53-2408"><a href="#cb53-2408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2411"><a href="#cb53-2411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2412"><a href="#cb53-2412" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb53-2413"><a href="#cb53-2413" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb53-2414"><a href="#cb53-2414" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2415"><a href="#cb53-2415" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2416"><a href="#cb53-2416" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb53-2417"><a href="#cb53-2417" aria-hidden="true" tabindex="-1"></a><span class="do">### COmmon formatting scripts</span></span>
<span id="cb53-2418"><a href="#cb53-2418" aria-hidden="true" tabindex="-1"></a><span class="do">### </span><span class="al">NOTE</span><span class="do">: captioner.R must be read BEFORE captions_XYZ.R</span></span>
<span id="cb53-2419"><a href="#cb53-2419" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">file.path</span>(<span class="st">"assets"</span>, <span class="st">"functions.R"</span>))</span>
<span id="cb53-2420"><a href="#cb53-2420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-2421"><a href="#cb53-2421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2422"><a href="#cb53-2422" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Source Code {.appendix}</span></span>
<span id="cb53-2423"><a href="#cb53-2423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2424"><a href="#cb53-2424" aria-hidden="true" tabindex="-1"></a>The source code for this page can be accessed on GitHub <span class="in">`r fa(name = "github")`</span> by <span class="co">[</span><span class="ot">clicking this link</span><span class="co">]</span>(<span class="in">`r source_code()`</span>). </span>
<span id="cb53-2425"><a href="#cb53-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2426"><a href="#cb53-2426" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data Availability {.appendix}</span></span>
<span id="cb53-2427"><a href="#cb53-2427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2428"><a href="#cb53-2428" aria-hidden="true" tabindex="-1"></a>Data generated in this workflow and the Rdata need to run the workflow can be accessed on figshare at <span class="co">[</span><span class="ot">10.25573/data.16826779</span><span class="co">](https://doi.org/10.25573/data.16826779)</span>.</span>
<span id="cb53-2429"><a href="#cb53-2429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2430"><a href="#cb53-2430" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Last updated on {.appendix}</span></span>
<span id="cb53-2431"><a href="#cb53-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2434"><a href="#cb53-2434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2435"><a href="#cb53-2435" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-2436"><a href="#cb53-2436" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb53-2437"><a href="#cb53-2437" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span>
<span id="cb53-2438"><a href="#cb53-2438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">© Copyright 2022 <a href="https://metacrobe.github.io/">metacrobe</a> &amp; The SWELTR Project. Site constructed using <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>