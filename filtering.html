<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.514">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Reproducible workflow for Arbitrary, PERfect, &amp; PIME filtering of community data.">
<title>- 3. Filtering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./taxa.html" rel="next">
<link href="./data-prep.html" rel="prev">
<link href="./assets/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>
    .quarto-title-block .quarto-title-banner {
      background: #FFFFFF;
    }
    </style>
<script src="site_libs/font-awesome-5.13.0/js/script.js"></script><script src="site_libs/core-js-2.5.3/shim.min.js"></script><script src="site_libs/react-17.0.0/react.min.js"></script><script src="site_libs/react-17.0.0/react-dom.min.js"></script><script src="site_libs/reactwidget-1.0.0/react-tools.js"></script><script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="site_libs/reactable-binding-0.2.3.9000/reactable.js"></script><link rel="stylesheet" href="assets/styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <img src="./assets/icon.png" alt=""></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item compact">
    <a class="nav-link" href="./index.html"><i class="bi bi-home" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-a.-processing" role="button" data-bs-toggle="dropdown" aria-expanded="false">A. Processing</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-a.-processing">
<li class="dropdown-header">Workflows</li>
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="./dada2.html">
 <span class="dropdown-text">1. DADA2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./data-prep.html">
 <span class="dropdown-text">2. Data Set Prep</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./filtering.html">
 <span class="dropdown-text">3. Filtering</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-b.-diversity" role="button" data-bs-toggle="dropdown" aria-expanded="false">B. Diversity</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-b.-diversity">
<li class="dropdown-header">Workflows</li>
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="./taxa.html">
 <span class="dropdown-text">4. Taxonomic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./alpha.html">
 <span class="dropdown-text">5. Alpha Diversity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./beta.html">
 <span class="dropdown-text">6. Beta Diversity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./da.html">
 <span class="dropdown-text">7. DA ASVs &amp; Taxa</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./metadata.html">
 <span class="dropdown-text">8. Metadata</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link active" href="./data-availability.html" aria-current="page">DATA</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./som.html">SOM</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sweltr/high-temp/"><i class="bi bi-github" role="img" aria-label="Agua Salud GitHub">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="./about.html"><i class="bi bi-question" role="img">
</i> 
 </a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">3. Filtering</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">3. Filtering</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
                  <div>
        <div class="description">
          <p>Reproducible workflow for Arbitrary, PERfect, &amp; PIME filtering of community data.</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">A. Processing</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dada2.html" class="sidebar-item-text sidebar-link">1. DADA2 Workflow</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-prep.html" class="sidebar-item-text sidebar-link">2. Data Set Preparation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./filtering.html" class="sidebar-item-text sidebar-link active">3. Filtering</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">B. Diversity</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./taxa.html" class="sidebar-item-text sidebar-link">4. Taxonomic Diversity</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./alpha.html" class="sidebar-item-text sidebar-link">5. Alpha Diversity Estimates</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./beta.html" class="sidebar-item-text sidebar-link">6. Beta Diversity &amp; Dispersion Estimates</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./da.html" class="sidebar-item-text sidebar-link">7. Differentially Abundant ASVs &amp; Taxa</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metadata.html" class="sidebar-item-text sidebar-link">8. Metadata Analysis</a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">More</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-availability.html" class="sidebar-item-text sidebar-link">Data Availability</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./som.html" class="sidebar-item-text sidebar-link">Electronic Supplementary Material</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">Website Contruction</a>
  </div>
</li>
    </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#workflow-input" id="toc-workflow-input" class="nav-link active" data-scroll-target="#workflow-input">Workflow Input</a></li>
  <li>
<a href="#filtering-results" id="toc-filtering-results" class="nav-link" data-scroll-target="#filtering-results">Filtering Results</a>
  <ul class="collapse">
<li><a href="#s-rrna" id="toc-s-rrna" class="nav-link" data-scroll-target="#s-rrna">16S rRNA</a></li>
  <li><a href="#its" id="toc-its" class="nav-link" data-scroll-target="#its">ITS</a></li>
  </ul>
</li>
  <li>
<a href="#a.-arbitrary-filtering" id="toc-a.-arbitrary-filtering" class="nav-link" data-scroll-target="#a.-arbitrary-filtering">A. Arbitrary Filtering</a>
  <ul class="collapse">
<li><a href="#s-rrna-1" id="toc-s-rrna-1" class="nav-link" data-scroll-target="#s-rrna-1">16S rRNA</a></li>
  <li><a href="#its-1" id="toc-its-1" class="nav-link" data-scroll-target="#its-1">ITS</a></li>
  </ul>
</li>
  <li>
<a href="#b.-perfect-filtering" id="toc-b.-perfect-filtering" class="nav-link" data-scroll-target="#b.-perfect-filtering">B. PERfect Filtering</a>
  <ul class="collapse">
<li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter">Filter</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
</li>
  <li>
<a href="#c.-pime-filtering" id="toc-c.-pime-filtering" class="nav-link" data-scroll-target="#c.-pime-filtering">C. PIME Filtering</a>
  <ul class="collapse">
<li>
<a href="#s-rrna-2" id="toc-s-rrna-2" class="nav-link" data-scroll-target="#s-rrna-2">16S rRNA</a>
  <ul class="collapse">
<li><a href="#setup-1" id="toc-setup-1" class="nav-link" data-scroll-target="#setup-1">Setup</a></li>
  <li><a href="#split-by-predictor-variable" id="toc-split-by-predictor-variable" class="nav-link" data-scroll-target="#split-by-predictor-variable">Split by Predictor Variable</a></li>
  <li><a href="#calculate-prevalence-intervals" id="toc-calculate-prevalence-intervals" class="nav-link" data-scroll-target="#calculate-prevalence-intervals">Calculate Prevalence Intervals</a></li>
  <li><a href="#calculate-best-prevalence" id="toc-calculate-best-prevalence" class="nav-link" data-scroll-target="#calculate-best-prevalence">Calculate Best Prevalence</a></li>
  <li><a href="#best-prevalence-summary" id="toc-best-prevalence-summary" class="nav-link" data-scroll-target="#best-prevalence-summary">Best Prevalence Summary</a></li>
  <li><a href="#estimate-error-in-prediction" id="toc-estimate-error-in-prediction" class="nav-link" data-scroll-target="#estimate-error-in-prediction">Estimate Error in Prediction</a></li>
  <li><a href="#save-phyloseq-pime-objects" id="toc-save-phyloseq-pime-objects" class="nav-link" data-scroll-target="#save-phyloseq-pime-objects">Save Phyloseq PIME objects</a></li>
  <li><a href="#split-save-by-predictor-variable" id="toc-split-save-by-predictor-variable" class="nav-link" data-scroll-target="#split-save-by-predictor-variable">Split &amp; save by predictor variable</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">Summary</a></li>
  </ul>
</li>
  <li>
<a href="#its-2" id="toc-its-2" class="nav-link" data-scroll-target="#its-2">ITS</a>
  <ul class="collapse">
<li><a href="#setup-2" id="toc-setup-2" class="nav-link" data-scroll-target="#setup-2">Setup</a></li>
  <li><a href="#split-by-predictor-variable-1" id="toc-split-by-predictor-variable-1" class="nav-link" data-scroll-target="#split-by-predictor-variable-1">Split by Predictor Variable</a></li>
  <li><a href="#calculate-prevalence-intervals-1" id="toc-calculate-prevalence-intervals-1" class="nav-link" data-scroll-target="#calculate-prevalence-intervals-1">Calculate Prevalence Intervals</a></li>
  <li><a href="#calculate-best-prevalence-1" id="toc-calculate-best-prevalence-1" class="nav-link" data-scroll-target="#calculate-best-prevalence-1">Calculate Best Prevalence</a></li>
  <li><a href="#best-prevalence-summary-1" id="toc-best-prevalence-summary-1" class="nav-link" data-scroll-target="#best-prevalence-summary-1">Best Prevalence Summary</a></li>
  <li><a href="#estimate-error-in-prediction-1" id="toc-estimate-error-in-prediction-1" class="nav-link" data-scroll-target="#estimate-error-in-prediction-1">Estimate Error in Prediction</a></li>
  <li><a href="#save-phyloseq-pime-objects-1" id="toc-save-phyloseq-pime-objects-1" class="nav-link" data-scroll-target="#save-phyloseq-pime-objects-1">Save Phyloseq PIME objects</a></li>
  <li><a href="#split-save-by-predictor-variable-1" id="toc-split-save-by-predictor-variable-1" class="nav-link" data-scroll-target="#split-save-by-predictor-variable-1">Split &amp; save by predictor variable</a></li>
  <li><a href="#summary-2" id="toc-summary-2" class="nav-link" data-scroll-target="#summary-2">Summary</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#workflow-output" id="toc-workflow-output" class="nav-link" data-scroll-target="#workflow-output">Workflow Output</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/sweltr/high-temp/edit/main/filtering.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/sweltr/high-temp/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><details><summary><strong>Click here</strong> for setup information.
</summary><div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">remove</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span>, eval <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">119</span><span class="op">)</span>

<span class="co">#library(conflicted)</span>
<span class="co">#pacman::p_depends(PERFect, local = TRUE)  </span>
<span class="co">#pacman::p_depends_reverse(PERFect, local = TRUE)  </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217">phyloseq</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"phyloseq"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biostrings">Biostrings</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"Biostrings"</span><span class="op">)</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">patchwork</span>, 
               <span class="va">agricolae</span>, <span class="va">labdsv</span>, <span class="va">naniar</span>, <span class="va">PERFect</span>, <span class="va">pime</span>, <span class="va">ape</span>, <span class="va">gdata</span>,
               <span class="va">pairwiseAdonis</span>, <span class="va">microbiome</span>, <span class="va">seqRFLP</span>, <span class="va">microbiomeMarker</span>, 
               <span class="va">reactable</span>, <span class="va">downloadthis</span>, <span class="va">captioner</span>, <span class="va">jamba</span>, 
               install <span class="op">=</span> <span class="cn">FALSE</span>, update <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_current</a></span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span>
  <span class="st">"cache"</span>,
  <span class="st">"cache.path"</span>,
  <span class="st">"cache.rebuild"</span>,
  <span class="st">"dependson"</span>,
  <span class="st">"autodep"</span>
<span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"assets"</span>, <span class="st">"functions.R"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details><div class="cell">

</div>
<p>In <a href="#a.-arbitrary-filtering">Part A</a>, we apply arbitrary filtering to the 16S rRNA and ITS data sets. In <a href="#b.-perfect-filtering">Part B</a> we use PERFect <a href="https://github.com/katiasmirn/PERFect">(PERmutation Filtering test for microbiome data)</a> <span class="citation" data-cites="smirnova2019perfect">(<a href="#ref-smirnova2019perfect" role="doc-biblioref">Smirnova, Huzurbazar, and Jafari 2019</a>)</span> to filter the data sets. And in <a href="#c.-pime-filtering">Part C</a> of this workflow, we use PIME <a href="https://github.com/microEcology/pime">(Prevalence Interval for Microbiome Evaluation)</a> <span class="citation" data-cites="roesch2020pime">(<a href="#ref-roesch2020pime" role="doc-biblioref">Roesch et al. 2020</a>)</span> to filter the FULL 16S rRNA and ITS data sets.</p>
<section id="workflow-input" class="level2"><h2 class="anchored" data-anchor-id="workflow-input">Workflow Input</h2>
<p>Files needed to run this workflow can be downloaded from figshare.</p>
<iframe src="https://widgets.figshare.com/articles/14690739/embed?show_title=1" width="100%" height="301" allowfullscreen="" frameborder="0">
</iframe>
</section><section id="filtering-results" class="level1"><h1>Filtering Results</h1>
<p>We begin by summarizing the results of each filtering method on the 16S and ITS data sets. Below you can find the complete workflow for each filtering method.</p>
<section id="s-rrna" class="level2"><h2 class="anchored" data-anchor-id="s-rrna">16S rRNA</h2>
<p><small><strong>(16S rRNA) Table 1 | Summary of Arbitrary, PERfect, and PIME filtering.</strong></small></p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,TWV0cmljLEZ1bGwgZGF0YSxBcmJpdHJhcnksUEVSZmVjdCxQSU1FClRvdGFsIG51bWJlciBvZiByZWFkcyw5MzY2NDAsNzI5OTczLDczMTUwOCwyMzI1MzIKTWluLiBudW1iZXIgb2YgcmVhZHMsMjUwODgsMTU5MjEsMTY2OTcsMTA1ODUKTWF4LiBudW1iZXIgb2YgcmVhZHMsODY2MDAsNjM3NzEsNzEwMjYsMTgzNjAKQXZlcmFnZSBudW1iZXIgb2YgcmVhZHMsNjI0NDMsNDg2NjUsNDg3NjcsMTU1MDIKTWVkaWFuIG51bWJlciBvZiByZWFkcyw2MjExNyw1MDkzOCw1MDI0MSwxNTc4MApUb3RhbCBBU1ZzLDIwMTczLDE4MjIsMTY1OSwxMDU4Ck1pbi4gbnVtYmVyIG9mIEFTVnMsODEzLDM3NiwzMzIsMTcwCk1heC4gbnVtYmVyIG9mIEFTVnMsMzA2NSwxMDExLDg1Nyw2NjQKQXZlcmFnZSBudW1iZXIgb2YgQVNWcywyMDYzLDczOSw2NDUsNDU4Ck1lZGlhbiBudW1iZXIgb2YgQVNWcywyMTI0LDgwMiw2NzEsNTAyCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_all_filt_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-9450f0e2eaa9c45ce7bf" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9450f0e2eaa9c45ce7bf">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Metric":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"Full data":[936640,25088,86600,62443,62117,20173,813,3065,2063,2124],"Arbitrary":[729973,15921,63771,48665,50938,1822,376,1011,739,802],"PERfect":[731508,16697,71026,48767,50241,1659,332,857,645,671],"PIME":[232532,10585,18360,15502,15780,1058,170,664,458,502]},"columns":[{"accessor":"Metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"header":"Metric","minWidth":200,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Full data","name":"Full data","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["936640","25088","86600","62443","62117","20173","813","3065","2063","2124"],"header":"Full data","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Arbitrary","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["729973","15921","63771","48665","50938","1822","376","1011","739","802"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PERfect","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["731508","16697","71026","48767","50241","1659","332","857","645","671"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PIME","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["232532","10585","18360","15502","15780","1058","170","664","458","502"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[5,10,10],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"0de2cfd5193efecdf42b8722bcf55252"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 2 | Sample summary showing the number of reads and ASVs after Arbitrary, PERfect, and PIME filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELHRvdGFsX3JlYWRzLngsdG90YWxfcmVhZHMueSx0b3RhbF9yZWFkcy54LngsdG90YWxfcmVhZHMueS55LHRvdGFsX2FzdnMueCx0b3RhbF9hc3ZzLnksdG90YWxfYXN2cy54LngsdG90YWxfYXN2cy55LnkKUDAxX0QwMF8wMTBfVzNBLDY3OTAyLDUzODI0LDUyOTgwLDE1NjM2LDIzNzEsODMxLDcwNyw1MDIKUDAxX0QwMF8wMTBfVzhBLDYwNTA5LDUyMDEyLDUyMzI3LDE2OTUyLDE2MTAsNjIwLDU2MywzMjIKUDAyX0QwMF8wMTBfQzBBLDcwNDEyLDU3NjAzLDU2NjE5LDE3MTkwLDIyNzIsODg0LDczNyw1OTAKUDAzX0QwMF8wMTBfVzNCLDc1MTIzLDYxNzI3LDYwMzY2LDE3NDkyLDIzNTYsOTIyLDc2NCw1OTYKUDAzX0QwMF8wMTBfVzhCLDUzMzQ3LDM0MTM1LDM1NjA0LDExNzM3LDE1NzUsNDIyLDQxMSwyMjQKUDA0X0QwMF8wMTBfQzBCLDUzNzcwLDQzMDI2LDQxNjI0LDE3MDc0LDIwNDAsODAyLDY2Myw1NzAKUDA1X0QwMF8wMTBfVzNDLDQ3MDIzLDM4ODU3LDM3ODc3LDE4MzYwLDE2NjMsNjgwLDU3NCw0OTkKUDA1X0QwMF8wMTBfVzhDLDg2NjAwLDYzNzcxLDcxMDI2LDE0OTY1LDIxMjQsNTcyLDY2MSwyODkKUDA2X0QwMF8wMTBfQzBDLDgxMTUwLDYxMzkzLDYxMjc3LDE1NDI2LDMwNjUsMTAxMSw4NTcsNjY0ClAwN19EMDBfMDEwX1czRCw2MTYzMiw1MDkzOCw0OTg3NywxNjc5MSwyMDEwLDg0Myw3MjUsNTE2ClAwN19EMDBfMDEwX1c4RCw2MjExNyw1MDE4MCw1MDI0MSwxMjcyMiwyMTU3LDc3MSw2NzEsMjc2ClAwOF9EMDBfMDEwX0MwRCw2MjEzNiw0NjMyOCw0NTYzMywxNTc4MCwyNDQxLDgxMyw2ODEsNTk0ClAwOV9EMDBfMDEwX1czRSw3NjIzMSw2MTIwMyw2MTAzMywxNjY5NywyMzg2LDg3NCw3NTEsNTYzClAwOV9EMDBfMDEwX1c4RSwyNTA4OCwxNTkyMSwxNjY5NywxMDU4NSw4MTMsMzc2LDMzMiwxNzAKUDEwX0QwMF8wMTBfQzBFLDUzNjAwLDM5MDU1LDM4MzI3LDE1MTI1LDIwNjYsNjcwLDU3MSw0OTEK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_all_filt_samp_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-b9188a0b80be14a520b6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b9188a0b80be14a520b6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"total_reads.x":[67902,60509,70412,75123,53347,53770,47023,86600,81150,61632,62117,62136,76231,25088,53600],"total_reads.y":[53824,52012,57603,61727,34135,43026,38857,63771,61393,50938,50180,46328,61203,15921,39055],"total_reads.x.x":[52980,52327,56619,60366,35604,41624,37877,71026,61277,49877,50241,45633,61033,16697,38327],"total_reads.y.y":[15636,16952,17190,17492,11737,17074,18360,14965,15426,16791,12722,15780,16697,10585,15125],"total_asvs.x":[2371,1610,2272,2356,1575,2040,1663,2124,3065,2010,2157,2441,2386,813,2066],"total_asvs.y":[831,620,884,922,422,802,680,572,1011,843,771,813,874,376,670],"total_asvs.x.x":[707,563,737,764,411,663,574,661,857,725,671,681,751,332,571],"total_asvs.y.y":[502,322,590,596,224,570,499,289,664,516,276,594,563,170,491]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"total_reads.x","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["67902","60509","70412","75123","53347","53770","47023","86600","81150","61632","62117","62136","76231","25088","53600"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads.y","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["53824","52012","57603","61727","34135","43026","38857","63771","61393","50938","50180","46328","61203","15921","39055"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads.x.x","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["52980","52327","56619","60366","35604","41624","37877","71026","61277","49877","50241","45633","61033","16697","38327"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads.y.y","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["15636","16952","17190","17492","11737","17074","18360","14965","15426","16791","12722","15780","16697","10585","15125"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"},"style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"total_asvs.x","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["2371","1610","2272","2356","1575","2040","1663","2124","3065","2010","2157","2441","2386","813","2066"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs.y","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["831","620","884","922","422","802","680","572","1011","843","771","813","874","376","670"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs.x.x","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["707","563","737","764","411","663","574","661","857","725","671","681","751","332","571"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs.y.y","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["502","322","590","596","224","570","499","289","664","516","276","594","563","170","491"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"columnGroups":[{"name":"Total Reads","headerStyle":{"borderRight":"5px solid #eee","fontSize":"1.5em"},"columns":["total_reads.x","total_reads.y","total_reads.x.x","total_reads.y.y"]},{"name":"Total ASVs","headerStyle":{"fontSize":"1.5em"},"columns":["total_asvs.x","total_asvs.y","total_asvs.x.x","total_asvs.y.y"]}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,15],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"a9a9f8d99d51d5bdec73e09013c50841"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="its" class="level2"><h2 class="anchored" data-anchor-id="its">ITS</h2>
<p><small><strong>(ITS) Table 1 | Summary of Arbitrary, PERfect, and PIME filtering.</strong></small></p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,TWV0cmljLEZ1bGwgZGF0YSxBcmJpdHJhcnksUEVSZmVjdCxQSU1FClRvdGFsIG51bWJlciBvZiByZWFkcyw0OTA3NjcsMzg1NjQzLDM2MTM5OSw2NzY2NQpNaW4uIG51bWJlciBvZiByZWFkcyw5MTcyLDg2OTIsNzI4NiwzNDQyCk1heC4gbnVtYmVyIG9mIHJlYWRzLDY0NjM2LDU4MzYwLDU2NzcyLDY3NjEKQXZlcmFnZSBudW1iZXIgb2YgcmVhZHMsMzc3NTEsMjk2NjUsMjc4MDAsNTIwNQpNZWRpYW4gbnVtYmVyIG9mIHJlYWRzLDM4MzcxLDI5MDUyLDI0MzEzLDQ5NjMKVG90YWwgQVNWcywzMzU1LDgxNiwzMDYsNDc0Ck1pbi4gbnVtYmVyIG9mIEFTVnMsMzM1LDIwNCw2NCw5NwpNYXguIG51bWJlciBvZiBBU1ZzLDEwMTcsNDk5LDE2MSwyNDYKQXZlcmFnZSBudW1iZXIgb2YgQVNWcyw3NTcsMzkwLDEyMiwxODEKTWVkaWFuIG51bWJlciBvZiBBU1ZzLDc2NSw0MDQsMTM2LDE5Ngo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_all_filt_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-bc48323e8ced4f91b05c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bc48323e8ced4f91b05c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Metric":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"Full data":[490767,9172,64636,37751,38371,3355,335,1017,757,765],"Arbitrary":[385643,8692,58360,29665,29052,816,204,499,390,404],"PERfect":[361399,7286,56772,27800,24313,306,64,161,122,136],"PIME":[67665,3442,6761,5205,4963,474,97,246,181,196]},"columns":[{"accessor":"Metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"header":"Metric","minWidth":200,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Full data","name":"Full data","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["490767","9172","64636","37751","38371","3355","335","1017","757","765"],"header":"Full data","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Arbitrary","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["385643","8692","58360","29665","29052","816","204","499","390","404"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PERfect","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["361399","7286","56772","27800","24313","306","64","161","122","136"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PIME","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["67665","3442","6761","5205","4963","474","97","246","181","196"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[5,10,10],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"057c25d9197f535a95b5ea71ab25e909"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 2 | Sample summary showing the number of reads and ASVs after Arbitrary, PERfect, and PIME filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELHRvdGFsX3JlYWRzLngsdG90YWxfcmVhZHMueSx0b3RhbF9yZWFkcy54LngsdG90YWxfcmVhZHMueS55LHRvdGFsX2FzdnMueCx0b3RhbF9hc3ZzLnksdG90YWxfYXN2cy54LngsdG90YWxfYXN2cy55LnkKUDAxX0QwMF8wMTBfVzNBLDI5Nzk0LDI2MzAyLDIzNzM3LDY1ODYsOTQ1LDQ5OSwxNDgsMTgxClAwMV9EMDBfMDEwX1c4QSw0MTg4MCwyNzIxOCwyMzg1MCwzNDQyLDcxOSwzNDQsOTgsMTIzClAwMl9EMDBfMDEwX0MwQSw1MTE0NCw0MzEyNywzOTY4OSw1ODE5LDEwMTEsNDk0LDE0NywyMzgKUDAzX0QwMF8wMTBfVzNCLDM4Mzc0LDI5MDUyLDI4MjU2LDQzNTMsNzY1LDQyMywxMzYsMTk2ClAwM19EMDBfMDEwX1c4QiwxNDE4OCwxMDM3Niw4MTM4LDQ5OTEsMzQ5LDIwNCw2NCwxMDkKUDA0X0QwMF8wMTBfQzBCLDU2NTkzLDM4OTM0LDQ3NjU0LDQzODUsMTAxNyw0NzEsMTYxLDIyOQpQMDVfRDAwXzAxMF9XOEMsMzU2MDAsMjIxOTgsMjA4MzEsNDE4MSw2MTYsMjk2LDkwLDEzMQpQMDZfRDAwXzAxMF9DMEMsNDU4NTAsMzY2NTIsMzU5MjMsNjcyNyw5NTQsNDg2LDE1NywyNDYKUDA3X0QwMF8wMTBfVzNELDM2MDYzLDMxMTg0LDI0MzEzLDQ5NjMsODY3LDQ5MiwxNDcsMjA1ClAwN19EMDBfMDEwX1c4RCw5MTcyLDg2OTIsNzI4Niw0MjE1LDMzNSwyMjMsNzYsOTcKUDA4X0QwMF8wMTBfQzBELDM4MzcxLDMxODY3LDI4NDIwLDY3NjEsNzAyLDM0NSwxMDUsMTk4ClAwOV9EMDBfMDEwX1czRSwyOTEwMiwyMTY4MSwxNjUzMCw0OTI1LDc0NSwzOTAsMTE4LDE5NgpQMTBfRDAwXzAxMF9DMEUsNjQ2MzYsNTgzNjAsNTY3NzIsNjMxNyw4MTIsNDA0LDE0MywyMDMK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_all_filt_samp_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-55a05d383c6a99cbe322" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-55a05d383c6a99cbe322">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"total_reads.x":[29794,41880,51144,38374,14188,56593,35600,45850,36063,9172,38371,29102,64636],"total_reads.y":[26302,27218,43127,29052,10376,38934,22198,36652,31184,8692,31867,21681,58360],"total_reads.x.x":[23737,23850,39689,28256,8138,47654,20831,35923,24313,7286,28420,16530,56772],"total_reads.y.y":[6586,3442,5819,4353,4991,4385,4181,6727,4963,4215,6761,4925,6317],"total_asvs.x":[945,719,1011,765,349,1017,616,954,867,335,702,745,812],"total_asvs.y":[499,344,494,423,204,471,296,486,492,223,345,390,404],"total_asvs.x.x":[148,98,147,136,64,161,90,157,147,76,105,118,143],"total_asvs.y.y":[181,123,238,196,109,229,131,246,205,97,198,196,203]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"total_reads.x","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["29794","41880","51144","38374","14188","56593","35600","45850","36063","9172","38371","29102","64636"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads.y","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["26302","27218","43127","29052","10376","38934","22198","36652","31184","8692","31867","21681","58360"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads.x.x","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["23737","23850","39689","28256","8138","47654","20831","35923","24313","7286","28420","16530","56772"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads.y.y","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["6586","3442","5819","4353","4991","4385","4181","6727","4963","4215","6761","4925","6317"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"},"style":{"borderRight":"5px solid #eee"},"headerStyle":{"borderRight":"5px solid #eee"}},{"accessor":"total_asvs.x","name":"FULL","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["945","719","1011","765","349","1017","616","954","867","335","702","745","812"],"header":"FULL","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs.y","name":"Arbitrary","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["499","344","494","423","204","471","296","486","492","223","345","390","404"],"header":"Arbitrary","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs.x.x","name":"PERfect","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["148","98","147","136","64","161","90","157","147","76","105","118","143"],"header":"PERfect","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs.y.y","name":"PIME","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["181","123","238","196","109","229","131","246","205","97","198","196","203"],"header":"PIME","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"columnGroups":[{"name":"Total Reads","headerStyle":{"borderRight":"5px solid #eee","fontSize":"1.5em"},"columns":["total_reads.x","total_reads.y","total_reads.x.x","total_reads.y.y"]},{"name":"Total ASVs","headerStyle":{"fontSize":"1.5em"},"columns":["total_asvs.x","total_asvs.y","total_asvs.x.x","total_asvs.y.y"]}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,13],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"b81425449bc2121cd0243108417812dc"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section id="a.-arbitrary-filtering" class="level1"><h1>A. Arbitrary Filtering</h1>
<p>For low-count arbitrary filtering, we set the minimum read count to <code>5</code> and the prevalence to 20%. Then we apply another filter to remove ASVs with a low variance (<code>0.2</code>).</p>
<section id="s-rrna-1" class="level2"><h2 class="anchored" data-anchor-id="s-rrna-1">16S rRNA</h2>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">tmp_low_count</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/genefilter_sample-methods.html">genefilter_sample</a></span><span class="op">(</span>
                                         <span class="va">ssu18_ps_work</span>, 
                                         <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/filterfun_sample.html">filterfun_sample</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">)</span>, 
                                         A <span class="op">=</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/nsamples-methods.html">nsamples</a></span><span class="op">(</span><span class="va">ssu18_ps_work</span><span class="op">)</span><span class="op">)</span>
<span class="va">tmp_low_count</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/prune_taxa-methods.html">prune_taxa</a></span><span class="op">(</span><span class="va">tmp_low_count</span>, <span class="va">ssu18_ps_work</span><span class="op">)</span>
<span class="va">tmp_low_var</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/filter_taxa.html">filter_taxa</a></span><span class="op">(</span><span class="va">tmp_low_count</span>, 
                                     <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/var.html">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.2</span>, prune <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">ssu18_ps_filt</span> <span class="op">&lt;-</span> <span class="va">tmp_low_var</span>
<span class="va">ssu18_ps_filt</span><span class="op">@</span><span class="va">phy_tree</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="va">tmp_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">ssu18_ps_filt</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>,
                      tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">ssu18_ps_filt</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssu18_ps_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">ssu18_ps_filt</span>,
                          <span class="va">sample_data</span>,
                          <span class="va">tmp_tree</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssu18_ps_filt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here is the filtered 16S rRNA phyloseq object.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1822 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1822 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 1822 tips and 1821 internal nodes ]</code></pre>
</div>
</div>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 3 | Summary of arbitrary filtering where ASVs represented by fewer than 5 reads, present in less than 20% of samples, and/or a variance less than 0.2, were removed.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,TWV0cmljLEZ1bGwgZGF0YSxBcmJpdHJhcnkgZmlsdGVyClRvdGFsIG51bWJlciBvZiByZWFkcyw5MzY2NDAsNzI5OTczCk1pbi4gbnVtYmVyIG9mIHJlYWRzLDI1MDg4LDE1OTIxCk1heC4gbnVtYmVyIG9mIHJlYWRzLDg2NjAwLDYzNzcxCkF2ZXJhZ2UgbnVtYmVyIG9mIHJlYWRzLDYyNDQzLDQ4NjY1Ck1lZGlhbiBudW1iZXIgb2YgcmVhZHMsNjIxMTcsNTA5MzgKVG90YWwgQVNWcywyMDE3MywxODIyCk1pbi4gbnVtYmVyIG9mIEFTVnMsODEzLDM3NgpNYXguIG51bWJlciBvZiBBU1ZzLDMwNjUsMTAxMQpBdmVyYWdlIG51bWJlciBvZiBBU1ZzLDIwNjMsNzM5Ck1lZGlhbiBudW1iZXIgb2YgQVNWcywyMTI0LDgwMgo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_arbitrary_filt_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-a7f9d0ae0dc37a834d81" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a7f9d0ae0dc37a834d81">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Metric":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"Full data":[936640,25088,86600,62443,62117,20173,813,3065,2063,2124],"Arbitrary filter":[729973,15921,63771,48665,50938,1822,376,1011,739,802]},"columns":[{"accessor":"Metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"header":"Metric","minWidth":200,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Full data","name":"Full data","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["936640","25088","86600","62443","62117","20173","813","3065","2063","2124"],"header":"Full data","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Arbitrary filter","name":"Arbitrary filter","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["729973","15921","63771","48665","50938","1822","376","1011","739","802"],"header":"Arbitrary filter","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[5,10,10],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"5a35e7ec6003b0c038897ef2eec7b3d5"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We can look at how filtering affected total reads and ASVs for each sample.</p>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 4 | Sample summary showing the number of reads and ASVs after Arbitrary filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELFBMT1QsVFJFQVQsVEVNUCxQQUlSLHRvdGFsX3JlYWRzLHRvdGFsX2FzdnMKUDAxX0QwMF8wMTBfVzNBLFAwMSxXLDMsQSw1MzgyNCw4MzEKUDAxX0QwMF8wMTBfVzhBLFAwMSxXLDgsQSw1MjAxMiw2MjAKUDAyX0QwMF8wMTBfQzBBLFAwMixDLDAsQSw1NzYwMyw4ODQKUDAzX0QwMF8wMTBfVzNCLFAwMyxXLDMsQiw2MTcyNyw5MjIKUDAzX0QwMF8wMTBfVzhCLFAwMyxXLDgsQiwzNDEzNSw0MjIKUDA0X0QwMF8wMTBfQzBCLFAwNCxDLDAsQiw0MzAyNiw4MDIKUDA1X0QwMF8wMTBfVzNDLFAwNSxXLDMsQywzODg1Nyw2ODAKUDA1X0QwMF8wMTBfVzhDLFAwNSxXLDgsQyw2Mzc3MSw1NzIKUDA2X0QwMF8wMTBfQzBDLFAwNixDLDAsQyw2MTM5MywxMDExClAwN19EMDBfMDEwX1czRCxQMDcsVywzLEQsNTA5MzgsODQzClAwN19EMDBfMDEwX1c4RCxQMDcsVyw4LEQsNTAxODAsNzcxClAwOF9EMDBfMDEwX0MwRCxQMDgsQywwLEQsNDYzMjgsODEzClAwOV9EMDBfMDEwX1czRSxQMDksVywzLEUsNjEyMDMsODc0ClAwOV9EMDBfMDEwX1c4RSxQMDksVyw4LEUsMTU5MjEsMzc2ClAxMF9EMDBfMDEwX0MwRSxQMTAsQywwLEUsMzkwNTUsNjcwCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_filt_samp_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-1bdc27c2e5272be6d41b" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1bdc27c2e5272be6d41b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"PLOT":["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],"TREAT":["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],"TEMP":["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],"PAIR":["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],"total_reads":[53824,52012,57603,61727,34135,43026,38857,63771,61393,50938,50180,46328,61203,15921,39055],"total_asvs":[831,620,884,922,422,802,680,572,1011,843,771,813,874,376,670]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"PLOT","name":"PLOT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],"header":"PLOT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TREAT","name":"TREAT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],"header":"TREAT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TEMP","name":"TEMP","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],"header":"TEMP","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PAIR","name":"PAIR","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],"header":"PAIR","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads","name":"total_reads","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["53824","52012","57603","61727","34135","43026","38857","63771","61393","50938","50180","46328","61203","15921","39055"],"header":"total reads","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs","name":"total_asvs","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["831","620","884","922","422","802","680","572","1011","843","771","813","874","376","670"],"header":"total asvs","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,15],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"inline":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"e795895e74a3f3f4f82bc2132f17cb32"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="its-1" class="level2"><h2 class="anchored" data-anchor-id="its-1">ITS</h2>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">tmp_low_count</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/genefilter_sample-methods.html">genefilter_sample</a></span><span class="op">(</span>
                                         <span class="va">its18_ps_work</span>, 
                                         <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/filterfun_sample.html">filterfun_sample</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">)</span>, 
                                         A <span class="op">=</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/nsamples-methods.html">nsamples</a></span><span class="op">(</span><span class="va">its18_ps_work</span><span class="op">)</span><span class="op">)</span>
<span class="va">tmp_low_count</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/prune_taxa-methods.html">prune_taxa</a></span><span class="op">(</span><span class="va">tmp_low_count</span>, <span class="va">its18_ps_work</span><span class="op">)</span>
<span class="va">tmp_low_var</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/filter_taxa.html">filter_taxa</a></span><span class="op">(</span><span class="va">tmp_low_count</span>, 
                                     <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/var.html">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.2</span>, prune <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">its18_ps_filt</span> <span class="op">&lt;-</span> <span class="va">tmp_low_var</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="va">its18_ps_filt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And the filtered ITS phyloseq object.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 816 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 816 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 3 | Summary of arbitrary filtering where ASVs represented by fewer than 5 reads, present in less than 20% of samples, and/or a variance less than 0.2, were removed.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,TWV0cmljLEZ1bGwgZGF0YSxBcmJpdHJhcnkgZmlsdGVyClRvdGFsIG51bWJlciBvZiByZWFkcyw0OTA3NjcsMzg1NjQzCk1pbi4gbnVtYmVyIG9mIHJlYWRzLDkxNzIsODY5MgpNYXguIG51bWJlciBvZiByZWFkcyw2NDYzNiw1ODM2MApBdmVyYWdlIG51bWJlciBvZiByZWFkcywzNzc1MSwyOTY2NQpNZWRpYW4gbnVtYmVyIG9mIHJlYWRzLDM4MzcxLDI5MDUyClRvdGFsIEFTVnMsMzM1NSw4MTYKTWluLiBudW1iZXIgb2YgQVNWcywzMzUsMjA0Ck1heC4gbnVtYmVyIG9mIEFTVnMsMTAxNyw0OTkKQXZlcmFnZSBudW1iZXIgb2YgQVNWcyw3NTcsMzkwCk1lZGlhbiBudW1iZXIgb2YgQVNWcyw3NjUsNDA0Cg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_arbitrary_filt_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-80b9394d675d492296e1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-80b9394d675d492296e1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Metric":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"Full data":[490767,9172,64636,37751,38371,3355,335,1017,757,765],"Arbitrary filter":[385643,8692,58360,29665,29052,816,204,499,390,404]},"columns":[{"accessor":"Metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"header":"Metric","minWidth":200,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Full data","name":"Full data","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["490767","9172","64636","37751","38371","3355","335","1017","757","765"],"header":"Full data","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Arbitrary filter","name":"Arbitrary filter","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["385643","8692","58360","29665","29052","816","204","499","390","404"],"header":"Arbitrary filter","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":10,"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"596e9fc8afc47e13020a7bb961052303"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>And again, let’s look how filtering affected total reads and ASVs for each sample.</p>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 4 | Sample summary showing the number of reads and ASVs after Arbitrary filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELFBMT1QsVFJFQVQsVEVNUCxQQUlSLHRvdGFsX3JlYWRzLHRvdGFsX2FzdnMKUDAxX0QwMF8wMTBfVzNBLFAwMSxXLDMsQSwyNjMwMiw0OTkKUDAxX0QwMF8wMTBfVzhBLFAwMSxXLDgsQSwyNzIxOCwzNDQKUDAyX0QwMF8wMTBfQzBBLFAwMixDLDAsQSw0MzEyNyw0OTQKUDAzX0QwMF8wMTBfVzNCLFAwMyxXLDMsQiwyOTA1Miw0MjMKUDAzX0QwMF8wMTBfVzhCLFAwMyxXLDgsQiwxMDM3NiwyMDQKUDA0X0QwMF8wMTBfQzBCLFAwNCxDLDAsQiwzODkzNCw0NzEKUDA1X0QwMF8wMTBfVzhDLFAwNSxXLDgsQywyMjE5OCwyOTYKUDA2X0QwMF8wMTBfQzBDLFAwNixDLDAsQywzNjY1Miw0ODYKUDA3X0QwMF8wMTBfVzNELFAwNyxXLDMsRCwzMTE4NCw0OTIKUDA3X0QwMF8wMTBfVzhELFAwNyxXLDgsRCw4NjkyLDIyMwpQMDhfRDAwXzAxMF9DMEQsUDA4LEMsMCxELDMxODY3LDM0NQpQMDlfRDAwXzAxMF9XM0UsUDA5LFcsMyxFLDIxNjgxLDM5MApQMTBfRDAwXzAxMF9DMEUsUDEwLEMsMCxFLDU4MzYwLDQwNAo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_filt_samp_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-de69daed7c59a40aa4e8" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-de69daed7c59a40aa4e8">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"PLOT":["P01","P01","P02","P03","P03","P04","P05","P06","P07","P07","P08","P09","P10"],"TREAT":["W","W","C","W","W","C","W","C","W","W","C","W","C"],"TEMP":["3","8","0","3","8","0","8","0","3","8","0","3","0"],"PAIR":["A","A","A","B","B","B","C","C","D","D","D","E","E"],"total_reads":[26302,27218,43127,29052,10376,38934,22198,36652,31184,8692,31867,21681,58360],"total_asvs":[499,344,494,423,204,471,296,486,492,223,345,390,404]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"PLOT","name":"PLOT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01","P01","P02","P03","P03","P04","P05","P06","P07","P07","P08","P09","P10"],"header":"PLOT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TREAT","name":"TREAT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["W","W","C","W","W","C","W","C","W","W","C","W","C"],"header":"TREAT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TEMP","name":"TEMP","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["3","8","0","3","8","0","8","0","3","8","0","3","0"],"header":"TEMP","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PAIR","name":"PAIR","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["A","A","A","B","B","B","C","C","D","D","D","E","E"],"header":"PAIR","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads","name":"total_reads","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["26302","27218","43127","29052","10376","38934","22198","36652","31184","8692","31867","21681","58360"],"header":"total reads","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs","name":"total_asvs","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["499","344","494","423","204","471","296","486","492","223","345","390","404"],"header":"total asvs","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,13],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"inline":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"b51c2388019161509bc8ecaa8ed2bb73"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>And that’s it for Arbitrary filtering. Moving on.</p>
</section></section><section id="b.-perfect-filtering" class="level1"><h1>B. PERfect Filtering</h1>
<p>To run PERFect, we need the ASV tables in data frame format with samples as rows and ASVs as columns. PERFect is sensitive to the order of ASVs, so here we test <strong>a</strong>) the default order in the phyloseq object and <strong>b</strong>) ASVs ordered by decreasing abundance.</p>
<section id="setup" class="level2"><h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">samp_ps_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="st">"ssu18_ps_work"</span>, <span class="st">"its18_ps_work"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">samp_ps_filt</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
  <span class="va">tmp_get_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">tmp_get</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_get_tab</span> <span class="op">&lt;-</span> <span class="va">tmp_get_tab</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
  <span class="va">tmp_get_tab</span> <span class="op">&lt;-</span> <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/mixedSortDF.html">mixedSortDF</a></span><span class="op">(</span><span class="va">tmp_get_tab</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span>, 
                                        useRownames <span class="op">=</span> <span class="cn">FALSE</span>, byCols <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">tmp_get_tab</span> <span class="op">&lt;-</span> <span class="va">tmp_get_tab</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">remove_rownames</a></span><span class="op">(</span><span class="op">)</span> 
  <span class="va">tmp_get_tab</span> <span class="op">&lt;-</span> <span class="va">tmp_get_tab</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
  <span class="va">tmp_get_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="va">tmp_get_tab</span><span class="op">)</span><span class="op">)</span>

  <span class="va">tmp_get_tab_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">tmp_get</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_get_tab_ord</span> <span class="op">&lt;-</span> <span class="va">tmp_get_tab_ord</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
  <span class="va">tmp_get_tab_ord</span> <span class="op">&lt;-</span> <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/mixedSortDF.html">mixedSortDF</a></span><span class="op">(</span><span class="va">tmp_get_tab_ord</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span>, 
                                        useRownames <span class="op">=</span> <span class="cn">FALSE</span>, byCols <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">tmp_get_tab_ord</span> <span class="op">&lt;-</span> <span class="va">tmp_get_tab_ord</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">remove_rownames</a></span><span class="op">(</span><span class="op">)</span> 
  <span class="va">tmp_get_tab_ord</span> <span class="op">&lt;-</span> <span class="va">tmp_get_tab_ord</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
  <span class="va">tmp_get_tab_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="va">tmp_get_tab_ord</span><span class="op">)</span><span class="op">)</span>

  <span class="va">tmp_tab_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_perfect"</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_tab_name</span>, <span class="va">tmp_get_tab</span><span class="op">)</span>
  
  <span class="va">tmp_tab_ord_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_ord_perfect"</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_tab_ord_name</span>, <span class="va">tmp_get_tab_ord</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="filter" class="level2"><h2 class="anchored" data-anchor-id="filter">Filter</h2>
<p>Next we run the filtering analysis using <a href="https://rdrr.io/github/katiasmirn/PERFect/man/PERFect_sim.html"><code>PERFect_sim</code></a>. The other option is <a href="https://rdrr.io/github/katiasmirn/PERFect/man/PERFect_perm.html"><code>PERFect_perm</code></a> however I could not get <code>PERFect_perm</code> to work as of this writing. The process never finished :/</p>
<p>We need to set an initial p-value cutoff. For 16S rRNA, we use <code>0.05</code> and for ITS we use <code>0.1</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Set a pvalue cutoff</span>
<span class="va">ssu_per_pval</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">its_per_pval</span> <span class="op">&lt;-</span> <span class="fl">0.10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">samp_ps_filt</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_perfect"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"18.*"</span>, <span class="st">"_per_pval"</span>, <span class="va">i</span><span class="op">)</span>
  <span class="va">tmp_get_ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_ord_perfect"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp_sim</span> <span class="op">&lt;-</span> <span class="fu">PERFect_sim</span><span class="op">(</span>X <span class="op">=</span> <span class="va">tmp_get</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">tmp_pval</span><span class="op">)</span>, Order <span class="op">=</span> <span class="st">"NP"</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">tmp_sim</span><span class="op">$</span><span class="va">filtX</span><span class="op">)</span>
  <span class="va">tmp_sim_ord</span> <span class="op">&lt;-</span> <span class="fu">PERFect_sim</span><span class="op">(</span>X <span class="op">=</span> <span class="va">tmp_get_ord</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">tmp_pval</span><span class="op">)</span>, Order <span class="op">=</span> <span class="st">"NP"</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">tmp_sim_ord</span><span class="op">$</span><span class="va">filtX</span><span class="op">)</span>
  
  <span class="va">tmp_sim_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_perfect_sim"</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_sim_name</span>, <span class="va">tmp_sim</span><span class="op">)</span>

  <span class="va">tmp_sim_ord_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_ord_perfect_sim"</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_sim_ord_name</span>, <span class="va">tmp_sim_ord</span><span class="op">)</span>
  
  <span class="va">tmp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"files/filtering/perfect/rdata/"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">tmp_sim</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path</span>, <span class="va">tmp_sim_name</span>, <span class="st">".rds"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">tmp_sim_ord</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_path</span>, <span class="va">tmp_sim_ord_name</span>, <span class="st">".rds"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
  
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">objects</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_sim"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p>How many ASVs were retained after filtering?</p>
<p>First the 16S rRNA data set. Default ordering resulted in <strong>20172</strong> ASVs and reordering the data resulted in <strong>4466</strong> ASVs.</p>
<p>And then the ITS data set. Default ordering resulted in <strong>3354</strong> ASVs and reordering the data resulted in <strong>2133</strong> ASVs.</p>
<p>For some reason, the package does not remove based on the p value cutoff that we set earlier (<code>0.05</code>). So we need to filter out the ASVs that have a higher p-value than the cutoff.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Total 16S rRNA ASVs with p-value less than 0.05 
[1] default order: ASVs before checking p value was 20172 and after was 1679
[1] decreasing order: ASVs before checking p value was 4466 and after was 1659
[1] --------------------------------------
Total ITS ASVs with p-value less than 0.1 
[1] default order: ASVs before checking p-value was 3354 and after was 306
[1] decreasing order: ASVs before checking p-value was 2133 and after was 264</code></pre>
</div>
</div>
<p>Now we can make phyloseq objects. Manual inspection of the results from <code>PERFect_sim</code> for the 16S rRNA data indicated that using the <strong>decreasing</strong> order and filtering p-values less than 0.05 yielded in the best results. Manual inspection of the results from <code>PERFect_sim</code> for the ITS data indicated that using the <strong>default</strong> order and filtering p-values less than 0.1 yielded in the best results. These approaches limited the number of ASVs found in only 1 or 2 samples. So first we filter out ASVs with p-values lower than the defined cutoff and then make the objects.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># pvalue cutoffs set earlier</span>
<span class="va">ssu_per_pval</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">its_per_pval</span> <span class="op">&lt;-</span> <span class="fl">0.10</span>
<span class="co"># Choose method</span>
<span class="va">ssu_select</span> <span class="op">&lt;-</span> <span class="st">"_ord_perfect"</span>
<span class="va">its_select</span> <span class="op">&lt;-</span> <span class="st">"_perfect"</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">samp_ps_filt</span><span class="op">)</span> <span class="op">{</span>
  <span class="co">## select pval cutoff and method</span>
    <span class="va">tmp_pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"18.*"</span>, <span class="st">"_per_pval"</span>, <span class="va">i</span><span class="op">)</span>
    <span class="va">tmp_select</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"18.*"</span>, <span class="st">"_select"</span>, <span class="va">i</span><span class="op">)</span>
    
    <span class="va">tmp_get</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">tmp_select</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="va">tmp_get_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">tmp_select</span><span class="op">)</span>, <span class="st">"_sim"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="va">tmp_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="va">tmp_get_sim</span><span class="op">$</span><span class="va">filtX</span><span class="op">)</span><span class="op">)</span>
    <span class="va">tmp_filt</span> <span class="op">&lt;-</span> <span class="va">tmp_filt</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
    <span class="va">tmp_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="va">tmp_get</span><span class="op">)</span><span class="op">)</span>
    <span class="va">tmp_tab</span> <span class="op">&lt;-</span> <span class="va">tmp_tab</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
    <span class="va">tmp_pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">tmp_get_sim</span><span class="op">$</span><span class="va">pvals</span><span class="op">)</span>
    <span class="va">tmp_pvals</span> <span class="op">&lt;-</span> <span class="va">tmp_pvals</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"pval"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
    <span class="va">tmp_pvals</span> <span class="op">&lt;-</span> <span class="va">tmp_pvals</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">pval</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">tmp_pval</span><span class="op">)</span><span class="op">)</span>
    <span class="va">tmp_merge</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_pvals</span>, <span class="va">tmp_tab</span>, by <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>
    <span class="va">tmp_merge</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
    <span class="va">tmp_merge</span> <span class="op">&lt;-</span> <span class="va">tmp_merge</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
    <span class="va">tmp_tax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html">tax_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
    <span class="va">tmp_tax</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_pvals</span>, <span class="va">tmp_tax</span>, by <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>
    <span class="va">tmp_tax</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
    <span class="va">tmp_tax</span> <span class="op">&lt;-</span> <span class="va">tmp_tax</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span>
<span class="co"># Build PS object</span>
    <span class="va">tmp_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_tax</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_merge</span><span class="op">)</span><span class="op">)</span>
    <span class="va">tmp_merge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/transpose-methods.html">t</a></span><span class="op">(</span><span class="va">tmp_merge</span><span class="op">)</span><span class="op">)</span>
    <span class="va">tmp_merge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tmp_merge</span><span class="op">)</span>
    <span class="va">tmp_tax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tmp_tax</span><span class="op">)</span>
    <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/phyloseq.html">phyloseq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">tmp_merge</span>, taxa_are_rows <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
                     <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html">tax_table</a></span><span class="op">(</span><span class="va">tmp_tax</span><span class="op">)</span>,
                     <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">tmp_samp</span><span class="op">)</span><span class="op">)</span>
    
    <span class="va">tmp_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>,
                           tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">tmp_ps</span><span class="op">)</span><span class="op">)</span>
    <span class="va">tmp_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">tmp_ps</span>,
                               <span class="va">sample_data</span>,
                               <span class="va">tmp_tree</span><span class="op">)</span>
    <span class="va">tmp_ps_name</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">i</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"_perf_filt"</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_ps_name</span>, <span class="va">tmp_ps</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>  

<span class="va">ssu18_ps_perfect</span> <span class="op">&lt;-</span> <span class="va">ssu18_ps_work_perf_filt</span>
<span class="va">its18_ps_perfect</span> <span class="op">&lt;-</span> <span class="va">its18_ps_work_perf_filt</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_perf_filt"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16S rRNA phyloseq object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1659 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1659 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 1659 tips and 1658 internal nodes ]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ITS phyloseq object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 306 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 306 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 306 tips and 305 internal nodes ]</code></pre>
</div>
</div>
</section><section id="summary" class="level2"><h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>How many reads and ASVs were removed following PERfect filtering?</p>
<p><strong>16S rRNA</strong></p>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 5 | Summary of PERfect filtering using the decreased order and filtering p-values &lt; 0.05.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,TWV0cmljLEZ1bGwgZGF0YSxQRVJmZWN0IGZpbHRlcgpUb3RhbCBudW1iZXIgb2YgcmVhZHMsOTM2NjQwLDczMTUwOApNaW4uIG51bWJlciBvZiByZWFkcywyNTA4OCwxNjY5NwpNYXguIG51bWJlciBvZiByZWFkcyw4NjYwMCw3MTAyNgpBdmVyYWdlIG51bWJlciBvZiByZWFkcyw2MjQ0Myw0ODc2NwpNZWRpYW4gbnVtYmVyIG9mIHJlYWRzLDYyMTE3LDUwMjQxClRvdGFsIEFTVnMsMjAxNzMsMTY1OQpNaW4uIG51bWJlciBvZiBBU1ZzLDgxMywzMzIKTWF4LiBudW1iZXIgb2YgQVNWcywzMDY1LDg1NwpBdmVyYWdlIG51bWJlciBvZiBBU1ZzLDIwNjMsNjQ1Ck1lZGlhbiBudW1iZXIgb2YgQVNWcywyMTI0LDY3MQo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_perfect_filt_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-0df1bf31ad64c511b5d6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0df1bf31ad64c511b5d6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Metric":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"Full data":[936640,25088,86600,62443,62117,20173,813,3065,2063,2124],"PERfect filter":[731508,16697,71026,48767,50241,1659,332,857,645,671]},"columns":[{"accessor":"Metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"header":"Metric","minWidth":200,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Full data","name":"Full data","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["936640","25088","86600","62443","62117","20173","813","3065","2063","2124"],"header":"Full data","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PERfect filter","name":"PERfect filter","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["731508","16697","71026","48767","50241","1659","332","857","645","671"],"header":"PERfect filter","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[5,10,10],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"ce1119ec77494a0b33acd2611fc86c2a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>ITS</strong></p>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 5 | Summary of PERfect filtering using the defualt order and filtering p-values &lt; 0.10.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,TWV0cmljLEZ1bGwgZGF0YSxQRVJmZWN0IGZpbHRlcgpUb3RhbCBudW1iZXIgb2YgcmVhZHMsNDkwNzY3LDM2MTM5OQpNaW4uIG51bWJlciBvZiByZWFkcyw5MTcyLDcyODYKTWF4LiBudW1iZXIgb2YgcmVhZHMsNjQ2MzYsNTY3NzIKQXZlcmFnZSBudW1iZXIgb2YgcmVhZHMsMzc3NTEsMjc4MDAKTWVkaWFuIG51bWJlciBvZiByZWFkcywzODM3MSwyNDMxMwpUb3RhbCBBU1ZzLDMzNTUsMzA2Ck1pbi4gbnVtYmVyIG9mIEFTVnMsMzM1LDY0Ck1heC4gbnVtYmVyIG9mIEFTVnMsMTAxNywxNjEKQXZlcmFnZSBudW1iZXIgb2YgQVNWcyw3NTcsMTIyCk1lZGlhbiBudW1iZXIgb2YgQVNWcyw3NjUsMTM2Cg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_perfect_filt_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-0250397ffdcecbd15127" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0250397ffdcecbd15127">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Metric":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"Full data":[490767,9172,64636,37751,38371,3355,335,1017,757,765],"PERfect filter":[361399,7286,56772,27800,24313,306,64,161,122,136]},"columns":[{"accessor":"Metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"header":"Metric","minWidth":200,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Full data","name":"Full data","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["490767","9172","64636","37751","38371","3355","335","1017","757","765"],"header":"Full data","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PERfect filter","name":"PERfect filter","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["361399","7286","56772","27800","24313","306","64","161","122","136"],"header":"PERfect filter","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[5,10,10],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"0db8f2eee8f31ed5f725ee80f25868d0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Here is a summary table of total reads and ASVs on a per sample basis after filtering.</p>
<p><strong>16S rRNA</strong></p>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 6 | Sample summary showing the number of reads and ASVs after PERfect filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELFBMT1QsVFJFQVQsVEVNUCxQQUlSLHRvdGFsX3JlYWRzLHRvdGFsX2FzdnMKUDAxX0QwMF8wMTBfVzNBLFAwMSxXLDMsQSw1Mjk4MCw3MDcKUDAxX0QwMF8wMTBfVzhBLFAwMSxXLDgsQSw1MjMyNyw1NjMKUDAyX0QwMF8wMTBfQzBBLFAwMixDLDAsQSw1NjYxOSw3MzcKUDAzX0QwMF8wMTBfVzNCLFAwMyxXLDMsQiw2MDM2Niw3NjQKUDAzX0QwMF8wMTBfVzhCLFAwMyxXLDgsQiwzNTYwNCw0MTEKUDA0X0QwMF8wMTBfQzBCLFAwNCxDLDAsQiw0MTYyNCw2NjMKUDA1X0QwMF8wMTBfVzNDLFAwNSxXLDMsQywzNzg3Nyw1NzQKUDA1X0QwMF8wMTBfVzhDLFAwNSxXLDgsQyw3MTAyNiw2NjEKUDA2X0QwMF8wMTBfQzBDLFAwNixDLDAsQyw2MTI3Nyw4NTcKUDA3X0QwMF8wMTBfVzNELFAwNyxXLDMsRCw0OTg3Nyw3MjUKUDA3X0QwMF8wMTBfVzhELFAwNyxXLDgsRCw1MDI0MSw2NzEKUDA4X0QwMF8wMTBfQzBELFAwOCxDLDAsRCw0NTYzMyw2ODEKUDA5X0QwMF8wMTBfVzNFLFAwOSxXLDMsRSw2MTAzMyw3NTEKUDA5X0QwMF8wMTBfVzhFLFAwOSxXLDgsRSwxNjY5NywzMzIKUDEwX0QwMF8wMTBfQzBFLFAxMCxDLDAsRSwzODMyNyw1NzEK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_perfect_samp_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-f246c5c2231d24f6f031" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f246c5c2231d24f6f031">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"PLOT":["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],"TREAT":["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],"TEMP":["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],"PAIR":["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],"total_reads":[52980,52327,56619,60366,35604,41624,37877,71026,61277,49877,50241,45633,61033,16697,38327],"total_asvs":[707,563,737,764,411,663,574,661,857,725,671,681,751,332,571]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"PLOT","name":"PLOT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],"header":"PLOT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TREAT","name":"TREAT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],"header":"TREAT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TEMP","name":"TEMP","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],"header":"TEMP","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PAIR","name":"PAIR","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],"header":"PAIR","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads","name":"total_reads","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["52980","52327","56619","60366","35604","41624","37877","71026","61277","49877","50241","45633","61033","16697","38327"],"header":"total reads","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs","name":"total_asvs","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["707","563","737","764","411","663","574","661","857","725","671","681","751","332","571"],"header":"total asvs","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,15],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"inline":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"58e05dd3776fa79a2ec31f9c6f9c2c2e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>ITS</strong></p>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 6 | Sample summary showing the number of reads and ASVs after PERfect filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELFBMT1QsVFJFQVQsVEVNUCxQQUlSLHRvdGFsX3JlYWRzLHRvdGFsX2FzdnMKUDAxX0QwMF8wMTBfVzNBLFAwMSxXLDMsQSwyMzczNywxNDgKUDAxX0QwMF8wMTBfVzhBLFAwMSxXLDgsQSwyMzg1MCw5OApQMDJfRDAwXzAxMF9DMEEsUDAyLEMsMCxBLDM5Njg5LDE0NwpQMDNfRDAwXzAxMF9XM0IsUDAzLFcsMyxCLDI4MjU2LDEzNgpQMDNfRDAwXzAxMF9XOEIsUDAzLFcsOCxCLDgxMzgsNjQKUDA0X0QwMF8wMTBfQzBCLFAwNCxDLDAsQiw0NzY1NCwxNjEKUDA1X0QwMF8wMTBfVzhDLFAwNSxXLDgsQywyMDgzMSw5MApQMDZfRDAwXzAxMF9DMEMsUDA2LEMsMCxDLDM1OTIzLDE1NwpQMDdfRDAwXzAxMF9XM0QsUDA3LFcsMyxELDI0MzEzLDE0NwpQMDdfRDAwXzAxMF9XOEQsUDA3LFcsOCxELDcyODYsNzYKUDA4X0QwMF8wMTBfQzBELFAwOCxDLDAsRCwyODQyMCwxMDUKUDA5X0QwMF8wMTBfVzNFLFAwOSxXLDMsRSwxNjUzMCwxMTgKUDEwX0QwMF8wMTBfQzBFLFAxMCxDLDAsRSw1Njc3MiwxNDMK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_perfect_samp_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-ea5d15391a4e3e366a77" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ea5d15391a4e3e366a77">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"PLOT":["P01","P01","P02","P03","P03","P04","P05","P06","P07","P07","P08","P09","P10"],"TREAT":["W","W","C","W","W","C","W","C","W","W","C","W","C"],"TEMP":["3","8","0","3","8","0","8","0","3","8","0","3","0"],"PAIR":["A","A","A","B","B","B","C","C","D","D","D","E","E"],"total_reads":[23737,23850,39689,28256,8138,47654,20831,35923,24313,7286,28420,16530,56772],"total_asvs":[148,98,147,136,64,161,90,157,147,76,105,118,143]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"PLOT","name":"PLOT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01","P01","P02","P03","P03","P04","P05","P06","P07","P07","P08","P09","P10"],"header":"PLOT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TREAT","name":"TREAT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["W","W","C","W","W","C","W","C","W","W","C","W","C"],"header":"TREAT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TEMP","name":"TEMP","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["3","8","0","3","8","0","8","0","3","8","0","3","0"],"header":"TEMP","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PAIR","name":"PAIR","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["A","A","A","B","B","B","C","C","D","D","D","E","E"],"header":"PAIR","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads","name":"total_reads","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["23737","23850","39689","28256","8138","47654","20831","35923","24313","7286","28420","16530","56772"],"header":"total reads","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs","name":"total_asvs","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["148","98","147","136","64","161","90","157","147","76","105","118","143"],"header":"total asvs","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,13],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"inline":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"598055a988435905141931e6fdfa26ea"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>And finally, save the PERfect filtered phyloseq objects.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">ssu18_ps_perfect</span>, <span class="st">"files/filtering/perfect/rdata/ssu18_ps_perfect.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">its18_ps_perfect</span>, <span class="st">"files/filtering/perfect/rdata/its18_ps_perfect.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
</section></section><section id="c.-pime-filtering" class="level1"><h1>C. PIME Filtering</h1>
<p>The first step in the PIME process is to rarefy the data and then proceed with the filtering. Unlike the two previous workflows—which combined the analyses of the 16S rRNA and ITS data sets—here the two data sets will be analyzed separately because the PIME workflow is considerably more complicated.</p>
<section id="s-rrna-2" class="level2"><h2 class="anchored" data-anchor-id="s-rrna-2">16S rRNA</h2>
<section id="setup-1" class="level3"><h3 class="anchored" data-anchor-id="setup-1">Setup</h3>
<p>First, choose a phyloseq object and a sample data frame</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_pime_ds</span> <span class="op">&lt;-</span> <span class="va">ssu18_ps_work</span>
<span class="va">ssu18_which_pime</span> <span class="op">&lt;-</span> <span class="st">"ssu18_pime_ds"</span>
<span class="va">ssu18_pime_ds</span><span class="op">@</span><span class="va">phy_tree</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="va">ssu18_pime_ds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 20173 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 20173 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_pime_sample_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">ssu18_pime_ds_full</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssu18_pime_sample_d</span> <span class="op">&lt;-</span> <span class="va">ssu18_pime_sample_d</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>total_reads <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">ssu18_pime_ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/rarefy_even_depth.html">rarefy_even_depth</a></span><span class="op">(</span><span class="va">ssu18_pime_ds_full</span>,
                               sample.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">ssu18_pime_sample_d</span><span class="op">$</span><span class="va">total_reads</span><span class="op">)</span>,
                               trimOTUs <span class="op">=</span> <span class="cn">TRUE</span>, replace <span class="op">=</span> <span class="cn">FALSE</span>,
                               rngseed <span class="op">=</span> <span class="fl">119</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>2741 OTUs were removed because they are no longer 
present in any sample after random subsampling</code></pre>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 17432 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 17432 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
<p>The first step in PIME is to define if the microbial community presents a high relative abundance of taxa with low prevalence, which is considered as noise in PIME analysis. This is calculated by random forests analysis and is the baseline noise detection.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_pime.oob.error</span> <span class="op">&lt;-</span> <span class="fu">pime.oob.error</span><span class="op">(</span><span class="va">ssu18_pime_ds</span>, <span class="st">"TEMP"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6666667</code></pre>
</div>
</div>
</section><section id="split-by-predictor-variable" class="level3"><h3 class="anchored" data-anchor-id="split-by-predictor-variable">Split by Predictor Variable</h3>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">ssu18_pime_ds</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssu18_per_variable_obj</span> <span class="op">&lt;-</span> <span class="fu">pime.split.by.variable</span><span class="op">(</span><span class="va">ssu18_pime_ds</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">ssu18_per_variable_obj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$`0`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 7883 taxa and 5 samples ]
sample_data() Sample Data:       [ 5 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 7883 taxa by 8 taxonomic ranks ]

$`3`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 7173 taxa and 5 samples ]
sample_data() Sample Data:       [ 5 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 7173 taxa by 8 taxonomic ranks ]

$`8`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 6027 taxa and 5 samples ]
sample_data() Sample Data:       [ 5 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 6027 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
</section><section id="calculate-prevalence-intervals" class="level3"><h3 class="anchored" data-anchor-id="calculate-prevalence-intervals">Calculate Prevalence Intervals</h3>
<p>Using the output of <code>pime.split.by.variable</code>, we calculate the prevalence intervals with the function <code>pime.prevalence</code>. This function estimates the highest prevalence possible (no empty ASV table), calculates prevalence for taxa, starting at 5 maximum prevalence possible (no empty ASV table or dropping samples). After prevalence calculation, each prevalence interval are merged.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_prevalences</span> <span class="op">&lt;-</span> <span class="fu">pime.prevalence</span><span class="op">(</span><span class="va">ssu18_per_variable_obj</span><span class="op">)</span>
<span class="va">ssu18_prevalences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details><summary>
Detailed results for all prevalences intervals
</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$`5`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 17432 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 17432 taxa by 8 taxonomic ranks ]

$`10`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 17432 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 17432 taxa by 8 taxonomic ranks ]

$`15`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 17432 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 17432 taxa by 8 taxonomic ranks ]

$`20`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 2253 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 2253 taxa by 8 taxonomic ranks ]

$`25`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 2253 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 2253 taxa by 8 taxonomic ranks ]

$`30`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 2253 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 2253 taxa by 8 taxonomic ranks ]

$`35`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 2253 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 2253 taxa by 8 taxonomic ranks ]

$`40`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1058 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1058 taxa by 8 taxonomic ranks ]

$`45`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1058 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1058 taxa by 8 taxonomic ranks ]

$`50`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1058 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1058 taxa by 8 taxonomic ranks ]

$`55`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1058 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1058 taxa by 8 taxonomic ranks ]

$`60`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 585 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 585 taxa by 8 taxonomic ranks ]

$`65`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 585 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 585 taxa by 8 taxonomic ranks ]

$`70`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 585 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 585 taxa by 8 taxonomic ranks ]

$`75`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 585 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 585 taxa by 8 taxonomic ranks ]

$`80`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 294 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 294 taxa by 8 taxonomic ranks ]

$`85`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 294 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 294 taxa by 8 taxonomic ranks ]

$`90`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 294 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 294 taxa by 8 taxonomic ranks ]

$`95`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 294 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 294 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
</details></section><section id="calculate-best-prevalence" class="level3"><h3 class="anchored" data-anchor-id="calculate-best-prevalence">Calculate Best Prevalence</h3>
<p>Finally, we use the function <code>pime.best.prevalence</code> to calculate the best prevalence. The function uses randomForest to build random forests trees for samples classification and variable importance computation. It performs classifications for each prevalence interval returned by <code>pime.prevalence</code>. Variable importance is calculated, returning the Mean Decrease Accuracy (MDA), Mean Decrease Impurity (MDI), overall and by sample group, and taxonomy for each ASV. PIME keeps the top 30 variables with highest MDA each prevalence level.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1911</span><span class="op">)</span>
<span class="va">ssu18_best.prev</span> <span class="op">&lt;-</span> <span class="fu">pime.best.prevalence</span><span class="op">(</span><span class="va">ssu18_prevalences</span>, <span class="st">"TEMP"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>         Interval OOB error rate (%)  OTUs  Nseqs
1   Prevalence 5%              66.67 17432 376320
2  Prevalence 10%              66.67 17432 376320
3  Prevalence 15%                 60 17432 376320
4  Prevalence 20%                 40  2253 282185
5  Prevalence 25%              33.33  2253 282185
6  Prevalence 30%              26.67  2253 282185
7  Prevalence 35%              26.67  2253 282185
8  Prevalence 40%               6.67  1058 232532
9  Prevalence 45%               6.67  1058 232532
10 Prevalence 50%                  0  1058 232532
11 Prevalence 55%                  0  1058 232532
12 Prevalence 60%                  0   585 192484
13 Prevalence 65%                  0   585 192484
14 Prevalence 70%                  0   585 192484
15 Prevalence 75%                  0   585 192484
16 Prevalence 80%                  0   294 149258
17 Prevalence 85%                  0   294 149258
18 Prevalence 90%                  0   294 149258
19 Prevalence 95%                  0   294 149258</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_what_is_best</span> <span class="op">&lt;-</span> <span class="va">ssu18_best.prev</span><span class="op">$</span><span class="va">`OOB error`</span>
<span class="va">ssu18_what_is_best</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ssu18_what_is_best</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>, <span class="va">as.numeric</span><span class="op">)</span>
<span class="va">ssu18_what_is_best</span> <span class="op">&lt;-</span> <span class="va">ssu18_what_is_best</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"OOB_error_rate"</span> <span class="op">=</span> <span class="st">"OOB error rate (%)"</span><span class="op">)</span>
<span class="va">ssu18_what_is_best</span><span class="op">$</span><span class="va">Interval</span> <span class="op">&lt;-</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">ssu18_what_is_best</span><span class="op">$</span><span class="va">Interval</span>, <span class="st">"%"</span>, <span class="st">""</span><span class="op">)</span>
<span class="va">ssu18_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">ssu18_what_is_best</span>, <span class="va">Interval</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.min.html">which.min</a></span><span class="op">(</span><span class="va">OOB_error_rate</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">ssu18_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"`"</span>, <span class="va">ssu18_best</span>, <span class="st">"`"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">ssu18_prev_choice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_best.prev$`Importance`$"</span>, <span class="va">ssu18_best</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">ssu18_imp_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="op">(</span><span class="va">ssu18_prev_choice</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Looks like the lowest OOB error rate (%) that retains the most ASVs is 0% from <code>Prevalence 50</code>. We will use this interval.</p>
</section><section id="best-prevalence-summary" class="level3"><h3 class="anchored" data-anchor-id="best-prevalence-summary">Best Prevalence Summary</h3>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 7 | Summary of top 30 ASVs from the chosen prevalence interval.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,QVNWX0lELFgwLFgzLFg4LE1lYW5EZWNyZWFzZUFjY3VyYWN5LE1lYW5EZWNyZWFzZUdpbmksS2luZ2RvbSxQaHlsdW0sQ2xhc3MsT3JkZXIsRmFtaWx5LEdlbnVzCkFTVjExNCwwLjAwMjY2NjY2NjY2NjY2NjY2NjYsMC4wMDI2NjY2NjY2NjY2NjY2NjY2LDAuMDEzMzMzMzMzMzMzMzMzMzMyLDAuMDA2ODMzMzMzMzMzMzMzMzM0LDAuMTA5NTYxNjE2MTYxNjE2MTUsQmFjdGVyaWEsUHJvdGVvYmFjdGVyaWEsQWxwaGFwcm90ZW9iYWN0ZXJpYSxSaGl6b2JpYWxlcyxYYW50aG9iYWN0ZXJhY2VhZSxmX1hhbnRob2JhY3RlcmFjZWFlCkFTVjE0NiwwLjAwNjMzMzMzMzMzMzMzMzMzMywwLjAwMTMzMzMzMzMzMzMzMzMzMzUsMC4wMTMsMC4wMDY2ODU3MTQyODU3MTQyODUsMC4xMjI4MDQ5MDYyMDQ5MDYyMSxCYWN0ZXJpYSxQcm90ZW9iYWN0ZXJpYSxHYW1tYXByb3Rlb2JhY3RlcmlhLEJ1cmtob2xkZXJpYWxlcyxOaXRyb3NvbW9uYWRhY2VhZSxNTkQxCkFTVjM5LDAuMDAyNjY2NjY2NjY2NjY2NjY2NiwwLjAwMywwLjAxLDAuMDA1ODY2NjY2NjY2NjY2NjY2LDAuMDg5ODAyMTY0NTAyMTY0NTEsQmFjdGVyaWEsQWNpZG9iYWN0ZXJpb3RhLFZpY2luYW1pYmFjdGVyaWEsVmljaW5hbWliYWN0ZXJhbGVzLG9fVmljaW5hbWliYWN0ZXJhbGVzLG9fVmljaW5hbWliYWN0ZXJhbGVzCkFTVjE1NywwLjAwMywwLjAwNiwwLjAxMTY2NjY2NjY2NjY2NjY2NywwLjAwNTgwNDc2MTkwNDc2MTkwNTQsMC4wODcwNzQ2MDMxNzQ2MDMxNyxCYWN0ZXJpYSxWZXJydWNvbWljcm9iaW90YSxWZXJydWNvbWljcm9iaWFlLENodGhvbmlvYmFjdGVyYWxlcyxYaXBoaW5lbWF0b2JhY3RlcmFjZWFlLENhbmRpZGF0dXNfWGlwaGluZW1hdG9iYWN0ZXIKQVNWNDg4LDAuMDEsMCwwLjAwNTUsMC4wMDUwOTk5OTk5OTk5OTk5OTk1LDAuMDY3NzI4NzE1NzI4NzE1NzIsQmFjdGVyaWEsUGxhbmN0b215Y2V0b3RhLE9NMTkwLGNfT00xOTAsY19PTTE5MCxjX09NMTkwCkFTVjEzNywwLjAwMiwwLjAwMTY2NjY2NjY2NjY2NjY2NjYsMC4wMTEsMC4wMDQ3NDI4NTcxNDI4NTcxNDMsMC4wODQxMDc5MzY1MDc5MzY1LEJhY3RlcmlhLEFjaWRvYmFjdGVyaW90YSxTdWJncm91cF81LGNfU3ViZ3JvdXBfNSxjX1N1Ymdyb3VwXzUsY19TdWJncm91cF81CkFTVjM0MCwwLjAxMDMzMzMzMzMzMzMzMzMzMywwLjAwMiwwLjAwMiwwLjAwNDMwNDc2MTkwNDc2MTkwNiwwLjA2MTIxNTU4NDQxNTU4NDQyLEJhY3RlcmlhLFBsYW5jdG9teWNldG90YSxPTTE5MCxjX09NMTkwLGNfT00xOTAsY19PTTE5MApBU1YyODksMC4wMDg2NjY2NjY2NjY2NjY2NjgsMC4wMDMsMC4wMDI2NjY2NjY2NjY2NjY2NjY2LDAuMDAzOTQyODU3MTQyODU3MTQyLDAuMDUyMjY2NjY2NjY2NjY2NjYsQmFjdGVyaWEsVmVycnVjb21pY3JvYmlvdGEsVmVycnVjb21pY3JvYmlhZSxDaHRob25pb2JhY3RlcmFsZXMsWGlwaGluZW1hdG9iYWN0ZXJhY2VhZSxDYW5kaWRhdHVzX1hpcGhpbmVtYXRvYmFjdGVyCkFTVjkxOCwwLjAwMiwwLjAxLDAuMDAyLDAuMDAzOCwwLjA3Nzg5NjgyNTM5NjgyNTQsQmFjdGVyaWEsUHJvdGVvYmFjdGVyaWEsQWxwaGFwcm90ZW9iYWN0ZXJpYSxSaGl6b2JpYWxlcyxSaGl6b2JpYWNlYWUsQWxsb3JoaXpvYml1bS1OZW9yaGl6b2JpdW0tUGFyYXJoaXpvYml1bS1SaGl6b2JpdW0KQVNWMjgyLDAuMDAyLDAuMDAzLDAuMDA3ODMzMzMzMzMzMzMzMzMzLDAuMDAzNjY2NjY2NjY2NjY2NjY3LDAuMDQ2Njk2MTAzODk2MTAzODk1LEJhY3RlcmlhLFZlcnJ1Y29taWNyb2Jpb3RhLFZlcnJ1Y29taWNyb2JpYWUsUGVkb3NwaGFlcmFsZXMsUGVkb3NwaGFlcmFjZWFlLGZfUGVkb3NwaGFlcmFjZWFlCkFTVjg2MSwwLjAxLDAuMDAyNSwwLjAwMTY2NjY2NjY2NjY2NjY2NjYsMC4wMDM2MzgwOTUyMzgwOTUyMzc2LDAuMDg5NzYxOTA0NzYxOTA0NzUsQmFjdGVyaWEsQWN0aW5vYmFjdGVyaW90YSxBY3Rpbm9iYWN0ZXJpYSxDb3J5bmViYWN0ZXJpYWxlcyxNeWNvYmFjdGVyaWFjZWFlLE15Y29iYWN0ZXJpdW0KQVNWMzE0LDAuMDA4LDAuMDAyLDAuMDAyNjY2NjY2NjY2NjY2NjY2NiwwLjAwMzYwOTUyMzgwOTUyMzgwOTQsMC4wNzIyODczMDE1ODczMDE1OCxCYWN0ZXJpYSxBY2lkb2JhY3RlcmlvdGEsU3ViZ3JvdXBfMjIsY19TdWJncm91cF8yMixjX1N1Ymdyb3VwXzIyLGNfU3ViZ3JvdXBfMjIKQVNWNTA4LC02LjY2NjY2NjY2NjY2NjY2NmUtNCwwLjAwMywwLjAwOTMzMzMzMzMzMzMzMzMzNCwwLjAwMzUwNDc2MTkwNDc2MTkwNDYsMC4wNjY1OTk5OTk5OTk5OTk5OSxCYWN0ZXJpYSxDaGxvcm9mbGV4aSxBbmFlcm9saW5lYWUsQW5hZXJvbGluZWFsZXMsQW5hZXJvbGluZWFjZWFlLGZfQW5hZXJvbGluZWFjZWFlCkFTVjEwMzUsMCwwLjAwMzY2NjY2NjY2NjY2NjY2NjYsMC4wMDYsMC4wMDMyLDAuMDMzNzc3Nzc3Nzc3Nzc3NzgsQmFjdGVyaWEsQ2hsb3JvZmxleGksRGVoYWxvY29jY29pZGlhLFMwODUsb19TMDg1LG9fUzA4NQpBU1YxNDI2LDAuMDA1LDAuMDAyLDAuMDAxNjY2NjY2NjY2NjY2NjY2NiwwLjAwMzE2NjY2NjY2NjY2NjY2NjYsMC4wNTQxNjUwNzkzNjUwNzkzNyxCYWN0ZXJpYSxCYWN0ZXJvaWRvdGEsQmFjdGVyb2lkaWEsQ2hpdGlub3BoYWdhbGVzLENoaXRpbm9waGFnYWNlYWUsRWRhcGhvYmFjdWx1bQpBU1YyNTQsMC4wMDEsMC4wMDMsMC4wMDUsMC4wMDMxNjY2NjY2NjY2NjY2NjY2LDAuMDUzMjA1MDUwNTA1MDUwNSxCYWN0ZXJpYSxQcm90ZW9iYWN0ZXJpYSxHYW1tYXByb3Rlb2JhY3RlcmlhLEJ1cmtob2xkZXJpYWxlcyxTdXR0ZXJlbGxhY2VhZSxmX1N1dHRlcmVsbGFjZWFlCkFTVjQxMCwwLjAwNywwLjAwMSwwLjAwMSwwLjAwMzEsMC4xMDI0MDk1MjM4MDk1MjM4MSxCYWN0ZXJpYSxEZXN1bGZvYmFjdGVyb3RhLHBfRGVzdWxmb2JhY3Rlcm90YSxwX0Rlc3VsZm9iYWN0ZXJvdGEscF9EZXN1bGZvYmFjdGVyb3RhLHBfRGVzdWxmb2JhY3Rlcm90YQpBU1YyMTIsMC4wMDIsMC4wMDQsMC4wMDEsMC4wMDMwNjY2NjY2NjY2NjY2NjYzLDAuMDQ0MjMwNzM1OTMwNzM1OTI2LEJhY3RlcmlhLFZlcnJ1Y29taWNyb2Jpb3RhLFZlcnJ1Y29taWNyb2JpYWUsUGVkb3NwaGFlcmFsZXMsUGVkb3NwaGFlcmFjZWFlLEFEdXJiLkJpbjA2My0xCkFTVjEzNCwwLjAwNCwwLDAuMDA2LDAuMDAzMDMzMzMzMzMzMzMzMzMzLDAuMDcxNDAxMDEwMTAxMDEwMDksQmFjdGVyaWEsUHJvdGVvYmFjdGVyaWEsQWxwaGFwcm90ZW9iYWN0ZXJpYSxSaGl6b2JpYWxlcyxYYW50aG9iYWN0ZXJhY2VhZSxmX1hhbnRob2JhY3RlcmFjZWFlCkFTVjE4NSwwLjAwMiw2LjY2NjY2NjY2NjY2NjY2NmUtNCwwLjAwNiwwLjAwMywwLjA4Mjc1MzI0Njc1MzI0Njc1LEJhY3RlcmlhLFByb3Rlb2JhY3RlcmlhLEdhbW1hcHJvdGVvYmFjdGVyaWEsQnVya2hvbGRlcmlhbGVzLFRSQTMtMjAsZl9UUkEzLTIwCkFTVjY0LDYuNjY2NjY2NjY2NjY2NjY2ZS00LDAuMDA0LDAuMDAzNjY2NjY2NjY2NjY2NjY2NiwwLjAwMjk5OTk5OTk5OTk5OTk5OTYsMC4wMzQ0MjQyNDI0MjQyNDI0MyxCYWN0ZXJpYSxBY2lkb2JhY3RlcmlvdGEsVGhlcm1vYW5hZXJvYmFjdWxpYSxUaGVybW9hbmFlcm9iYWN1bGFsZXMsVGhlcm1vYW5hZXJvYmFjdWxhY2VhZSxTdWJncm91cF8xMApBU1Y0NzIsMC4wMDI1LDAuMDAxLDAuMDA2LDAuMDAyOTAwMDAwMDAwMDAwMDAwMiwwLjA0MzA5MDkwOTA5MDkwOTA5NixCYWN0ZXJpYSxrX0JhY3RlcmlhLGtfQmFjdGVyaWEsa19CYWN0ZXJpYSxrX0JhY3RlcmlhLGtfQmFjdGVyaWEKQVNWNTc1LDAuMDA0LDAuMDA1LDAsMC4wMDI2ODU3MTQyODU3MTQyODYsMC4wMjA0NDUwMjE2NDUwMjE2NDQsQmFjdGVyaWEsVmVycnVjb21pY3JvYmlvdGEsVmVycnVjb21pY3JvYmlhZSxQZWRvc3BoYWVyYWxlcyxQZWRvc3BoYWVyYWNlYWUsZl9QZWRvc3BoYWVyYWNlYWUKQVNWNTU4LDAsMC4wMDYsMC4wMDMsMC4wMDI2NjY2NjY2NjY2NjY2NjY2LDAuMDQ1NDE1MTUxNTE1MTUxNTEsQmFjdGVyaWEsQWNpZG9iYWN0ZXJpb3RhLFZpY2luYW1pYmFjdGVyaWEsVmljaW5hbWliYWN0ZXJhbGVzLG9fVmljaW5hbWliYWN0ZXJhbGVzLG9fVmljaW5hbWliYWN0ZXJhbGVzCkFTVjQ1NCwwLjAwMjY2NjY2NjY2NjY2NjY2NjYsMC4wMDEsMC4wMDQzMzMzMzMzMzMzMzMzMzMsMC4wMDI2MTkwNDc2MTkwNDc2MTksMC4wMzA5MTU4NzMwMTU4NzMwMSxCYWN0ZXJpYSxOQjEtaixwX05CMS1qLHBfTkIxLWoscF9OQjEtaixwX05CMS1qCkFTVjY4NiwwLDAuMDAxLDAuMDA2LDAuMDAyNiwwLjA0NTY3Nzc3Nzc3Nzc3Nzc3NSxCYWN0ZXJpYSxBY3Rpbm9iYWN0ZXJpb3RhLEFjdGlub2JhY3RlcmlhLEZyYW5raWFsZXMsQWNpZG90aGVybWFjZWFlLEFjaWRvdGhlcm11cwpBU1YxOTksMC4wMDYsMC4wMDEsMC4wMDIsMC4wMDI2LDAuMDQ1ODY2NjY2NjY2NjY2NjYsQmFjdGVyaWEsUGxhbmN0b215Y2V0b3RhLE9NMTkwLGNfT00xOTAsY19PTTE5MCxjX09NMTkwCkFTVjQxMiwwLjAwNyw2LjY2NjY2NjY2NjY2NjY2NmUtNCwwLjAwMiwwLjAwMjYsMC4wNTQxMDc5MzY1MDc5MzY1LEJhY3RlcmlhLFByb3Rlb2JhY3RlcmlhLEFscGhhcHJvdGVvYmFjdGVyaWEsQ2F1bG9iYWN0ZXJhbGVzLEh5cGhvbW9uYWRhY2VhZSxTV0IwMgpBU1YzMjQsMC4wMDI2NjY2NjY2NjY2NjY2NjY2LDAuMDAzNjY2NjY2NjY2NjY2NjY2NiwwLDAuMDAyNSwwLjA1Njc2NDIxMzU2NDIxMzU2NixCYWN0ZXJpYSxMYXRlc2NpYmFjdGVyb3RhLHBfTGF0ZXNjaWJhY3Rlcm90YSxwX0xhdGVzY2liYWN0ZXJvdGEscF9MYXRlc2NpYmFjdGVyb3RhLHBfTGF0ZXNjaWJhY3Rlcm90YQpBU1YxMjYsMC4wMDUzMzMzMzMzMzMzMzMzMzMsLTAuMDAxNjY2NjY2NjY2NjY2NjY2NiwwLjAwNSwwLjAwMjQ4MzMzMzMzMzMzMzMzMzUsMC4wNjE1NDEyNjk4NDEyNjk4NSxCYWN0ZXJpYSxBY2lkb2JhY3RlcmlvdGEsU3ViZ3JvdXBfNSxjX1N1Ymdyb3VwXzUsY19TdWJncm91cF81LGNfU3ViZ3JvdXBfNQo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_pime_filt_top_asvs.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-a89bca59ba4526b4224c" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a89bca59ba4526b4224c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"ASV_ID":["ASV114","ASV146","ASV39","ASV157","ASV488","ASV137","ASV340","ASV289","ASV918","ASV282","ASV861","ASV314","ASV508","ASV1035","ASV1426","ASV254","ASV410","ASV212","ASV134","ASV185","ASV64","ASV472","ASV575","ASV558","ASV454","ASV686","ASV199","ASV412","ASV324","ASV126"],"Control":[0.0027,0.0063,0.0027,0.003,0.01,0.002,0.0103,0.0087,0.002,0.002,0.01,0.008,-0.0007,0,0.005,0.001,0.007,0.002,0.004,0.002,0.0007,0.0025,0.004,0,0.0027,0,0.006,0.007,0.0027,0.0053],"Warm_3":[0.0027,0.0013,0.003,0.006,0,0.0017,0.002,0.003,0.01,0.003,0.0025,0.002,0.003,0.0037,0.002,0.003,0.001,0.004,0,0.0007,0.004,0.001,0.005,0.006,0.001,0.001,0.001,0.0007,0.0037,-0.0017],"Warm_8":[0.0133,0.013,0.01,0.0117,0.0055,0.011,0.002,0.0027,0.002,0.0078,0.0017,0.0027,0.0093,0.006,0.0017,0.005,0.001,0.001,0.006,0.006,0.0037,0.006,0,0.003,0.0043,0.006,0.002,0.002,0,0.005],"MeanDecreaseAccuracy":[0.0068,0.0067,0.0059,0.0058,0.0051,0.0047,0.0043,0.0039,0.0038,0.0037,0.0036,0.0036,0.0035,0.0032,0.0032,0.0032,0.0031,0.0031,0.003,0.003,0.003,0.0029,0.0027,0.0027,0.0026,0.0026,0.0026,0.0026,0.0025,0.0025],"MeanDecreaseGini":[0.1096,0.1228,0.0898,0.0871,0.0677,0.0841,0.0612,0.0523,0.0779,0.0467,0.0898,0.0723,0.0666,0.0338,0.0542,0.0532,0.1024,0.0442,0.0714,0.0828,0.0344,0.0431,0.0204,0.0454,0.0309,0.0457,0.0459,0.0541,0.0568,0.0615],"Kingdom":["Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria"],"Phylum":["Proteobacteria","Proteobacteria","Acidobacteriota","Verrucomicrobiota","Planctomycetota","Acidobacteriota","Planctomycetota","Verrucomicrobiota","Proteobacteria","Verrucomicrobiota","Actinobacteriota","Acidobacteriota","Chloroflexi","Chloroflexi","Bacteroidota","Proteobacteria","Desulfobacterota","Verrucomicrobiota","Proteobacteria","Proteobacteria","Acidobacteriota","k_Bacteria","Verrucomicrobiota","Acidobacteriota","NB1-j","Actinobacteriota","Planctomycetota","Proteobacteria","Latescibacterota","Acidobacteriota"],"Class":["Alphaproteobacteria","Gammaproteobacteria","Vicinamibacteria","Verrucomicrobiae","OM190","Subgroup_5","OM190","Verrucomicrobiae","Alphaproteobacteria","Verrucomicrobiae","Actinobacteria","Subgroup_22","Anaerolineae","Dehalococcoidia","Bacteroidia","Gammaproteobacteria","p_Desulfobacterota","Verrucomicrobiae","Alphaproteobacteria","Gammaproteobacteria","Thermoanaerobaculia","k_Bacteria","Verrucomicrobiae","Vicinamibacteria","p_NB1-j","Actinobacteria","OM190","Alphaproteobacteria","p_Latescibacterota","Subgroup_5"],"Order":["Rhizobiales","Burkholderiales","Vicinamibacterales","Chthoniobacterales","c_OM190","c_Subgroup_5","c_OM190","Chthoniobacterales","Rhizobiales","Pedosphaerales","Corynebacteriales","c_Subgroup_22","Anaerolineales","S085","Chitinophagales","Burkholderiales","p_Desulfobacterota","Pedosphaerales","Rhizobiales","Burkholderiales","Thermoanaerobaculales","k_Bacteria","Pedosphaerales","Vicinamibacterales","p_NB1-j","Frankiales","c_OM190","Caulobacterales","p_Latescibacterota","c_Subgroup_5"],"Family":["Xanthobacteraceae","Nitrosomonadaceae","o_Vicinamibacterales","Xiphinematobacteraceae","c_OM190","c_Subgroup_5","c_OM190","Xiphinematobacteraceae","Rhizobiaceae","Pedosphaeraceae","Mycobacteriaceae","c_Subgroup_22","Anaerolineaceae","o_S085","Chitinophagaceae","Sutterellaceae","p_Desulfobacterota","Pedosphaeraceae","Xanthobacteraceae","TRA3-20","Thermoanaerobaculaceae","k_Bacteria","Pedosphaeraceae","o_Vicinamibacterales","p_NB1-j","Acidothermaceae","c_OM190","Hyphomonadaceae","p_Latescibacterota","c_Subgroup_5"],"Genus":["f_Xanthobacteraceae","MND1","o_Vicinamibacterales","Candidatus_Xiphinematobacter","c_OM190","c_Subgroup_5","c_OM190","Candidatus_Xiphinematobacter","Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium","f_Pedosphaeraceae","Mycobacterium","c_Subgroup_22","f_Anaerolineaceae","o_S085","Edaphobaculum","f_Sutterellaceae","p_Desulfobacterota","ADurb.Bin063-1","f_Xanthobacteraceae","f_TRA3-20","Subgroup_10","k_Bacteria","f_Pedosphaeraceae","o_Vicinamibacterales","p_NB1-j","Acidothermus","c_OM190","SWB02","p_Latescibacterota","c_Subgroup_5"]},"columns":[{"accessor":"ASV_ID","name":"ASV ID","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["ASV114","ASV146","ASV39","ASV157","ASV488","ASV137","ASV340","ASV289","ASV918","ASV282","ASV861","ASV314","ASV508","ASV1035","ASV1426","ASV254","ASV410","ASV212","ASV134","ASV185","ASV64","ASV472","ASV575","ASV558","ASV454","ASV686","ASV199","ASV412","ASV324","ASV126"],"header":"ASV ID","minWidth":100,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Control","name":"Control","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0027","0.0063","0.0027","0.0030","0.0100","0.0020","0.0103","0.0087","0.0020","0.0020","0.0100","0.0080","-0.0007","0.0000","0.0050","0.0010","0.0070","0.0020","0.0040","0.0020","0.0007","0.0025","0.0040","0.0000","0.0027","0.0000","0.0060","0.0070","0.0027","0.0053"],"header":"Control","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Warm_3","name":"Warm_3","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0027","0.0013","0.0030","0.0060","0.0000","0.0017","0.0020","0.0030","0.0100","0.0030","0.0025","0.0020","0.0030","0.0037","0.0020","0.0030","0.0010","0.0040","0.0000","0.0007","0.0040","0.0010","0.0050","0.0060","0.0010","0.0010","0.0010","0.0007","0.0037","-0.0017"],"header":"Warm 3","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Warm_8","name":"Warm_8","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0133","0.0130","0.0100","0.0117","0.0055","0.0110","0.0020","0.0027","0.0020","0.0078","0.0017","0.0027","0.0093","0.0060","0.0017","0.0050","0.0010","0.0010","0.0060","0.0060","0.0037","0.0060","0.0000","0.0030","0.0043","0.0060","0.0020","0.0020","0.0000","0.0050"],"header":"Warm 8","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"MeanDecreaseAccuracy","name":"MeanDecreaseAccuracy","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0068","0.0067","0.0059","0.0058","0.0051","0.0047","0.0043","0.0039","0.0038","0.0037","0.0036","0.0036","0.0035","0.0032","0.0032","0.0032","0.0031","0.0031","0.0030","0.0030","0.0030","0.0029","0.0027","0.0027","0.0026","0.0026","0.0026","0.0026","0.0025","0.0025"],"header":"MeanDecreaseAccuracy","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"MeanDecreaseGini","name":"MeanDecreaseGini","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.1096","0.1228","0.0898","0.0871","0.0677","0.0841","0.0612","0.0523","0.0779","0.0467","0.0898","0.0723","0.0666","0.0338","0.0542","0.0532","0.1024","0.0442","0.0714","0.0828","0.0344","0.0431","0.0204","0.0454","0.0309","0.0457","0.0459","0.0541","0.0568","0.0615"],"header":"MeanDecreaseGini","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Kingdom","name":"Kingdom","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria","Bacteria"],"header":"Kingdom","minWidth":100,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Phylum","name":"Phylum","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["Proteobacteria","Proteobacteria","Acidobacteriota","Verrucomicrobiota","Planctomycetota","Acidobacteriota","Planctomycetota","Verrucomicrobiota","Proteobacteria","Verrucomicrobiota","Actinobacteriota","Acidobacteriota","Chloroflexi","Chloroflexi","Bacteroidota","Proteobacteria","Desulfobacterota","Verrucomicrobiota","Proteobacteria","Proteobacteria","Acidobacteriota","k_Bacteria","Verrucomicrobiota","Acidobacteriota","NB1-j","Actinobacteriota","Planctomycetota","Proteobacteria","Latescibacterota","Acidobacteriota"],"header":"Phylum","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Class","name":"Class","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["Alphaproteobacteria","Gammaproteobacteria","Vicinamibacteria","Verrucomicrobiae","OM190","Subgroup_5","OM190","Verrucomicrobiae","Alphaproteobacteria","Verrucomicrobiae","Actinobacteria","Subgroup_22","Anaerolineae","Dehalococcoidia","Bacteroidia","Gammaproteobacteria","p_Desulfobacterota","Verrucomicrobiae","Alphaproteobacteria","Gammaproteobacteria","Thermoanaerobaculia","k_Bacteria","Verrucomicrobiae","Vicinamibacteria","p_NB1-j","Actinobacteria","OM190","Alphaproteobacteria","p_Latescibacterota","Subgroup_5"],"header":"Class","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Order","name":"Order","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["Rhizobiales","Burkholderiales","Vicinamibacterales","Chthoniobacterales","c_OM190","c_Subgroup_5","c_OM190","Chthoniobacterales","Rhizobiales","Pedosphaerales","Corynebacteriales","c_Subgroup_22","Anaerolineales","S085","Chitinophagales","Burkholderiales","p_Desulfobacterota","Pedosphaerales","Rhizobiales","Burkholderiales","Thermoanaerobaculales","k_Bacteria","Pedosphaerales","Vicinamibacterales","p_NB1-j","Frankiales","c_OM190","Caulobacterales","p_Latescibacterota","c_Subgroup_5"],"header":"Order","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Family","name":"Family","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["Xanthobacteraceae","Nitrosomonadaceae","o_Vicinamibacterales","Xiphinematobacteraceae","c_OM190","c_Subgroup_5","c_OM190","Xiphinematobacteraceae","Rhizobiaceae","Pedosphaeraceae","Mycobacteriaceae","c_Subgroup_22","Anaerolineaceae","o_S085","Chitinophagaceae","Sutterellaceae","p_Desulfobacterota","Pedosphaeraceae","Xanthobacteraceae","TRA3-20","Thermoanaerobaculaceae","k_Bacteria","Pedosphaeraceae","o_Vicinamibacterales","p_NB1-j","Acidothermaceae","c_OM190","Hyphomonadaceae","p_Latescibacterota","c_Subgroup_5"],"header":"Family","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Genus","name":"Genus","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["f_Xanthobacteraceae","MND1","o_Vicinamibacterales","Candidatus_Xiphinematobacter","c_OM190","c_Subgroup_5","c_OM190","Candidatus_Xiphinematobacter","Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium","f_Pedosphaeraceae","Mycobacterium","c_Subgroup_22","f_Anaerolineaceae","o_S085","Edaphobaculum","f_Sutterellaceae","p_Desulfobacterota","ADurb.Bin063-1","f_Xanthobacteraceae","f_TRA3-20","Subgroup_10","k_Bacteria","f_Pedosphaeraceae","o_Vicinamibacterales","p_NB1-j","Acidothermus","c_OM190","SWB02","p_Latescibacterota","c_Subgroup_5"],"header":"Genus","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,30],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"b25b2792200a7084fe5f9480d9048713"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Here is a list of the top 30 ASVs.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ASV114"  "ASV146"  "ASV39"   "ASV157"  "ASV488"  "ASV137"  "ASV340" 
 [8] "ASV289"  "ASV918"  "ASV282"  "ASV861"  "ASV314"  "ASV508"  "ASV1035"
[15] "ASV1426" "ASV254"  "ASV410"  "ASV212"  "ASV134"  "ASV185"  "ASV64"  
[22] "ASV472"  "ASV575"  "ASV558"  "ASV454"  "ASV686"  "ASV199"  "ASV412" 
[29] "ASV324"  "ASV126" </code></pre>
</div>
</div>
<p>Now we need to create a phyloseq object of ASVs at this cutoff (<code>Prevalence 50</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_best_val</span> <span class="op">&lt;-</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">ssu18_best</span>, <span class="st">"Prevalence "</span>, <span class="st">""</span><span class="op">)</span>
<span class="va">ssu18_best_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_prevalences$"</span>, <span class="va">ssu18_best_val</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">ssu18_prevalence_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="op">(</span><span class="va">ssu18_best_val</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">ssu18_prevalence_best</span>, <span class="st">"files/filtering/pime/rdata/ssu18_prevalence_best.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And look at a summary of the phyloseq object.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1058 taxa and 15 samples ]
sample_data() Sample Data:       [ 15 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1058 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 5 | Summary of PERfect filtering using the decreased order and filtering p-values &lt; 0.05.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,TWV0cmljLEZ1bGwgZGF0YSxQSU1FIGZpbHRlcgpUb3RhbCBudW1iZXIgb2YgcmVhZHMsOTM2NjQwLDIzMjUzMgpNaW4uIG51bWJlciBvZiByZWFkcywyNTA4OCwxMDU4NQpNYXguIG51bWJlciBvZiByZWFkcyw4NjYwMCwxODM2MApBdmVyYWdlIG51bWJlciBvZiByZWFkcyw2MjQ0MywxNTUwMgpNZWRpYW4gbnVtYmVyIG9mIHJlYWRzLDYyMTE3LDE1NzgwClRvdGFsIEFTVnMsMjAxNzMsMTA1OApNaW4uIG51bWJlciBvZiBBU1ZzLDgxMywxNzAKTWF4LiBudW1iZXIgb2YgQVNWcywzMDY1LDY2NApBdmVyYWdlIG51bWJlciBvZiBBU1ZzLDIwNjMsNDU4Ck1lZGlhbiBudW1iZXIgb2YgQVNWcywyMTI0LDUwMgo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_perfect_filt_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-310482b1c81fa5f3e6de" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-310482b1c81fa5f3e6de">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Metric":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"Full data":[936640,25088,86600,62443,62117,20173,813,3065,2063,2124],"PIME filter":[232532,10585,18360,15502,15780,1058,170,664,458,502]},"columns":[{"accessor":"Metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"header":"Metric","minWidth":200,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Full data","name":"Full data","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["936640","25088","86600","62443","62117","20173","813","3065","2063","2124"],"header":"Full data","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PIME filter","name":"PIME filter","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["232532","10585","18360","15502","15780","1058","170","664","458","502"],"header":"PIME filter","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[5,10,10],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"502ddb466715551cddc6c876044b5de0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="estimate-error-in-prediction" class="level3"><h3 class="anchored" data-anchor-id="estimate-error-in-prediction">Estimate Error in Prediction</h3>
<p>Using the function <code>pime.error.prediction</code> we can estimate the error in prediction. For each prevalence interval, this function randomizes the samples labels into arbitrary groupings using <code>n</code> random permutations, defined by the <code>bootstrap</code> value. For each, randomized and prevalence filtered, data set the OOB error rate is calculated to estimate whether the original differences in groups of samples occur by chance. Results are in a list containing a table and a box plot summarizing the results.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_randomized</span> <span class="op">&lt;-</span> <span class="fu">pime.error.prediction</span><span class="op">(</span><span class="va">ssu18_pime_ds</span>, <span class="st">"TEMP"</span>,
                                          bootstrap <span class="op">=</span> <span class="fl">100</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>,
                                          max.prev <span class="op">=</span> <span class="fl">95</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 8 | Results of 100 random permutations for each prevalence interval based on a function that randomizes the samples labels into arbitrary groupings. using n random permutations. For each randomized and prevalence filtered data set, the OOB error rate is calculated to estimate whether the original differences in groups of samples occur by chance. </strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,UHJldmFsZW5jZTUlLFByZXZhbGVuY2UxMCUsUHJldmFsZW5jZTE1JSxQcmV2YWxlbmNlMjAlLFByZXZhbGVuY2UyNSUsUHJldmFsZW5jZTMwJSxQcmV2YWxlbmNlMzUlLFByZXZhbGVuY2U0MCUsUHJldmFsZW5jZTQ1JSxQcmV2YWxlbmNlNTAlLFByZXZhbGVuY2U1NSUsUHJldmFsZW5jZTYwJSxQcmV2YWxlbmNlNjUlLFByZXZhbGVuY2U3MCUsUHJldmFsZW5jZTc1JSxQcmV2YWxlbmNlODAlLFByZXZhbGVuY2U4NSUsUHJldmFsZW5jZTkwJSxQcmV2YWxlbmNlOTUlCjAuMzMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDEsMC44NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMsMSwwLjY2NjY2NjY2NjY2NjY2NjYsMSwwLjkzMzMzMzMzMzMzMzMzMzMsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuNgowLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjQsMC40NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjgKMC43MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjgsMC45MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMC44LDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC44LDAuOCwwLjYsMSwwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjg2NjY2NjY2NjY2NjY2NjcsMSwwLjYKMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjgsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC40CjAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC4zMzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjQsMC4zMzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjg2NjY2NjY2NjY2NjY2NjcsMC42LDAuMzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjgsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjYsMC44LDAuODY2NjY2NjY2NjY2NjY2NwowLjg2NjY2NjY2NjY2NjY2NjcsMC45MzMzMzMzMzMzMzMzMzMzLDAuNCwwLjQsMC40NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMSwwLjg2NjY2NjY2NjY2NjY2NjcsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC42LDAuOCwwLjkzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzCjAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC44LDAuODY2NjY2NjY2NjY2NjY2NywwLjYsMC44LDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjg2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDEsMC43MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjYsMC44LDAuNCwwLjQ2NjY2NjY2NjY2NjY2NjcKMC44LDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjgsMSwwLjkzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDEsMC41MzMzMzMzMzMzMzMzMzMzLDAuNCwwLjgsMC44LDAuOCwwLjYsMC42LDAuODY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMKMC42LDAuMzMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC4zMzMzMzMzMzMzMzMzMzMzLDEsMC40NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjkzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC45MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMwowLjczMzMzMzMzMzMzMzMzMzMsMC40LDAuMzMzMzMzMzMzMzMzMzMzMywwLjYsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcKMC42LDAuNTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjgsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC40CjAuNzMzMzMzMzMzMzMzMzMzMywwLjgsMC44LDAuMjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjgsMC43MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjczMzMzMzMzMzMzMzMzMzMKMC40NjY2NjY2NjY2NjY2NjY3LDAuOTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC43MzMzMzMzMzMzMzMzMzMzLDEsMC40NjY2NjY2NjY2NjY2NjY3LDAuMzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjkzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC44LDAuMgowLjczMzMzMzMzMzMzMzMzMzMsMC44LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMSwwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjgsMC44LDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC44CjAuNTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMSwwLjQKMC40LDAuOTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjczMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC44LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNzMzMzMzMzMzMzMzMzMzMywwLjgsMC41MzMzMzMzMzMzMzMzMzMzCjAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjQsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuMjY2NjY2NjY2NjY2NjY2NjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjQsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjQKMC41MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMSwwLjUzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjg2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMwowLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywxLDAuNTMzMzMzMzMzMzMzMzMzMywwLjMzMzMzMzMzMzMzMzMzMzMsMSwwLjkzMzMzMzMzMzMzMzMzMzMsMC42LDAuNTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNgowLjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjg2NjY2NjY2NjY2NjY2NjcsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuODY2NjY2NjY2NjY2NjY2NywwLjYsMSwwLjQ2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3CjAuODY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC42LDAuNiwwLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNCwwLjg2NjY2NjY2NjY2NjY2NjcsMC44LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NgowLjgsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywxLDAuOTMzMzMzMzMzMzMzMzMzMywwLjgsMC42CjAuOCwwLjYsMC40LDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuOTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNCwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NgowLjgsMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjg2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNCwwLjUzMzMzMzMzMzMzMzMzMzMKMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC42LDAuNCwwLjUzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDEsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNgoxLDAuODY2NjY2NjY2NjY2NjY2NywwLjQsMC45MzMzMzMzMzMzMzMzMzMzLDEsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjQsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC42LDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDAuOCwwLjQsMC40LDAuNAowLjY2NjY2NjY2NjY2NjY2NjYsMSwwLjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNCwwLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjg2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjI2NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuOCwwLjQsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NwowLjUzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNCwwLjYsMC42LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC42NjY2NjY2NjY2NjY2NjY2LDAuMzMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMKMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC42LDAuODY2NjY2NjY2NjY2NjY2NywwLjQsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMQowLjkzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNCwwLjQ2NjY2NjY2NjY2NjY2NjcsMC42LDAuNiwxLDAuNTMzMzMzMzMzMzMzMzMzMywwLjYsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC42LDAuODY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzCjAuOCwwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDAuNiwwLjkzMzMzMzMzMzMzMzMzMzMsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuMzMzMzMzMzMzMzMzMzMzMwoxLDAuNDY2NjY2NjY2NjY2NjY2NywwLjkzMzMzMzMzMzMzMzMzMzMsMC44LDAuOCwwLjczMzMzMzMzMzMzMzMzMzMsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC4zMzMzMzMzMzMzMzMzMzMzCjAuNiwwLjYsMSwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjQsMC42NjY2NjY2NjY2NjY2NjY2LDEsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2CjAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDEsMC40NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuOTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjQsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMKMC42LDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuMzMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMC40LDAuNCwwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuNCwwLjgsMC40NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC42LDAuOTMzMzMzMzMzMzMzMzMzMywwLjYsMC43MzMzMzMzMzMzMzMzMzMzCjEsMC40NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjQsMSwxLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuMzMzMzMzMzMzMzMzMzMzMywwLjYsMC42LDAuNiwwLjgsMC42LDAuOAowLjQ2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNiwxLDAuNzMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuMzMzMzMzMzMzMzMzMzMzMywwLjQsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzCjAuOTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC45MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjkzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuMzMzMzMzMzMzMzMzMzMzMywxLDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC4yNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDAuNTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2CjAuNDY2NjY2NjY2NjY2NjY2NywwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjczMzMzMzMzMzMzMzMzMzMsMC45MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjQsMC44LDAuNjY2NjY2NjY2NjY2NjY2NgowLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjI2NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC45MzMzMzMzMzMzMzMzMzMzLDAuNCwwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzCjAuNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNiwwLjg2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNgowLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuOCwwLjgsMC42LDAuOCwwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC44LDAuNiwwLjkzMzMzMzMzMzMzMzMzMzMsMC42LDAuNTMzMzMzMzMzMzMzMzMzMywwLjYKMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjgsMC43MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMQowLjQsMSwwLjczMzMzMzMzMzMzMzMzMzMsMC42LDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjQ2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC40LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2CjAuODY2NjY2NjY2NjY2NjY2NywwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjg2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuOTMzMzMzMzMzMzMzMzMzMywwLjYsMSwwLjgsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMKMC40LDAuNzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDEsMC45MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC45MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjgsMC43MzMzMzMzMzMzMzMzMzMzLDAuNgowLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC4zMzMzMzMzMzMzMzMzMzMzLDAuMzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuOCwwLjQsMC44LDAuNTMzMzMzMzMzMzMzMzMzMywwLjMzMzMzMzMzMzMzMzMzMzMsMC44LDAuNCwwLjkzMzMzMzMzMzMzMzMzMzMsMC44LDAuNDY2NjY2NjY2NjY2NjY2NywwLjYKMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjUzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuODY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuMzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjkzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC42CjAuNTMzMzMzMzMzMzMzMzMzMywwLjMzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDEsMC41MzMzMzMzMzMzMzMzMzMzLDAuMzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDEsMC40LDAuNTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42CjAuNzMzMzMzMzMzMzMzMzMzMywwLjgsMC45MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC44LDAuNDY2NjY2NjY2NjY2NjY2NywwLjI2NjY2NjY2NjY2NjY2NjY2LDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjkzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjkzMzMzMzMzMzMzMzMzMzMsMC40LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjUzMzMzMzMzMzMzMzMzMzMKMC40LDAuOCwwLjkzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuODY2NjY2NjY2NjY2NjY2NywwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42LDAuOCwwLjgsMC42NjY2NjY2NjY2NjY2NjY2CjAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjkzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNCwwLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NgowLjYsMC40LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMSwwLjQ2NjY2NjY2NjY2NjY2NjcsMC45MzMzMzMzMzMzMzMzMzMzCjAuNiwwLjQsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42LDAuNCwwLjg2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjgsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjg2NjY2NjY2NjY2NjY2NjcsMC44LDAuNjY2NjY2NjY2NjY2NjY2NgowLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDEsMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjkzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjYsMC44CjAuNTMzMzMzMzMzMzMzMzMzMywwLjgsMC40LDAuMzMzMzMzMzMzMzMzMzMzMywwLjgsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNCwwLjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNjY2NjY2NjY2NjY2NjY2NgowLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwxLDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuMzMzMzMzMzMzMzMzMzMzMywwLjgsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC40LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC40LDAuOCwwLjczMzMzMzMzMzMzMzMzMzMsMC44CjAuOTMzMzMzMzMzMzMzMzMzMywwLjQsMC44NjY2NjY2NjY2NjY2NjY3LDEsMC43MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC44LDAuODY2NjY2NjY2NjY2NjY2NywwLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjMzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNzMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjczMzMzMzMzMzMzMzMzMzMKMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDEsMSwwLjUzMzMzMzMzMzMzMzMzMzMsMSwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjgsMC44CjAuNTMzMzMzMzMzMzMzMzMzMywwLjYsMC44LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjg2NjY2NjY2NjY2NjY2NjcsMSwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjg2NjY2NjY2NjY2NjY2NjcsMC42LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjMzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjkzMzMzMzMzMzMzMzMzMzMsMC44LDAuNiwwLjYKMC44NjY2NjY2NjY2NjY2NjY3LDAuOTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjkzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC42CjAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42LDAuODY2NjY2NjY2NjY2NjY2NywwLjQsMC42LDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuODY2NjY2NjY2NjY2NjY2NywwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMwowLjg2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjQsMC42LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNTMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjUzMzMzMzMzMzMzMzMzMzMKMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjkzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDAuOCwwLjUzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3CjAuNCwwLjY2NjY2NjY2NjY2NjY2NjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuMzMzMzMzMzMzMzMzMzMzMywwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuOCwwLjQsMC44NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMwowLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDEsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjI2NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDAuNDY2NjY2NjY2NjY2NjY2NwowLjQsMC43MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjQsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDEsMC41MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzCjAuNDY2NjY2NjY2NjY2NjY2NywwLjYsMC40LDAuNTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC44LDEsMC44NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywxLDAuOTMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjYsMC42CjAuOCwxLDAuNzMzMzMzMzMzMzMzMzMzMywwLjgsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjQsMC45MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywxLDAuNCwwLjg2NjY2NjY2NjY2NjY2NjcsMSwwLjczMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNDY2NjY2NjY2NjY2NjY2NwowLjkzMzMzMzMzMzMzMzMzMzMsMSwwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMSwwLjUzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjkzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywxLDAuNiwwLjMzMzMzMzMzMzMzMzMzMzMKMC42LDAuODY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC40LDAuOCwwLjQsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjQsMC44LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC40LDAuNCwwLjYsMC44CjAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNCwwLjQsMC44LDAuMzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC42LDAuMjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuODY2NjY2NjY2NjY2NjY2NywwLjQsMC4zMzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcKMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjQsMC44LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjQsMC44NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDEsMC42NjY2NjY2NjY2NjY2NjY2LDAuMzMzMzMzMzMzMzMzMzMzMwowLjQsMSwwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuOCwxLDAuNzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC42LDAuOTMzMzMzMzMzMzMzMzMzMywwLjgsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NwowLjY2NjY2NjY2NjY2NjY2NjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDEsMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywxLDAuOCwwLjUzMzMzMzMzMzMzMzMzMzMsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNgowLjkzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDEsMC44LDAuNTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDEsMC42LDAuODY2NjY2NjY2NjY2NjY2NwowLjgsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNCwwLjczMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjgsMC42NjY2NjY2NjY2NjY2NjY2LDAuNTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMKMC43MzMzMzMzMzMzMzMzMzMzLDAuNCwwLjQ2NjY2NjY2NjY2NjY2NjcsMC42LDAuNCwxLDAuMzMzMzMzMzMzMzMzMzMzMywwLjQsMC44NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwxLDAuNiwxLDAuNTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMQowLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjg2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuMjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzCjAuOCwwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMSwwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjg2NjY2NjY2NjY2NjY2NjcsMC40LDAuNiwwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjY2NjY2NjY2NjY2NjY2NjYKMC45MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjQsMC44LDAuODY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC42LDAuNCwwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2CjAuNjY2NjY2NjY2NjY2NjY2NiwwLjkzMzMzMzMzMzMzMzMzMzMsMC40LDAuNTMzMzMzMzMzMzMzMzMzMywwLjQsMC40NjY2NjY2NjY2NjY2NjY3LDAuNCwwLjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjczMzMzMzMzMzMzMzMzMzMsMC42LDAuNiwwLjgsMC42NjY2NjY2NjY2NjY2NjY2LDAuODY2NjY2NjY2NjY2NjY2NywwLjgsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMwowLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNCwwLjg2NjY2NjY2NjY2NjY2NjcsMC4zMzMzMzMzMzMzMzMzMzMzLDAuOCwwLjgsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC42LDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcKMC44NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjQ2NjY2NjY2NjY2NjY2NjcsMC45MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywxLDAuNjY2NjY2NjY2NjY2NjY2NiwxLDAuNzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC40LDAuNDY2NjY2NjY2NjY2NjY2NywwLjYKMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjgsMC42NjY2NjY2NjY2NjY2NjY2LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjQsMC44NjY2NjY2NjY2NjY2NjY3LDAuODY2NjY2NjY2NjY2NjY2NywwLjgsMC42LDAuNzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuNCwwLjkzMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3CjAuOTMzMzMzMzMzMzMzMzMzMywwLjgsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjYsMC42LDAuNiwwLjgsMC4zMzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjgsMC44LDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuOCwwLjg2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NgowLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjgsMC44LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuNCwwLjczMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC41MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjYKMC44NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywxLDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC44LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42LDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC4yNjY2NjY2NjY2NjY2NjY2NiwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjg2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuOTMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYKMC42LDAuNiwwLjczMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC4zMzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjQsMC43MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjYsMC45MzMzMzMzMzMzMzMzMzMzCjAuNiwwLjczMzMzMzMzMzMzMzMzMzMsMC40NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjgsMC40LDAuOTMzMzMzMzMzMzMzMzMzMywwLjgsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjY2NjY2NjY2NjY2NjY2NjYsMC41MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMwowLjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC41MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjQsMC45MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC40LDAuNTMzMzMzMzMzMzMzMzMzMywwLjYsMC42LDAuNDY2NjY2NjY2NjY2NjY2NywwLjgsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjgKMC40NjY2NjY2NjY2NjY2NjY3LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjczMzMzMzMzMzMzMzMzMzMsMC44LDAuNTMzMzMzMzMzMzMzMzMzMywwLjQsMC43MzMzMzMzMzMzMzMzMzMzLDAuODY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuOCwwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuMzMzMzMzMzMzMzMzMzMzMywwLjYsMC42LDAuNTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzCjAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNzMzMzMzMzMzMzMzMzMzMywwLjY2NjY2NjY2NjY2NjY2NjYsMC44LDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC45MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC40LDAuNiwwLjYsMC45MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NwowLjY2NjY2NjY2NjY2NjY2NjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjg2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNTMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjgsMC45MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywxCjAuNzMzMzMzMzMzMzMzMzMzMywwLjQ2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuOCwwLjQ2NjY2NjY2NjY2NjY2NjcsMC44LDAuOTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC41MzMzMzMzMzMzMzMzMzMzLDAuNDY2NjY2NjY2NjY2NjY2NywwLjkzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC42NjY2NjY2NjY2NjY2NjY2LDAuNTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC44LDAuNgowLjgsMC40LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNzMzMzMzMzMzMzMzMzMzMywwLjMzMzMzMzMzMzMzMzMzMzMsMSwwLjczMzMzMzMzMzMzMzMzMzMsMC4zMzMzMzMzMzMzMzMzMzMzLDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcsMC40NjY2NjY2NjY2NjY2NjY3LDAuNzMzMzMzMzMzMzMzMzMzMywwLjkzMzMzMzMzMzMzMzMzMzMsMC43MzMzMzMzMzMzMzMzMzMzLDAuNTMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC42CjAuOCwwLjYsMC44LDAuNiwwLjMzMzMzMzMzMzMzMzMzMzMsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjg2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuNiwwLjQsMC44LDAuODY2NjY2NjY2NjY2NjY2NwowLjQ2NjY2NjY2NjY2NjY2NjcsMC42NjY2NjY2NjY2NjY2NjY2LDAuOTMzMzMzMzMzMzMzMzMzMywwLjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNiwwLjQ2NjY2NjY2NjY2NjY2NjcsMSwwLjY2NjY2NjY2NjY2NjY2NjYsMC40NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2NywwLjQ2NjY2NjY2NjY2NjY2NjcsMC43MzMzMzMzMzMzMzMzMzMzLDAuNzMzMzMzMzMzMzMzMzMzMywxLDAuNzMzMzMzMzMzMzMzMzMzMywwLjg2NjY2NjY2NjY2NjY2NjcsMC42LDAuODY2NjY2NjY2NjY2NjY2NwowLjgsMC4zMzMzMzMzMzMzMzMzMzMzLDAuOTMzMzMzMzMzMzMzMzMzMywwLjczMzMzMzMzMzMzMzMzMzMsMC40LDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMC42NjY2NjY2NjY2NjY2NjY2LDAuNjY2NjY2NjY2NjY2NjY2NiwwLjY2NjY2NjY2NjY2NjY2NjYsMC43MzMzMzMzMzMzMzMzMzMzLDAuNiwxLDAuODY2NjY2NjY2NjY2NjY2NywwLjY2NjY2NjY2NjY2NjY2NjYsMSwwLjgsMC42LDAuMjY2NjY2NjY2NjY2NjY2NjYKMC42NjY2NjY2NjY2NjY2NjY2LDAuODY2NjY2NjY2NjY2NjY2NywwLjczMzMzMzMzMzMzMzMzMzMsMC40LDAuNzMzMzMzMzMzMzMzMzMzMywwLjUzMzMzMzMzMzMzMzMzMzMsMC45MzMzMzMzMzMzMzMzMzMzLDAuNjY2NjY2NjY2NjY2NjY2NiwwLjgsMC42NjY2NjY2NjY2NjY2NjY2LDAuNjY2NjY2NjY2NjY2NjY2NiwxLDAuOCwwLjQ2NjY2NjY2NjY2NjY2NjcsMC44NjY2NjY2NjY2NjY2NjY3LDAuNiwwLjY2NjY2NjY2NjY2NjY2NjYsMC44NjY2NjY2NjY2NjY2NjY3LDAuNDY2NjY2NjY2NjY2NjY2Nwo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_pime_est_error.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-d7627313e1f875eb2a94" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d7627313e1f875eb2a94">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Prevalence5%":[0.3333,0.6,0.7333,0.6,0.6667,0.8667,0.4667,0.8,0.6,0.7333,0.6,0.7333,0.4667,0.7333,0.5333,0.4,0.6667,0.5333,0.6,0.6,0.8667,0.8,0.8,0.8,0.8,1,0.6667,0.5333,0.5333,0.9333,0.8,1,0.6,0.6667,0.6,1,0.4667,0.9333,0.4667,0.7333,0.6667,0.5333,0.7333,0.4,0.8667,0.4,0.6,0.5333,0.5333,0.7333,0.4,0.6667,0.6,0.6,0.5333,0.5333,0.6,0.9333,0.7333,0.5333,0.8667,0.4667,0.8667,0.5333,0.4,0.6,0.4,0.4667,0.8,0.9333,0.6,0.4667,0.5333,0.4,0.6667,0.9333,0.8,0.7333,0.7333,0.8,0.9333,0.6667,0.8667,0.8667,0.6,0.9333,0.5333,0.8667,0.6,0.6,0.6,0.4667,0.6,0.6667,0.7333,0.8,0.8,0.4667,0.8,0.6667],"Prevalence10%":[0.9333,0.5333,0.6,0.4667,0.7333,0.9333,0.8,0.8,0.3333,0.4,0.5333,0.8,0.9333,0.8,0.4667,0.9333,0.7333,0.7333,0.5333,0.9333,0.7333,0.6,0.6,0.7333,0.7333,0.8667,1,0.4667,0.4667,0.5333,0.5333,0.4667,0.6,0.7333,0.6,0.4667,0.4667,0.4667,0.6,0.6667,0.5333,0.6667,0.6667,1,0.6,0.7333,0.7333,0.8,0.3333,0.8,0.8,0.8,0.4,0.4,0.5333,0.8,0.5333,0.4,0.8667,0.6,0.9333,0.4667,0.5333,0.6667,0.6667,0.5333,0.7333,0.6,1,1,0.8667,0.5333,0.8667,1,0.9333,0.4667,0.4667,0.4,0.6667,0.6,0.8,0.9333,0.7333,0.8,0.7333,0.8,0.5333,0.5333,0.6,0.7333,0.4667,0.6667,0.6667,0.4667,0.4667,0.4,0.6,0.6667,0.3333,0.8667],"Prevalence15%":[0.6,0.4667,0.8,0.4667,0.3333,0.4,0.8,0.6667,0.7333,0.3333,0.6667,0.8,0.6667,0.6667,0.6667,0.5333,0.7333,0.5333,0.6667,0.6667,0.6,0.6667,0.4,0.6667,0.6667,0.4,0.6,0.4,0.8,0.4,0.5333,0.9333,1,0.4667,0.4667,0.6,0.6,0.9333,0.6667,0.6667,0.6667,0.6,0.5333,0.7333,0.6667,0.6667,0.7333,0.5333,0.6667,0.9333,0.9333,0.6667,0.6667,0.6,1,0.4,0.6667,0.8667,0.5333,0.8,0.4667,0.6,0.4667,0.4667,0.9333,0.6,0.7333,0.4,0.7333,0.8,0.4667,0.4667,0.6667,0.6667,0.7333,0.4667,0.4667,0.4667,0.4667,0.6667,0.6,0.4,0.6667,0.4667,0.8,0.7333,0.4667,1,0.7333,0.4667,0.5333,0.7333,0.6667,0.8,0.8667,0.6667,0.8,0.9333,0.9333,0.7333],"Prevalence20%":[0.7333,0.4,0.9333,0.6667,0.8667,0.4,0.8667,0.8,0.3333,0.6,0.8,0.2667,0.4667,0.6667,0.6,0.7333,0.4667,1,0.4667,0.8667,0.6,0.5333,0.8,0.6667,0.7333,0.9333,0.4667,0.6,0.8667,0.4667,0.8667,0.8,0.6667,1,0.6667,0.4,1,0.8,0.6,0.6,0.8,0.6,0.6,0.6,0.6,0.6,0.6667,0.7333,1,0.9333,0.6667,0.4667,0.6,0.6667,0.7333,0.3333,1,1,0.6,0.6667,0.4667,0.8667,0.4,0.7333,0.9333,0.8667,0.4,0.5333,0.8,0.8667,0.4,0.4,0.9333,0.8667,0.6667,0.5333,0.6667,0.6,0.7333,0.8,0.9333,0.5333,0.6,0.9333,0.6667,0.5333,0.5333,0.4667,0.6667,0.5333,0.4667,0.8,0.7333,0.8667,0.8,0.6667,0.6,0.6,0.7333,0.4],"Prevalence25%":[0.5333,0.4667,0.7333,0.6667,0.4,0.4667,0.6,0.9333,1,0.6,0.9333,0.6,0.4667,0.8,0.6667,0.8,0.4,0.5333,0.4667,0.7333,0.6,0.5333,0.6667,0.6667,0.6667,1,0.4,0.6,0.8667,0.6,0.5333,0.8,0.5333,0.4667,0.3333,1,0.7333,0.9333,0.7333,0.6,0.6667,0.6667,0.4667,0.6,0.8667,0.6667,0.3333,0.5333,0.5333,0.7333,0.8667,0.9333,0.4667,0.6667,0.8667,0.8,0.4667,0.7333,0.7333,0.8667,0.6,0.4,0.6,0.8,0.9333,0.7333,0.5333,0.7333,0.8,0.8667,0.8,0.4,0.4667,0.8,0.5333,0.8667,0.8,0.4,0.5333,0.6667,0.6,0.4,0.6667,0.4667,0.6667,0.6,0.5333,0.8,0.4667,0.8,0.5333,0.5333,0.6667,0.4667,0.4667,0.6667,0.3333,0.6667,0.4,0.7333],"Prevalence30%":[0.6,0.7333,0.9333,0.6,0.3333,0.6667,0.8,0.8,0.4667,0.4667,0.7333,0.5333,0.6667,0.7333,0.6,0.7333,0.8,0.8667,0.5333,0.6667,0.5333,0.5333,0.6667,0.6,0.8,0.8,0.8667,0.6,0.5333,0.6,0.6667,0.7333,0.4667,0.8667,0.9333,1,0.7333,0.8667,0.6667,0.7333,0.5333,0.8,0.8,0.5333,0.5333,0.4667,0.3333,0.6667,0.3333,0.8,0.8,0.7333,0.6667,0.6,0.5333,0.5333,0.7333,0.7333,0.8667,1,0.6667,0.6,0.6,0.9333,0.8667,1,0.5333,0.8,0.9333,0.8667,0.4,0.8,0.4,1,1,0.5333,0.4,1,0.6667,0.7333,0.4,0.4667,0.4,0.5333,0.6,0.6,0.5333,0.8,0.7333,0.4,0.9333,0.4,0.8,0.5333,0.8,0.7333,0.8667,0.6,0.8667,0.5333],"Prevalence35%":[1,0.6667,0.8,0.9333,0.6667,0.6,0.4667,1,0.6667,0.5333,0.5333,0.6667,0.7333,0.9333,0.7333,0.4667,0.7333,0.8,1,0.8667,0.4,0.7333,0.9333,0.6667,0.6,0.9333,0.7333,0.6667,0.6667,1,0.4667,0.6,0.4667,0.7333,0.4,0.6667,0.4667,0.6667,0.6,0.2667,0.6667,0.8,0.8,0.7333,0.9333,0.5333,0.6667,0.6667,0.5333,0.4667,0.8667,0.8,0.8,0.4667,0.7333,0.6667,0.5333,0.8667,0.8667,0.6667,0.5333,0.6,0.6667,0.5333,0.3333,0.5333,0.6667,1,0.4,0.4667,0.8667,0.3333,0.8,0.7333,0.7333,0.5333,0.7333,0.3333,0.8,0.9333,0.8,0.4,0.8667,0.4667,0.4667,0.6,0.8,0.6,0.5333,0.9333,0.4,0.7333,0.7333,0.9333,0.9333,0.3333,0.6,0.4667,0.6667,0.9333],"Prevalence40%":[0.8667,0.8,0.6,0.6,0.8667,0.8667,0.5333,0.9333,0.9333,0.7333,0.9333,0.8,1,1,0.6667,0.7333,0.4667,0.8667,0.5333,0.6,0.8667,0.6,0.6667,0.7333,0.4,0.4,0.6667,0.5333,0.5333,0.5333,0.5333,0.6667,0.6,0.5333,0.4,0.7333,0.8667,0.5333,0.7333,0.6,0.5333,0.6,0.9333,0.8,0.8667,1,0.6,0.8667,0.4,0.2667,0.4667,0.7333,0.8667,0.4667,0.8667,0.8,0.3333,0.8,1,0.5333,0.4667,0.5333,0.6,0.9333,0.6,0.6667,0.6,0.8667,0.9333,0.8667,0.6,0.6667,0.4667,0.4667,0.6667,0.6667,0.4667,0.4,0.8667,0.8667,0.8667,0.6,0.3333,0.4667,0.8667,0.8,0.8,0.6667,0.4667,0.8,0.9333,0.8667,0.8667,0.5333,0.5333,1,0.6667,1,0.6667,0.6667],"Prevalence45%":[0.6667,0.7333,0.5333,0.8,0.6,0.7333,0.5333,0.5333,0.7333,0.7333,0.8,0.7333,0.4667,0.6667,0.5333,0.8667,0.5333,0.4667,0.3333,0.4667,0.8,0.7333,0.6,0.9333,0.5333,0.6,0.8667,0.8,0.5333,0.6,0.4,0.7333,0.4667,0.9333,0.8,0.6667,0.6667,0.7333,0.9333,0.6667,0.6,0.8,0.4667,0.4667,0.6667,0.9333,0.8,0.8667,1,0.7333,0.7333,0.5333,0.8,0.6,0.8667,0.5333,0.8,0.8667,1,0.8,0.9333,0.4,0.7333,0.6667,0.7333,0.2667,1,0.7333,0.4667,0.7333,0.4,0.6,0.4667,0.6667,0.6,1,0.8,0.8667,0.6,1,0.7333,0.8667,0.8,0.6667,0.4,0.3333,0.6667,0.6,0.7333,0.6,0.9333,0.4667,0.9333,0.9333,0.5333,0.7333,0.4667,0.6667,0.6667,0.8],"Prevalence50%":[0.5333,0.7333,0.8,0.6667,0.3333,0.5333,0.8,1,0.4667,0.6,0.4667,0.8,0.3333,0.6,0.6667,0.8,0.6,0.6,1,0.6,0.6667,0.6,0.6667,0.8667,0.4667,0.7333,0.8667,0.6,0.4667,0.6,0.6,0.5333,0.8,0.6,0.8667,0.7333,0.8,0.3333,0.7333,0.8667,0.4667,0.5333,0.8667,0.5333,0.4667,0.8667,0.4,0.4667,0.4,0.6,0.8667,0.5333,0.7333,0.4,0.5333,0.8,0.5333,0.6,0.5333,0.8667,0.7333,0.6667,0.8667,0.4667,0.6,0.4667,0.5333,0.4667,1,1,0.8,0.4667,0.5333,0.4667,0.5333,0.8,0.8,0.6667,0.8667,0.7333,0.4667,0.6,0.8,0.8,0.8667,0.7333,0.6,0.8667,0.3333,0.4667,0.4667,0.7333,0.4667,0.8,0.4667,0.3333,0.6,0.4667,0.6667,0.6667],"Prevalence55%":[1,0.5333,0.8,0.6,0.4667,1,0.8667,0.5333,0.8667,0.7333,0.4667,0.7333,0.4667,0.6667,0.5333,0.6667,0.5333,0.5333,0.9333,0.7333,0.8,0.7333,0.4667,0.8667,1,0.6,0.8,0.5333,0.7333,0.7333,0.9333,0.8,0.7333,0.6667,0.4,0.4667,0.5333,1,0.6,0.6,0.4667,0.5333,0.8667,0.6,0.6667,0.5333,0.8,0.3333,0.5333,0.5333,0.5333,0.9333,0.5333,0.8667,0.8667,0.6667,0.4667,0.5333,1,0.6,0.6667,0.4667,0.6667,0.4667,0.6667,0.6667,0.6,0.7333,0.4,0.5333,0.6,0.8,0.8667,0.4667,0.5333,0.5333,0.6667,0.4667,0.8667,0.5333,0.7333,0.7333,0.8,0.7333,0.8667,0.8,0.7333,0.6667,0.4667,0.4667,0.4,0.8,0.6667,0.9333,0.9333,0.6,0.8667,0.4667,0.7333,0.6667],"Prevalence60%":[0.6667,0.4667,0.6,0.6667,0.6,0.8667,0.5333,0.4,0.9333,0.5333,0.6667,0.4667,0.6667,0.4,0.4667,0.6,0.5333,0.5333,0.6,0.8,0.4667,0.9333,0.5333,0.8,0.5333,0.6,0.2667,0.5333,0.7333,0.4667,0.6,0.8667,0.5333,0.9333,0.8,0.8,0.7333,0.7333,0.6667,0.4667,0.8667,0.8667,0.8,0.5333,0.6667,0.6,0.5333,0.5333,0.5333,0.4667,0.8,0.5333,0.5333,0.4667,0.8667,0.8667,0.8667,0.7333,0.6667,0.6667,0.4667,0.8,0.5333,0.6667,0.6667,0.8667,0.6,0.8667,0.8667,0.7333,0.6667,0.6,0.4,0.6667,1,0.4667,0.5333,0.8667,0.6,0.4667,0.6,0.6,0.9333,1,0.8,0.8,0.4,0.2667,0.4,0.7333,0.5333,0.4667,0.9333,0.7333,0.7333,0.4667,0.8667,0.4667,0.6,1],"Prevalence65%":[1,0.6667,1,0.5333,0.7333,0.6,1,0.8,0.9333,0.7333,0.6,0.5333,0.6,0.7333,0.6,0.9333,0.2667,0.6,0.5333,0.6667,0.4667,0.5333,0.8,0.6,0.8667,0.6,0.4667,0.5333,0.6,0.7333,0.4667,0.7333,0.4,0.6667,0.4667,0.3333,0.7333,0.8667,0.6667,0.9333,0.8667,0.5333,0.7333,0.4,0.9333,0.6,0.3333,0.6,0.5333,0.9333,0.8667,0.5333,0.7333,0.5333,0.5333,0.4,0.4,0.3333,0.5333,0.3333,0.8,0.8667,0.8667,0.7333,0.4667,0.5333,0.7333,1,1,0.8667,0.8,0.2667,0.8667,0.4667,0.8,0.6667,0.5333,0.6,0.6,0.8667,0.6,0.6,0.5333,0.6667,0.6,0.4667,0.7333,0.6667,0.7333,0.6,0.6,0.8,0.4667,0.4667,0.5333,0.4667,0.6,0.7333,1,0.8],"Prevalence70%":[0.9333,0.6,0.6667,0.8667,0.8,0.7333,0.7333,0.8,0.4667,0.7333,0.7333,0.6,0.9333,0.8,0.8,0.4667,0.9333,0.6667,0.6667,0.8,0.4667,0.5333,0.6667,0.7333,0.8667,0.5333,0.7333,0.6667,0.8667,0.6,0.6667,0.6,0.6667,0.8667,0.5333,0.6,0.3333,0.2667,0.7333,0.4,0.6667,0.8,0.7333,0.7333,0.6,0.5333,0.8,0.6667,0.9333,0.6667,0.4667,0.5333,0.6667,0.8,0.8,0.6,0.6667,0.6667,0.6667,0.7333,0.8,0.6,0.8667,0.8667,0.6667,0.6667,0.8667,0.9333,0.7333,0.9333,0.4667,0.6667,0.4667,0.8667,0.5333,0.4667,0.4,1,0.7333,0.4,0.4,0.8,0.6,1,0.7333,0.7333,0.8667,0.5333,0.7333,0.4667,0.6,0.3333,0.4667,0.4667,0.5333,0.7333,0.6667,0.7333,0.8667,0.4667],"Prevalence75%":[0.6,0.6667,0.8667,0.6667,0.7333,0.7333,0.9333,0.8,0.6667,0.5333,0.6,0.6667,0.4667,0.8,0.8667,0.8667,0.4667,0.9333,0.6667,0.8667,0.8,0.7333,0.8,0.8,0.8667,0.4,0.6667,0.4667,0.4,0.4667,0.8667,0.5333,1,0.6,0.7333,0.6,0.4,0.5333,0.8,0.6,0.6,0.6,0.4667,0.8667,1,0.9333,0.4,0.9333,0.7333,0.6,0.4667,0.6667,0.4667,0.6,0.9333,0.8667,0.6,0.7333,0.7333,0.4667,0.6667,0.7333,0.4667,0.5333,0.6,0.8667,0.4667,0.8667,0.8667,0.8667,0.4667,0.8667,0.8,0.6,0.8,0.5333,0.4667,0.6,0.2667,0.6,0.8,0.6667,0.6,0.7333,0.6667,0.6667,0.6667,0.8,0.6,0.8,0.4667,0.6,0.4,0.7333,0.6667,0.9333,0.7333,1,0.6667,0.8667],"Prevalence80%":[0.6667,0.6,0.6,0.8,0.5333,0.6,0.6,0.6,0.6,0.8667,0.6667,0.8,0.4667,0.8,0.8667,0.6667,0.4,0.6,0.6,0.6,0.7333,1,0.4,0.8667,0.6667,0.8,0.8,0.8,0.6,0.6,0.4667,0.6667,0.6667,0.4,0.6,0.6,0.6,0.4,0.9333,0.7333,0.6,0.9333,0.8,0.4,0.8,0.5333,0.9333,0.7333,0.6667,0.9333,0.6,0.4,0.6667,0.6667,0.8667,0.4667,0.4,0.9333,0.6667,0.9333,0.8667,0.5333,0.6667,0.6,0.8,0.8,0.8667,0.7333,0.6,0.7333,0.4,0.4,0.8667,0.9333,0.7333,0.8667,0.7333,1,0.5333,0.7333,0.8667,0.8667,0.4667,0.5333,0.6,0.8,0.8,0.8667,0.8667,0.6667,0.8,0.6,0.6,0.8667,0.5333,0.7333,0.6,0.7333,1,0.6],"Prevalence85%":[0.4667,0.5333,0.8667,0.7333,0.6,0.8,0.8,0.6,0.4667,0.6667,0.8667,0.5333,0.7333,0.4667,0.7333,0.7333,0.5333,0.5333,0.6,1,0.6,0.9333,0.6667,0.4667,0.7333,0.4,0.4,0.6667,0.4667,0.8667,0.6667,0.4667,0.4667,0.4667,0.9333,0.8,0.6667,0.5333,0.4,0.8,0.8667,0.6,0.9333,0.6667,0.6,0.8,0.8,0.4667,0.8667,0.4,0.8,0.8667,1,0.8667,0.4667,0.6667,0.8,0.4667,0.6,0.8,0.6667,0.4667,0.6667,0.8,0.4,0.5333,0.6,0.8,0.6667,1,0.4,0.3333,1,0.8,0.5333,1,0.7333,0.5333,0.8667,0.5333,0.6,0.8,0.4667,0.4,0.4,0.8667,0.5333,0.6667,0.5333,0.6667,0.8667,0.5333,0.6,0.7333,0.7333,0.5333,0.4,0.8667,0.8,0.6667],"Prevalence90%":[0.8,0.8,1,0.5333,0.8,0.9333,0.4,0.8667,0.7333,0.4667,0.6667,0.8,0.8,0.8,1,0.8,0.8667,0.8667,0.4667,0.4667,0.4667,0.8,0.5333,0.4,0.6667,0.4,0.5333,0.3333,0.8,0.5333,0.8,0.5333,0.5333,0.4667,0.6,0.6,0.8667,0.7333,0.8,0.7333,0.6667,0.5333,0.6667,0.4667,0.4667,0.7333,0.4667,0.8667,0.6667,0.6667,0.8,0.7333,0.4667,0.8,0.6,0.6667,0.7333,0.8,0.8,0.6,0.6,0.5333,0.6,0.5333,0.8667,0.4,0.7333,0.6,0.6,0.6,0.6,0.4667,0.6667,0.5333,0.6667,0.6,0.8667,0.6667,0.6667,0.8,0.7333,0.5333,0.6,0.4667,0.9333,0.5333,0.7333,0.9333,0.6,0.5333,0.6,0.5333,0.9333,0.5333,0.8,0.8667,0.8,0.6,0.6,0.8667],"Prevalence95%":[0.6,0.8,0.6,0.4,0.8667,0.7333,0.4667,0.7333,0.9333,0.8667,0.4,0.7333,0.2,0.8,0.4,0.5333,0.4,0.7333,0.6,0.4667,0.6667,0.6,0.6667,0.5333,0.6,0.4,0.8667,0.9333,1,0.5333,0.3333,0.3333,0.6667,0.7333,0.7333,0.8,0.7333,0.6667,0.6667,0.5333,0.6,0.6,1,0.6667,0.5333,0.6,0.6,0.6,0.6,0.5333,0.6667,0.6667,0.9333,0.6667,0.8,0.6667,0.8,0.7333,0.8,0.6,0.6,0.9333,0.5333,0.4667,0.5333,0.4667,0.5333,0.6,0.4667,0.3333,0.8,0.8667,0.3333,0.4667,0.6,0.8667,0.7333,1,0.5333,0.6667,0.6667,0.5333,0.4667,0.6,0.4667,0.6667,0.6,0.6667,0.9333,0.7333,0.8,0.5333,0.4667,1,0.6,0.6,0.8667,0.8667,0.2667,0.4667]},"columns":[{"accessor":"Prevalence5%","name":"Prevalence5%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.3333","0.6000","0.7333","0.6000","0.6667","0.8667","0.4667","0.8000","0.6000","0.7333","0.6000","0.7333","0.4667","0.7333","0.5333","0.4000","0.6667","0.5333","0.6000","0.6000","0.8667","0.8000","0.8000","0.8000","0.8000","1.0000","0.6667","0.5333","0.5333","0.9333","0.8000","1.0000","0.6000","0.6667","0.6000","1.0000","0.4667","0.9333","0.4667","0.7333","0.6667","0.5333","0.7333","0.4000","0.8667","0.4000","0.6000","0.5333","0.5333","0.7333","0.4000","0.6667","0.6000","0.6000","0.5333","0.5333","0.6000","0.9333","0.7333","0.5333","0.8667","0.4667","0.8667","0.5333","0.4000","0.6000","0.4000","0.4667","0.8000","0.9333","0.6000","0.4667","0.5333","0.4000","0.6667","0.9333","0.8000","0.7333","0.7333","0.8000","0.9333","0.6667","0.8667","0.8667","0.6000","0.9333","0.5333","0.8667","0.6000","0.6000","0.6000","0.4667","0.6000","0.6667","0.7333","0.8000","0.8000","0.4667","0.8000","0.6667"],"header":"Prevalence5%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence10%","name":"Prevalence10%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.9333","0.5333","0.6000","0.4667","0.7333","0.9333","0.8000","0.8000","0.3333","0.4000","0.5333","0.8000","0.9333","0.8000","0.4667","0.9333","0.7333","0.7333","0.5333","0.9333","0.7333","0.6000","0.6000","0.7333","0.7333","0.8667","1.0000","0.4667","0.4667","0.5333","0.5333","0.4667","0.6000","0.7333","0.6000","0.4667","0.4667","0.4667","0.6000","0.6667","0.5333","0.6667","0.6667","1.0000","0.6000","0.7333","0.7333","0.8000","0.3333","0.8000","0.8000","0.8000","0.4000","0.4000","0.5333","0.8000","0.5333","0.4000","0.8667","0.6000","0.9333","0.4667","0.5333","0.6667","0.6667","0.5333","0.7333","0.6000","1.0000","1.0000","0.8667","0.5333","0.8667","1.0000","0.9333","0.4667","0.4667","0.4000","0.6667","0.6000","0.8000","0.9333","0.7333","0.8000","0.7333","0.8000","0.5333","0.5333","0.6000","0.7333","0.4667","0.6667","0.6667","0.4667","0.4667","0.4000","0.6000","0.6667","0.3333","0.8667"],"header":"Prevalence10%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence15%","name":"Prevalence15%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6000","0.4667","0.8000","0.4667","0.3333","0.4000","0.8000","0.6667","0.7333","0.3333","0.6667","0.8000","0.6667","0.6667","0.6667","0.5333","0.7333","0.5333","0.6667","0.6667","0.6000","0.6667","0.4000","0.6667","0.6667","0.4000","0.6000","0.4000","0.8000","0.4000","0.5333","0.9333","1.0000","0.4667","0.4667","0.6000","0.6000","0.9333","0.6667","0.6667","0.6667","0.6000","0.5333","0.7333","0.6667","0.6667","0.7333","0.5333","0.6667","0.9333","0.9333","0.6667","0.6667","0.6000","1.0000","0.4000","0.6667","0.8667","0.5333","0.8000","0.4667","0.6000","0.4667","0.4667","0.9333","0.6000","0.7333","0.4000","0.7333","0.8000","0.4667","0.4667","0.6667","0.6667","0.7333","0.4667","0.4667","0.4667","0.4667","0.6667","0.6000","0.4000","0.6667","0.4667","0.8000","0.7333","0.4667","1.0000","0.7333","0.4667","0.5333","0.7333","0.6667","0.8000","0.8667","0.6667","0.8000","0.9333","0.9333","0.7333"],"header":"Prevalence15%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence20%","name":"Prevalence20%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.7333","0.4000","0.9333","0.6667","0.8667","0.4000","0.8667","0.8000","0.3333","0.6000","0.8000","0.2667","0.4667","0.6667","0.6000","0.7333","0.4667","1.0000","0.4667","0.8667","0.6000","0.5333","0.8000","0.6667","0.7333","0.9333","0.4667","0.6000","0.8667","0.4667","0.8667","0.8000","0.6667","1.0000","0.6667","0.4000","1.0000","0.8000","0.6000","0.6000","0.8000","0.6000","0.6000","0.6000","0.6000","0.6000","0.6667","0.7333","1.0000","0.9333","0.6667","0.4667","0.6000","0.6667","0.7333","0.3333","1.0000","1.0000","0.6000","0.6667","0.4667","0.8667","0.4000","0.7333","0.9333","0.8667","0.4000","0.5333","0.8000","0.8667","0.4000","0.4000","0.9333","0.8667","0.6667","0.5333","0.6667","0.6000","0.7333","0.8000","0.9333","0.5333","0.6000","0.9333","0.6667","0.5333","0.5333","0.4667","0.6667","0.5333","0.4667","0.8000","0.7333","0.8667","0.8000","0.6667","0.6000","0.6000","0.7333","0.4000"],"header":"Prevalence20%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence25%","name":"Prevalence25%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.5333","0.4667","0.7333","0.6667","0.4000","0.4667","0.6000","0.9333","1.0000","0.6000","0.9333","0.6000","0.4667","0.8000","0.6667","0.8000","0.4000","0.5333","0.4667","0.7333","0.6000","0.5333","0.6667","0.6667","0.6667","1.0000","0.4000","0.6000","0.8667","0.6000","0.5333","0.8000","0.5333","0.4667","0.3333","1.0000","0.7333","0.9333","0.7333","0.6000","0.6667","0.6667","0.4667","0.6000","0.8667","0.6667","0.3333","0.5333","0.5333","0.7333","0.8667","0.9333","0.4667","0.6667","0.8667","0.8000","0.4667","0.7333","0.7333","0.8667","0.6000","0.4000","0.6000","0.8000","0.9333","0.7333","0.5333","0.7333","0.8000","0.8667","0.8000","0.4000","0.4667","0.8000","0.5333","0.8667","0.8000","0.4000","0.5333","0.6667","0.6000","0.4000","0.6667","0.4667","0.6667","0.6000","0.5333","0.8000","0.4667","0.8000","0.5333","0.5333","0.6667","0.4667","0.4667","0.6667","0.3333","0.6667","0.4000","0.7333"],"header":"Prevalence25%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence30%","name":"Prevalence30%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6000","0.7333","0.9333","0.6000","0.3333","0.6667","0.8000","0.8000","0.4667","0.4667","0.7333","0.5333","0.6667","0.7333","0.6000","0.7333","0.8000","0.8667","0.5333","0.6667","0.5333","0.5333","0.6667","0.6000","0.8000","0.8000","0.8667","0.6000","0.5333","0.6000","0.6667","0.7333","0.4667","0.8667","0.9333","1.0000","0.7333","0.8667","0.6667","0.7333","0.5333","0.8000","0.8000","0.5333","0.5333","0.4667","0.3333","0.6667","0.3333","0.8000","0.8000","0.7333","0.6667","0.6000","0.5333","0.5333","0.7333","0.7333","0.8667","1.0000","0.6667","0.6000","0.6000","0.9333","0.8667","1.0000","0.5333","0.8000","0.9333","0.8667","0.4000","0.8000","0.4000","1.0000","1.0000","0.5333","0.4000","1.0000","0.6667","0.7333","0.4000","0.4667","0.4000","0.5333","0.6000","0.6000","0.5333","0.8000","0.7333","0.4000","0.9333","0.4000","0.8000","0.5333","0.8000","0.7333","0.8667","0.6000","0.8667","0.5333"],"header":"Prevalence30%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence35%","name":"Prevalence35%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["1.0000","0.6667","0.8000","0.9333","0.6667","0.6000","0.4667","1.0000","0.6667","0.5333","0.5333","0.6667","0.7333","0.9333","0.7333","0.4667","0.7333","0.8000","1.0000","0.8667","0.4000","0.7333","0.9333","0.6667","0.6000","0.9333","0.7333","0.6667","0.6667","1.0000","0.4667","0.6000","0.4667","0.7333","0.4000","0.6667","0.4667","0.6667","0.6000","0.2667","0.6667","0.8000","0.8000","0.7333","0.9333","0.5333","0.6667","0.6667","0.5333","0.4667","0.8667","0.8000","0.8000","0.4667","0.7333","0.6667","0.5333","0.8667","0.8667","0.6667","0.5333","0.6000","0.6667","0.5333","0.3333","0.5333","0.6667","1.0000","0.4000","0.4667","0.8667","0.3333","0.8000","0.7333","0.7333","0.5333","0.7333","0.3333","0.8000","0.9333","0.8000","0.4000","0.8667","0.4667","0.4667","0.6000","0.8000","0.6000","0.5333","0.9333","0.4000","0.7333","0.7333","0.9333","0.9333","0.3333","0.6000","0.4667","0.6667","0.9333"],"header":"Prevalence35%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence40%","name":"Prevalence40%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.8667","0.8000","0.6000","0.6000","0.8667","0.8667","0.5333","0.9333","0.9333","0.7333","0.9333","0.8000","1.0000","1.0000","0.6667","0.7333","0.4667","0.8667","0.5333","0.6000","0.8667","0.6000","0.6667","0.7333","0.4000","0.4000","0.6667","0.5333","0.5333","0.5333","0.5333","0.6667","0.6000","0.5333","0.4000","0.7333","0.8667","0.5333","0.7333","0.6000","0.5333","0.6000","0.9333","0.8000","0.8667","1.0000","0.6000","0.8667","0.4000","0.2667","0.4667","0.7333","0.8667","0.4667","0.8667","0.8000","0.3333","0.8000","1.0000","0.5333","0.4667","0.5333","0.6000","0.9333","0.6000","0.6667","0.6000","0.8667","0.9333","0.8667","0.6000","0.6667","0.4667","0.4667","0.6667","0.6667","0.4667","0.4000","0.8667","0.8667","0.8667","0.6000","0.3333","0.4667","0.8667","0.8000","0.8000","0.6667","0.4667","0.8000","0.9333","0.8667","0.8667","0.5333","0.5333","1.0000","0.6667","1.0000","0.6667","0.6667"],"header":"Prevalence40%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence45%","name":"Prevalence45%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6667","0.7333","0.5333","0.8000","0.6000","0.7333","0.5333","0.5333","0.7333","0.7333","0.8000","0.7333","0.4667","0.6667","0.5333","0.8667","0.5333","0.4667","0.3333","0.4667","0.8000","0.7333","0.6000","0.9333","0.5333","0.6000","0.8667","0.8000","0.5333","0.6000","0.4000","0.7333","0.4667","0.9333","0.8000","0.6667","0.6667","0.7333","0.9333","0.6667","0.6000","0.8000","0.4667","0.4667","0.6667","0.9333","0.8000","0.8667","1.0000","0.7333","0.7333","0.5333","0.8000","0.6000","0.8667","0.5333","0.8000","0.8667","1.0000","0.8000","0.9333","0.4000","0.7333","0.6667","0.7333","0.2667","1.0000","0.7333","0.4667","0.7333","0.4000","0.6000","0.4667","0.6667","0.6000","1.0000","0.8000","0.8667","0.6000","1.0000","0.7333","0.8667","0.8000","0.6667","0.4000","0.3333","0.6667","0.6000","0.7333","0.6000","0.9333","0.4667","0.9333","0.9333","0.5333","0.7333","0.4667","0.6667","0.6667","0.8000"],"header":"Prevalence45%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence50%","name":"Prevalence50%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.5333","0.7333","0.8000","0.6667","0.3333","0.5333","0.8000","1.0000","0.4667","0.6000","0.4667","0.8000","0.3333","0.6000","0.6667","0.8000","0.6000","0.6000","1.0000","0.6000","0.6667","0.6000","0.6667","0.8667","0.4667","0.7333","0.8667","0.6000","0.4667","0.6000","0.6000","0.5333","0.8000","0.6000","0.8667","0.7333","0.8000","0.3333","0.7333","0.8667","0.4667","0.5333","0.8667","0.5333","0.4667","0.8667","0.4000","0.4667","0.4000","0.6000","0.8667","0.5333","0.7333","0.4000","0.5333","0.8000","0.5333","0.6000","0.5333","0.8667","0.7333","0.6667","0.8667","0.4667","0.6000","0.4667","0.5333","0.4667","1.0000","1.0000","0.8000","0.4667","0.5333","0.4667","0.5333","0.8000","0.8000","0.6667","0.8667","0.7333","0.4667","0.6000","0.8000","0.8000","0.8667","0.7333","0.6000","0.8667","0.3333","0.4667","0.4667","0.7333","0.4667","0.8000","0.4667","0.3333","0.6000","0.4667","0.6667","0.6667"],"header":"Prevalence50%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence55%","name":"Prevalence55%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["1.0000","0.5333","0.8000","0.6000","0.4667","1.0000","0.8667","0.5333","0.8667","0.7333","0.4667","0.7333","0.4667","0.6667","0.5333","0.6667","0.5333","0.5333","0.9333","0.7333","0.8000","0.7333","0.4667","0.8667","1.0000","0.6000","0.8000","0.5333","0.7333","0.7333","0.9333","0.8000","0.7333","0.6667","0.4000","0.4667","0.5333","1.0000","0.6000","0.6000","0.4667","0.5333","0.8667","0.6000","0.6667","0.5333","0.8000","0.3333","0.5333","0.5333","0.5333","0.9333","0.5333","0.8667","0.8667","0.6667","0.4667","0.5333","1.0000","0.6000","0.6667","0.4667","0.6667","0.4667","0.6667","0.6667","0.6000","0.7333","0.4000","0.5333","0.6000","0.8000","0.8667","0.4667","0.5333","0.5333","0.6667","0.4667","0.8667","0.5333","0.7333","0.7333","0.8000","0.7333","0.8667","0.8000","0.7333","0.6667","0.4667","0.4667","0.4000","0.8000","0.6667","0.9333","0.9333","0.6000","0.8667","0.4667","0.7333","0.6667"],"header":"Prevalence55%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence60%","name":"Prevalence60%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6667","0.4667","0.6000","0.6667","0.6000","0.8667","0.5333","0.4000","0.9333","0.5333","0.6667","0.4667","0.6667","0.4000","0.4667","0.6000","0.5333","0.5333","0.6000","0.8000","0.4667","0.9333","0.5333","0.8000","0.5333","0.6000","0.2667","0.5333","0.7333","0.4667","0.6000","0.8667","0.5333","0.9333","0.8000","0.8000","0.7333","0.7333","0.6667","0.4667","0.8667","0.8667","0.8000","0.5333","0.6667","0.6000","0.5333","0.5333","0.5333","0.4667","0.8000","0.5333","0.5333","0.4667","0.8667","0.8667","0.8667","0.7333","0.6667","0.6667","0.4667","0.8000","0.5333","0.6667","0.6667","0.8667","0.6000","0.8667","0.8667","0.7333","0.6667","0.6000","0.4000","0.6667","1.0000","0.4667","0.5333","0.8667","0.6000","0.4667","0.6000","0.6000","0.9333","1.0000","0.8000","0.8000","0.4000","0.2667","0.4000","0.7333","0.5333","0.4667","0.9333","0.7333","0.7333","0.4667","0.8667","0.4667","0.6000","1.0000"],"header":"Prevalence60%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence65%","name":"Prevalence65%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["1.0000","0.6667","1.0000","0.5333","0.7333","0.6000","1.0000","0.8000","0.9333","0.7333","0.6000","0.5333","0.6000","0.7333","0.6000","0.9333","0.2667","0.6000","0.5333","0.6667","0.4667","0.5333","0.8000","0.6000","0.8667","0.6000","0.4667","0.5333","0.6000","0.7333","0.4667","0.7333","0.4000","0.6667","0.4667","0.3333","0.7333","0.8667","0.6667","0.9333","0.8667","0.5333","0.7333","0.4000","0.9333","0.6000","0.3333","0.6000","0.5333","0.9333","0.8667","0.5333","0.7333","0.5333","0.5333","0.4000","0.4000","0.3333","0.5333","0.3333","0.8000","0.8667","0.8667","0.7333","0.4667","0.5333","0.7333","1.0000","1.0000","0.8667","0.8000","0.2667","0.8667","0.4667","0.8000","0.6667","0.5333","0.6000","0.6000","0.8667","0.6000","0.6000","0.5333","0.6667","0.6000","0.4667","0.7333","0.6667","0.7333","0.6000","0.6000","0.8000","0.4667","0.4667","0.5333","0.4667","0.6000","0.7333","1.0000","0.8000"],"header":"Prevalence65%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence70%","name":"Prevalence70%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.9333","0.6000","0.6667","0.8667","0.8000","0.7333","0.7333","0.8000","0.4667","0.7333","0.7333","0.6000","0.9333","0.8000","0.8000","0.4667","0.9333","0.6667","0.6667","0.8000","0.4667","0.5333","0.6667","0.7333","0.8667","0.5333","0.7333","0.6667","0.8667","0.6000","0.6667","0.6000","0.6667","0.8667","0.5333","0.6000","0.3333","0.2667","0.7333","0.4000","0.6667","0.8000","0.7333","0.7333","0.6000","0.5333","0.8000","0.6667","0.9333","0.6667","0.4667","0.5333","0.6667","0.8000","0.8000","0.6000","0.6667","0.6667","0.6667","0.7333","0.8000","0.6000","0.8667","0.8667","0.6667","0.6667","0.8667","0.9333","0.7333","0.9333","0.4667","0.6667","0.4667","0.8667","0.5333","0.4667","0.4000","1.0000","0.7333","0.4000","0.4000","0.8000","0.6000","1.0000","0.7333","0.7333","0.8667","0.5333","0.7333","0.4667","0.6000","0.3333","0.4667","0.4667","0.5333","0.7333","0.6667","0.7333","0.8667","0.4667"],"header":"Prevalence70%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence75%","name":"Prevalence75%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6000","0.6667","0.8667","0.6667","0.7333","0.7333","0.9333","0.8000","0.6667","0.5333","0.6000","0.6667","0.4667","0.8000","0.8667","0.8667","0.4667","0.9333","0.6667","0.8667","0.8000","0.7333","0.8000","0.8000","0.8667","0.4000","0.6667","0.4667","0.4000","0.4667","0.8667","0.5333","1.0000","0.6000","0.7333","0.6000","0.4000","0.5333","0.8000","0.6000","0.6000","0.6000","0.4667","0.8667","1.0000","0.9333","0.4000","0.9333","0.7333","0.6000","0.4667","0.6667","0.4667","0.6000","0.9333","0.8667","0.6000","0.7333","0.7333","0.4667","0.6667","0.7333","0.4667","0.5333","0.6000","0.8667","0.4667","0.8667","0.8667","0.8667","0.4667","0.8667","0.8000","0.6000","0.8000","0.5333","0.4667","0.6000","0.2667","0.6000","0.8000","0.6667","0.6000","0.7333","0.6667","0.6667","0.6667","0.8000","0.6000","0.8000","0.4667","0.6000","0.4000","0.7333","0.6667","0.9333","0.7333","1.0000","0.6667","0.8667"],"header":"Prevalence75%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence80%","name":"Prevalence80%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6667","0.6000","0.6000","0.8000","0.5333","0.6000","0.6000","0.6000","0.6000","0.8667","0.6667","0.8000","0.4667","0.8000","0.8667","0.6667","0.4000","0.6000","0.6000","0.6000","0.7333","1.0000","0.4000","0.8667","0.6667","0.8000","0.8000","0.8000","0.6000","0.6000","0.4667","0.6667","0.6667","0.4000","0.6000","0.6000","0.6000","0.4000","0.9333","0.7333","0.6000","0.9333","0.8000","0.4000","0.8000","0.5333","0.9333","0.7333","0.6667","0.9333","0.6000","0.4000","0.6667","0.6667","0.8667","0.4667","0.4000","0.9333","0.6667","0.9333","0.8667","0.5333","0.6667","0.6000","0.8000","0.8000","0.8667","0.7333","0.6000","0.7333","0.4000","0.4000","0.8667","0.9333","0.7333","0.8667","0.7333","1.0000","0.5333","0.7333","0.8667","0.8667","0.4667","0.5333","0.6000","0.8000","0.8000","0.8667","0.8667","0.6667","0.8000","0.6000","0.6000","0.8667","0.5333","0.7333","0.6000","0.7333","1.0000","0.6000"],"header":"Prevalence80%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence85%","name":"Prevalence85%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.4667","0.5333","0.8667","0.7333","0.6000","0.8000","0.8000","0.6000","0.4667","0.6667","0.8667","0.5333","0.7333","0.4667","0.7333","0.7333","0.5333","0.5333","0.6000","1.0000","0.6000","0.9333","0.6667","0.4667","0.7333","0.4000","0.4000","0.6667","0.4667","0.8667","0.6667","0.4667","0.4667","0.4667","0.9333","0.8000","0.6667","0.5333","0.4000","0.8000","0.8667","0.6000","0.9333","0.6667","0.6000","0.8000","0.8000","0.4667","0.8667","0.4000","0.8000","0.8667","1.0000","0.8667","0.4667","0.6667","0.8000","0.4667","0.6000","0.8000","0.6667","0.4667","0.6667","0.8000","0.4000","0.5333","0.6000","0.8000","0.6667","1.0000","0.4000","0.3333","1.0000","0.8000","0.5333","1.0000","0.7333","0.5333","0.8667","0.5333","0.6000","0.8000","0.4667","0.4000","0.4000","0.8667","0.5333","0.6667","0.5333","0.6667","0.8667","0.5333","0.6000","0.7333","0.7333","0.5333","0.4000","0.8667","0.8000","0.6667"],"header":"Prevalence85%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence90%","name":"Prevalence90%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.8000","0.8000","1.0000","0.5333","0.8000","0.9333","0.4000","0.8667","0.7333","0.4667","0.6667","0.8000","0.8000","0.8000","1.0000","0.8000","0.8667","0.8667","0.4667","0.4667","0.4667","0.8000","0.5333","0.4000","0.6667","0.4000","0.5333","0.3333","0.8000","0.5333","0.8000","0.5333","0.5333","0.4667","0.6000","0.6000","0.8667","0.7333","0.8000","0.7333","0.6667","0.5333","0.6667","0.4667","0.4667","0.7333","0.4667","0.8667","0.6667","0.6667","0.8000","0.7333","0.4667","0.8000","0.6000","0.6667","0.7333","0.8000","0.8000","0.6000","0.6000","0.5333","0.6000","0.5333","0.8667","0.4000","0.7333","0.6000","0.6000","0.6000","0.6000","0.4667","0.6667","0.5333","0.6667","0.6000","0.8667","0.6667","0.6667","0.8000","0.7333","0.5333","0.6000","0.4667","0.9333","0.5333","0.7333","0.9333","0.6000","0.5333","0.6000","0.5333","0.9333","0.5333","0.8000","0.8667","0.8000","0.6000","0.6000","0.8667"],"header":"Prevalence90%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence95%","name":"Prevalence95%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6000","0.8000","0.6000","0.4000","0.8667","0.7333","0.4667","0.7333","0.9333","0.8667","0.4000","0.7333","0.2000","0.8000","0.4000","0.5333","0.4000","0.7333","0.6000","0.4667","0.6667","0.6000","0.6667","0.5333","0.6000","0.4000","0.8667","0.9333","1.0000","0.5333","0.3333","0.3333","0.6667","0.7333","0.7333","0.8000","0.7333","0.6667","0.6667","0.5333","0.6000","0.6000","1.0000","0.6667","0.5333","0.6000","0.6000","0.6000","0.6000","0.5333","0.6667","0.6667","0.9333","0.6667","0.8000","0.6667","0.8000","0.7333","0.8000","0.6000","0.6000","0.9333","0.5333","0.4667","0.5333","0.4667","0.5333","0.6000","0.4667","0.3333","0.8000","0.8667","0.3333","0.4667","0.6000","0.8667","0.7333","1.0000","0.5333","0.6667","0.6667","0.5333","0.4667","0.6000","0.4667","0.6667","0.6000","0.6667","0.9333","0.7333","0.8000","0.5333","0.4667","1.0000","0.6000","0.6000","0.8667","0.8667","0.2667","0.4667"],"header":"Prevalence95%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"5c65ffc12fc22496c6aff39a4dfed4d2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">

</div>
<p>It is also possible to estimate the variation of OOB error for each prevalence interval filtering. This is done by running the random forests classification for <code>n</code> times, determined by the <code>bootstrap</code> value. The function will return a box plot figure and a table for each classification error.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_replicated.oob.error</span> <span class="op">&lt;-</span> <span class="fu">pime.oob.replicate</span><span class="op">(</span><span class="va">ssu18_prevalences</span>, <span class="st">"TEMP"</span>,
                                         bootstrap <span class="op">=</span> <span class="fl">100</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="filtering_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><small><strong>(16S rRNA) Figure 1 | OOB error rate for the original data set (top) &amp; the randomized data (bottom).</strong></small></p>
<p>To obtain the confusion matrix from random forests classification use the following:</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_prev_confuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"ssu18_best.prev$`Confusion`$"</span>, <span class="va">ssu18_best</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="op">(</span><span class="va">ssu18_prev_confuse</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="save-phyloseq-pime-objects" class="level3"><h3 class="anchored" data-anchor-id="save-phyloseq-pime-objects">Save Phyloseq PIME objects</h3>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ssu18_ps_pime</span> <span class="op">&lt;-</span> <span class="va">ssu18_prevalence_best</span>
<span class="va">ssu18_ps_pime_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">ssu18_ps_pime</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>,
                           tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">ssu18_ps_pime</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssu18_ps_pime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">ssu18_ps_pime</span>,
                               <span class="va">sample_data</span>,
                               <span class="va">ssu18_ps_pime_tree</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">ssu18_ps_pime</span>, <span class="st">"files/filtering/pime/rdata/ssu18_ps_pime.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="split-save-by-predictor-variable" class="level3"><h3 class="anchored" data-anchor-id="split-save-by-predictor-variable">Split &amp; save by predictor variable</h3>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">ssu18_ps_pime</span><span class="op">)</span><span class="op">)</span>
<span class="va">ssu18_ps_pime_split</span> <span class="op">&lt;-</span> <span class="fu">pime.split.by.variable</span><span class="op">(</span><span class="va">ssu18_ps_pime</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">ssu18_ps_pime_split</span><span class="op">$</span><span class="va">`0`</span>, <span class="st">"files/filtering/pime/rdata/ssu18_ps_pime_0.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">ssu18_ps_pime_split</span><span class="op">$</span><span class="va">`3`</span>, <span class="st">"files/filtering/pime/rdata/ssu18_ps_pime_3.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">ssu18_ps_pime_split</span><span class="op">$</span><span class="va">`8`</span>, <span class="st">"files/filtering/pime/rdata/ssu18_ps_pime_8.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$`0`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 752 taxa and 5 samples ]
sample_data() Sample Data:       [ 5 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 752 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 752 tips and 751 internal nodes ]

$`3`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 692 taxa and 5 samples ]
sample_data() Sample Data:       [ 5 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 692 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 692 tips and 691 internal nodes ]

$`8`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 355 taxa and 5 samples ]
sample_data() Sample Data:       [ 5 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 355 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 355 tips and 354 internal nodes ]</code></pre>
</div>
</div>
<div class="cell">

</div>
</section><section id="summary-1" class="level3"><h3 class="anchored" data-anchor-id="summary-1">Summary</h3>
<p>You know the routine. How did filtering affect total reads and ASVs for each sample?</p>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 9 | Sample summary showing the number of reads and ASVs after PIME filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELFBMT1QsVFJFQVQsVEVNUCxQQUlSLHRvdGFsX3JlYWRzLHRvdGFsX2FzdnMKUDAxX0QwMF8wMTBfVzNBLFAwMSxXLDMsQSwxNTYzNiw1MDIKUDAxX0QwMF8wMTBfVzhBLFAwMSxXLDgsQSwxNjk1MiwzMjIKUDAyX0QwMF8wMTBfQzBBLFAwMixDLDAsQSwxNzE5MCw1OTAKUDAzX0QwMF8wMTBfVzNCLFAwMyxXLDMsQiwxNzQ5Miw1OTYKUDAzX0QwMF8wMTBfVzhCLFAwMyxXLDgsQiwxMTczNywyMjQKUDA0X0QwMF8wMTBfQzBCLFAwNCxDLDAsQiwxNzA3NCw1NzAKUDA1X0QwMF8wMTBfVzNDLFAwNSxXLDMsQywxODM2MCw0OTkKUDA1X0QwMF8wMTBfVzhDLFAwNSxXLDgsQywxNDk2NSwyODkKUDA2X0QwMF8wMTBfQzBDLFAwNixDLDAsQywxNTQyNiw2NjQKUDA3X0QwMF8wMTBfVzNELFAwNyxXLDMsRCwxNjc5MSw1MTYKUDA3X0QwMF8wMTBfVzhELFAwNyxXLDgsRCwxMjcyMiwyNzYKUDA4X0QwMF8wMTBfQzBELFAwOCxDLDAsRCwxNTc4MCw1OTQKUDA5X0QwMF8wMTBfVzNFLFAwOSxXLDMsRSwxNjY5Nyw1NjMKUDA5X0QwMF8wMTBfVzhFLFAwOSxXLDgsRSwxMDU4NSwxNzAKUDEwX0QwMF8wMTBfQzBFLFAxMCxDLDAsRSwxNTEyNSw0OTEK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu_pime_samp_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-505345458a8577c9afbb" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-505345458a8577c9afbb">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"PLOT":["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],"TREAT":["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],"TEMP":["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],"PAIR":["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],"total_reads":[15636,16952,17190,17492,11737,17074,18360,14965,15426,16791,12722,15780,16697,10585,15125],"total_asvs":[502,322,590,596,224,570,499,289,664,516,276,594,563,170,491]},"columns":[{"accessor":"Sample_ID","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W3C","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P09_D00_010_W8E","P10_D00_010_C0E"],"header":"Metric","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"PLOT","name":"PLOT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01","P01","P02","P03","P03","P04","P05","P05","P06","P07","P07","P08","P09","P09","P10"],"header":"PLOT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TREAT","name":"TREAT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["W","W","C","W","W","C","W","W","C","W","W","C","W","W","C"],"header":"TREAT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TEMP","name":"TEMP","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["3","8","0","3","8","0","3","8","0","3","8","0","3","8","0"],"header":"TEMP","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PAIR","name":"PAIR","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["A","A","A","B","B","B","C","C","C","D","D","D","E","E","E"],"header":"PAIR","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads","name":"total_reads","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["15636","16952","17190","17492","11737","17074","18360","14965","15426","16791","12722","15780","16697","10585","15125"],"header":"total reads","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs","name":"total_asvs","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["502","322","590","596","224","570","499","289","664","516","276","594","563","170","491"],"header":"total asvs","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,15],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"inline":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"dad7821178dfcfbe9f6676800d9fffb0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>And here is how the subsets changed through the PIME filtering process.</p>
<div class="cell">

</div>
<p><small><strong>(16S rRNA) Table 10 | Changes in read count and total ASVs during PIME filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,RGVzY3JpcHRpb24sbm8uIHNhbXBsZXMsdG90YWwgcmVhZHMsdG90YWwgYXN2cwpGVUxMIGRhdGEgc2V0LDE1LDkzNjY0MCwyMDE3MwpSYXJlZmllZCBkYXRhLDE1LDM3NjMyMCwxNzQzMgpQSU1FIGZpbHRlcmVkIGRhdGEsMTUsMjMyNTMyLDEwNTgKUElNRSAoKzBDKSw1LDgwNTk1LDc1MgpQSU1FICgrM0MpLDUsODQ5NzYsNjkyClBJTUUgKCs4QyksNSw2Njk2MSwzNTUK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'ssu18_asv_pime_sum.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-21cf683d03d4589f53e1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-21cf683d03d4589f53e1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Description":["FULL data set","Rarefied data","PIME filtered data","PIME (+0C)","PIME (+3C)","PIME (+8C)"],"no. samples":[15,15,15,5,5,5],"total reads":[936640,376320,232532,80595,84976,66961],"total asvs":[20173,17432,1058,752,692,355]},"columns":[{"accessor":"Description","name":"Description","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["FULL data set","Rarefied data","PIME filtered data","PIME (+0C)","PIME (+3C)","PIME (+8C)"],"header":"Description","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"no. samples","name":"no. samples","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["15","15","15","5","5","5"],"header":"no. samples","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total reads","name":"total reads","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["936640","376320","232532","80595","84976","66961"],"header":"total reads","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total asvs","name":"total asvs","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["20173","17432","1058","752","692","355"],"header":"total asvs","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":6,"showPageSizeOptions":true,"pageSizeOptions":[5,10,6],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"inline":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"aae7d488712b98d4000b604815803af3"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section id="its-2" class="level2"><h2 class="anchored" data-anchor-id="its-2">ITS</h2>
<section id="setup-2" class="level3"><h3 class="anchored" data-anchor-id="setup-2">Setup</h3>
<p>First, choose a phyloseq object and a sample data frame</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_pime_ds</span> <span class="op">&lt;-</span> <span class="va">its18_ps_work</span>
<span class="va">its18_which_pime</span> <span class="op">&lt;-</span> <span class="st">"its18_pime_ds"</span>
<span class="va">its18_pime_ds</span><span class="op">@</span><span class="va">phy_tree</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 3355 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 3355 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_pime_sample_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">its18_pime_ds_full</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">its18_pime_sample_d</span> <span class="op">&lt;-</span> <span class="va">its18_pime_sample_d</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>total_reads <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">its18_pime_ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/rarefy_even_depth.html">rarefy_even_depth</a></span><span class="op">(</span><span class="va">its18_pime_ds_full</span>,
                               sample.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">its18_pime_sample_d</span><span class="op">$</span><span class="va">total_reads</span><span class="op">)</span>,
                               trimOTUs <span class="op">=</span> <span class="cn">TRUE</span>, replace <span class="op">=</span> <span class="cn">FALSE</span>,
                               rngseed <span class="op">=</span> <span class="fl">119</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>298 OTUs were removed because they are no longer 
present in any sample after random subsampling</code></pre>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 3057 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 3057 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
<p>The first step in PIME is to define if the microbial community presents a high relative abundance of taxa with low prevalence, which is considered as noise in PIME analysis. This is calculated by random forests analysis and is the baseline noise detection.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_pime.oob.error</span> <span class="op">&lt;-</span> <span class="fu">pime.oob.error</span><span class="op">(</span><span class="va">its18_pime_ds</span>, <span class="st">"TEMP"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3846154</code></pre>
</div>
</div>
</section><section id="split-by-predictor-variable-1" class="level3"><h3 class="anchored" data-anchor-id="split-by-predictor-variable-1">Split by Predictor Variable</h3>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">its18_pime_ds</span><span class="op">)</span><span class="op">)</span>
<span class="va">its18_per_variable_obj</span> <span class="op">&lt;-</span> <span class="fu">pime.split.by.variable</span><span class="op">(</span><span class="va">its18_pime_ds</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="va">its18_per_variable_obj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$`0`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1932 taxa and 5 samples ]
sample_data() Sample Data:       [ 5 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1932 taxa by 8 taxonomic ranks ]

$`3`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1682 taxa and 4 samples ]
sample_data() Sample Data:       [ 4 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1682 taxa by 8 taxonomic ranks ]

$`8`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1306 taxa and 4 samples ]
sample_data() Sample Data:       [ 4 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1306 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
</section><section id="calculate-prevalence-intervals-1" class="level3"><h3 class="anchored" data-anchor-id="calculate-prevalence-intervals-1">Calculate Prevalence Intervals</h3>
<p>Using the output of <code>pime.split.by.variable</code>, we calculate the prevalence intervals with the function <code>pime.prevalence</code>. This function estimates the highest prevalence possible (no empty ASV table), calculates prevalence for taxa, starting at 5 maximum prevalence possible (no empty ASV table or dropping samples). After prevalence calculation, each prevalence interval are merged.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_prevalences</span> <span class="op">&lt;-</span> <span class="fu">pime.prevalence</span><span class="op">(</span><span class="va">its18_per_variable_obj</span><span class="op">)</span>
<span class="va">its18_prevalences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details><summary>
Detailed results for all prevalences intervals
</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$`5`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 3057 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 3057 taxa by 8 taxonomic ranks ]

$`10`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 3057 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 3057 taxa by 8 taxonomic ranks ]

$`15`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 3057 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 3057 taxa by 8 taxonomic ranks ]

$`20`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 2421 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 2421 taxa by 8 taxonomic ranks ]

$`25`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1152 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1152 taxa by 8 taxonomic ranks ]

$`30`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1152 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1152 taxa by 8 taxonomic ranks ]

$`35`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 1152 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 1152 taxa by 8 taxonomic ranks ]

$`40`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 873 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 873 taxa by 8 taxonomic ranks ]

$`45`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 873 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 873 taxa by 8 taxonomic ranks ]

$`50`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 474 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 474 taxa by 8 taxonomic ranks ]

$`55`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 474 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 474 taxa by 8 taxonomic ranks ]

$`60`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 336 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 336 taxa by 8 taxonomic ranks ]

$`65`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 336 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 336 taxa by 8 taxonomic ranks ]

$`70`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 336 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 336 taxa by 8 taxonomic ranks ]

$`75`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 171 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 171 taxa by 8 taxonomic ranks ]

$`80`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 114 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 114 taxa by 8 taxonomic ranks ]

$`85`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 114 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 114 taxa by 8 taxonomic ranks ]

$`90`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 114 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 114 taxa by 8 taxonomic ranks ]

$`95`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 114 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 114 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
</details></section><section id="calculate-best-prevalence-1" class="level3"><h3 class="anchored" data-anchor-id="calculate-best-prevalence-1">Calculate Best Prevalence</h3>
<p>Finally, we use the function <code>pime.best.prevalence</code> to calculate the best prevalence. The function uses randomForest to build random forests trees for samples classification and variable importance computation. It performs classifications for each prevalence interval returned by <code>pime.prevalence</code>. Variable importance is calculated, returning the Mean Decrease Accuracy (MDA), Mean Decrease Impurity (MDI), overall and by sample group, and taxonomy for each ASV. PIME keeps the top 30 variables with highest MDA each prevalence level.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1911</span><span class="op">)</span>
<span class="va">its18_best.prev</span> <span class="op">&lt;-</span> <span class="fu">pime.best.prevalence</span><span class="op">(</span><span class="va">its18_prevalences</span>, <span class="st">"TEMP"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>         Interval OOB error rate (%) OTUs  Nseqs
1   Prevalence 5%              38.46 3057 119236
2  Prevalence 10%              53.85 3057 119236
3  Prevalence 15%              38.46 3057 119236
4  Prevalence 20%              38.46 2421 112518
5  Prevalence 25%              38.46 1152  91780
6  Prevalence 30%              23.08 1152  91780
7  Prevalence 35%              15.38 1152  91780
8  Prevalence 40%              30.77  873  82647
9  Prevalence 45%              15.38  873  82647
10 Prevalence 50%               7.69  474  67665
11 Prevalence 55%                  0  474  67665
12 Prevalence 60%               7.69  336  60556
13 Prevalence 65%                  0  336  60556
14 Prevalence 70%               7.69  336  60556
15 Prevalence 75%                  0  171  44260
16 Prevalence 80%                  0  114  33492
17 Prevalence 85%                  0  114  33492
18 Prevalence 90%                  0  114  33492
19 Prevalence 95%                  0  114  33492</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_what_is_best</span> <span class="op">&lt;-</span> <span class="va">its18_best.prev</span><span class="op">$</span><span class="va">`OOB error`</span>
<span class="va">its18_what_is_best</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">sapply</a></span><span class="op">(</span><span class="va">its18_what_is_best</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>, <span class="va">as.numeric</span><span class="op">)</span>
<span class="va">its18_what_is_best</span> <span class="op">&lt;-</span> <span class="va">its18_what_is_best</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"OOB_error_rate"</span> <span class="op">=</span> <span class="st">"OOB error rate (%)"</span><span class="op">)</span>
<span class="va">its18_what_is_best</span><span class="op">$</span><span class="va">Interval</span> <span class="op">&lt;-</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">its18_what_is_best</span><span class="op">$</span><span class="va">Interval</span>, <span class="st">"%"</span>, <span class="st">""</span><span class="op">)</span>
<span class="va">its18_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">its18_what_is_best</span>, <span class="va">Interval</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.min.html">which.min</a></span><span class="op">(</span><span class="va">OOB_error_rate</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">its18_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"`"</span>, <span class="va">its18_best</span>, <span class="st">"`"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">its18_prev_choice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_best.prev$`Importance`$"</span>, <span class="va">its18_best</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">its18_imp_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="op">(</span><span class="va">its18_prev_choice</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Looks like the lowest OOB error rate (%) that retains the most ASVs is 0% from <code>Prevalence 55</code>. We will use this interval.</p>
</section><section id="best-prevalence-summary-1" class="level3"><h3 class="anchored" data-anchor-id="best-prevalence-summary-1">Best Prevalence Summary</h3>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 7 | Summary of top 30 ASVs from the chosen prevalence interval.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,QVNWX0lELFgwLFgzLFg4LE1lYW5EZWNyZWFzZUFjY3VyYWN5LE1lYW5EZWNyZWFzZUdpbmksS2luZ2RvbSxQaHlsdW0sQ2xhc3MsT3JkZXIsRmFtaWx5LEdlbnVzCkFTVjMwNywwLjAwMzMzMzMzMzMzMzMzMzMzMywwLjAwNiwwLjAxMzY2NjY2NjY2NjY2NjY2NiwwLjAwNzYzODA5NTIzODA5NTIzOCwwLjA4NTk0MTc1ODI0MTc1ODIzLEZ1bmdpLGtfRnVuZ2ksa19GdW5naSxrX0Z1bmdpLGtfRnVuZ2ksa19GdW5naQpBU1YzMDIsMC4wMSwwLjAwMSwwLjAwOCwwLjAwNzIwOTUyMzgwOTUyMzgxLDAuMTI5MjIxOTc4MDIxOTc4LEZ1bmdpLGtfRnVuZ2ksa19GdW5naSxrX0Z1bmdpLGtfRnVuZ2ksa19GdW5naQpBU1Y2NzcsMC4wMTMsMC4wMDMsMC4wMDMsMC4wMDYyLDAuMDc3OTMxODY4MTMxODY4MTMsRnVuZ2ksQXNjb215Y290YSxTb3JkYXJpb215Y2V0ZXMsWHlsYXJpYWxlcyxYeWxhcmlhY2VhZSxmX1h5bGFyaWFjZWFlCkFTVjY0MywwLjAwMzY2NjY2NjY2NjY2NjY2NjYsMC4wMDQ2NjY2NjY2NjY2NjY2NjcsMC4wMTEsMC4wMDU5MzMzMzMzMzMzMzMzMzQsMC4xMDg0NTYxNjYwNTYxNjYwNixGdW5naSxrX0Z1bmdpLGtfRnVuZ2ksa19GdW5naSxrX0Z1bmdpLGtfRnVuZ2kKQVNWNzEsMC4wMDgzMzMzMzMzMzMzMzMzMzEsMC4wMDIsMC4wMDUsMC4wMDU3MzMzMzMzMzMzMzMzMzQsMC4wOTYzNzcyODkzNzcyODkzNyxGdW5naSxCYXNpZGlvbXljb3RhLFRyZW1lbGxvbXljZXRlcyxUcmljaG9zcG9yb25hbGVzLFRyaWNob3Nwb3JvbmFjZWFlLEFwaW90cmljaHVtCkFTVjQzNywwLjAxMSwwLjAwNDY2NjY2NjY2NjY2NjY2NiwwLjAwMiwwLjAwNTM2NjY2NjY2NjY2NjY2NiwwLjA4ODk4MTY4NDk4MTY4NDk5LEZ1bmdpLEFzY29teWNvdGEsRG90aGlkZW9teWNldGVzLFBsZW9zcG9yYWxlcyxQbGVvc3BvcmFsZXNfZmFtX0luY2VydGFlX3NlZGlzLFBvbHlzY2hlbWEKQVNWMTI1LDAuMDA4NjY2NjY2NjY2NjY2NjY4LDAuMDAzLDAuMDA1LDAuMDA1MzAwMDAwMDAwMDAwMDAxLDAuMDc4MTMxODY4MTMxODY4MTIsRnVuZ2ksQXNjb215Y290YSxQZXppem9teWNldGVzLFBleml6YWxlcyxQeXJvbmVtYXRhY2VhZSxTY3V0ZWxsaW5pYQpBU1YzMTgsLTAuMDAxLDAuMDA2LDAuMDEwNjY2NjY2NjY2NjY2NjY2LDAuMDA1MTA0NzYxOTA0NzYxOTA0NSwwLjA2NDYxMzkxOTQxMzkxOTQsRnVuZ2ksQmFzaWRpb215Y290YSxBZ2FyaWNvbXljZXRlcyxBZ2FyaWNhbGVzLENsYXZhcmlhY2VhZSxSYW1hcmlvcHNpcwpBU1Y1MDIsMC4wMDIsMC4wMDI2NjY2NjY2NjY2NjY2NjY2LDAuMDA3LDAuMDA0NTMzMzMzMzMzMzMzMzMzLDAuMDY0MjkxNTc1MDkxNTc1MDgsRnVuZ2ksa19GdW5naSxrX0Z1bmdpLGtfRnVuZ2ksa19GdW5naSxrX0Z1bmdpCkFTVjEwNCwwLjAwMTgzMzMzMzMzMzMzMzMzMywwLjAwMSwwLjAwOTMzMzMzMzMzMzMzMzMzNCwwLjAwNDIwMDAwMDAwMDAwMDAwMSwwLjE0NTYzMTg2ODEzMTg2ODEzLEZ1bmdpLEFzY29teWNvdGEsU29yZGFyaW9teWNldGVzLFh5bGFyaWFsZXMsTWljcm9kb2NoaWFjZWFlLElkcmllbGxhCkFTVjQwLDAuMDA0LDAuMDAxLDAuMDA2MzMzMzMzMzMzMzMzMzMzLDAuMDA0MSwwLjA2NTIzMjExMjMzMjExMjMzLEZ1bmdpLEFzY29teWNvdGEsRG90aGlkZW9teWNldGVzLFBsZW9zcG9yYWxlcyxQbGVvc3BvcmFsZXNfZmFtX0luY2VydGFlX3NlZGlzLFBvbHlzY2hlbWEKQVNWMTE0MSwwLjAwNiwwLjAwNCwwLDAuMDAzOSwwLjA0MDAzMzMzMzMzMzMzMzMzLEZ1bmdpLEFzY29teWNvdGEscF9Bc2NvbXljb3RhLHBfQXNjb215Y290YSxwX0FzY29teWNvdGEscF9Bc2NvbXljb3RhCkFTVjQ4MSwwLjAwNSwwLjAwNSwwLDAuMDAzODY2NjY2NjY2NjY2NjY2NywwLjA4MTU2ODEzMTg2ODEzMTg3LEZ1bmdpLEFzY29teWNvdGEsU29yZGFyaW9teWNldGVzLEh5cG9jcmVhbGVzLE5lY3RyaWFjZWFlLEZ1c2FyaXVtCkFTVjM0OSwwLjAwOSwwLjAwMSwwLDAuMDAzODY2NjY2NjY2NjY2NjY2MywwLjA3NDE5MTk0MTM5MTk0MTM4LEZ1bmdpLEFzY29teWNvdGEsU29yZGFyaW9teWNldGVzLFh5bGFyaWFsZXMsWHlsYXJpYWNlYWUsZl9YeWxhcmlhY2VhZQpBU1Y2NTksMC4wMDE2NjY2NjY2NjY2NjY2NjY2LDAuMDA4LDAuMDA0LDAuMDAzOCwwLjA4ODc3NjU1Njc3NjU1Njc3LEZ1bmdpLEFzY29teWNvdGEscF9Bc2NvbXljb3RhLHBfQXNjb215Y290YSxwX0FzY29teWNvdGEscF9Bc2NvbXljb3RhCkFTVjY1MywwLjAwOCwwLjAwMSwwLjAwMjY2NjY2NjY2NjY2NjY2NjYsMC4wMDM2MzMzMzMzMzMzMzMzMzM1LDAuMDc0ODY0NDY4ODY0NDY4ODYsRnVuZ2ksQmFzaWRpb215Y290YSxwX0Jhc2lkaW9teWNvdGEscF9CYXNpZGlvbXljb3RhLHBfQmFzaWRpb215Y290YSxwX0Jhc2lkaW9teWNvdGEKQVNWMzMsMC4wMDYsMC4wMDIsMC4wMDMsMC4wMDM1MzMzMzMzMzMzMzMzMzMsMC4wNzI0ODk5MTAwODk5MTAwOCxGdW5naSxNb3J0aWVyZWxsb215Y290YSxNb3J0aWVyZWxsb215Y2V0ZXMsTW9ydGllcmVsbGFsZXMsTW9ydGllcmVsbGFjZWFlLE1vcnRpZXJlbGxhCkFTVjExOCwwLjAwNiwwLjAwMiwwLDAuMDAzMDY2NjY2NjY2NjY2NjY2MywwLjA0NzU5MjE4NTU5MjE4NTU5LEZ1bmdpLGtfRnVuZ2ksa19GdW5naSxrX0Z1bmdpLGtfRnVuZ2ksa19GdW5naQpBU1YzLDAuMDAxNjY2NjY2NjY2NjY2NjY2NiwwLjAwMiwwLjAwNjMzMzMzMzMzMzMzMzMzMywwLjAwMzAzODA5NTIzODA5NTIzOCwwLjAzODEzNTE2NDgzNTE2NDgzLEZ1bmdpLEFzY29teWNvdGEscF9Bc2NvbXljb3RhLHBfQXNjb215Y290YSxwX0FzY29teWNvdGEscF9Bc2NvbXljb3RhCkFTVjE4NCwwLjAwNDgzMzMzMzMzMzMzMzMzMywwLjAwMSwwLjAwMSwwLjAwMywwLjA1MTkyNTI3NDcyNTI3NDcyLEZ1bmdpLFJvemVsbG9teWNvdGEsUm96ZWxsb215Y290aW5hX2Nsc19JbmNlcnRhZV9zZWRpcyxHUzExLG9fR1MxMSxvX0dTMTEKQVNWMTY0LDAuMDAxLDAuMDAxLDAuMDA3LDAuMDAyOTMzMzMzMzMzMzMzMzMzNCwwLjA5MzQ5MjY3Mzk5MjY3Mzk4LEZ1bmdpLEJhc2lkaW9teWNvdGEsQWdhcmljb215Y2V0ZXMsU2ViYWNpbmFsZXMsb19TZWJhY2luYWxlcyxvX1NlYmFjaW5hbGVzCkFTVjgxLDAuMDA3LDAsMC4wMDI2NjY2NjY2NjY2NjY2NjY2LDAuMDAyOSwwLjAzNjAzODQ2MTUzODQ2MTU0LEZ1bmdpLENoeXRyaWRpb215Y290YSxDaHl0cmlkaW9teWNldGVzLENoeXRyaWRpYWxlcyxDaHl0cmlkaWFsZXNfZmFtX0luY2VydGFlX3NlZGlzLERlbGZpbmFjaHl0cml1bQpBU1YxNTQsMCwwLjAwMSwwLjAwNiwwLjAwMjgzMzMzMzMzMzMzMzMzMywwLjA1MTYwNjcxNTUwNjcxNTUsRnVuZ2ksa19GdW5naSxrX0Z1bmdpLGtfRnVuZ2ksa19GdW5naSxrX0Z1bmdpCkFTVjU2NywwLjAwMzY2NjY2NjY2NjY2NjY2NjYsMC4wMDMsMC4wMDE2NjY2NjY2NjY2NjY2NjY2LDAuMDAyODAwMDAwMDAwMDAwMDAwNCwwLjA0MTUwMzA1MjUwMzA1MjUsRnVuZ2ksa19GdW5naSxrX0Z1bmdpLGtfRnVuZ2ksa19GdW5naSxrX0Z1bmdpCkFTVjQ2LDAuMDAzLDAuMDA2LDAsMC4wMDI3MzMzMzMzMzMzMzMzMzMsMC4wNDU5NjMzNjk5NjMzNjk5NjQsRnVuZ2ksQmFzaWRpb215Y290YSxBZ2FyaWNvbXljZXRlcyxDYW50aGFyZWxsYWxlcyxDZXJhdG9iYXNpZGlhY2VhZSxmX0NlcmF0b2Jhc2lkaWFjZWFlCkFTVjE0MCwwLjAwNiwtMC4wMDIsMC4wMDUsMC4wMDI2OTk5OTk5OTk5OTk5OTk3LDAuMDQ5NDM1ODk3NDM1ODk3NDM2LEZ1bmdpLEFzY29teWNvdGEscF9Bc2NvbXljb3RhLHBfQXNjb215Y290YSxwX0FzY29teWNvdGEscF9Bc2NvbXljb3RhCkFTVjU3MCwwLjAwMSwwLjAwMSwwLjAwNiwwLjAwMjYzMzMzMzMzMzMzMzMzMzQsMC4wMzM0Nzg4NzY2Nzg4NzY2OCxGdW5naSxBc2NvbXljb3RhLFNhY2NoYXJvbXljZXRlcyxTYWNjaGFyb215Y2V0YWxlcyxNZXRzY2huaWtvd2lhY2VhZSxNZXRzY2huaWtvd2lhCkFTVjEzMTgsMC4wMDUsMC4wMDIsMCwwLjAwMjU5OTk5OTk5OTk5OTk5OTQsMC4wNzI4MTg1NTkyMTg1NTkyMixGdW5naSxrX0Z1bmdpLGtfRnVuZ2ksa19GdW5naSxrX0Z1bmdpLGtfRnVuZ2kKQVNWMTg1LDAuMDA0MzMzMzMzMzMzMzMzMzMzLDAsMC4wMDIsMC4wMDI0MDAwMDAwMDAwMDAwMDAyLDAuMDcyNTI1NjQxMDI1NjQxMDIsRnVuZ2ksQmFzaWRpb215Y290YSxUcmVtZWxsb215Y2V0ZXMsVHJpY2hvc3Bvcm9uYWxlcyxUcmljaG9zcG9yb25hY2VhZSxBcGlvdHJpY2h1bQpBU1Y2MDMsMCwwLjAwMiwwLjAwNiwwLjAwMjQsMC4wMzQ1MzA3NjkyMzA3NjkyMyxGdW5naSxab29wYWdvbXljb3RhLFpvb3BhZ29teWNldGVzLFpvb3BhZ2FsZXMsUGlwdG9jZXBoYWxpZGFjZWFlLFN5bmNlcGhhbGlzCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_pime_filt_top_asvs.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-828f1fbe673e4a39fe83" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-828f1fbe673e4a39fe83">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"ASV_ID":["ASV307","ASV302","ASV677","ASV643","ASV71","ASV437","ASV125","ASV318","ASV502","ASV104","ASV40","ASV1141","ASV481","ASV349","ASV659","ASV653","ASV33","ASV118","ASV3","ASV184","ASV164","ASV81","ASV154","ASV567","ASV46","ASV140","ASV570","ASV1318","ASV185","ASV603"],"Control":[0.0033,0.01,0.013,0.0037,0.0083,0.011,0.0087,-0.001,0.002,0.0018,0.004,0.006,0.005,0.009,0.0017,0.008,0.006,0.006,0.0017,0.0048,0.001,0.007,0,0.0037,0.003,0.006,0.001,0.005,0.0043,0],"Warm_3":[0.006,0.001,0.003,0.0047,0.002,0.0047,0.003,0.006,0.0027,0.001,0.001,0.004,0.005,0.001,0.008,0.001,0.002,0.002,0.002,0.001,0.001,0,0.001,0.003,0.006,-0.002,0.001,0.002,0,0.002],"Warm_8":[0.0137,0.008,0.003,0.011,0.005,0.002,0.005,0.0107,0.007,0.0093,0.0063,0,0,0,0.004,0.0027,0.003,0,0.0063,0.001,0.007,0.0027,0.006,0.0017,0,0.005,0.006,0,0.002,0.006],"MeanDecreaseAccuracy":[0.0076,0.0072,0.0062,0.0059,0.0057,0.0054,0.0053,0.0051,0.0045,0.0042,0.0041,0.0039,0.0039,0.0039,0.0038,0.0036,0.0035,0.0031,0.003,0.003,0.0029,0.0029,0.0028,0.0028,0.0027,0.0027,0.0026,0.0026,0.0024,0.0024],"MeanDecreaseGini":[0.0859,0.1292,0.0779,0.1085,0.0964,0.089,0.0781,0.0646,0.0643,0.1456,0.0652,0.04,0.0816,0.0742,0.0888,0.0749,0.0725,0.0476,0.0381,0.0519,0.0935,0.036,0.0516,0.0415,0.046,0.0494,0.0335,0.0728,0.0725,0.0345],"Kingdom":["Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi"],"Phylum":["k_Fungi","k_Fungi","Ascomycota","k_Fungi","Basidiomycota","Ascomycota","Ascomycota","Basidiomycota","k_Fungi","Ascomycota","Ascomycota","Ascomycota","Ascomycota","Ascomycota","Ascomycota","Basidiomycota","Mortierellomycota","k_Fungi","Ascomycota","Rozellomycota","Basidiomycota","Chytridiomycota","k_Fungi","k_Fungi","Basidiomycota","Ascomycota","Ascomycota","k_Fungi","Basidiomycota","Zoopagomycota"],"Class":["k_Fungi","k_Fungi","Sordariomycetes","k_Fungi","Tremellomycetes","Dothideomycetes","Pezizomycetes","Agaricomycetes","k_Fungi","Sordariomycetes","Dothideomycetes","p_Ascomycota","Sordariomycetes","Sordariomycetes","p_Ascomycota","p_Basidiomycota","Mortierellomycetes","k_Fungi","p_Ascomycota","Rozellomycotina_cls_Incertae_sedis","Agaricomycetes","Chytridiomycetes","k_Fungi","k_Fungi","Agaricomycetes","p_Ascomycota","Saccharomycetes","k_Fungi","Tremellomycetes","Zoopagomycetes"],"Order":["k_Fungi","k_Fungi","Xylariales","k_Fungi","Trichosporonales","Pleosporales","Pezizales","Agaricales","k_Fungi","Xylariales","Pleosporales","p_Ascomycota","Hypocreales","Xylariales","p_Ascomycota","p_Basidiomycota","Mortierellales","k_Fungi","p_Ascomycota","GS11","Sebacinales","Chytridiales","k_Fungi","k_Fungi","Cantharellales","p_Ascomycota","Saccharomycetales","k_Fungi","Trichosporonales","Zoopagales"],"Family":["k_Fungi","k_Fungi","Xylariaceae","k_Fungi","Trichosporonaceae","Pleosporales_fam_Incertae_sedis","Pyronemataceae","Clavariaceae","k_Fungi","Microdochiaceae","Pleosporales_fam_Incertae_sedis","p_Ascomycota","Nectriaceae","Xylariaceae","p_Ascomycota","p_Basidiomycota","Mortierellaceae","k_Fungi","p_Ascomycota","o_GS11","o_Sebacinales","Chytridiales_fam_Incertae_sedis","k_Fungi","k_Fungi","Ceratobasidiaceae","p_Ascomycota","Metschnikowiaceae","k_Fungi","Trichosporonaceae","Piptocephalidaceae"],"Genus":["k_Fungi","k_Fungi","f_Xylariaceae","k_Fungi","Apiotrichum","Polyschema","Scutellinia","Ramariopsis","k_Fungi","Idriella","Polyschema","p_Ascomycota","Fusarium","f_Xylariaceae","p_Ascomycota","p_Basidiomycota","Mortierella","k_Fungi","p_Ascomycota","o_GS11","o_Sebacinales","Delfinachytrium","k_Fungi","k_Fungi","f_Ceratobasidiaceae","p_Ascomycota","Metschnikowia","k_Fungi","Apiotrichum","Syncephalis"]},"columns":[{"accessor":"ASV_ID","name":"ASV ID","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["ASV307","ASV302","ASV677","ASV643","ASV71","ASV437","ASV125","ASV318","ASV502","ASV104","ASV40","ASV1141","ASV481","ASV349","ASV659","ASV653","ASV33","ASV118","ASV3","ASV184","ASV164","ASV81","ASV154","ASV567","ASV46","ASV140","ASV570","ASV1318","ASV185","ASV603"],"header":"ASV ID","minWidth":100,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Control","name":"Control","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0033","0.0100","0.0130","0.0037","0.0083","0.0110","0.0087","-0.0010","0.0020","0.0018","0.0040","0.0060","0.0050","0.0090","0.0017","0.0080","0.0060","0.0060","0.0017","0.0048","0.0010","0.0070","0.0000","0.0037","0.0030","0.0060","0.0010","0.0050","0.0043","0.0000"],"header":"Control","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Warm_3","name":"Warm_3","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0060","0.0010","0.0030","0.0047","0.0020","0.0047","0.0030","0.0060","0.0027","0.0010","0.0010","0.0040","0.0050","0.0010","0.0080","0.0010","0.0020","0.0020","0.0020","0.0010","0.0010","0.0000","0.0010","0.0030","0.0060","-0.0020","0.0010","0.0020","0.0000","0.0020"],"header":"Warm 3","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Warm_8","name":"Warm_8","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0137","0.0080","0.0030","0.0110","0.0050","0.0020","0.0050","0.0107","0.0070","0.0093","0.0063","0.0000","0.0000","0.0000","0.0040","0.0027","0.0030","0.0000","0.0063","0.0010","0.0070","0.0027","0.0060","0.0017","0.0000","0.0050","0.0060","0.0000","0.0020","0.0060"],"header":"Warm 8","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"MeanDecreaseAccuracy","name":"MeanDecreaseAccuracy","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0076","0.0072","0.0062","0.0059","0.0057","0.0054","0.0053","0.0051","0.0045","0.0042","0.0041","0.0039","0.0039","0.0039","0.0038","0.0036","0.0035","0.0031","0.0030","0.0030","0.0029","0.0029","0.0028","0.0028","0.0027","0.0027","0.0026","0.0026","0.0024","0.0024"],"header":"MeanDecreaseAccuracy","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"MeanDecreaseGini","name":"MeanDecreaseGini","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.0859","0.1292","0.0779","0.1085","0.0964","0.0890","0.0781","0.0646","0.0643","0.1456","0.0652","0.0400","0.0816","0.0742","0.0888","0.0749","0.0725","0.0476","0.0381","0.0519","0.0935","0.0360","0.0516","0.0415","0.0460","0.0494","0.0335","0.0728","0.0725","0.0345"],"header":"MeanDecreaseGini","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Kingdom","name":"Kingdom","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi","Fungi"],"header":"Kingdom","minWidth":100,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Phylum","name":"Phylum","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["k_Fungi","k_Fungi","Ascomycota","k_Fungi","Basidiomycota","Ascomycota","Ascomycota","Basidiomycota","k_Fungi","Ascomycota","Ascomycota","Ascomycota","Ascomycota","Ascomycota","Ascomycota","Basidiomycota","Mortierellomycota","k_Fungi","Ascomycota","Rozellomycota","Basidiomycota","Chytridiomycota","k_Fungi","k_Fungi","Basidiomycota","Ascomycota","Ascomycota","k_Fungi","Basidiomycota","Zoopagomycota"],"header":"Phylum","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Class","name":"Class","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["k_Fungi","k_Fungi","Sordariomycetes","k_Fungi","Tremellomycetes","Dothideomycetes","Pezizomycetes","Agaricomycetes","k_Fungi","Sordariomycetes","Dothideomycetes","p_Ascomycota","Sordariomycetes","Sordariomycetes","p_Ascomycota","p_Basidiomycota","Mortierellomycetes","k_Fungi","p_Ascomycota","Rozellomycotina_cls_Incertae_sedis","Agaricomycetes","Chytridiomycetes","k_Fungi","k_Fungi","Agaricomycetes","p_Ascomycota","Saccharomycetes","k_Fungi","Tremellomycetes","Zoopagomycetes"],"header":"Class","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Order","name":"Order","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["k_Fungi","k_Fungi","Xylariales","k_Fungi","Trichosporonales","Pleosporales","Pezizales","Agaricales","k_Fungi","Xylariales","Pleosporales","p_Ascomycota","Hypocreales","Xylariales","p_Ascomycota","p_Basidiomycota","Mortierellales","k_Fungi","p_Ascomycota","GS11","Sebacinales","Chytridiales","k_Fungi","k_Fungi","Cantharellales","p_Ascomycota","Saccharomycetales","k_Fungi","Trichosporonales","Zoopagales"],"header":"Order","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Family","name":"Family","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["k_Fungi","k_Fungi","Xylariaceae","k_Fungi","Trichosporonaceae","Pleosporales_fam_Incertae_sedis","Pyronemataceae","Clavariaceae","k_Fungi","Microdochiaceae","Pleosporales_fam_Incertae_sedis","p_Ascomycota","Nectriaceae","Xylariaceae","p_Ascomycota","p_Basidiomycota","Mortierellaceae","k_Fungi","p_Ascomycota","o_GS11","o_Sebacinales","Chytridiales_fam_Incertae_sedis","k_Fungi","k_Fungi","Ceratobasidiaceae","p_Ascomycota","Metschnikowiaceae","k_Fungi","Trichosporonaceae","Piptocephalidaceae"],"header":"Family","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}},{"accessor":"Genus","name":"Genus","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["k_Fungi","k_Fungi","f_Xylariaceae","k_Fungi","Apiotrichum","Polyschema","Scutellinia","Ramariopsis","k_Fungi","Idriella","Polyschema","p_Ascomycota","Fusarium","f_Xylariaceae","p_Ascomycota","p_Basidiomycota","Mortierella","k_Fungi","p_Ascomycota","o_GS11","o_Sebacinales","Delfinachytrium","k_Fungi","k_Fungi","f_Ceratobasidiaceae","p_Ascomycota","Metschnikowia","k_Fungi","Apiotrichum","Syncephalis"],"header":"Genus","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,30],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"f38d9cfe4109dce65caa354438493969"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ASV307"  "ASV302"  "ASV677"  "ASV643"  "ASV71"   "ASV437"  "ASV125" 
 [8] "ASV318"  "ASV502"  "ASV104"  "ASV40"   "ASV1141" "ASV481"  "ASV349" 
[15] "ASV659"  "ASV653"  "ASV33"   "ASV118"  "ASV3"    "ASV184"  "ASV164" 
[22] "ASV81"   "ASV154"  "ASV567"  "ASV46"   "ASV140"  "ASV570"  "ASV1318"
[29] "ASV185"  "ASV603" </code></pre>
</div>
</div>
<p>Now we need to create a phyloseq object of ASVs at this cutoff (<code>Prevalence 55</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_best_val</span> <span class="op">&lt;-</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">its18_best</span>, <span class="st">"Prevalence "</span>, <span class="st">""</span><span class="op">)</span>
<span class="va">its18_best_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_prevalences$"</span>, <span class="va">its18_best_val</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">its18_prevalence_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="op">(</span><span class="va">its18_best_val</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">its18_prevalence_best</span>, <span class="st">"files/filtering/pime/rdata/its18_asv_prevalence_best.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And look at a summary of the data.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 474 taxa and 13 samples ]
sample_data() Sample Data:       [ 13 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 474 taxa by 8 taxonomic ranks ]</code></pre>
</div>
</div>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 5 | Summary of PERfect filtering using the defualt order and filtering p-values &lt; 0.10.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,TWV0cmljLEZ1bGwgZGF0YSxQSU1FIGZpbHRlcgpUb3RhbCBudW1iZXIgb2YgcmVhZHMsNDkwNzY3LDY3NjY1Ck1pbi4gbnVtYmVyIG9mIHJlYWRzLDkxNzIsMzQ0MgpNYXguIG51bWJlciBvZiByZWFkcyw2NDYzNiw2NzYxCkF2ZXJhZ2UgbnVtYmVyIG9mIHJlYWRzLDM3NzUxLDUyMDUKTWVkaWFuIG51bWJlciBvZiByZWFkcywzODM3MSw0OTYzClRvdGFsIEFTVnMsMzM1NSw0NzQKTWluLiBudW1iZXIgb2YgQVNWcywzMzUsOTcKTWF4LiBudW1iZXIgb2YgQVNWcywxMDE3LDI0NgpBdmVyYWdlIG51bWJlciBvZiBBU1ZzLDc1NywxODEKTWVkaWFuIG51bWJlciBvZiBBU1ZzLDc2NSwxOTYK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_perfect_filt_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-a01269357138fbd87902" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a01269357138fbd87902">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Metric":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"Full data":[490767,9172,64636,37751,38371,3355,335,1017,757,765],"PIME filter":[67665,3442,6761,5205,4963,474,97,246,181,196]},"columns":[{"accessor":"Metric","name":"Metric","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Total number of reads","Min. number of reads","Max. number of reads","Average number of reads","Median number of reads","Total ASVs","Min. number of ASVs","Max. number of ASVs","Average number of ASVs","Median number of ASVs"],"header":"Metric","minWidth":200,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"Full data","name":"Full data","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["490767","9172","64636","37751","38371","3355","335","1017","757","765"],"header":"Full data","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PIME filter","name":"PIME filter","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["67665","3442","6761","5205","4963","474","97","246","181","196"],"header":"PIME filter","minWidth":150,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[5,10,10],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"82b38e8e6ec875ed50d6b64dfc938651"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="estimate-error-in-prediction-1" class="level3"><h3 class="anchored" data-anchor-id="estimate-error-in-prediction-1">Estimate Error in Prediction</h3>
<p>Using the function <code>pime.error.prediction</code> we can estimate the error in prediction. For each prevalence interval, this function randomizes the samples labels into arbitrary groupings using <code>n</code> random permutations, defined by the <code>bootstrap</code> value. For each, randomized and prevalence filtered, data set the OOB error rate is calculated to estimate whether the original differences in groups of samples occur by chance. Results are in a list containing a table and a box plot summarizing the results.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_randomized</span> <span class="op">&lt;-</span> <span class="fu">pime.error.prediction</span><span class="op">(</span><span class="va">its18_pime_ds</span>, <span class="st">"TEMP"</span>,
                                          bootstrap <span class="op">=</span> <span class="fl">100</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>,
                                          max.prev <span class="op">=</span> <span class="fl">95</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 8 | Results of 100 random permutations for each prevalence interval based on a function that randomizes the samples labels into arbitrary groupings. using n random permutations. For each randomized and prevalence filtered data set, the OOB error rate is calculated to estimate whether the original differences in groups of samples occur by chance. </strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,UHJldmFsZW5jZTUlLFByZXZhbGVuY2UxMCUsUHJldmFsZW5jZTE1JSxQcmV2YWxlbmNlMjAlLFByZXZhbGVuY2UyNSUsUHJldmFsZW5jZTMwJSxQcmV2YWxlbmNlMzUlLFByZXZhbGVuY2U0MCUsUHJldmFsZW5jZTQ1JSxQcmV2YWxlbmNlNTAlLFByZXZhbGVuY2U1NSUsUHJldmFsZW5jZTYwJSxQcmV2YWxlbmNlNjUlLFByZXZhbGVuY2U3MCUsUHJldmFsZW5jZTc1JSxQcmV2YWxlbmNlODAlLFByZXZhbGVuY2U4NSUsUHJldmFsZW5jZTkwJSxQcmV2YWxlbmNlOTUlCjAuOTIzMDc2OTIzMDc2OTIzMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC42OTIzMDc2OTIzMDc2OTIzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjMwNzY5MjMwNzY5MjMwNzcsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuMzA3NjkyMzA3NjkyMzA3NywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEKMC42OTIzMDc2OTIzMDc2OTIzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuMjMwNzY5MjMwNzY5MjMwNzgsMC44NDYxNTM4NDYxNTM4NDYxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQKMC45MjMwNzY5MjMwNzY5MjMxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC45MjMwNzY5MjMwNzY5MjMxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42MTUzODQ2MTUzODQ2MTU0LDAuOTIzMDc2OTIzMDc2OTIzMSwxLDAuMjMwNzY5MjMwNzY5MjMwNzgsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjY5MjMwNzY5MjMwNzY5MjMsMC42OTIzMDc2OTIzMDc2OTIzLDAuNTM4NDYxNTM4NDYxNTM4NAowLjM4NDYxNTM4NDYxNTM4NDY0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjYxNTM4NDYxNTM4NDYxNTQsMSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42MTUzODQ2MTUzODQ2MTU0LDEsMC45MjMwNzY5MjMwNzY5MjMxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQKMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjMwNzY5MjMwNzY5MjMwNzcsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjIzMDc2OTIzMDc2OTIzMDc4LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjYxNTM4NDYxNTM4NDYxNTQsMC45MjMwNzY5MjMwNzY5MjMxCjAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC45MjMwNzY5MjMwNzY5MjMxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQKMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjQ2MTUzODQ2MTUzODQ2MTU2LDEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC44NDYxNTM4NDYxNTM4NDYxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjUzODQ2MTUzODQ2MTUzODQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjMwNzY5MjMwNzY5MjMwNzcKMC43NjkyMzA3NjkyMzA3NjkzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC44NDYxNTM4NDYxNTM4NDYxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMSwxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC42OTIzMDc2OTIzMDc2OTIzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC42OTIzMDc2OTIzMDc2OTIzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzCjAuNTM4NDYxNTM4NDYxNTM4NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuNzY5MjMwNzY5MjMwNzY5MywxLDAuMzA3NjkyMzA3NjkyMzA3NywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC42OTIzMDc2OTIzMDc2OTIzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjYxNTM4NDYxNTM4NDYxNTQsMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MwowLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDEsMC44NDYxNTM4NDYxNTM4NDYxLDAuNzY5MjMwNzY5MjMwNzY5MywxLDEsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNTM4NDYxNTM4NDYxNTM4NAowLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQKMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2CjAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2CjAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMSwwLjUzODQ2MTUzODQ2MTUzODQsMC4xNTM4NDYxNTM4NDYxNTM4NSwwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMjMwNzY5MjMwNzY5MjMwNzgsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMQowLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMjMwNzY5MjMwNzY5MjMwNzgsMC42OTIzMDc2OTIzMDc2OTIzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC42OTIzMDc2OTIzMDc2OTIzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjUzODQ2MTUzODQ2MTUzODQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjIzMDc2OTIzMDc2OTIzMDc4LDAuNTM4NDYxNTM4NDYxNTM4NAowLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjkyMzA3NjkyMzA3NjkyMzEsMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC42OTIzMDc2OTIzMDc2OTIzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC44NDYxNTM4NDYxNTM4NDYxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuOTIzMDc2OTIzMDc2OTIzMQoxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC45MjMwNzY5MjMwNzY5MjMxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC44NDYxNTM4NDYxNTM4NDYxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMSwwLjc2OTIzMDc2OTIzMDc2OTMKMC44NDYxNTM4NDYxNTM4NDYxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC44NDYxNTM4NDYxNTM4NDYxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0CjEsMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjYxNTM4NDYxNTM4NDYxNTQsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwxLDEsMC42OTIzMDc2OTIzMDc2OTIzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NAowLjg0NjE1Mzg0NjE1Mzg0NjEsMC42MTUzODQ2MTUzODQ2MTU0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42OTIzMDc2OTIzMDc2OTIzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNTM4NDYxNTM4NDYxNTM4NCwxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuODQ2MTUzODQ2MTUzODQ2MSwwLjUzODQ2MTUzODQ2MTUzODQsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNjkyMzA3NjkyMzA3NjkyMywwLjY5MjMwNzY5MjMwNzY5MjMsMC4zMDc2OTIzMDc2OTIzMDc3LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQKMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjYxNTM4NDYxNTM4NDYxNTQKMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjMwNzY5MjMwNzY5MjMwNzcsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjMwNzY5MjMwNzY5MjMwNzcsMC42OTIzMDc2OTIzMDc2OTIzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42OTIzMDc2OTIzMDc2OTIzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzCjAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC44NDYxNTM4NDYxNTM4NDYxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC44NDYxNTM4NDYxNTM4NDYxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC45MjMwNzY5MjMwNzY5MjMxLDAuNTM4NDYxNTM4NDYxNTM4NAowLjUzODQ2MTUzODQ2MTUzODQsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjMwNzY5MjMwNzY5MjMwNzcKMC42OTIzMDc2OTIzMDc2OTIzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjIzMDc2OTIzMDc2OTIzMDc4LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC42OTIzMDc2OTIzMDc2OTIzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjc2OTIzMDc2OTIzMDc2OTMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjE1Mzg0NjE1Mzg0NjE1Mzg1CjAuMzA3NjkyMzA3NjkyMzA3NywwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42OTIzMDc2OTIzMDc2OTIzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMywwLjYxNTM4NDYxNTM4NDYxNTQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjY5MjMwNzY5MjMwNzY5MjMsMSwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC44NDYxNTM4NDYxNTM4NDYxCjAuODQ2MTUzODQ2MTUzODQ2MSwwLjMwNzY5MjMwNzY5MjMwNzcsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC42OTIzMDc2OTIzMDc2OTIzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzLDAuODQ2MTUzODQ2MTUzODQ2MSwxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjMwNzY5MjMwNzY5MjMwNzcsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuMzg0NjE1Mzg0NjE1Mzg0NjQsMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMKMC42OTIzMDc2OTIzMDc2OTIzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMKMC43NjkyMzA3NjkyMzA3NjkzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC44NDYxNTM4NDYxNTM4NDYxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC45MjMwNzY5MjMwNzY5MjMxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNzY5MjMwNzY5MjMwNzY5MywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuMzg0NjE1Mzg0NjE1Mzg0NjQKMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC44NDYxNTM4NDYxNTM4NDYxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42MTUzODQ2MTUzODQ2MTU0LDAuOTIzMDc2OTIzMDc2OTIzMSwxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC42OTIzMDc2OTIzMDc2OTIzCjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjc2OTIzMDc2OTIzMDc2OTMsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuMzA3NjkyMzA3NjkyMzA3NwowLjYxNTM4NDYxNTM4NDYxNTQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC44NDYxNTM4NDYxNTM4NDYxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjMwNzY5MjMwNzY5MjMwNzcsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42OTIzMDc2OTIzMDc2OTIzLDEKMC45MjMwNzY5MjMwNzY5MjMxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC42OTIzMDc2OTIzMDc2OTIzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC44NDYxNTM4NDYxNTM4NDYxCjAuNDYxNTM4NDYxNTM4NDYxNTYsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC44NDYxNTM4NDYxNTM4NDYxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjc2OTIzMDc2OTIzMDc2OTMsMC44NDYxNTM4NDYxNTM4NDYxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjUzODQ2MTUzODQ2MTUzODQsMC45MjMwNzY5MjMwNzY5MjMxLDAuNDYxNTM4NDYxNTM4NDYxNTYKMC42MTUzODQ2MTUzODQ2MTU0LDAuMzA3NjkyMzA3NjkyMzA3NywwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42OTIzMDc2OTIzMDc2OTIzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMKMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjIzMDc2OTIzMDc2OTIzMDc4LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMywwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzCjAuMzA3NjkyMzA3NjkyMzA3NywwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNzY5MjMwNzY5MjMwNzY5MywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjkyMzA3NjkyMzA3NjkyMywxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42MTUzODQ2MTUzODQ2MTU0LDAuOTIzMDc2OTIzMDc2OTIzMSwxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC40NjE1Mzg0NjE1Mzg0NjE1NgowLjM4NDYxNTM4NDYxNTM4NDY0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMSwxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42OTIzMDc2OTIzMDc2OTIzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQKMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuMTUzODQ2MTUzODQ2MTUzODUsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywxCjAuNjE1Mzg0NjE1Mzg0NjE1NCwxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEKMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjUzODQ2MTUzODQ2MTUzODQsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNjkyMzA3NjkyMzA3NjkyMywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC45MjMwNzY5MjMwNzY5MjMxCjAuNDYxNTM4NDYxNTM4NDYxNTYsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC4yMzA3NjkyMzA3NjkyMzA3OCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42MTUzODQ2MTUzODQ2MTU0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjc2OTIzMDc2OTIzMDc2OTMsMC43NjkyMzA3NjkyMzA3NjkzCjAuNTM4NDYxNTM4NDYxNTM4NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC44NDYxNTM4NDYxNTM4NDYxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2CjAuNzY5MjMwNzY5MjMwNzY5MywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC44NDYxNTM4NDYxNTM4NDYxLDAuMzA3NjkyMzA3NjkyMzA3NywwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNTM4NDYxNTM4NDYxNTM4NAowLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC44NDYxNTM4NDYxNTM4NDYxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuOTIzMDc2OTIzMDc2OTIzMQowLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxCjAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMC42MTUzODQ2MTUzODQ2MTU0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuOTIzMDc2OTIzMDc2OTIzMSwxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMwowLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNzY5MjMwNzY5MjMwNzY5MywwLjMwNzY5MjMwNzY5MjMwNzcsMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNjkyMzA3NjkyMzA3NjkyMywwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDEsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2CjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC44NDYxNTM4NDYxNTM4NDYxLDEsMC4yMzA3NjkyMzA3NjkyMzA3OCwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjMwNzY5MjMwNzY5MjMwNzcsMC4zMDc2OTIzMDc2OTIzMDc3LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NAowLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC42OTIzMDc2OTIzMDc2OTIzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjUzODQ2MTUzODQ2MTUzODQsMC45MjMwNzY5MjMwNzY5MjMxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC44NDYxNTM4NDYxNTM4NDYxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjkyMzA3NjkyMzA3NjkyMwowLjM4NDYxNTM4NDYxNTM4NDY0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjYxNTM4NDYxNTM4NDYxNTQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC45MjMwNzY5MjMwNzY5MjMxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC42MTUzODQ2MTUzODQ2MTU0LDEsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC44NDYxNTM4NDYxNTM4NDYxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC44NDYxNTM4NDYxNTM4NDYxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuMTUzODQ2MTUzODQ2MTUzODUsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC45MjMwNzY5MjMwNzY5MjMxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjUzODQ2MTUzODQ2MTUzODQsMC44NDYxNTM4NDYxNTM4NDYxCjAuNzY5MjMwNzY5MjMwNzY5MywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNzY5MjMwNzY5MjMwNzY5MywwLjkyMzA3NjkyMzA3NjkyMzEsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjc2OTIzMDc2OTIzMDc2OTMKMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMC44NDYxNTM4NDYxNTM4NDYxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzA3NjkyMzA3NjkyMzA3NywwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzCjAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjkyMzA3NjkyMzA3NjkyMywxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuOTIzMDc2OTIzMDc2OTIzMQowLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjMwNzY5MjMwNzY5MjMwNzcsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMQowLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC44NDYxNTM4NDYxNTM4NDYxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC43NjkyMzA3NjkyMzA3NjkzCjAuOTIzMDc2OTIzMDc2OTIzMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC44NDYxNTM4NDYxNTM4NDYxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC42OTIzMDc2OTIzMDc2OTIzLDEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQKMC44NDYxNTM4NDYxNTM4NDYxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjYxNTM4NDYxNTM4NDYxNTQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDEsMC4xNTM4NDYxNTM4NDYxNTM4NSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NAowLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwxLDEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC45MjMwNzY5MjMwNzY5MjMxLDAuMzA3NjkyMzA3NjkyMzA3NywwLjkyMzA3NjkyMzA3NjkyMzEsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjUzODQ2MTUzODQ2MTUzODQKMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC45MjMwNzY5MjMwNzY5MjMxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC44NDYxNTM4NDYxNTM4NDYxLDAuMzA3NjkyMzA3NjkyMzA3NywwLjkyMzA3NjkyMzA3NjkyMzEsMC45MjMwNzY5MjMwNzY5MjMxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQKMC45MjMwNzY5MjMwNzY5MjMxLDAuNjkyMzA3NjkyMzA3NjkyMywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjkyMzA3NjkyMzA3NjkyMzEsMSwwLjUzODQ2MTUzODQ2MTUzODQsMC4zMDc2OTIzMDc2OTIzMDc3LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMKMC42MTUzODQ2MTUzODQ2MTU0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjY5MjMwNzY5MjMwNzY5MjMsMC4zMDc2OTIzMDc2OTIzMDc3LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2CjAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjYxNTM4NDYxNTM4NDYxNTQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC44NDYxNTM4NDYxNTM4NDYxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjkyMzA3NjkyMzA3NjkyMzEKMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC44NDYxNTM4NDYxNTM4NDYxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC4zODQ2MTUzODQ2MTUzODQ2NCwxLDAuNjE1Mzg0NjE1Mzg0NjE1NAowLjg0NjE1Mzg0NjE1Mzg0NjEsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjc2OTIzMDc2OTIzMDc2OTMsMSwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMwowLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMSwwLjc2OTIzMDc2OTIzMDc2OTMKMC43NjkyMzA3NjkyMzA3NjkzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjYxNTM4NDYxNTM4NDYxNTQsMC4zODQ2MTUzODQ2MTUzODQ2NCwxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjMwNzY5MjMwNzY5MjMwNzcKMSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuMjMwNzY5MjMwNzY5MjMwNzgsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NAowLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuMzA3NjkyMzA3NjkyMzA3NywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMywwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC4zMDc2OTIzMDc2OTIzMDc3LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjYxNTM4NDYxNTM4NDYxNTQKMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC42OTIzMDc2OTIzMDc2OTIzLDAuODQ2MTUzODQ2MTUzODQ2MQowLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC44NDYxNTM4NDYxNTM4NDYxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjUzODQ2MTUzODQ2MTUzODQsMC45MjMwNzY5MjMwNzY5MjMxCjAuMzA3NjkyMzA3NjkyMzA3NywwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC44NDYxNTM4NDYxNTM4NDYxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjkyMzA3NjkyMzA3NjkyMwoxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC42OTIzMDc2OTIzMDc2OTIzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNzY5MjMwNzY5MjMwNzY5MywwLjMwNzY5MjMwNzY5MjMwNzcsMC43NjkyMzA3NjkyMzA3NjkzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMSwwLjYxNTM4NDYxNTM4NDYxNTQKMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuMzA3NjkyMzA3NjkyMzA3NywwLjYxNTM4NDYxNTM4NDYxNTQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC43NjkyMzA3NjkyMzA3NjkzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMQowLjMwNzY5MjMwNzY5MjMwNzcsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMSwwLjUzODQ2MTUzODQ2MTUzODQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYKMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC4yMzA3NjkyMzA3NjkyMzA3OCwwLjg0NjE1Mzg0NjE1Mzg0NjEKMC42MTUzODQ2MTUzODQ2MTU0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC42MTUzODQ2MTUzODQ2MTU0LDAuMzA3NjkyMzA3NjkyMzA3NywxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC42MTUzODQ2MTUzODQ2MTU0CjAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC4yMzA3NjkyMzA3NjkyMzA3OCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDEsMC4yMzA3NjkyMzA3NjkyMzA3OCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NAowLjQ2MTUzODQ2MTUzODQ2MTU2LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC44NDYxNTM4NDYxNTM4NDYxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC42OTIzMDc2OTIzMDc2OTIzLDAuMzA3NjkyMzA3NjkyMzA3NywwLjUzODQ2MTUzODQ2MTUzODQsMC42MTUzODQ2MTUzODQ2MTU0LDEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywxLDAuNzY5MjMwNzY5MjMwNzY5MwowLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC45MjMwNzY5MjMwNzY5MjMxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMSwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDEsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC45MjMwNzY5MjMwNzY5MjMxCjAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjkyMzA3NjkyMzA3NjkyMzEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjMwNzY5MjMwNzY5MjMwNzcsMC42MTUzODQ2MTUzODQ2MTU0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjkyMzA3NjkyMzA3NjkyMzEsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjg0NjE1Mzg0NjE1Mzg0NjEKMC44NDYxNTM4NDYxNTM4NDYxLDEsMC42OTIzMDc2OTIzMDc2OTIzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNzY5MjMwNzY5MjMwNzY5MywwLjY5MjMwNzY5MjMwNzY5MjMsMSwwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMSwxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC44NDYxNTM4NDYxNTM4NDYxLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC41Mzg0NjE1Mzg0NjE1Mzg0CjAuNjkyMzA3NjkyMzA3NjkyMywwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMSwwLjIzMDc2OTIzMDc2OTIzMDc4LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42OTIzMDc2OTIzMDc2OTIzLDEsMSwwLjMwNzY5MjMwNzY5MjMwNzcsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC43NjkyMzA3NjkyMzA3NjkzCjAuOTIzMDc2OTIzMDc2OTIzMSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC45MjMwNzY5MjMwNzY5MjMxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNTM4NDYxNTM4NDYxNTM4NCwwLjc2OTIzMDc2OTIzMDc2OTMsMC45MjMwNzY5MjMwNzY5MjMxLDEsMC42OTIzMDc2OTIzMDc2OTIzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjc2OTIzMDc2OTIzMDc2OTMsMC42OTIzMDc2OTIzMDc2OTIzLDAuNDYxNTM4NDYxNTM4NDYxNTYKMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjkyMzA3NjkyMzA3NjkyMywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuMzA3NjkyMzA3NjkyMzA3NywwLjM4NDYxNTM4NDYxNTM4NDY0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjc2OTIzMDc2OTIzMDc2OTMsMC42MTUzODQ2MTUzODQ2MTU0CjAuOTIzMDc2OTIzMDc2OTIzMSwwLjkyMzA3NjkyMzA3NjkyMzEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuOTIzMDc2OTIzMDc2OTIzMSwwLjMwNzY5MjMwNzY5MjMwNzcsMC43NjkyMzA3NjkyMzA3NjkzLDAuNzY5MjMwNzY5MjMwNzY5MywwLjYxNTM4NDYxNTM4NDYxNTQsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC40NjE1Mzg0NjE1Mzg0NjE1NgowLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuMzA3NjkyMzA3NjkyMzA3NywwLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDEsMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuODQ2MTUzODQ2MTUzODQ2MSwxLDAuNzY5MjMwNzY5MjMwNzY5MywwLjc2OTIzMDc2OTIzMDc2OTMKMC42OTIzMDc2OTIzMDc2OTIzLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjkyMzA3NjkyMzA3NjkyMzEsMC44NDYxNTM4NDYxNTM4NDYxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC42OTIzMDc2OTIzMDc2OTIzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC43NjkyMzA3NjkyMzA3NjkzLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjUzODQ2MTUzODQ2MTUzODQsMC45MjMwNzY5MjMwNzY5MjMxLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC41Mzg0NjE1Mzg0NjE1Mzg0LDEsMC44NDYxNTM4NDYxNTM4NDYxCjAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjY5MjMwNzY5MjMwNzY5MjMsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNjkyMzA3NjkyMzA3NjkyMywwLjc2OTIzMDc2OTIzMDc2OTMsMC42OTIzMDc2OTIzMDc2OTIzLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC45MjMwNzY5MjMwNzY5MjMxLDAuNjE1Mzg0NjE1Mzg0NjE1NCwwLjkyMzA3NjkyMzA3NjkyMzEsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MQoxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjM4NDYxNTM4NDYxNTM4NDY0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjQ2MTUzODQ2MTUzODQ2MTU2LDAuMzA3NjkyMzA3NjkyMzA3NywwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42OTIzMDc2OTIzMDc2OTIzLDAuMzg0NjE1Mzg0NjE1Mzg0NjQsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjc2OTIzMDc2OTIzMDc2OTMsMSwwLjMwNzY5MjMwNzY5MjMwNzcsMC43NjkyMzA3NjkyMzA3NjkzLDAuNDYxNTM4NDYxNTM4NDYxNTYsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjYxNTM4NDYxNTM4NDYxNTQKMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjUzODQ2MTUzODQ2MTUzODQsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC44NDYxNTM4NDYxNTM4NDYxLDAuOTIzMDc2OTIzMDc2OTIzMSwwLjYxNTM4NDYxNTM4NDYxNTQsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNzY5MjMwNzY5MjMwNzY5MywwLjkyMzA3NjkyMzA3NjkyMzEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuNDYxNTM4NDYxNTM4NDYxNTYsMC44NDYxNTM4NDYxNTM4NDYxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjg0NjE1Mzg0NjE1Mzg0NjEsMC42OTIzMDc2OTIzMDc2OTIzLDEsMC41Mzg0NjE1Mzg0NjE1Mzg0LDAuODQ2MTUzODQ2MTUzODQ2MQowLjY5MjMwNzY5MjMwNzY5MjMsMC40NjE1Mzg0NjE1Mzg0NjE1NiwxLDAuNTM4NDYxNTM4NDYxNTM4NCwwLjUzODQ2MTUzODQ2MTUzODQsMC44NDYxNTM4NDYxNTM4NDYxLDEsMC44NDYxNTM4NDYxNTM4NDYxLDAuODQ2MTUzODQ2MTUzODQ2MSwwLjkyMzA3NjkyMzA3NjkyMzEsMC40NjE1Mzg0NjE1Mzg0NjE1NiwwLjc2OTIzMDc2OTIzMDc2OTMsMC4zODQ2MTUzODQ2MTUzODQ2NCwwLjYxNTM4NDYxNTM4NDYxNTQsMC42MTUzODQ2MTUzODQ2MTU0LDAuODQ2MTUzODQ2MTUzODQ2MSwwLjY5MjMwNzY5MjMwNzY5MjMsMC42MTUzODQ2MTUzODQ2MTU0LDAuNjkyMzA3NjkyMzA3NjkyMwo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_pime_est_error.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-c048052d9b061696b121" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c048052d9b061696b121">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Prevalence5%":[0.9231,0.6923,0.9231,0.3846,1,0.4615,0.6923,0.6154,0.7692,0.5385,0.7692,0.5385,0.5385,0.6154,0.5385,0.7692,0.6154,0.9231,1,0.6923,0.8462,1,0.8462,0.8462,0.4615,0.7692,0.4615,0.5385,0.6923,0.3077,0.8462,0.3846,0.6923,0.7692,0.3846,1,0.6154,0.9231,0.4615,0.6154,0.6154,0.3077,0.3846,0.3846,0.6154,0.9231,0.4615,0.5385,0.7692,0.9231,0.5385,0.9231,0.9231,1,0.4615,0.3846,0.6923,0.1538,0.7692,0.4615,0.5385,0.3846,0.3846,0.9231,0.8462,0.6154,0.4615,0.9231,0.6154,0.3846,0.4615,0.8462,0.7692,0.7692,1,0.5385,0.4615,0.5385,0.3077,1,0.6154,0.3077,0.3846,0.6154,0.6154,0.4615,0.4615,0.4615,0.4615,0.8462,0.6923,0.9231,0.5385,0.9231,0.3846,0.6923,0.8462,1,0.3846,0.6923],"Prevalence10%":[0.9231,0.7692,0.6154,0.5385,0.4615,0.4615,0.6923,0.3846,0.9231,0.3846,1,0.7692,0.5385,0.6923,0.6923,0.5385,0.5385,0.7692,0.8462,0.9231,0.9231,0.9231,0.6154,0.5385,0.8462,0.7692,0.9231,0.9231,0.5385,0.9231,0.3077,1,0.6154,0.6154,0.5385,0.7692,0.8462,0.5385,0.3846,0.3077,0.6923,0.9231,0.7692,0.5385,1,0.7692,0.3846,0.3846,0.3846,0.5385,0.4615,0.4615,0.7692,0.7692,0.6154,0.9231,0.4615,0.5385,0.4615,0.7692,0.4615,0.6923,0.6154,0.7692,0.5385,0.5385,0.5385,0.6923,0.9231,0.6923,0.4615,0.6154,0.6154,0.6923,0.8462,0.7692,0.6154,0.6154,0.6923,0.4615,0.7692,0.5385,0.6923,0.5385,0.5385,0.9231,0.6154,0.5385,0.7692,1,0.6923,0.4615,0.6154,0.9231,0.6923,0.9231,0.9231,0.9231,0.5385,0.4615],"Prevalence15%":[0.6923,0.7692,0.4615,0.4615,0.5385,0.6154,0.3846,0.7692,0.8462,0.6154,0.3077,0.6154,0.4615,0.5385,0.4615,1,0.2308,0.7692,0.9231,0.3077,0.5385,0.7692,0.4615,0.3077,0.9231,0.9231,0.4615,0.9231,0.4615,0.5385,0.5385,0.9231,0.3846,0.8462,0.8462,0.4615,0.4615,0.8462,0.6923,0.6923,0.4615,0.5385,0.5385,0.5385,0.9231,0.7692,0.5385,0.8462,0.6154,0.6154,1,0.7692,0.6923,0.4615,0.7692,0.6923,0.5385,0.6923,0.7692,0.9231,0.5385,0.3846,0.6923,0.6154,0.7692,0.3846,0.9231,0.3846,0.6923,0.6154,0.8462,0.6154,0.5385,0.6154,0.7692,0.3077,0.7692,0.3846,0.6154,0.4615,0.6154,0.6154,0.5385,0.4615,0.5385,0.8462,0.7692,0.6154,0.7692,0.6923,0.5385,0.6154,0.9231,0.3846,0.4615,0.3846,0.3846,0.3846,0.4615,1],"Prevalence20%":[0.8462,0.4615,0.3846,0.8462,0.6154,0.4615,0.6923,0.4615,0.8462,0.4615,0.3846,0.4615,0.6154,0.4615,0.5385,0.5385,0.6923,0.5385,0.9231,0.4615,0.4615,0.4615,0.6923,0.6923,0.7692,0.4615,0.8462,0.6154,0.8462,0.4615,0.6923,0.3846,0.9231,0.8462,0.8462,0.4615,0.4615,0.7692,0.6154,0.7692,0.6154,0.4615,0.4615,0.4615,0.6923,0.3846,0.4615,0.6923,0.5385,0.6923,0.6923,0.6154,0.4615,0.8462,0.4615,0.6154,0.8462,1,0.9231,0.7692,0.3846,0.9231,0.8462,0.9231,0.3846,0.6154,0.5385,0.4615,0.3077,0.5385,0.4615,0.6923,0.6923,0.3846,0.2308,0.4615,0.4615,0.8462,0.6154,0.6923,0.6154,0.7692,0.7692,0.5385,1,0.8462,0.4615,0.8462,0.9231,0.9231,0.4615,0.6923,0.3846,0.9231,0.3077,0.6923,0.6923,0.8462,0.8462,0.5385],"Prevalence25%":[0.3846,0.4615,0.9231,0.4615,0.8462,0.6154,0.4615,1,0.4615,0.9231,0.5385,0.9231,0.4615,0.3846,0.5385,0.1538,0.5385,0.6923,0.5385,0.4615,0.5385,0.9231,0.4615,0.6923,0.6154,0.3077,0.5385,0.4615,0.2308,0.6923,0.9231,0.6923,0.5385,0.3846,0.4615,0.9231,0.6154,0.4615,0.3846,0.7692,0.4615,0.7692,0.8462,0.6154,0.9231,0.9231,0.5385,0.4615,0.6154,0.6154,0.6923,0.6154,0.7692,1,0.6923,0.8462,0.3846,0.5385,0.6154,0.6923,0.6923,0.9231,0.3846,0.3846,0.8462,0.4615,0.8462,0.5385,0.3846,0.4615,0.5385,0.7692,0.6154,1,0.4615,0.6923,0.6154,0.3846,0.5385,0.6923,0.6154,0.6154,1,0.3846,0.5385,0.4615,0.8462,0.7692,0.3846,0.4615,1,0.9231,0.5385,0.5385,0.9231,0.9231,0.5385,0.8462,0.8462,0.5385],"Prevalence30%":[0.7692,0.7692,0.3846,0.8462,0.7692,0.9231,0.5385,0.4615,1,0.9231,0.8462,0.4615,0.7692,0.6154,0.9231,0.6923,0.9231,0.9231,0.4615,0.3846,0.3846,0.3846,0.3846,0.3077,0.4615,0.4615,0.6923,1,0.5385,0.5385,0.7692,0.6154,0.6154,0.4615,0.3846,0.5385,0.4615,0.3846,0.8462,0.3846,0.8462,0.8462,0.5385,0.7692,0.6154,0.5385,0.7692,0.7692,0.8462,0.3846,0.9231,0.3846,0.3077,0.2308,0.4615,0.6154,0.8462,0.8462,0.8462,0.8462,1,0.4615,0.6923,0.5385,0.7692,0.6154,0.3846,0.6154,0.4615,0.6923,1,0.6923,0.6154,0.8462,0.5385,0.7692,0.8462,0.4615,0.7692,0.8462,0.3846,0.3846,0.8462,0.3846,0.5385,0.6923,0.7692,0.4615,0.4615,0.7692,0.2308,0.9231,0.4615,0.6923,0.7692,0.8462,0.6923,0.4615,0.9231,0.8462],"Prevalence35%":[0.3077,0.5385,0.6154,0.6154,0.3077,0.6154,0.5385,0.6154,0.6154,0.5385,0.9231,1,0.3846,0.3846,0.6154,0.9231,0.4615,0.9231,0.6154,0.7692,0.7692,0.8462,0.6923,0.9231,0.8462,0.7692,0.8462,0.5385,0.6154,0.4615,0.8462,0.4615,0.7692,1,0.6154,0.8462,0.5385,0.7692,0.9231,0.6923,0.2308,0.6923,0.9231,0.3846,0.8462,0.5385,0.5385,0.8462,0.7692,0.3846,0.4615,0.8462,0.6154,0.6923,0.7692,0.3846,0.5385,0.3846,0.4615,0.7692,0.4615,0.3077,0.6923,0.8462,0.8462,0.5385,0.9231,0.9231,1,0.5385,0.4615,0.4615,0.6154,0.4615,0.7692,0.4615,0.8462,0.5385,0.4615,0.6923,0.6154,0.4615,0.9231,0.6154,0.4615,0.3077,1,1,0.5385,0.6923,0.6154,0.6923,0.5385,0.9231,0.9231,0.5385,0.7692,0.4615,0.6154,1],"Prevalence40%":[0.6154,0.6923,0.9231,1,0.5385,0.6923,0.5385,0.8462,0.4615,0.6923,0.9231,0.8462,0.8462,0.5385,0.3846,0.4615,0.6154,1,0.6154,0.5385,0.4615,0.6154,0.7692,0.4615,0.7692,0.6154,0.7692,0.7692,0.6923,0.6923,0.6923,0.9231,0.5385,0.6154,0.9231,0.7692,0.8462,0.4615,0.7692,0.4615,0.5385,0.3077,0.8462,0.1538,0.6154,0.5385,0.5385,0.4615,0.4615,0.5385,0.9231,0.7692,0.5385,0.4615,0.6923,0.5385,0.4615,0.9231,0.5385,0.6923,0.9231,0.6923,1,1,0.6154,1,0.6154,0.5385,0.7692,0.6923,0.6154,0.4615,0.7692,0.8462,0.6154,0.5385,0.4615,0.6154,0.7692,0.6154,0.3846,0.4615,0.3846,0.3077,0.9231,0.5385,0.4615,0.6923,0.3077,1,0.6923,0.5385,0.6923,0.7692,0.6923,0.5385,0.6923,0.3077,0.5385,0.8462],"Prevalence45%":[0.6923,1,1,0.8462,0.6154,0.6154,0.9231,0.8462,0.6154,0.5385,0.6154,0.7692,0.6154,0.6923,0.6154,1,1,0.9231,0.6154,0.5385,0.6154,0.3077,0.6154,0.4615,1,0.3846,0.6154,0.5385,0.8462,0.6154,0.4615,0.9231,0.6923,0.5385,1,0.3846,0.8462,0.6154,0.6154,0.5385,0.6923,0.7692,0.6154,0.6154,0.6154,0.4615,0.4615,0.6154,0.7692,0.6154,0.9231,0.6923,0.9231,0.3077,0.9231,0.5385,0.5385,0.7692,0.8462,0.5385,0.6923,0.6923,0.3846,0.9231,0.6923,1,0.6923,0.6154,0.7692,0.6154,0.8462,0.6154,0.9231,0.8462,0.3846,0.5385,0.6923,0.5385,0.4615,0.7692,0.3077,0.4615,0.3846,1,0.6154,0.6154,0.6923,0.5385,0.6154,0.6923,0.6923,0.5385,0.6154,0.6154,0.5385,0.6923,0.8462,0.8462,0.7692,0.8462],"Prevalence50%":[0.3846,0.7692,0.2308,0.6154,0.2308,0.7692,0.4615,0.5385,1,0.5385,0.6923,1,1,0.4615,0.4615,0.7692,0.7692,0.6923,0.8462,0.7692,0.8462,0.7692,0.8462,0.7692,0.5385,0.6923,0.7692,0.6923,0.7692,0.3846,0.6923,0.7692,0.5385,0.9231,0.6923,0.6923,0.6154,0.8462,0.7692,0.4615,0.9231,0.3846,0.8462,0.6154,0.6154,0.9231,0.4615,0.5385,0.8462,0.5385,0.5385,0.4615,0.3077,0.3077,0.5385,0.6923,0.7692,0.9231,0.4615,0.3077,0.3846,0.5385,0.7692,0.4615,0.5385,0.3846,0.9231,0.5385,0.6154,0.6154,0.6923,0.8462,0.6154,0.5385,0.9231,0.8462,0.7692,0.7692,0.5385,0.4615,0.6154,0.4615,0.9231,0.8462,0.2308,1,0.4615,0.8462,0.7692,0.9231,1,0.7692,0.8462,0.4615,0.6154,0.6154,0.4615,0.6923,0.9231,0.9231],"Prevalence55%":[0.3846,0.5385,0.6154,1,0.5385,0.7692,0.5385,0.8462,1,0.9231,0.3846,1,0.4615,0.4615,0.7692,0.4615,0.6923,0.5385,0.4615,0.6154,0.3846,0.6923,0.3077,0.8462,0.5385,0.3846,0.7692,0.3846,0.5385,0.6923,0.6923,0.5385,0.6154,0.6923,0.9231,0.5385,0.5385,0.6154,0.8462,0.6923,0.6923,0.6923,0.9231,0.6923,0.6923,0.4615,0.3846,0.6923,0.3077,0.5385,0.7692,0.6154,0.6923,0.3846,0.9231,1,0.8462,0.9231,0.8462,0.6923,0.6923,0.6923,0.7692,0.4615,0.3846,0.3846,0.8462,1,0.7692,0.5385,0.8462,0.7692,0.4615,0.6154,0.9231,0.9231,0.8462,0.6154,0.4615,0.7692,0.6923,0.3846,0.6154,0.9231,0.6923,0.3846,0.5385,0.6923,0.9231,0.7692,1,0.9231,0.6923,0.9231,0.6923,0.9231,0.8462,0.3846,0.5385,0.4615],"Prevalence60%":[0.6923,0.5385,0.8462,0.9231,0.8462,0.4615,0.4615,0.5385,0.9231,0.4615,0.6923,0.3077,0.5385,0.5385,0.3846,1,0.4615,0.5385,0.6154,0.9231,0.5385,0.5385,0.5385,0.3846,0.9231,0.4615,0.5385,0.5385,0.7692,1,0.3846,0.6154,0.7692,0.7692,0.4615,0.7692,0.5385,0.7692,0.7692,0.8462,0.4615,1,1,0.9231,0.6923,0.6923,0.2308,0.5385,0.5385,0.6154,0.8462,0.5385,0.7692,0.4615,0.6154,0.9231,0.8462,0.9231,0.5385,0.6154,0.5385,0.5385,0.4615,0.4615,1,0.6154,0.3077,0.3846,0.7692,0.9231,0.6154,1,0.6923,1,0.4615,0.7692,0.6923,0.8462,0.5385,0.3077,0.6154,0.7692,0.4615,0.4615,0.6154,0.3846,0.4615,0.5385,0.6154,0.6154,0.3077,1,0.6923,0.3077,0.6154,0.7692,0.8462,0.3846,0.4615,0.7692],"Prevalence65%":[0.6154,0.7692,0.7692,0.6154,0.7692,0.5385,0.6154,0.4615,0.6154,0.6923,0.6923,0.4615,0.6923,0.3846,0.9231,0.5385,0.7692,0.6154,0.5385,0.9231,0.5385,0.5385,1,0.6154,0.5385,0.3077,0.9231,0.5385,0.7692,0.5385,0.6923,0.4615,0.5385,0.4615,0.8462,1,0.3077,0.6923,0.8462,0.5385,0.6923,0.5385,1,0.7692,0.6923,0.5385,0.8462,0.7692,0.6154,0.6923,1,0.3846,0.6154,0.5385,0.7692,0.7692,0.5385,0.3846,0.6154,0.6154,0.6154,0.9231,0.4615,0.8462,0.1538,0.7692,0.9231,0.7692,0.3846,0.8462,0.6154,0.5385,0.6154,0.8462,0.7692,0.4615,0.6923,0.8462,0.3846,0.7692,0.6923,0.6923,0.4615,0.7692,0.4615,0.4615,0.6154,1,0.6923,1,0.3846,0.6923,0.8462,0.7692,1,0.6154,0.4615,0.7692,0.8462,0.3846],"Prevalence70%":[0.7692,0.9231,0.4615,0.6923,0.5385,0.6923,0.4615,1,0.6923,0.4615,0.6154,0.4615,0.6154,0.7692,0.4615,0.6154,0.9231,0.8462,0.4615,0.7692,0.5385,1,0.5385,0.5385,1,0.6923,0.9231,0.5385,0.6923,0.4615,0.8462,0.9231,0.6923,0.6923,0.5385,0.5385,0.7692,0.9231,0.7692,0.3846,0.4615,0.8462,0.4615,0.5385,0.4615,0.6923,0.6154,0.6923,0.6154,0.9231,0.4615,0.5385,1,0.6154,0.8462,0.9231,0.6154,0.6923,1,0.6923,0.4615,0.6154,0.4615,0.8462,0.4615,0.9231,0.9231,0.9231,0.5385,0.8462,0.6923,0.4615,0.7692,0.8462,0.7692,0.7692,0.6923,0.6154,0.4615,0.8462,0.4615,1,0.8462,0.4615,0.5385,0.4615,0.5385,0.6154,0.9231,1,0.6154,0.3846,0.5385,0.7692,1,0.5385,0.8462,1,0.5385,0.6154],"Prevalence75%":[0.6154,0.8462,0.3846,0.6923,0.5385,0.6154,0.5385,0.4615,0.8462,0.6154,1,0.9231,0.7692,0.8462,0.4615,0.5385,0.5385,0.8462,0.6923,0.6154,1,1,0.6923,0.7692,0.4615,0.7692,0.4615,0.7692,0.6923,0.5385,1,0.3846,0.9231,0.4615,0.7692,0.6154,0.4615,0.4615,0.8462,0.6923,0.6923,0.6154,0.4615,0.4615,0.3846,0.5385,0.9231,0.7692,0.6154,0.8462,1,0.9231,0.7692,0.4615,0.4615,0.8462,0.3846,0.4615,0.5385,0.9231,0.9231,0.7692,0.7692,0.9231,0.6923,0.3077,0.3846,1,0.3077,0.6923,0.6154,0.6154,0.7692,0.3077,0.4615,0.6154,0.6923,0.5385,0.6923,0.6923,0.5385,0.5385,1,0.4615,1,0.6923,0.4615,0.6154,0.5385,0.9231,0.6923,0.5385,0.3077,0.6154,0.3846,0.9231,0.9231,0.3077,0.8462,0.6154],"Prevalence80%":[0.3077,0.7692,0.9231,0.6923,0.6923,0.6923,0.6154,0.6923,0.9231,0.6923,0.3846,0.4615,0.4615,0.5385,0.3846,0.2308,0.8462,0.8462,0.8462,0.7692,0.7692,0.6923,0.7692,0.6154,0.6923,0.8462,0.9231,0.6923,0.9231,0.6923,0.4615,0.4615,0.3846,0.4615,0.4615,0.7692,0.7692,0.4615,0.8462,0.4615,0.6923,0.9231,0.3846,0.6923,0.6154,0.3077,0.3846,0.7692,0.7692,0.7692,0.8462,1,0.8462,0.7692,0.9231,0.9231,0.5385,0.6154,0.7692,0.4615,0.7692,0.5385,0.7692,0.6923,0.3846,0.9231,0.3846,0.5385,0.4615,0.6154,0.5385,0.7692,0.7692,0.6154,0.6154,0.8462,0.4615,1,0.8462,0.5385,0.7692,0.3846,0.9231,1,0.2308,0.5385,0.9231,0.9231,0.5385,0.6154,0.4615,0.9231,0.3846,0.6154,0.8462,0.4615,0.6154,0.7692,0.6923,0.8462],"Prevalence85%":[0.4615,0.2308,0.6923,0.5385,0.8462,0.5385,0.3846,0.6154,0.6923,0.4615,0.4615,0.6923,0.9231,1,0.6154,0.7692,0.6923,0.6923,0.7692,0.6923,0.3846,0.9231,0.9231,0.6154,0.5385,0.6923,0.6154,0.5385,0.7692,0.7692,0.3846,0.5385,0.8462,0.7692,0.8462,0.7692,0.4615,0.7692,0.5385,0.6923,0.7692,1,0.4615,0.6923,0.8462,0.6923,0.8462,1,0.3846,0.5385,0.7692,0.8462,0.4615,0.4615,1,0.6154,0.8462,0.9231,0.9231,0.5385,0.6154,0.4615,0.7692,1,0.7692,0.6154,0.8462,0.3077,0.9231,0.4615,0.3846,0.4615,0.4615,0.5385,0.6923,0.3077,0.7692,0.9231,0.6154,0.3846,0.3846,0.6923,0.9231,0.4615,0.8462,0.6923,0.5385,0.3846,0.3846,0.8462,0.7692,0.7692,0.8462,0.6923,1,0.5385,0.9231,0.4615,1,0.6923],"Prevalence90%":[0.8462,0.8462,0.6923,0.5385,0.6154,0.7692,0.6154,0.8462,0.4615,0.6154,0.9231,0.7692,0.7692,0.4615,0.6923,0.4615,0.2308,0.3846,0.6154,1,0.6154,0.4615,0.6154,0.7692,0.5385,0.3846,0.9231,0.6923,0.6923,0.7692,0.3077,0.7692,0.6154,0.4615,0.6923,0.3846,0.6923,0.4615,0.9231,0.7692,0.4615,0.3846,0.6923,0.6923,0.4615,0.8462,0.7692,0.6923,0.8462,0.6154,0.4615,0.4615,0.6154,0.5385,0.7692,1,0.4615,0.5385,0.9231,0.3846,0.7692,0.5385,0.7692,0.3846,0.4615,0.8462,0.4615,0.8462,0.8462,0.4615,1,0.6923,1,0.3846,0.4615,0.6154,0.6923,0.5385,0.4615,1,0.9231,0.7692,0.2308,0.6154,0.5385,1,0.6923,0.6154,0.6154,0.3846,0.4615,0.6923,0.7692,0.8462,0.7692,1,0.6154,0.3846,0.5385,0.6154],"Prevalence95%":[0.9231,0.3846,0.5385,0.3846,0.9231,0.5385,0.5385,0.3077,0.7692,0.5385,0.7692,0.5385,0.5385,0.4615,0.4615,1,0.5385,0.9231,0.5385,0.7692,0.5385,0.5385,0.5385,0.3846,0.6154,0.6923,0.5385,0.3077,0.1538,0.8462,0.5385,0.7692,0.6923,0.3846,0.6923,0.3077,1,0.8462,0.4615,0.6923,0.7692,0.4615,0.3846,1,0.8462,0.9231,0.7692,0.4615,0.5385,0.9231,0.9231,0.6923,0.4615,0.5385,0.6923,0.5385,0.5385,0.8462,0.7692,0.6923,0.9231,1,0.7692,0.5385,0.5385,0.5385,0.5385,0.6923,0.4615,0.9231,0.6154,0.6923,0.7692,0.3077,0.6154,0.6154,0.8462,0.9231,0.6923,0.6154,0.9231,0.4615,0.8462,0.6154,0.6154,0.7692,0.5385,0.9231,0.8462,0.5385,0.7692,0.4615,0.6154,0.4615,0.7692,0.8462,0.8462,0.6154,0.8462,0.6923]},"columns":[{"accessor":"Prevalence5%","name":"Prevalence5%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.9231","0.6923","0.9231","0.3846","1.0000","0.4615","0.6923","0.6154","0.7692","0.5385","0.7692","0.5385","0.5385","0.6154","0.5385","0.7692","0.6154","0.9231","1.0000","0.6923","0.8462","1.0000","0.8462","0.8462","0.4615","0.7692","0.4615","0.5385","0.6923","0.3077","0.8462","0.3846","0.6923","0.7692","0.3846","1.0000","0.6154","0.9231","0.4615","0.6154","0.6154","0.3077","0.3846","0.3846","0.6154","0.9231","0.4615","0.5385","0.7692","0.9231","0.5385","0.9231","0.9231","1.0000","0.4615","0.3846","0.6923","0.1538","0.7692","0.4615","0.5385","0.3846","0.3846","0.9231","0.8462","0.6154","0.4615","0.9231","0.6154","0.3846","0.4615","0.8462","0.7692","0.7692","1.0000","0.5385","0.4615","0.5385","0.3077","1.0000","0.6154","0.3077","0.3846","0.6154","0.6154","0.4615","0.4615","0.4615","0.4615","0.8462","0.6923","0.9231","0.5385","0.9231","0.3846","0.6923","0.8462","1.0000","0.3846","0.6923"],"header":"Prevalence5%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence10%","name":"Prevalence10%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.9231","0.7692","0.6154","0.5385","0.4615","0.4615","0.6923","0.3846","0.9231","0.3846","1.0000","0.7692","0.5385","0.6923","0.6923","0.5385","0.5385","0.7692","0.8462","0.9231","0.9231","0.9231","0.6154","0.5385","0.8462","0.7692","0.9231","0.9231","0.5385","0.9231","0.3077","1.0000","0.6154","0.6154","0.5385","0.7692","0.8462","0.5385","0.3846","0.3077","0.6923","0.9231","0.7692","0.5385","1.0000","0.7692","0.3846","0.3846","0.3846","0.5385","0.4615","0.4615","0.7692","0.7692","0.6154","0.9231","0.4615","0.5385","0.4615","0.7692","0.4615","0.6923","0.6154","0.7692","0.5385","0.5385","0.5385","0.6923","0.9231","0.6923","0.4615","0.6154","0.6154","0.6923","0.8462","0.7692","0.6154","0.6154","0.6923","0.4615","0.7692","0.5385","0.6923","0.5385","0.5385","0.9231","0.6154","0.5385","0.7692","1.0000","0.6923","0.4615","0.6154","0.9231","0.6923","0.9231","0.9231","0.9231","0.5385","0.4615"],"header":"Prevalence10%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence15%","name":"Prevalence15%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6923","0.7692","0.4615","0.4615","0.5385","0.6154","0.3846","0.7692","0.8462","0.6154","0.3077","0.6154","0.4615","0.5385","0.4615","1.0000","0.2308","0.7692","0.9231","0.3077","0.5385","0.7692","0.4615","0.3077","0.9231","0.9231","0.4615","0.9231","0.4615","0.5385","0.5385","0.9231","0.3846","0.8462","0.8462","0.4615","0.4615","0.8462","0.6923","0.6923","0.4615","0.5385","0.5385","0.5385","0.9231","0.7692","0.5385","0.8462","0.6154","0.6154","1.0000","0.7692","0.6923","0.4615","0.7692","0.6923","0.5385","0.6923","0.7692","0.9231","0.5385","0.3846","0.6923","0.6154","0.7692","0.3846","0.9231","0.3846","0.6923","0.6154","0.8462","0.6154","0.5385","0.6154","0.7692","0.3077","0.7692","0.3846","0.6154","0.4615","0.6154","0.6154","0.5385","0.4615","0.5385","0.8462","0.7692","0.6154","0.7692","0.6923","0.5385","0.6154","0.9231","0.3846","0.4615","0.3846","0.3846","0.3846","0.4615","1.0000"],"header":"Prevalence15%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence20%","name":"Prevalence20%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.8462","0.4615","0.3846","0.8462","0.6154","0.4615","0.6923","0.4615","0.8462","0.4615","0.3846","0.4615","0.6154","0.4615","0.5385","0.5385","0.6923","0.5385","0.9231","0.4615","0.4615","0.4615","0.6923","0.6923","0.7692","0.4615","0.8462","0.6154","0.8462","0.4615","0.6923","0.3846","0.9231","0.8462","0.8462","0.4615","0.4615","0.7692","0.6154","0.7692","0.6154","0.4615","0.4615","0.4615","0.6923","0.3846","0.4615","0.6923","0.5385","0.6923","0.6923","0.6154","0.4615","0.8462","0.4615","0.6154","0.8462","1.0000","0.9231","0.7692","0.3846","0.9231","0.8462","0.9231","0.3846","0.6154","0.5385","0.4615","0.3077","0.5385","0.4615","0.6923","0.6923","0.3846","0.2308","0.4615","0.4615","0.8462","0.6154","0.6923","0.6154","0.7692","0.7692","0.5385","1.0000","0.8462","0.4615","0.8462","0.9231","0.9231","0.4615","0.6923","0.3846","0.9231","0.3077","0.6923","0.6923","0.8462","0.8462","0.5385"],"header":"Prevalence20%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence25%","name":"Prevalence25%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.3846","0.4615","0.9231","0.4615","0.8462","0.6154","0.4615","1.0000","0.4615","0.9231","0.5385","0.9231","0.4615","0.3846","0.5385","0.1538","0.5385","0.6923","0.5385","0.4615","0.5385","0.9231","0.4615","0.6923","0.6154","0.3077","0.5385","0.4615","0.2308","0.6923","0.9231","0.6923","0.5385","0.3846","0.4615","0.9231","0.6154","0.4615","0.3846","0.7692","0.4615","0.7692","0.8462","0.6154","0.9231","0.9231","0.5385","0.4615","0.6154","0.6154","0.6923","0.6154","0.7692","1.0000","0.6923","0.8462","0.3846","0.5385","0.6154","0.6923","0.6923","0.9231","0.3846","0.3846","0.8462","0.4615","0.8462","0.5385","0.3846","0.4615","0.5385","0.7692","0.6154","1.0000","0.4615","0.6923","0.6154","0.3846","0.5385","0.6923","0.6154","0.6154","1.0000","0.3846","0.5385","0.4615","0.8462","0.7692","0.3846","0.4615","1.0000","0.9231","0.5385","0.5385","0.9231","0.9231","0.5385","0.8462","0.8462","0.5385"],"header":"Prevalence25%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence30%","name":"Prevalence30%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.7692","0.7692","0.3846","0.8462","0.7692","0.9231","0.5385","0.4615","1.0000","0.9231","0.8462","0.4615","0.7692","0.6154","0.9231","0.6923","0.9231","0.9231","0.4615","0.3846","0.3846","0.3846","0.3846","0.3077","0.4615","0.4615","0.6923","1.0000","0.5385","0.5385","0.7692","0.6154","0.6154","0.4615","0.3846","0.5385","0.4615","0.3846","0.8462","0.3846","0.8462","0.8462","0.5385","0.7692","0.6154","0.5385","0.7692","0.7692","0.8462","0.3846","0.9231","0.3846","0.3077","0.2308","0.4615","0.6154","0.8462","0.8462","0.8462","0.8462","1.0000","0.4615","0.6923","0.5385","0.7692","0.6154","0.3846","0.6154","0.4615","0.6923","1.0000","0.6923","0.6154","0.8462","0.5385","0.7692","0.8462","0.4615","0.7692","0.8462","0.3846","0.3846","0.8462","0.3846","0.5385","0.6923","0.7692","0.4615","0.4615","0.7692","0.2308","0.9231","0.4615","0.6923","0.7692","0.8462","0.6923","0.4615","0.9231","0.8462"],"header":"Prevalence30%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence35%","name":"Prevalence35%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.3077","0.5385","0.6154","0.6154","0.3077","0.6154","0.5385","0.6154","0.6154","0.5385","0.9231","1.0000","0.3846","0.3846","0.6154","0.9231","0.4615","0.9231","0.6154","0.7692","0.7692","0.8462","0.6923","0.9231","0.8462","0.7692","0.8462","0.5385","0.6154","0.4615","0.8462","0.4615","0.7692","1.0000","0.6154","0.8462","0.5385","0.7692","0.9231","0.6923","0.2308","0.6923","0.9231","0.3846","0.8462","0.5385","0.5385","0.8462","0.7692","0.3846","0.4615","0.8462","0.6154","0.6923","0.7692","0.3846","0.5385","0.3846","0.4615","0.7692","0.4615","0.3077","0.6923","0.8462","0.8462","0.5385","0.9231","0.9231","1.0000","0.5385","0.4615","0.4615","0.6154","0.4615","0.7692","0.4615","0.8462","0.5385","0.4615","0.6923","0.6154","0.4615","0.9231","0.6154","0.4615","0.3077","1.0000","1.0000","0.5385","0.6923","0.6154","0.6923","0.5385","0.9231","0.9231","0.5385","0.7692","0.4615","0.6154","1.0000"],"header":"Prevalence35%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence40%","name":"Prevalence40%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6154","0.6923","0.9231","1.0000","0.5385","0.6923","0.5385","0.8462","0.4615","0.6923","0.9231","0.8462","0.8462","0.5385","0.3846","0.4615","0.6154","1.0000","0.6154","0.5385","0.4615","0.6154","0.7692","0.4615","0.7692","0.6154","0.7692","0.7692","0.6923","0.6923","0.6923","0.9231","0.5385","0.6154","0.9231","0.7692","0.8462","0.4615","0.7692","0.4615","0.5385","0.3077","0.8462","0.1538","0.6154","0.5385","0.5385","0.4615","0.4615","0.5385","0.9231","0.7692","0.5385","0.4615","0.6923","0.5385","0.4615","0.9231","0.5385","0.6923","0.9231","0.6923","1.0000","1.0000","0.6154","1.0000","0.6154","0.5385","0.7692","0.6923","0.6154","0.4615","0.7692","0.8462","0.6154","0.5385","0.4615","0.6154","0.7692","0.6154","0.3846","0.4615","0.3846","0.3077","0.9231","0.5385","0.4615","0.6923","0.3077","1.0000","0.6923","0.5385","0.6923","0.7692","0.6923","0.5385","0.6923","0.3077","0.5385","0.8462"],"header":"Prevalence40%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence45%","name":"Prevalence45%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6923","1.0000","1.0000","0.8462","0.6154","0.6154","0.9231","0.8462","0.6154","0.5385","0.6154","0.7692","0.6154","0.6923","0.6154","1.0000","1.0000","0.9231","0.6154","0.5385","0.6154","0.3077","0.6154","0.4615","1.0000","0.3846","0.6154","0.5385","0.8462","0.6154","0.4615","0.9231","0.6923","0.5385","1.0000","0.3846","0.8462","0.6154","0.6154","0.5385","0.6923","0.7692","0.6154","0.6154","0.6154","0.4615","0.4615","0.6154","0.7692","0.6154","0.9231","0.6923","0.9231","0.3077","0.9231","0.5385","0.5385","0.7692","0.8462","0.5385","0.6923","0.6923","0.3846","0.9231","0.6923","1.0000","0.6923","0.6154","0.7692","0.6154","0.8462","0.6154","0.9231","0.8462","0.3846","0.5385","0.6923","0.5385","0.4615","0.7692","0.3077","0.4615","0.3846","1.0000","0.6154","0.6154","0.6923","0.5385","0.6154","0.6923","0.6923","0.5385","0.6154","0.6154","0.5385","0.6923","0.8462","0.8462","0.7692","0.8462"],"header":"Prevalence45%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence50%","name":"Prevalence50%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.3846","0.7692","0.2308","0.6154","0.2308","0.7692","0.4615","0.5385","1.0000","0.5385","0.6923","1.0000","1.0000","0.4615","0.4615","0.7692","0.7692","0.6923","0.8462","0.7692","0.8462","0.7692","0.8462","0.7692","0.5385","0.6923","0.7692","0.6923","0.7692","0.3846","0.6923","0.7692","0.5385","0.9231","0.6923","0.6923","0.6154","0.8462","0.7692","0.4615","0.9231","0.3846","0.8462","0.6154","0.6154","0.9231","0.4615","0.5385","0.8462","0.5385","0.5385","0.4615","0.3077","0.3077","0.5385","0.6923","0.7692","0.9231","0.4615","0.3077","0.3846","0.5385","0.7692","0.4615","0.5385","0.3846","0.9231","0.5385","0.6154","0.6154","0.6923","0.8462","0.6154","0.5385","0.9231","0.8462","0.7692","0.7692","0.5385","0.4615","0.6154","0.4615","0.9231","0.8462","0.2308","1.0000","0.4615","0.8462","0.7692","0.9231","1.0000","0.7692","0.8462","0.4615","0.6154","0.6154","0.4615","0.6923","0.9231","0.9231"],"header":"Prevalence50%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence55%","name":"Prevalence55%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.3846","0.5385","0.6154","1.0000","0.5385","0.7692","0.5385","0.8462","1.0000","0.9231","0.3846","1.0000","0.4615","0.4615","0.7692","0.4615","0.6923","0.5385","0.4615","0.6154","0.3846","0.6923","0.3077","0.8462","0.5385","0.3846","0.7692","0.3846","0.5385","0.6923","0.6923","0.5385","0.6154","0.6923","0.9231","0.5385","0.5385","0.6154","0.8462","0.6923","0.6923","0.6923","0.9231","0.6923","0.6923","0.4615","0.3846","0.6923","0.3077","0.5385","0.7692","0.6154","0.6923","0.3846","0.9231","1.0000","0.8462","0.9231","0.8462","0.6923","0.6923","0.6923","0.7692","0.4615","0.3846","0.3846","0.8462","1.0000","0.7692","0.5385","0.8462","0.7692","0.4615","0.6154","0.9231","0.9231","0.8462","0.6154","0.4615","0.7692","0.6923","0.3846","0.6154","0.9231","0.6923","0.3846","0.5385","0.6923","0.9231","0.7692","1.0000","0.9231","0.6923","0.9231","0.6923","0.9231","0.8462","0.3846","0.5385","0.4615"],"header":"Prevalence55%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence60%","name":"Prevalence60%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6923","0.5385","0.8462","0.9231","0.8462","0.4615","0.4615","0.5385","0.9231","0.4615","0.6923","0.3077","0.5385","0.5385","0.3846","1.0000","0.4615","0.5385","0.6154","0.9231","0.5385","0.5385","0.5385","0.3846","0.9231","0.4615","0.5385","0.5385","0.7692","1.0000","0.3846","0.6154","0.7692","0.7692","0.4615","0.7692","0.5385","0.7692","0.7692","0.8462","0.4615","1.0000","1.0000","0.9231","0.6923","0.6923","0.2308","0.5385","0.5385","0.6154","0.8462","0.5385","0.7692","0.4615","0.6154","0.9231","0.8462","0.9231","0.5385","0.6154","0.5385","0.5385","0.4615","0.4615","1.0000","0.6154","0.3077","0.3846","0.7692","0.9231","0.6154","1.0000","0.6923","1.0000","0.4615","0.7692","0.6923","0.8462","0.5385","0.3077","0.6154","0.7692","0.4615","0.4615","0.6154","0.3846","0.4615","0.5385","0.6154","0.6154","0.3077","1.0000","0.6923","0.3077","0.6154","0.7692","0.8462","0.3846","0.4615","0.7692"],"header":"Prevalence60%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence65%","name":"Prevalence65%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6154","0.7692","0.7692","0.6154","0.7692","0.5385","0.6154","0.4615","0.6154","0.6923","0.6923","0.4615","0.6923","0.3846","0.9231","0.5385","0.7692","0.6154","0.5385","0.9231","0.5385","0.5385","1.0000","0.6154","0.5385","0.3077","0.9231","0.5385","0.7692","0.5385","0.6923","0.4615","0.5385","0.4615","0.8462","1.0000","0.3077","0.6923","0.8462","0.5385","0.6923","0.5385","1.0000","0.7692","0.6923","0.5385","0.8462","0.7692","0.6154","0.6923","1.0000","0.3846","0.6154","0.5385","0.7692","0.7692","0.5385","0.3846","0.6154","0.6154","0.6154","0.9231","0.4615","0.8462","0.1538","0.7692","0.9231","0.7692","0.3846","0.8462","0.6154","0.5385","0.6154","0.8462","0.7692","0.4615","0.6923","0.8462","0.3846","0.7692","0.6923","0.6923","0.4615","0.7692","0.4615","0.4615","0.6154","1.0000","0.6923","1.0000","0.3846","0.6923","0.8462","0.7692","1.0000","0.6154","0.4615","0.7692","0.8462","0.3846"],"header":"Prevalence65%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence70%","name":"Prevalence70%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.7692","0.9231","0.4615","0.6923","0.5385","0.6923","0.4615","1.0000","0.6923","0.4615","0.6154","0.4615","0.6154","0.7692","0.4615","0.6154","0.9231","0.8462","0.4615","0.7692","0.5385","1.0000","0.5385","0.5385","1.0000","0.6923","0.9231","0.5385","0.6923","0.4615","0.8462","0.9231","0.6923","0.6923","0.5385","0.5385","0.7692","0.9231","0.7692","0.3846","0.4615","0.8462","0.4615","0.5385","0.4615","0.6923","0.6154","0.6923","0.6154","0.9231","0.4615","0.5385","1.0000","0.6154","0.8462","0.9231","0.6154","0.6923","1.0000","0.6923","0.4615","0.6154","0.4615","0.8462","0.4615","0.9231","0.9231","0.9231","0.5385","0.8462","0.6923","0.4615","0.7692","0.8462","0.7692","0.7692","0.6923","0.6154","0.4615","0.8462","0.4615","1.0000","0.8462","0.4615","0.5385","0.4615","0.5385","0.6154","0.9231","1.0000","0.6154","0.3846","0.5385","0.7692","1.0000","0.5385","0.8462","1.0000","0.5385","0.6154"],"header":"Prevalence70%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence75%","name":"Prevalence75%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.6154","0.8462","0.3846","0.6923","0.5385","0.6154","0.5385","0.4615","0.8462","0.6154","1.0000","0.9231","0.7692","0.8462","0.4615","0.5385","0.5385","0.8462","0.6923","0.6154","1.0000","1.0000","0.6923","0.7692","0.4615","0.7692","0.4615","0.7692","0.6923","0.5385","1.0000","0.3846","0.9231","0.4615","0.7692","0.6154","0.4615","0.4615","0.8462","0.6923","0.6923","0.6154","0.4615","0.4615","0.3846","0.5385","0.9231","0.7692","0.6154","0.8462","1.0000","0.9231","0.7692","0.4615","0.4615","0.8462","0.3846","0.4615","0.5385","0.9231","0.9231","0.7692","0.7692","0.9231","0.6923","0.3077","0.3846","1.0000","0.3077","0.6923","0.6154","0.6154","0.7692","0.3077","0.4615","0.6154","0.6923","0.5385","0.6923","0.6923","0.5385","0.5385","1.0000","0.4615","1.0000","0.6923","0.4615","0.6154","0.5385","0.9231","0.6923","0.5385","0.3077","0.6154","0.3846","0.9231","0.9231","0.3077","0.8462","0.6154"],"header":"Prevalence75%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence80%","name":"Prevalence80%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.3077","0.7692","0.9231","0.6923","0.6923","0.6923","0.6154","0.6923","0.9231","0.6923","0.3846","0.4615","0.4615","0.5385","0.3846","0.2308","0.8462","0.8462","0.8462","0.7692","0.7692","0.6923","0.7692","0.6154","0.6923","0.8462","0.9231","0.6923","0.9231","0.6923","0.4615","0.4615","0.3846","0.4615","0.4615","0.7692","0.7692","0.4615","0.8462","0.4615","0.6923","0.9231","0.3846","0.6923","0.6154","0.3077","0.3846","0.7692","0.7692","0.7692","0.8462","1.0000","0.8462","0.7692","0.9231","0.9231","0.5385","0.6154","0.7692","0.4615","0.7692","0.5385","0.7692","0.6923","0.3846","0.9231","0.3846","0.5385","0.4615","0.6154","0.5385","0.7692","0.7692","0.6154","0.6154","0.8462","0.4615","1.0000","0.8462","0.5385","0.7692","0.3846","0.9231","1.0000","0.2308","0.5385","0.9231","0.9231","0.5385","0.6154","0.4615","0.9231","0.3846","0.6154","0.8462","0.4615","0.6154","0.7692","0.6923","0.8462"],"header":"Prevalence80%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence85%","name":"Prevalence85%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.4615","0.2308","0.6923","0.5385","0.8462","0.5385","0.3846","0.6154","0.6923","0.4615","0.4615","0.6923","0.9231","1.0000","0.6154","0.7692","0.6923","0.6923","0.7692","0.6923","0.3846","0.9231","0.9231","0.6154","0.5385","0.6923","0.6154","0.5385","0.7692","0.7692","0.3846","0.5385","0.8462","0.7692","0.8462","0.7692","0.4615","0.7692","0.5385","0.6923","0.7692","1.0000","0.4615","0.6923","0.8462","0.6923","0.8462","1.0000","0.3846","0.5385","0.7692","0.8462","0.4615","0.4615","1.0000","0.6154","0.8462","0.9231","0.9231","0.5385","0.6154","0.4615","0.7692","1.0000","0.7692","0.6154","0.8462","0.3077","0.9231","0.4615","0.3846","0.4615","0.4615","0.5385","0.6923","0.3077","0.7692","0.9231","0.6154","0.3846","0.3846","0.6923","0.9231","0.4615","0.8462","0.6923","0.5385","0.3846","0.3846","0.8462","0.7692","0.7692","0.8462","0.6923","1.0000","0.5385","0.9231","0.4615","1.0000","0.6923"],"header":"Prevalence85%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence90%","name":"Prevalence90%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.8462","0.8462","0.6923","0.5385","0.6154","0.7692","0.6154","0.8462","0.4615","0.6154","0.9231","0.7692","0.7692","0.4615","0.6923","0.4615","0.2308","0.3846","0.6154","1.0000","0.6154","0.4615","0.6154","0.7692","0.5385","0.3846","0.9231","0.6923","0.6923","0.7692","0.3077","0.7692","0.6154","0.4615","0.6923","0.3846","0.6923","0.4615","0.9231","0.7692","0.4615","0.3846","0.6923","0.6923","0.4615","0.8462","0.7692","0.6923","0.8462","0.6154","0.4615","0.4615","0.6154","0.5385","0.7692","1.0000","0.4615","0.5385","0.9231","0.3846","0.7692","0.5385","0.7692","0.3846","0.4615","0.8462","0.4615","0.8462","0.8462","0.4615","1.0000","0.6923","1.0000","0.3846","0.4615","0.6154","0.6923","0.5385","0.4615","1.0000","0.9231","0.7692","0.2308","0.6154","0.5385","1.0000","0.6923","0.6154","0.6154","0.3846","0.4615","0.6923","0.7692","0.8462","0.7692","1.0000","0.6154","0.3846","0.5385","0.6154"],"header":"Prevalence90%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"Prevalence95%","name":"Prevalence95%","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.9231","0.3846","0.5385","0.3846","0.9231","0.5385","0.5385","0.3077","0.7692","0.5385","0.7692","0.5385","0.5385","0.4615","0.4615","1.0000","0.5385","0.9231","0.5385","0.7692","0.5385","0.5385","0.5385","0.3846","0.6154","0.6923","0.5385","0.3077","0.1538","0.8462","0.5385","0.7692","0.6923","0.3846","0.6923","0.3077","1.0000","0.8462","0.4615","0.6923","0.7692","0.4615","0.3846","1.0000","0.8462","0.9231","0.7692","0.4615","0.5385","0.9231","0.9231","0.6923","0.4615","0.5385","0.6923","0.5385","0.5385","0.8462","0.7692","0.6923","0.9231","1.0000","0.7692","0.5385","0.5385","0.5385","0.5385","0.6923","0.4615","0.9231","0.6154","0.6923","0.7692","0.3077","0.6154","0.6154","0.8462","0.9231","0.6923","0.6154","0.9231","0.4615","0.8462","0.6154","0.6154","0.7692","0.5385","0.9231","0.8462","0.5385","0.7692","0.4615","0.6154","0.4615","0.7692","0.8462","0.8462","0.6154","0.8462","0.6923"],"header":"Prevalence95%","minWidth":120,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"dba160f554296c2e691d2f50954b48ec"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">

</div>
<p>It is also possible to estimate the variation of OOB error for each prevalence interval filtering. This is done by running the random forests classification for <code>n</code> times, determined by the <code>bootstrap</code> value. The function will return a box plot figure and a table for each classification error.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_replicated.oob.error</span> <span class="op">&lt;-</span> <span class="fu">pime.oob.replicate</span><span class="op">(</span><span class="va">its18_prevalences</span>, <span class="st">"TEMP"</span>,
                                         bootstrap <span class="op">=</span> <span class="fl">100</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="filtering_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><small><strong>(ITS) Figure 1 | OOB error rate for the original data set (top) &amp; the randomized data (bottom).</strong></small></p>
<p>To obtain the confusion matrix from random forests classification use the following:</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_prev_confuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"its18_best.prev$`Confusion`$"</span>, <span class="va">its18_best</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="op">(</span><span class="va">its18_prev_confuse</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="save-phyloseq-pime-objects-1" class="level3"><h3 class="anchored" data-anchor-id="save-phyloseq-pime-objects-1">Save Phyloseq PIME objects</h3>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">its18_ps_pime</span> <span class="op">&lt;-</span> <span class="va">its18_prevalence_best</span>
<span class="va">its18_ps_pime_tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html">ntaxa</a></span><span class="op">(</span><span class="va">its18_ps_pime</span><span class="op">)</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span>,
                           tip.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html">taxa_names</a></span><span class="op">(</span><span class="va">its18_ps_pime</span><span class="op">)</span><span class="op">)</span>
<span class="va">its18_ps_pime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/merge_phyloseq.html">merge_phyloseq</a></span><span class="op">(</span><span class="va">its18_ps_pime</span>,
                               <span class="va">sample_data</span>,
                               <span class="va">its18_ps_pime_tree</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">its18_ps_pime</span>, <span class="st">"files/filtering/pime/rdata/its18_ps_pime.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="split-save-by-predictor-variable-1" class="level3"><h3 class="anchored" data-anchor-id="split-save-by-predictor-variable-1">Split &amp; save by predictor variable</h3>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">its18_ps_pime</span><span class="op">)</span><span class="op">)</span>
<span class="va">its18_ps_pime_split</span> <span class="op">&lt;-</span> <span class="fu">pime.split.by.variable</span><span class="op">(</span><span class="va">its18_ps_pime</span>, <span class="st">"TEMP"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">its18_ps_pime_split</span><span class="op">$</span><span class="va">`0`</span>, <span class="st">"files/filtering/pime/rdata/its18_ps_pime_0.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">its18_ps_pime_split</span><span class="op">$</span><span class="va">`3`</span>, <span class="st">"files/filtering/pime/rdata/its18_ps_pime_3.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">its18_ps_pime_split</span><span class="op">$</span><span class="va">`8`</span>, <span class="st">"files/filtering/pime/rdata/its18_ps_pime_8.rds"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$`0`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 315 taxa and 5 samples ]
sample_data() Sample Data:       [ 5 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 315 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 315 tips and 314 internal nodes ]

$`3`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 234 taxa and 4 samples ]
sample_data() Sample Data:       [ 4 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 234 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 234 tips and 233 internal nodes ]

$`8`
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 138 taxa and 4 samples ]
sample_data() Sample Data:       [ 4 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 138 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 138 tips and 137 internal nodes ]</code></pre>
</div>
</div>
<div class="cell">

</div>
</section><section id="summary-2" class="level3"><h3 class="anchored" data-anchor-id="summary-2">Summary</h3>
<p>The influence of filtering on total reads and ASVs for each sample.</p>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 9 | Sample summary showing the number of reads and ASVs after PIME filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,U2FtcGxlX0lELFBMT1QsVFJFQVQsVEVNUCxQQUlSLHRvdGFsX3JlYWRzLHRvdGFsX2FzdnMKUDAxX0QwMF8wMTBfVzNBLFAwMSxXLDMsQSw2NTg2LDE4MQpQMDFfRDAwXzAxMF9XOEEsUDAxLFcsOCxBLDM0NDIsMTIzClAwMl9EMDBfMDEwX0MwQSxQMDIsQywwLEEsNTgxOSwyMzgKUDAzX0QwMF8wMTBfVzNCLFAwMyxXLDMsQiw0MzUzLDE5NgpQMDNfRDAwXzAxMF9XOEIsUDAzLFcsOCxCLDQ5OTEsMTA5ClAwNF9EMDBfMDEwX0MwQixQMDQsQywwLEIsNDM4NSwyMjkKUDA1X0QwMF8wMTBfVzhDLFAwNSxXLDgsQyw0MTgxLDEzMQpQMDZfRDAwXzAxMF9DMEMsUDA2LEMsMCxDLDY3MjcsMjQ2ClAwN19EMDBfMDEwX1czRCxQMDcsVywzLEQsNDk2MywyMDUKUDA3X0QwMF8wMTBfVzhELFAwNyxXLDgsRCw0MjE1LDk3ClAwOF9EMDBfMDEwX0MwRCxQMDgsQywwLEQsNjc2MSwxOTgKUDA5X0QwMF8wMTBfVzNFLFAwOSxXLDMsRSw0OTI1LDE5NgpQMTBfRDAwXzAxMF9DMEUsUDEwLEMsMCxFLDYzMTcsMjAzCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its_pime_samp_summary.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-284c701bf46a3820172f" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-284c701bf46a3820172f">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Sample_ID":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"PLOT":["P01","P01","P02","P03","P03","P04","P05","P06","P07","P07","P08","P09","P10"],"TREAT":["W","W","C","W","W","C","W","C","W","W","C","W","C"],"TEMP":["3","8","0","3","8","0","8","0","3","8","0","3","0"],"PAIR":["A","A","A","B","B","B","C","C","D","D","D","E","E"],"total_reads":[6586,3442,5819,4353,4991,4385,4181,6727,4963,4215,6761,4925,6317],"total_asvs":[181,123,238,196,109,229,131,246,205,97,198,196,203]},"columns":[{"accessor":"Sample_ID","name":"Sample_ID","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01_D00_010_W3A","P01_D00_010_W8A","P02_D00_010_C0A","P03_D00_010_W3B","P03_D00_010_W8B","P04_D00_010_C0B","P05_D00_010_W8C","P06_D00_010_C0C","P07_D00_010_W3D","P07_D00_010_W8D","P08_D00_010_C0D","P09_D00_010_W3E","P10_D00_010_C0E"],"header":"Sample ID","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"PLOT","name":"PLOT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["P01","P01","P02","P03","P03","P04","P05","P06","P07","P07","P08","P09","P10"],"header":"PLOT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TREAT","name":"TREAT","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["W","W","C","W","W","C","W","C","W","W","C","W","C"],"header":"TREAT","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"TEMP","name":"TEMP","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["3","8","0","3","8","0","8","0","3","8","0","3","0"],"header":"TEMP","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"PAIR","name":"PAIR","type":"character","sortable":true,"resizable":true,"filterable":true,"cell":["A","A","A","B","B","B","C","C","D","D","D","E","E"],"header":"PAIR","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_reads","name":"total_reads","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["6586","3442","5819","4353","4991","4385","4181","6727","4963","4215","6761","4925","6317"],"header":"total reads","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total_asvs","name":"total_asvs","type":"numeric","sortable":true,"resizable":true,"filterable":true,"cell":["181","123","238","196","109","229","131","246","205","97","198","196","203"],"header":"total asvs","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"searchable":true,"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,13],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"showSortable":true,"inline":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"8182cdbf82b0bb4a2e1e7b44b9a84e60"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>And here is how the subsets changed through the PIME filtering process.</p>
<div class="cell">

</div>
<p><small><strong>(ITS) Table 10 | Changes in read count and total ASVs during PIME filtering.</strong></small></p>
<div class="cell">
<div class="cell-output-display">
<a onclick="fetch('data:text/csv;base64,RGVzY3JpcHRpb24sbm8uIHNhbXBsZXMsdG90YWwgcmVhZHMsdG90YWwgYXN2cwpGVUxMIGRhdGEgc2V0LDEzLDQ5MDc2NywzMzU1ClJhcmVmaWVkIGRhdGEsMTMsMTE5MjM2LDMwNTcKUElNRSBmaWx0ZXJlZCBkYXRhLDEzLDY3NjY1LDQ3NApQSU1FICgrMEMpLDUsMzAwMDksMzE1ClBJTUUgKCszQyksNCwyMDgyNywyMzQKUElNRSAoKzhDKSw0LDE2ODI5LDEzOAo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'its18_asv_pime_sum.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-default" has_icon="TRUE"><i class="fa fa-save"></i> Download data as csv file</button>
</a>
</div>
</div>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-33ef87874891cb7f613e" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-33ef87874891cb7f613e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Description":["FULL data set","Rarefied data","PIME filtered data","PIME (+0C)","PIME (+3C)","PIME (+8C)"],"no. samples":[13,13,13,5,4,4],"total reads":[490767,119236,67665,30009,20827,16829],"total asvs":[3355,3057,474,315,234,138]},"columns":[{"accessor":"Description","name":"Description","type":"character","sortable":false,"resizable":true,"filterable":false,"cell":["FULL data set","Rarefied data","PIME filtered data","PIME (+0C)","PIME (+3C)","PIME (+8C)"],"header":"Description","minWidth":150,"align":"left","footerStyle":{"fontWeight":"bold"},"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"accessor":"no. samples","name":"no. samples","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["13","13","13","5","4","4"],"header":"no. samples","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total reads","name":"total reads","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["490767","119236","67665","30009","20827","16829"],"header":"total reads","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}},{"accessor":"total asvs","name":"total asvs","type":"numeric","sortable":false,"resizable":true,"filterable":false,"cell":["3355","3057","474","315","234","138"],"header":"total asvs","minWidth":100,"align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":6,"showPageSizeOptions":true,"pageSizeOptions":[5,10,6],"paginationType":"numbers","showPagination":false,"showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"striped":true,"compact":true,"nowrap":true,"inline":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"060a32b1a79b70264c8886a5cbb85938"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">

</div>
</section></section></section><section id="workflow-output" class="level1"><h1>Workflow Output</h1>
<p>Data products generated in this workflow can be downloaded from figshare.</p>
<iframe src="https://widgets.figshare.com/articles/14701440/embed?show_title=1" width="100%" height="351" allowfullscreen="" frameborder="0">
</iframe>
<p></p>
<p><a href="taxa.html" class="btnnav button_round" style="float: right;">Next workflow: <br> 4. Taxonomic Diversity</a> <a href="data-prep.html" class="btnnav button_round" style="float: left;">Previous workflow: <br> 2. Data Set Preparation</a><br><br></p>
<div class="cell">

</div>
</section><div id="quarto-appendix" class="default"><section id="source-code" class="level4 appendix"><h2 class="quarto-appendix-heading">Source Code</h2><div class="quarto-appendix-contents">
<p>The source code for this page can be accessed on GitHub <svg aria-hidden="true" role="img" viewbox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> by <a href="https://github.com/sweltr/high-temp/blob/main/filtering.qmd">clicking this link</a>.</p>
</div></section><section id="data-availability" class="level4 appendix"><h2 class="quarto-appendix-heading">Data Availability</h2><div class="quarto-appendix-contents">
<p>Data generated in this workflow and the <code>Rdata</code> file need to run the workflow can be accessed on figshare at <a href="https://doi.org/10.25573/data.14701440">10.25573/data.14701440</a>.</p>
</div></section><section id="last-updated-on" class="level4 appendix"><h2 class="quarto-appendix-heading">Last updated on</h2><div class="quarto-appendix-contents">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022-06-16 18:34:30 EST"</code></pre>
</div>
</div>


<!-- -->


</div></section><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-roesch2020pime" class="csl-entry" role="doc-biblioentry">
Roesch, Luiz Fernando W, Priscila T Dobbler, Victor S Pylro, Bryan Kolaczkowski, Jennifer C Drew, and Eric W Triplett. 2020. <span>“PIME: A Package for Discovery of Novel Differences Among Microbial Communities.”</span> <em>Molecular Ecology Resources</em> 20 (2): 415–28. <a href="https://doi.org/10.1111/1755-0998.13116">https://doi.org/10.1111/1755-0998.13116</a>.
</div>
<div id="ref-smirnova2019perfect" class="csl-entry" role="doc-biblioentry">
Smirnova, Ekaterina, Snehalata Huzurbazar, and Farhad Jafari. 2019. <span>“PERFect: PERmutation Filtering Test for Microbiome Data.”</span> <em>Biostatistics</em> 20 (4): 615–31. <a href="https://doi.org/10.1093/biostatistics/kxy020">https://doi.org/10.1093/biostatistics/kxy020</a>.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./data-prep.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">2. Data Set Preparation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./taxa.html" class="pagination-link">
        <span class="nav-page-text">4. Taxonomic Diversity</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb64" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "3. Filtering"</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Reproducible workflow for Arbitrary, PERfect, &amp; PIME filtering of community data.</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;&lt;strong&gt;</span>Click here<span class="kw">&lt;/strong&gt;</span> for setup information.<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">eval =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co">#library(conflicted)</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_depends(PERFect, local = TRUE)  </span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="co">#pacman::p_depends_reverse(PERFect, local = TRUE)  </span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq); <span class="fu">packageVersion</span>(<span class="st">"phyloseq"</span>)</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biostrings); <span class="fu">packageVersion</span>(<span class="st">"Biostrings"</span>)</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, patchwork, </span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>               agricolae, labdsv, naniar, PERFect, pime, ape, gdata,</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>               pairwiseAdonis, microbiome, seqRFLP, microbiomeMarker, </span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>               reactable, downloadthis, captioner, jamba, </span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">install =</span> <span class="cn">FALSE</span>, <span class="at">update =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_current<span class="sc">$</span><span class="fu">get</span>(<span class="fu">c</span>(</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache"</span>,</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache.path"</span>,</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cache.rebuild"</span>,</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dependson"</span>,</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"autodep"</span></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">file.path</span>(<span class="st">"assets"</span>, <span class="st">"functions.R"</span>))</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a><span class="do">## Load to build page</span></span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"page_build/filtering_wf.rdata"</span>)</span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/ssu18_ps_work.rds"</span>)</span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>its18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/its18_ps_work.rds"</span>)</span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the caption(s) with captioner</span></span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a>caption_tab_ssu <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(16S rRNA) Table"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>caption_fig_ssu <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(16S rRNA) Figure"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a>caption_tab_its <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(ITS) Table"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a>caption_fig_its <span class="ot">&lt;-</span> <span class="fu">captioner</span>(<span class="at">prefix =</span> <span class="st">"(ITS) Figure"</span>, <span class="at">suffix =</span> <span class="st">" |"</span>, <span class="at">style =</span> <span class="st">"b"</span>)</span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function for referring to the tables in text</span></span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">str_extract</span>(x, <span class="st">"[^|]*"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trimws</span>(<span class="at">which =</span> <span class="st">"right"</span>, <span class="at">whitespace =</span> <span class="st">"[ ]"</span>)</span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"assets/captions/captions_filtering.R"</span>)</span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a>In <span class="co">[</span><span class="ot">Part A</span><span class="co">](#a.-arbitrary-filtering)</span>, we apply arbitrary filtering to the 16S rRNA and ITS data sets. In <span class="co">[</span><span class="ot">Part B</span><span class="co">](#b.-perfect-filtering)</span> we use PERFect <span class="co">[</span><span class="ot">(PERmutation Filtering test for microbiome data)</span><span class="co">](https://github.com/katiasmirn/PERFect)</span> <span class="co">[</span><span class="ot">@smirnova2019perfect</span><span class="co">]</span> to filter the data sets. And in <span class="co">[</span><span class="ot">Part C</span><span class="co">](#c.-pime-filtering)</span> of this workflow, we use PIME <span class="co">[</span><span class="ot">(Prevalence Interval for Microbiome Evaluation)</span><span class="co">](https://github.com/microEcology/pime)</span> <span class="co">[</span><span class="ot">@roesch2020pime</span><span class="co">]</span> to filter the FULL 16S rRNA and ITS data sets. </span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workflow Input</span></span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-88"><a href="#cb64-88" aria-hidden="true" tabindex="-1"></a>Files needed to run this workflow can be downloaded from figshare. </span>
<span id="cb64-89"><a href="#cb64-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-90"><a href="#cb64-90" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://widgets.figshare.com/articles/14690739/embed?show_title=1"</span> <span class="er">width</span><span class="ot">=</span><span class="st">"100%"</span> <span class="er">height</span><span class="ot">=</span><span class="st">"301"</span> <span class="er">allowfullscreen</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">"0"</span><span class="kw">&gt;&lt;/iframe&gt;</span></span>
<span id="cb64-91"><a href="#cb64-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-92"><a href="#cb64-92" aria-hidden="true" tabindex="-1"></a><span class="fu"># Filtering Results</span></span>
<span id="cb64-93"><a href="#cb64-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-94"><a href="#cb64-94" aria-hidden="true" tabindex="-1"></a>We begin by summarizing the results of each filtering method on the 16S and ITS data sets. Below you can find the complete workflow for each filtering method.</span>
<span id="cb64-95"><a href="#cb64-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-96"><a href="#cb64-96" aria-hidden="true" tabindex="-1"></a><span class="fu">## 16S rRNA</span></span>
<span id="cb64-97"><a href="#cb64-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-98"><a href="#cb64-98" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_all_filt_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-99"><a href="#cb64-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-102"><a href="#cb64-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-103"><a href="#cb64-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-104"><a href="#cb64-104" aria-hidden="true" tabindex="-1"></a>ssu18_filtering_results <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(ssu18_sum_arbitrary, ssu18_sum_perfect, </span>
<span id="cb64-105"><a href="#cb64-105" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Full data"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-106"><a href="#cb64-106" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ssu18_sum_pime, </span>
<span id="cb64-107"><a href="#cb64-107" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Full data"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-108"><a href="#cb64-108" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Arbitrary"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"PERfect"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"PIME"</span> <span class="ot">=</span> <span class="dv">5</span>)</span>
<span id="cb64-109"><a href="#cb64-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-110"><a href="#cb64-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-113"><a href="#cb64-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-114"><a href="#cb64-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-115"><a href="#cb64-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-116"><a href="#cb64-116" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_filtering_results</span>
<span id="cb64-117"><a href="#cb64-117" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-118"><a href="#cb64-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-119"><a href="#cb64-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_all_filt_summary"</span>,</span>
<span id="cb64-120"><a href="#cb64-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-121"><a href="#cb64-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-122"><a href="#cb64-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-123"><a href="#cb64-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-124"><a href="#cb64-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-125"><a href="#cb64-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-126"><a href="#cb64-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-127"><a href="#cb64-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-130"><a href="#cb64-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-131"><a href="#cb64-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-132"><a href="#cb64-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-133"><a href="#cb64-133" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-134"><a href="#cb64-134" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-135"><a href="#cb64-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-136"><a href="#cb64-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-137"><a href="#cb64-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-138"><a href="#cb64-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-139"><a href="#cb64-139" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-140"><a href="#cb64-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-141"><a href="#cb64-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-142"><a href="#cb64-142" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-143"><a href="#cb64-143" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-144"><a href="#cb64-144" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-145"><a href="#cb64-145" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-146"><a href="#cb64-146" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>)</span>
<span id="cb64-147"><a href="#cb64-147" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-148"><a href="#cb64-148" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">10</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-149"><a href="#cb64-149" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-150"><a href="#cb64-150" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-151"><a href="#cb64-151" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-152"><a href="#cb64-152" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-153"><a href="#cb64-153" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-154"><a href="#cb64-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-155"><a href="#cb64-155" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-156"><a href="#cb64-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-157"><a href="#cb64-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-160"><a href="#cb64-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-161"><a href="#cb64-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-162"><a href="#cb64-162" aria-hidden="true" tabindex="-1"></a>tmp_read_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_sums</span>(ssu18_ps_work)) <span class="sc">%&gt;%</span></span>
<span id="cb64-163"><a href="#cb64-163" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-164"><a href="#cb64-164" aria-hidden="true" tabindex="-1"></a>tmp_asv_count <span class="ot">&lt;-</span> <span class="fu">estimate_richness</span>(ssu18_ps_work, <span class="at">split =</span> <span class="cn">TRUE</span>, <span class="at">measures =</span> <span class="st">"Observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-165"><a href="#cb64-165" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-166"><a href="#cb64-166" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ssu18_ps_work))</span>
<span id="cb64-167"><a href="#cb64-167" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> tmp_samp_data[<span class="fu">order</span>(tmp_samp_data<span class="sc">$</span>PLOT, tmp_samp_data<span class="sc">$</span>TEMP),]</span>
<span id="cb64-168"><a href="#cb64-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-169"><a href="#cb64-169" aria-hidden="true" tabindex="-1"></a>tmp_join <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp_data, tmp_read_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-170"><a href="#cb64-170" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_asv_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-171"><a href="#cb64-171" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-172"><a href="#cb64-172" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-173"><a href="#cb64-173" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_asvs"</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb64-174"><a href="#cb64-174" aria-hidden="true" tabindex="-1"></a>tmp_join[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-175"><a href="#cb64-175" aria-hidden="true" tabindex="-1"></a>ssu_work_samp_summary <span class="ot">&lt;-</span> tmp_join</span>
<span id="cb64-176"><a href="#cb64-176" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-177"><a href="#cb64-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-178"><a href="#cb64-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-181"><a href="#cb64-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-182"><a href="#cb64-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-183"><a href="#cb64-183" aria-hidden="true" tabindex="-1"></a>ssu18_filtering_results <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(ssu18_sum_arbitrary, ssu18_sum_perfect, </span>
<span id="cb64-184"><a href="#cb64-184" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Full data"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-185"><a href="#cb64-185" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ssu18_sum_pime, </span>
<span id="cb64-186"><a href="#cb64-186" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Full data"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-187"><a href="#cb64-187" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Arbitrary"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"PERfect"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"PIME"</span> <span class="ot">=</span> <span class="dv">5</span>)</span>
<span id="cb64-188"><a href="#cb64-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-189"><a href="#cb64-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-190"><a href="#cb64-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-193"><a href="#cb64-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-194"><a href="#cb64-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-195"><a href="#cb64-195" aria-hidden="true" tabindex="-1"></a>ssu_all_filt_samp_summary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(ssu_work_samp_summary, ssu_filt_samp_summary, </span>
<span id="cb64-196"><a href="#cb64-196" aria-hidden="true" tabindex="-1"></a>                             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sample_ID"</span>, <span class="st">"PLOT"</span>, <span class="st">"TREAT"</span>, <span class="st">"TEMP"</span>, <span class="st">"PAIR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-197"><a href="#cb64-197" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ssu_perfect_samp_summary, </span>
<span id="cb64-198"><a href="#cb64-198" aria-hidden="true" tabindex="-1"></a>                             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sample_ID"</span>, <span class="st">"PLOT"</span>, <span class="st">"TREAT"</span>, <span class="st">"TEMP"</span>, <span class="st">"PAIR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-199"><a href="#cb64-199" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ssu_pime_samp_summary, </span>
<span id="cb64-200"><a href="#cb64-200" aria-hidden="true" tabindex="-1"></a>                             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sample_ID"</span>, <span class="st">"PLOT"</span>, <span class="st">"TREAT"</span>, <span class="st">"TEMP"</span>, <span class="st">"PAIR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-201"><a href="#cb64-201" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">"total_reads.x"</span>, <span class="st">"total_reads.y"</span>, </span>
<span id="cb64-202"><a href="#cb64-202" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"total_reads.x.x"</span>, <span class="st">"total_reads.y.y"</span>), <span class="at">.after =</span> <span class="st">"PAIR"</span>)</span>
<span id="cb64-203"><a href="#cb64-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-204"><a href="#cb64-204" aria-hidden="true" tabindex="-1"></a>ssu_all_filt_samp_summary[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-205"><a href="#cb64-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-206"><a href="#cb64-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-207"><a href="#cb64-207" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_all_filt_samp_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-208"><a href="#cb64-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-211"><a href="#cb64-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-212"><a href="#cb64-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-213"><a href="#cb64-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-214"><a href="#cb64-214" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu_all_filt_samp_summary</span>
<span id="cb64-215"><a href="#cb64-215" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-216"><a href="#cb64-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-217"><a href="#cb64-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_all_filt_samp_summary"</span>,</span>
<span id="cb64-218"><a href="#cb64-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-219"><a href="#cb64-219" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-220"><a href="#cb64-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-221"><a href="#cb64-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-222"><a href="#cb64-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-223"><a href="#cb64-223" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-224"><a href="#cb64-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-225"><a href="#cb64-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-228"><a href="#cb64-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-229"><a href="#cb64-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-230"><a href="#cb64-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-231"><a href="#cb64-231" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-232"><a href="#cb64-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-233"><a href="#cb64-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb64-234"><a href="#cb64-234" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-235"><a href="#cb64-235" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb64-236"><a href="#cb64-236" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>), </span>
<span id="cb64-237"><a href="#cb64-237" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-238"><a href="#cb64-238" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-239"><a href="#cb64-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_reads.x =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb64-240"><a href="#cb64-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_reads.y =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb64-241"><a href="#cb64-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_reads.x.x =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb64-242"><a href="#cb64-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_reads.y.y =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>, </span>
<span id="cb64-243"><a href="#cb64-243" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb64-244"><a href="#cb64-244" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>)),</span>
<span id="cb64-245"><a href="#cb64-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_asvs.x =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb64-246"><a href="#cb64-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_asvs.y =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb64-247"><a href="#cb64-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_asvs.x.x =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb64-248"><a href="#cb64-248" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_asvs.y.y =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>)</span>
<span id="cb64-249"><a href="#cb64-249" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb64-250"><a href="#cb64-250" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb64-251"><a href="#cb64-251" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Reads"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_reads.x"</span>, <span class="st">"total_reads.y"</span>, <span class="st">"total_reads.x.x"</span>, <span class="st">"total_reads.y.y"</span>),</span>
<span id="cb64-252"><a href="#cb64-252" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>, <span class="at">fontSize =</span> <span class="st">"1.5em"</span>)),</span>
<span id="cb64-253"><a href="#cb64-253" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total ASVs"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_asvs.x"</span>, <span class="st">"total_asvs.y"</span>, <span class="st">"total_asvs.x.x"</span>, <span class="st">"total_asvs.y.y"</span>),</span>
<span id="cb64-254"><a href="#cb64-254" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"1.5em"</span>))</span>
<span id="cb64-255"><a href="#cb64-255" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb64-256"><a href="#cb64-256" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-257"><a href="#cb64-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-258"><a href="#cb64-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-259"><a href="#cb64-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-260"><a href="#cb64-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-261"><a href="#cb64-261" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-262"><a href="#cb64-262" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-263"><a href="#cb64-263" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-264"><a href="#cb64-264" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-265"><a href="#cb64-265" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-266"><a href="#cb64-266" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-267"><a href="#cb64-267" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-268"><a href="#cb64-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-269"><a href="#cb64-269" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-270"><a href="#cb64-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-271"><a href="#cb64-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-272"><a href="#cb64-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-273"><a href="#cb64-273" aria-hidden="true" tabindex="-1"></a><span class="fu">## ITS</span></span>
<span id="cb64-274"><a href="#cb64-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-275"><a href="#cb64-275" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_all_filt_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-276"><a href="#cb64-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-279"><a href="#cb64-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-280"><a href="#cb64-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-281"><a href="#cb64-281" aria-hidden="true" tabindex="-1"></a>its18_filtering_results <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(its18_sum_arbitrary, its18_sum_perfect, </span>
<span id="cb64-282"><a href="#cb64-282" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Full data"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-283"><a href="#cb64-283" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">left_join</span>(., its18_sum_pime, </span>
<span id="cb64-284"><a href="#cb64-284" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Full data"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-285"><a href="#cb64-285" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Arbitrary"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"PERfect"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"PIME"</span> <span class="ot">=</span> <span class="dv">5</span>)</span>
<span id="cb64-286"><a href="#cb64-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-287"><a href="#cb64-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-290"><a href="#cb64-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-291"><a href="#cb64-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-292"><a href="#cb64-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-293"><a href="#cb64-293" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_filtering_results</span>
<span id="cb64-294"><a href="#cb64-294" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-295"><a href="#cb64-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-296"><a href="#cb64-296" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_all_filt_summary"</span>,</span>
<span id="cb64-297"><a href="#cb64-297" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-298"><a href="#cb64-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-299"><a href="#cb64-299" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-300"><a href="#cb64-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-301"><a href="#cb64-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-302"><a href="#cb64-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-303"><a href="#cb64-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-304"><a href="#cb64-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-307"><a href="#cb64-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-308"><a href="#cb64-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-309"><a href="#cb64-309" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-310"><a href="#cb64-310" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-311"><a href="#cb64-311" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-312"><a href="#cb64-312" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-313"><a href="#cb64-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-314"><a href="#cb64-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-315"><a href="#cb64-315" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-316"><a href="#cb64-316" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-317"><a href="#cb64-317" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-318"><a href="#cb64-318" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-319"><a href="#cb64-319" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-320"><a href="#cb64-320" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-321"><a href="#cb64-321" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-322"><a href="#cb64-322" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-323"><a href="#cb64-323" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>)</span>
<span id="cb64-324"><a href="#cb64-324" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-325"><a href="#cb64-325" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">10</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-326"><a href="#cb64-326" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-327"><a href="#cb64-327" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-328"><a href="#cb64-328" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-329"><a href="#cb64-329" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-330"><a href="#cb64-330" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-331"><a href="#cb64-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-332"><a href="#cb64-332" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-333"><a href="#cb64-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-334"><a href="#cb64-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-337"><a href="#cb64-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-338"><a href="#cb64-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-339"><a href="#cb64-339" aria-hidden="true" tabindex="-1"></a>tmp_read_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_sums</span>(its18_ps_work)) <span class="sc">%&gt;%</span></span>
<span id="cb64-340"><a href="#cb64-340" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-341"><a href="#cb64-341" aria-hidden="true" tabindex="-1"></a>tmp_asv_count <span class="ot">&lt;-</span> <span class="fu">estimate_richness</span>(its18_ps_work, <span class="at">split =</span> <span class="cn">TRUE</span>, <span class="at">measures =</span> <span class="st">"Observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-342"><a href="#cb64-342" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-343"><a href="#cb64-343" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(its18_ps_work))</span>
<span id="cb64-344"><a href="#cb64-344" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> tmp_samp_data[<span class="fu">order</span>(tmp_samp_data<span class="sc">$</span>PLOT, tmp_samp_data<span class="sc">$</span>TEMP),]</span>
<span id="cb64-345"><a href="#cb64-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-346"><a href="#cb64-346" aria-hidden="true" tabindex="-1"></a>tmp_join <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp_data, tmp_read_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-347"><a href="#cb64-347" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_asv_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-348"><a href="#cb64-348" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-349"><a href="#cb64-349" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-350"><a href="#cb64-350" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_asvs"</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb64-351"><a href="#cb64-351" aria-hidden="true" tabindex="-1"></a>tmp_join[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-352"><a href="#cb64-352" aria-hidden="true" tabindex="-1"></a>its_work_samp_summary <span class="ot">&lt;-</span> tmp_join</span>
<span id="cb64-353"><a href="#cb64-353" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-354"><a href="#cb64-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-355"><a href="#cb64-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-356"><a href="#cb64-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-359"><a href="#cb64-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-360"><a href="#cb64-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-361"><a href="#cb64-361" aria-hidden="true" tabindex="-1"></a>its18_filtering_results <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(its18_sum_arbitrary, its18_sum_perfect, </span>
<span id="cb64-362"><a href="#cb64-362" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Full data"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-363"><a href="#cb64-363" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">left_join</span>(., its18_sum_pime, </span>
<span id="cb64-364"><a href="#cb64-364" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Metric"</span>, <span class="st">"Full data"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-365"><a href="#cb64-365" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Arbitrary"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"PERfect"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"PIME"</span> <span class="ot">=</span> <span class="dv">5</span>)</span>
<span id="cb64-366"><a href="#cb64-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-367"><a href="#cb64-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-368"><a href="#cb64-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-371"><a href="#cb64-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-372"><a href="#cb64-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-373"><a href="#cb64-373" aria-hidden="true" tabindex="-1"></a>its_all_filt_samp_summary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(its_work_samp_summary, its_filt_samp_summary, </span>
<span id="cb64-374"><a href="#cb64-374" aria-hidden="true" tabindex="-1"></a>                             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sample_ID"</span>, <span class="st">"PLOT"</span>, <span class="st">"TREAT"</span>, <span class="st">"TEMP"</span>, <span class="st">"PAIR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-375"><a href="#cb64-375" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">left_join</span>(., its_perfect_samp_summary, </span>
<span id="cb64-376"><a href="#cb64-376" aria-hidden="true" tabindex="-1"></a>                             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sample_ID"</span>, <span class="st">"PLOT"</span>, <span class="st">"TREAT"</span>, <span class="st">"TEMP"</span>, <span class="st">"PAIR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-377"><a href="#cb64-377" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">left_join</span>(., its_pime_samp_summary, </span>
<span id="cb64-378"><a href="#cb64-378" aria-hidden="true" tabindex="-1"></a>                             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Sample_ID"</span>, <span class="st">"PLOT"</span>, <span class="st">"TREAT"</span>, <span class="st">"TEMP"</span>, <span class="st">"PAIR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-379"><a href="#cb64-379" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">"total_reads.x"</span>, <span class="st">"total_reads.y"</span>, </span>
<span id="cb64-380"><a href="#cb64-380" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"total_reads.x.x"</span>, <span class="st">"total_reads.y.y"</span>), <span class="at">.after =</span> <span class="st">"PAIR"</span>)</span>
<span id="cb64-381"><a href="#cb64-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-382"><a href="#cb64-382" aria-hidden="true" tabindex="-1"></a>its_all_filt_samp_summary[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-383"><a href="#cb64-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-384"><a href="#cb64-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-385"><a href="#cb64-385" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_all_filt_samp_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-386"><a href="#cb64-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-389"><a href="#cb64-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-390"><a href="#cb64-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-391"><a href="#cb64-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-392"><a href="#cb64-392" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its_all_filt_samp_summary</span>
<span id="cb64-393"><a href="#cb64-393" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-394"><a href="#cb64-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-395"><a href="#cb64-395" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_all_filt_samp_summary"</span>,</span>
<span id="cb64-396"><a href="#cb64-396" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-397"><a href="#cb64-397" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-398"><a href="#cb64-398" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-399"><a href="#cb64-399" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-400"><a href="#cb64-400" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-401"><a href="#cb64-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-402"><a href="#cb64-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-403"><a href="#cb64-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-406"><a href="#cb64-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-407"><a href="#cb64-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-408"><a href="#cb64-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-409"><a href="#cb64-409" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-410"><a href="#cb64-410" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-411"><a href="#cb64-411" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb64-412"><a href="#cb64-412" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-413"><a href="#cb64-413" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb64-414"><a href="#cb64-414" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>), </span>
<span id="cb64-415"><a href="#cb64-415" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-416"><a href="#cb64-416" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-417"><a href="#cb64-417" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_reads.x =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb64-418"><a href="#cb64-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_reads.y =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb64-419"><a href="#cb64-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_reads.x.x =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb64-420"><a href="#cb64-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_reads.y.y =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>, </span>
<span id="cb64-421"><a href="#cb64-421" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>),</span>
<span id="cb64-422"><a href="#cb64-422" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>)),</span>
<span id="cb64-423"><a href="#cb64-423" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_asvs.x =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"FULL"</span>),</span>
<span id="cb64-424"><a href="#cb64-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_asvs.y =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Arbitrary"</span>),</span>
<span id="cb64-425"><a href="#cb64-425" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_asvs.x.x =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PERfect"</span>),</span>
<span id="cb64-426"><a href="#cb64-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_asvs.y.y =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"PIME"</span>)</span>
<span id="cb64-427"><a href="#cb64-427" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb64-428"><a href="#cb64-428" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb64-429"><a href="#cb64-429" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Reads"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_reads.x"</span>, <span class="st">"total_reads.y"</span>, <span class="st">"total_reads.x.x"</span>, <span class="st">"total_reads.y.y"</span>),</span>
<span id="cb64-430"><a href="#cb64-430" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"5px solid #eee"</span>, <span class="at">fontSize =</span> <span class="st">"1.5em"</span>)),</span>
<span id="cb64-431"><a href="#cb64-431" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total ASVs"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_asvs.x"</span>, <span class="st">"total_asvs.y"</span>, <span class="st">"total_asvs.x.x"</span>, <span class="st">"total_asvs.y.y"</span>),</span>
<span id="cb64-432"><a href="#cb64-432" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"1.5em"</span>))</span>
<span id="cb64-433"><a href="#cb64-433" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb64-434"><a href="#cb64-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-435"><a href="#cb64-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-436"><a href="#cb64-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-437"><a href="#cb64-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-438"><a href="#cb64-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-439"><a href="#cb64-439" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-440"><a href="#cb64-440" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-441"><a href="#cb64-441" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-442"><a href="#cb64-442" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-443"><a href="#cb64-443" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-444"><a href="#cb64-444" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-445"><a href="#cb64-445" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-446"><a href="#cb64-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-447"><a href="#cb64-447" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-448"><a href="#cb64-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-449"><a href="#cb64-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-450"><a href="#cb64-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-451"><a href="#cb64-451" aria-hidden="true" tabindex="-1"></a><span class="fu"># A. Arbitrary Filtering</span></span>
<span id="cb64-452"><a href="#cb64-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-453"><a href="#cb64-453" aria-hidden="true" tabindex="-1"></a>For low-count arbitrary filtering, we set the minimum read count to <span class="in">`5`</span> and the prevalence to 20%. Then we apply another filter to remove ASVs with a low variance (<span class="in">`0.2`</span>).</span>
<span id="cb64-454"><a href="#cb64-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-457"><a href="#cb64-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-458"><a href="#cb64-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb64-459"><a href="#cb64-459" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial Load for ARBITRARY  ANALYSIS #1</span></span>
<span id="cb64-460"><a href="#cb64-460" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb64-461"><a href="#cb64-461" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/ssu18_ps_work.rds"</span>)</span>
<span id="cb64-462"><a href="#cb64-462" aria-hidden="true" tabindex="-1"></a>its18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/its18_ps_work.rds"</span>)</span>
<span id="cb64-463"><a href="#cb64-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-464"><a href="#cb64-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-465"><a href="#cb64-465" aria-hidden="true" tabindex="-1"></a><span class="fu">## 16S rRNA</span></span>
<span id="cb64-466"><a href="#cb64-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-469"><a href="#cb64-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-470"><a href="#cb64-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb64-471"><a href="#cb64-471" aria-hidden="true" tabindex="-1"></a>tmp_low_count <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">genefilter_sample</span>(</span>
<span id="cb64-472"><a href="#cb64-472" aria-hidden="true" tabindex="-1"></a>                                         ssu18_ps_work, </span>
<span id="cb64-473"><a href="#cb64-473" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">filterfun_sample</span>(<span class="cf">function</span>(x) x <span class="sc">&gt;=</span> <span class="dv">5</span>), </span>
<span id="cb64-474"><a href="#cb64-474" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">A =</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">nsamples</span>(ssu18_ps_work))</span>
<span id="cb64-475"><a href="#cb64-475" aria-hidden="true" tabindex="-1"></a>tmp_low_count <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">prune_taxa</span>(tmp_low_count, ssu18_ps_work)</span>
<span id="cb64-476"><a href="#cb64-476" aria-hidden="true" tabindex="-1"></a>tmp_low_var <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">filter_taxa</span>(tmp_low_count, </span>
<span id="cb64-477"><a href="#cb64-477" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(x) <span class="fu">var</span>(x) <span class="sc">&gt;</span> <span class="fl">0.2</span>, <span class="at">prune =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-478"><a href="#cb64-478" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt <span class="ot">&lt;-</span> tmp_low_var</span>
<span id="cb64-479"><a href="#cb64-479" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-480"><a href="#cb64-480" aria-hidden="true" tabindex="-1"></a>tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(ssu18_ps_filt), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-481"><a href="#cb64-481" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(ssu18_ps_filt))</span>
<span id="cb64-482"><a href="#cb64-482" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(ssu18_ps_filt,</span>
<span id="cb64-483"><a href="#cb64-483" aria-hidden="true" tabindex="-1"></a>                          sample_data,</span>
<span id="cb64-484"><a href="#cb64-484" aria-hidden="true" tabindex="-1"></a>                          tmp_tree)</span>
<span id="cb64-485"><a href="#cb64-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-486"><a href="#cb64-486" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-487"><a href="#cb64-487" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt</span>
<span id="cb64-488"><a href="#cb64-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-489"><a href="#cb64-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-490"><a href="#cb64-490" aria-hidden="true" tabindex="-1"></a>Here is the filtered 16S rRNA phyloseq object. </span>
<span id="cb64-491"><a href="#cb64-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-494"><a href="#cb64-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-495"><a href="#cb64-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-496"><a href="#cb64-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-497"><a href="#cb64-497" aria-hidden="true" tabindex="-1"></a>ssu18_ps_filt</span>
<span id="cb64-498"><a href="#cb64-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-499"><a href="#cb64-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-502"><a href="#cb64-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-503"><a href="#cb64-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-504"><a href="#cb64-504" aria-hidden="true" tabindex="-1"></a><span class="do">## This code is gross. I spent hours trying to find a better</span></span>
<span id="cb64-505"><a href="#cb64-505" aria-hidden="true" tabindex="-1"></a><span class="do">## solution but failed :(</span></span>
<span id="cb64-506"><a href="#cb64-506" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-507"><a href="#cb64-507" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_filt"</span>)</span>
<span id="cb64-508"><a href="#cb64-508" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb64-509"><a href="#cb64-509" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total number of reads"</span>, </span>
<span id="cb64-510"><a href="#cb64-510" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of reads"</span>, </span>
<span id="cb64-511"><a href="#cb64-511" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of reads"</span>, </span>
<span id="cb64-512"><a href="#cb64-512" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of reads"</span>, </span>
<span id="cb64-513"><a href="#cb64-513" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of reads"</span>, </span>
<span id="cb64-514"><a href="#cb64-514" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total ASVs"</span>, </span>
<span id="cb64-515"><a href="#cb64-515" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of ASVs"</span>, </span>
<span id="cb64-516"><a href="#cb64-516" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of ASVs"</span>, </span>
<span id="cb64-517"><a href="#cb64-517" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of ASVs"</span>, </span>
<span id="cb64-518"><a href="#cb64-518" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of ASVs"</span>)</span>
<span id="cb64-519"><a href="#cb64-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-520"><a href="#cb64-520" aria-hidden="true" tabindex="-1"></a>tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-521"><a href="#cb64-521" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-522"><a href="#cb64-522" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-523"><a href="#cb64-523" aria-hidden="true" tabindex="-1"></a>   tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_reads, tmp_get))</span>
<span id="cb64-524"><a href="#cb64-524" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-525"><a href="#cb64-525" aria-hidden="true" tabindex="-1"></a>tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-526"><a href="#cb64-526" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-527"><a href="#cb64-527" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-528"><a href="#cb64-528" aria-hidden="true" tabindex="-1"></a>   tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_read, tmp_get))</span>
<span id="cb64-529"><a href="#cb64-529" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-530"><a href="#cb64-530" aria-hidden="true" tabindex="-1"></a>tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-531"><a href="#cb64-531" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-532"><a href="#cb64-532" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-533"><a href="#cb64-533" aria-hidden="true" tabindex="-1"></a>   tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_read, tmp_get))</span>
<span id="cb64-534"><a href="#cb64-534" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-535"><a href="#cb64-535" aria-hidden="true" tabindex="-1"></a>tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-536"><a href="#cb64-536" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-537"><a href="#cb64-537" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i))), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-538"><a href="#cb64-538" aria-hidden="true" tabindex="-1"></a>   tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_reads, tmp_get))</span>
<span id="cb64-539"><a href="#cb64-539" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-540"><a href="#cb64-540" aria-hidden="true" tabindex="-1"></a>tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-541"><a href="#cb64-541" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-542"><a href="#cb64-542" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-543"><a href="#cb64-543" aria-hidden="true" tabindex="-1"></a>   tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_median_reads, tmp_get))</span>
<span id="cb64-544"><a href="#cb64-544" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-545"><a href="#cb64-545" aria-hidden="true" tabindex="-1"></a>tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-546"><a href="#cb64-546" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-547"><a href="#cb64-547" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-548"><a href="#cb64-548" aria-hidden="true" tabindex="-1"></a>   tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_asvs, tmp_get))</span>
<span id="cb64-549"><a href="#cb64-549" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-550"><a href="#cb64-550" aria-hidden="true" tabindex="-1"></a>tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-551"><a href="#cb64-551" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-552"><a href="#cb64-552" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-553"><a href="#cb64-553" aria-hidden="true" tabindex="-1"></a>   tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_asvs, tmp_get))</span>
<span id="cb64-554"><a href="#cb64-554" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-555"><a href="#cb64-555" aria-hidden="true" tabindex="-1"></a>tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-556"><a href="#cb64-556" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-557"><a href="#cb64-557" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-558"><a href="#cb64-558" aria-hidden="true" tabindex="-1"></a>   tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_asvs, tmp_get))</span>
<span id="cb64-559"><a href="#cb64-559" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-560"><a href="#cb64-560" aria-hidden="true" tabindex="-1"></a>tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-561"><a href="#cb64-561" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-562"><a href="#cb64-562" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-563"><a href="#cb64-563" aria-hidden="true" tabindex="-1"></a>   tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_asvs, tmp_get))</span>
<span id="cb64-564"><a href="#cb64-564" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-565"><a href="#cb64-565" aria-hidden="true" tabindex="-1"></a>tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-566"><a href="#cb64-566" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-567"><a href="#cb64-567" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed)</span>
<span id="cb64-568"><a href="#cb64-568" aria-hidden="true" tabindex="-1"></a>   tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_med_asvs, tmp_get))</span>
<span id="cb64-569"><a href="#cb64-569" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-570"><a href="#cb64-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-571"><a href="#cb64-571" aria-hidden="true" tabindex="-1"></a>tmp_bind <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, <span class="fu">list</span>(</span>
<span id="cb64-572"><a href="#cb64-572" aria-hidden="true" tabindex="-1"></a>  tmp_total_reads, tmp_min_read, tmp_max_read, tmp_mean_reads, tmp_median_reads, </span>
<span id="cb64-573"><a href="#cb64-573" aria-hidden="true" tabindex="-1"></a>  tmp_total_asvs, tmp_min_asvs, tmp_max_asvs, tmp_mean_asvs, tmp_med_asvs)))</span>
<span id="cb64-574"><a href="#cb64-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-575"><a href="#cb64-575" aria-hidden="true" tabindex="-1"></a>ssu18_sum_arbitrary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_bind) <span class="sc">%&gt;%</span></span>
<span id="cb64-576"><a href="#cb64-576" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Full data"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Arbitrary filter"</span> <span class="ot">=</span> <span class="dv">3</span>)</span>
<span id="cb64-577"><a href="#cb64-577" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-578"><a href="#cb64-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-579"><a href="#cb64-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-580"><a href="#cb64-580" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_arbitrary_filt_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-581"><a href="#cb64-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-584"><a href="#cb64-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-585"><a href="#cb64-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-586"><a href="#cb64-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-587"><a href="#cb64-587" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_sum_arbitrary</span>
<span id="cb64-588"><a href="#cb64-588" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-589"><a href="#cb64-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-590"><a href="#cb64-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_arbitrary_filt_summary"</span>,</span>
<span id="cb64-591"><a href="#cb64-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-592"><a href="#cb64-592" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-593"><a href="#cb64-593" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-594"><a href="#cb64-594" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-595"><a href="#cb64-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-596"><a href="#cb64-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-597"><a href="#cb64-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-598"><a href="#cb64-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-601"><a href="#cb64-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-602"><a href="#cb64-602" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-603"><a href="#cb64-603" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-604"><a href="#cb64-604" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-605"><a href="#cb64-605" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-606"><a href="#cb64-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-607"><a href="#cb64-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-608"><a href="#cb64-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-609"><a href="#cb64-609" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">150</span></span>
<span id="cb64-610"><a href="#cb64-610" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-611"><a href="#cb64-611" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-612"><a href="#cb64-612" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-613"><a href="#cb64-613" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-614"><a href="#cb64-614" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-615"><a href="#cb64-615" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-616"><a href="#cb64-616" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-617"><a href="#cb64-617" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>)</span>
<span id="cb64-618"><a href="#cb64-618" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-619"><a href="#cb64-619" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">10</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-620"><a href="#cb64-620" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-621"><a href="#cb64-621" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-622"><a href="#cb64-622" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-623"><a href="#cb64-623" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-624"><a href="#cb64-624" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-625"><a href="#cb64-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-626"><a href="#cb64-626" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-627"><a href="#cb64-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-628"><a href="#cb64-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-629"><a href="#cb64-629" aria-hidden="true" tabindex="-1"></a>We can look at how filtering affected total reads and ASVs for each sample.</span>
<span id="cb64-630"><a href="#cb64-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-633"><a href="#cb64-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-634"><a href="#cb64-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-635"><a href="#cb64-635" aria-hidden="true" tabindex="-1"></a>tmp_read_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_sums</span>(ssu18_ps_filt)) <span class="sc">%&gt;%</span></span>
<span id="cb64-636"><a href="#cb64-636" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-637"><a href="#cb64-637" aria-hidden="true" tabindex="-1"></a>tmp_asv_count <span class="ot">&lt;-</span> <span class="fu">estimate_richness</span>(ssu18_ps_filt, <span class="at">split =</span> <span class="cn">TRUE</span>, <span class="at">measures =</span> <span class="st">"Observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-638"><a href="#cb64-638" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-639"><a href="#cb64-639" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ssu18_ps_filt))</span>
<span id="cb64-640"><a href="#cb64-640" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> tmp_samp_data[<span class="fu">order</span>(tmp_samp_data<span class="sc">$</span>PLOT, tmp_samp_data<span class="sc">$</span>TEMP),]</span>
<span id="cb64-641"><a href="#cb64-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-642"><a href="#cb64-642" aria-hidden="true" tabindex="-1"></a>tmp_join <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp_data, tmp_read_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-643"><a href="#cb64-643" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_asv_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-644"><a href="#cb64-644" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-645"><a href="#cb64-645" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-646"><a href="#cb64-646" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_asvs"</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb64-647"><a href="#cb64-647" aria-hidden="true" tabindex="-1"></a>tmp_join[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-648"><a href="#cb64-648" aria-hidden="true" tabindex="-1"></a>ssu_filt_samp_summary <span class="ot">&lt;-</span> tmp_join</span>
<span id="cb64-649"><a href="#cb64-649" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-650"><a href="#cb64-650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-651"><a href="#cb64-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-652"><a href="#cb64-652" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_filt_samp_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-653"><a href="#cb64-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-656"><a href="#cb64-656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-657"><a href="#cb64-657" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-658"><a href="#cb64-658" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-659"><a href="#cb64-659" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu_filt_samp_summary</span>
<span id="cb64-660"><a href="#cb64-660" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-661"><a href="#cb64-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-662"><a href="#cb64-662" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_filt_samp_summary"</span>,</span>
<span id="cb64-663"><a href="#cb64-663" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-664"><a href="#cb64-664" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-665"><a href="#cb64-665" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-666"><a href="#cb64-666" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-667"><a href="#cb64-667" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-668"><a href="#cb64-668" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-669"><a href="#cb64-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-670"><a href="#cb64-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-673"><a href="#cb64-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-674"><a href="#cb64-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-675"><a href="#cb64-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-676"><a href="#cb64-676" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-677"><a href="#cb64-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-678"><a href="#cb64-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-679"><a href="#cb64-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-680"><a href="#cb64-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-681"><a href="#cb64-681" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-682"><a href="#cb64-682" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-683"><a href="#cb64-683" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-684"><a href="#cb64-684" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb64-685"><a href="#cb64-685" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-686"><a href="#cb64-686" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-687"><a href="#cb64-687" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-688"><a href="#cb64-688" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-689"><a href="#cb64-689" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-690"><a href="#cb64-690" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-691"><a href="#cb64-691" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-692"><a href="#cb64-692" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-693"><a href="#cb64-693" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-694"><a href="#cb64-694" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-695"><a href="#cb64-695" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-696"><a href="#cb64-696" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-697"><a href="#cb64-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-698"><a href="#cb64-698" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-699"><a href="#cb64-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-700"><a href="#cb64-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-701"><a href="#cb64-701" aria-hidden="true" tabindex="-1"></a><span class="fu">## ITS</span></span>
<span id="cb64-702"><a href="#cb64-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-705"><a href="#cb64-705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-706"><a href="#cb64-706" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb64-707"><a href="#cb64-707" aria-hidden="true" tabindex="-1"></a>tmp_low_count <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">genefilter_sample</span>(</span>
<span id="cb64-708"><a href="#cb64-708" aria-hidden="true" tabindex="-1"></a>                                         its18_ps_work, </span>
<span id="cb64-709"><a href="#cb64-709" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">filterfun_sample</span>(<span class="cf">function</span>(x) x <span class="sc">&gt;=</span> <span class="dv">5</span>), </span>
<span id="cb64-710"><a href="#cb64-710" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">A =</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">nsamples</span>(its18_ps_work))</span>
<span id="cb64-711"><a href="#cb64-711" aria-hidden="true" tabindex="-1"></a>tmp_low_count <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">prune_taxa</span>(tmp_low_count, its18_ps_work)</span>
<span id="cb64-712"><a href="#cb64-712" aria-hidden="true" tabindex="-1"></a>tmp_low_var <span class="ot">&lt;-</span> phyloseq<span class="sc">::</span><span class="fu">filter_taxa</span>(tmp_low_count, </span>
<span id="cb64-713"><a href="#cb64-713" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(x) <span class="fu">var</span>(x) <span class="sc">&gt;</span> <span class="fl">0.2</span>, <span class="at">prune =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-714"><a href="#cb64-714" aria-hidden="true" tabindex="-1"></a>its18_ps_filt <span class="ot">&lt;-</span> tmp_low_var</span>
<span id="cb64-715"><a href="#cb64-715" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-716"><a href="#cb64-716" aria-hidden="true" tabindex="-1"></a>its18_ps_filt</span>
<span id="cb64-717"><a href="#cb64-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-718"><a href="#cb64-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-719"><a href="#cb64-719" aria-hidden="true" tabindex="-1"></a>And the filtered ITS phyloseq object. </span>
<span id="cb64-720"><a href="#cb64-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-723"><a href="#cb64-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-724"><a href="#cb64-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-725"><a href="#cb64-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-726"><a href="#cb64-726" aria-hidden="true" tabindex="-1"></a>its18_ps_filt</span>
<span id="cb64-727"><a href="#cb64-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-728"><a href="#cb64-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-731"><a href="#cb64-731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-732"><a href="#cb64-732" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-733"><a href="#cb64-733" aria-hidden="true" tabindex="-1"></a><span class="do">## This code is gross. I spent hours trying to find a better</span></span>
<span id="cb64-734"><a href="#cb64-734" aria-hidden="true" tabindex="-1"></a><span class="do">## solution but failed :(</span></span>
<span id="cb64-735"><a href="#cb64-735" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-736"><a href="#cb64-736" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_filt"</span>)</span>
<span id="cb64-737"><a href="#cb64-737" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb64-738"><a href="#cb64-738" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total number of reads"</span>, </span>
<span id="cb64-739"><a href="#cb64-739" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of reads"</span>, </span>
<span id="cb64-740"><a href="#cb64-740" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of reads"</span>, </span>
<span id="cb64-741"><a href="#cb64-741" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of reads"</span>, </span>
<span id="cb64-742"><a href="#cb64-742" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of reads"</span>, </span>
<span id="cb64-743"><a href="#cb64-743" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total ASVs"</span>, </span>
<span id="cb64-744"><a href="#cb64-744" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of ASVs"</span>, </span>
<span id="cb64-745"><a href="#cb64-745" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of ASVs"</span>, </span>
<span id="cb64-746"><a href="#cb64-746" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of ASVs"</span>, </span>
<span id="cb64-747"><a href="#cb64-747" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of ASVs"</span>)</span>
<span id="cb64-748"><a href="#cb64-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-749"><a href="#cb64-749" aria-hidden="true" tabindex="-1"></a>tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-750"><a href="#cb64-750" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-751"><a href="#cb64-751" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-752"><a href="#cb64-752" aria-hidden="true" tabindex="-1"></a>   tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_reads, tmp_get))</span>
<span id="cb64-753"><a href="#cb64-753" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-754"><a href="#cb64-754" aria-hidden="true" tabindex="-1"></a>tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-755"><a href="#cb64-755" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-756"><a href="#cb64-756" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-757"><a href="#cb64-757" aria-hidden="true" tabindex="-1"></a>   tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_read, tmp_get))</span>
<span id="cb64-758"><a href="#cb64-758" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-759"><a href="#cb64-759" aria-hidden="true" tabindex="-1"></a>tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-760"><a href="#cb64-760" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-761"><a href="#cb64-761" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-762"><a href="#cb64-762" aria-hidden="true" tabindex="-1"></a>   tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_read, tmp_get))</span>
<span id="cb64-763"><a href="#cb64-763" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-764"><a href="#cb64-764" aria-hidden="true" tabindex="-1"></a>tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-765"><a href="#cb64-765" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-766"><a href="#cb64-766" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i))), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-767"><a href="#cb64-767" aria-hidden="true" tabindex="-1"></a>   tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_reads, tmp_get))</span>
<span id="cb64-768"><a href="#cb64-768" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-769"><a href="#cb64-769" aria-hidden="true" tabindex="-1"></a>tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-770"><a href="#cb64-770" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-771"><a href="#cb64-771" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-772"><a href="#cb64-772" aria-hidden="true" tabindex="-1"></a>   tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_median_reads, tmp_get))</span>
<span id="cb64-773"><a href="#cb64-773" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-774"><a href="#cb64-774" aria-hidden="true" tabindex="-1"></a>tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-775"><a href="#cb64-775" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-776"><a href="#cb64-776" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-777"><a href="#cb64-777" aria-hidden="true" tabindex="-1"></a>   tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_asvs, tmp_get))</span>
<span id="cb64-778"><a href="#cb64-778" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-779"><a href="#cb64-779" aria-hidden="true" tabindex="-1"></a>tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-780"><a href="#cb64-780" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-781"><a href="#cb64-781" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-782"><a href="#cb64-782" aria-hidden="true" tabindex="-1"></a>   tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_asvs, tmp_get))</span>
<span id="cb64-783"><a href="#cb64-783" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-784"><a href="#cb64-784" aria-hidden="true" tabindex="-1"></a>tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-785"><a href="#cb64-785" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-786"><a href="#cb64-786" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-787"><a href="#cb64-787" aria-hidden="true" tabindex="-1"></a>   tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_asvs, tmp_get))</span>
<span id="cb64-788"><a href="#cb64-788" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-789"><a href="#cb64-789" aria-hidden="true" tabindex="-1"></a>tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-790"><a href="#cb64-790" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-791"><a href="#cb64-791" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-792"><a href="#cb64-792" aria-hidden="true" tabindex="-1"></a>   tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_asvs, tmp_get))</span>
<span id="cb64-793"><a href="#cb64-793" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-794"><a href="#cb64-794" aria-hidden="true" tabindex="-1"></a>tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-795"><a href="#cb64-795" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-796"><a href="#cb64-796" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed)</span>
<span id="cb64-797"><a href="#cb64-797" aria-hidden="true" tabindex="-1"></a>   tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_med_asvs, tmp_get))</span>
<span id="cb64-798"><a href="#cb64-798" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-799"><a href="#cb64-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-800"><a href="#cb64-800" aria-hidden="true" tabindex="-1"></a>tmp_bind <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, <span class="fu">list</span>(</span>
<span id="cb64-801"><a href="#cb64-801" aria-hidden="true" tabindex="-1"></a>  tmp_total_reads, tmp_min_read, tmp_max_read, tmp_mean_reads, tmp_median_reads, </span>
<span id="cb64-802"><a href="#cb64-802" aria-hidden="true" tabindex="-1"></a>  tmp_total_asvs, tmp_min_asvs, tmp_max_asvs, tmp_mean_asvs, tmp_med_asvs)))</span>
<span id="cb64-803"><a href="#cb64-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-804"><a href="#cb64-804" aria-hidden="true" tabindex="-1"></a>its18_sum_arbitrary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_bind) <span class="sc">%&gt;%</span></span>
<span id="cb64-805"><a href="#cb64-805" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Full data"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Arbitrary filter"</span> <span class="ot">=</span> <span class="dv">3</span>)</span>
<span id="cb64-806"><a href="#cb64-806" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-807"><a href="#cb64-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-808"><a href="#cb64-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-809"><a href="#cb64-809" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_arbitrary_filt_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-810"><a href="#cb64-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-813"><a href="#cb64-813" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-814"><a href="#cb64-814" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-815"><a href="#cb64-815" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-816"><a href="#cb64-816" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_sum_arbitrary</span>
<span id="cb64-817"><a href="#cb64-817" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-818"><a href="#cb64-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-819"><a href="#cb64-819" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_arbitrary_filt_summary"</span>,</span>
<span id="cb64-820"><a href="#cb64-820" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-821"><a href="#cb64-821" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-822"><a href="#cb64-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-823"><a href="#cb64-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-824"><a href="#cb64-824" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-825"><a href="#cb64-825" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-826"><a href="#cb64-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-827"><a href="#cb64-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-830"><a href="#cb64-830" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-831"><a href="#cb64-831" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-832"><a href="#cb64-832" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-833"><a href="#cb64-833" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-834"><a href="#cb64-834" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-835"><a href="#cb64-835" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-836"><a href="#cb64-836" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-837"><a href="#cb64-837" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-838"><a href="#cb64-838" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">150</span></span>
<span id="cb64-839"><a href="#cb64-839" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-840"><a href="#cb64-840" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-841"><a href="#cb64-841" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-842"><a href="#cb64-842" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-843"><a href="#cb64-843" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-844"><a href="#cb64-844" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-845"><a href="#cb64-845" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-846"><a href="#cb64-846" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>)</span>
<span id="cb64-847"><a href="#cb64-847" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-848"><a href="#cb64-848" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">10</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-849"><a href="#cb64-849" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-850"><a href="#cb64-850" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">FALSE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-851"><a href="#cb64-851" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-852"><a href="#cb64-852" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-853"><a href="#cb64-853" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-854"><a href="#cb64-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-855"><a href="#cb64-855" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-856"><a href="#cb64-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-857"><a href="#cb64-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-858"><a href="#cb64-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-859"><a href="#cb64-859" aria-hidden="true" tabindex="-1"></a>And again, let's look how filtering affected total reads and ASVs for each sample.</span>
<span id="cb64-860"><a href="#cb64-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-863"><a href="#cb64-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-864"><a href="#cb64-864" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-865"><a href="#cb64-865" aria-hidden="true" tabindex="-1"></a>tmp_read_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_sums</span>(its18_ps_filt)) <span class="sc">%&gt;%</span></span>
<span id="cb64-866"><a href="#cb64-866" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-867"><a href="#cb64-867" aria-hidden="true" tabindex="-1"></a>tmp_asv_count <span class="ot">&lt;-</span> <span class="fu">estimate_richness</span>(its18_ps_filt, <span class="at">split =</span> <span class="cn">TRUE</span>, <span class="at">measures =</span> <span class="st">"Observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-868"><a href="#cb64-868" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-869"><a href="#cb64-869" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(its18_ps_filt))</span>
<span id="cb64-870"><a href="#cb64-870" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> tmp_samp_data[<span class="fu">order</span>(tmp_samp_data<span class="sc">$</span>PLOT, tmp_samp_data<span class="sc">$</span>TEMP),]</span>
<span id="cb64-871"><a href="#cb64-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-872"><a href="#cb64-872" aria-hidden="true" tabindex="-1"></a>tmp_join <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp_data, tmp_read_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-873"><a href="#cb64-873" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_asv_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-874"><a href="#cb64-874" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-875"><a href="#cb64-875" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-876"><a href="#cb64-876" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_asvs"</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb64-877"><a href="#cb64-877" aria-hidden="true" tabindex="-1"></a>tmp_join[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-878"><a href="#cb64-878" aria-hidden="true" tabindex="-1"></a>its_filt_samp_summary <span class="ot">&lt;-</span> tmp_join</span>
<span id="cb64-879"><a href="#cb64-879" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-880"><a href="#cb64-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-881"><a href="#cb64-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-882"><a href="#cb64-882" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_filt_samp_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-883"><a href="#cb64-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-886"><a href="#cb64-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-887"><a href="#cb64-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-888"><a href="#cb64-888" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-889"><a href="#cb64-889" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its_filt_samp_summary</span>
<span id="cb64-890"><a href="#cb64-890" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-891"><a href="#cb64-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-892"><a href="#cb64-892" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_filt_samp_summary"</span>,</span>
<span id="cb64-893"><a href="#cb64-893" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-894"><a href="#cb64-894" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-895"><a href="#cb64-895" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-896"><a href="#cb64-896" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-897"><a href="#cb64-897" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-898"><a href="#cb64-898" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-899"><a href="#cb64-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-900"><a href="#cb64-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-903"><a href="#cb64-903" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-904"><a href="#cb64-904" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-905"><a href="#cb64-905" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-906"><a href="#cb64-906" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-907"><a href="#cb64-907" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-908"><a href="#cb64-908" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-909"><a href="#cb64-909" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-910"><a href="#cb64-910" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-911"><a href="#cb64-911" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-912"><a href="#cb64-912" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-913"><a href="#cb64-913" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-914"><a href="#cb64-914" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb64-915"><a href="#cb64-915" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-916"><a href="#cb64-916" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-917"><a href="#cb64-917" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-918"><a href="#cb64-918" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-919"><a href="#cb64-919" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-920"><a href="#cb64-920" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-921"><a href="#cb64-921" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-922"><a href="#cb64-922" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-923"><a href="#cb64-923" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-924"><a href="#cb64-924" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-925"><a href="#cb64-925" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-926"><a href="#cb64-926" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-927"><a href="#cb64-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-928"><a href="#cb64-928" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-929"><a href="#cb64-929" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-930"><a href="#cb64-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-933"><a href="#cb64-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-934"><a href="#cb64-934" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb64-935"><a href="#cb64-935" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_ps_filt, <span class="st">"files/filtering/arbitrary/rdata/ssu18_ps_filt.rds"</span>)</span>
<span id="cb64-936"><a href="#cb64-936" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_ps_filt, <span class="st">"files/filtering/arbitrary/rdata/its18_ps_filt.rds"</span>)</span>
<span id="cb64-937"><a href="#cb64-937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-938"><a href="#cb64-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-939"><a href="#cb64-939" aria-hidden="true" tabindex="-1"></a>And that's it for Arbitrary filtering. Moving on.</span>
<span id="cb64-940"><a href="#cb64-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-941"><a href="#cb64-941" aria-hidden="true" tabindex="-1"></a><span class="fu"># B. PERfect Filtering</span></span>
<span id="cb64-942"><a href="#cb64-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-943"><a href="#cb64-943" aria-hidden="true" tabindex="-1"></a>To run PERFect, we need the ASV tables in data frame format with samples as rows and ASVs as columns. PERFect is sensitive to the order of ASVs, so here we test **a**) the default order in the phyloseq object and **b**) ASVs ordered by decreasing abundance.</span>
<span id="cb64-944"><a href="#cb64-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-945"><a href="#cb64-945" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setup</span></span>
<span id="cb64-946"><a href="#cb64-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-949"><a href="#cb64-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-950"><a href="#cb64-950" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb64-951"><a href="#cb64-951" aria-hidden="true" tabindex="-1"></a>samp_ps_filt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"its18_ps_work"</span>)</span>
<span id="cb64-952"><a href="#cb64-952" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps_filt) {</span>
<span id="cb64-953"><a href="#cb64-953" aria-hidden="true" tabindex="-1"></a>  tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb64-954"><a href="#cb64-954" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_get)))</span>
<span id="cb64-955"><a href="#cb64-955" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab <span class="ot">&lt;-</span> tmp_get_tab <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-956"><a href="#cb64-956" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab <span class="ot">&lt;-</span> jamba<span class="sc">::</span><span class="fu">mixedSortDF</span>(tmp_get_tab, <span class="at">decreasing =</span> <span class="cn">FALSE</span>, </span>
<span id="cb64-957"><a href="#cb64-957" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">useRownames =</span> <span class="cn">FALSE</span>, <span class="at">byCols =</span> <span class="dv">1</span>)</span>
<span id="cb64-958"><a href="#cb64-958" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab <span class="ot">&lt;-</span> tmp_get_tab <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>() </span>
<span id="cb64-959"><a href="#cb64-959" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab <span class="ot">&lt;-</span> tmp_get_tab <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-960"><a href="#cb64-960" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tmp_get_tab))</span>
<span id="cb64-961"><a href="#cb64-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-962"><a href="#cb64-962" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab_ord <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_get)))</span>
<span id="cb64-963"><a href="#cb64-963" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab_ord <span class="ot">&lt;-</span> tmp_get_tab_ord <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-964"><a href="#cb64-964" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab_ord <span class="ot">&lt;-</span> jamba<span class="sc">::</span><span class="fu">mixedSortDF</span>(tmp_get_tab_ord, <span class="at">decreasing =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-965"><a href="#cb64-965" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">useRownames =</span> <span class="cn">FALSE</span>, <span class="at">byCols =</span> <span class="dv">1</span>)</span>
<span id="cb64-966"><a href="#cb64-966" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab_ord <span class="ot">&lt;-</span> tmp_get_tab_ord <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>() </span>
<span id="cb64-967"><a href="#cb64-967" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab_ord <span class="ot">&lt;-</span> tmp_get_tab_ord <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-968"><a href="#cb64-968" aria-hidden="true" tabindex="-1"></a>  tmp_get_tab_ord <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tmp_get_tab_ord))</span>
<span id="cb64-969"><a href="#cb64-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-970"><a href="#cb64-970" aria-hidden="true" tabindex="-1"></a>  tmp_tab_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_perfect"</span>))</span>
<span id="cb64-971"><a href="#cb64-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_tab_name, tmp_get_tab)</span>
<span id="cb64-972"><a href="#cb64-972" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-973"><a href="#cb64-973" aria-hidden="true" tabindex="-1"></a>  tmp_tab_ord_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ord_perfect"</span>))</span>
<span id="cb64-974"><a href="#cb64-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_tab_ord_name, tmp_get_tab_ord)</span>
<span id="cb64-975"><a href="#cb64-975" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-976"><a href="#cb64-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-977"><a href="#cb64-977" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-978"><a href="#cb64-978" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb64-979"><a href="#cb64-979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-980"><a href="#cb64-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-981"><a href="#cb64-981" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filter </span></span>
<span id="cb64-982"><a href="#cb64-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-983"><a href="#cb64-983" aria-hidden="true" tabindex="-1"></a>Next we run the filtering analysis using <span class="co">[</span><span class="ot">`PERFect_sim`</span><span class="co">](https://rdrr.io/github/katiasmirn/PERFect/man/PERFect_sim.html)</span>. The other option is <span class="co">[</span><span class="ot">`PERFect_perm`</span><span class="co">](https://rdrr.io/github/katiasmirn/PERFect/man/PERFect_perm.html)</span> however I could not get <span class="in">`PERFect_perm`</span> to work as of this writing. The process never finished :/</span>
<span id="cb64-984"><a href="#cb64-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-985"><a href="#cb64-985" aria-hidden="true" tabindex="-1"></a>We need to set an initial p-value cutoff. For 16S rRNA, we use <span class="in">`0.05`</span> and for ITS we use <span class="in">`0.1`</span>. </span>
<span id="cb64-986"><a href="#cb64-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-989"><a href="#cb64-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-990"><a href="#cb64-990" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a pvalue cutoff</span></span>
<span id="cb64-991"><a href="#cb64-991" aria-hidden="true" tabindex="-1"></a>ssu_per_pval <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb64-992"><a href="#cb64-992" aria-hidden="true" tabindex="-1"></a>its_per_pval <span class="ot">&lt;-</span> <span class="fl">0.10</span></span>
<span id="cb64-993"><a href="#cb64-993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-994"><a href="#cb64-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-997"><a href="#cb64-997" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-998"><a href="#cb64-998" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb64-999"><a href="#cb64-999" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps_filt) {</span>
<span id="cb64-1000"><a href="#cb64-1000" aria-hidden="true" tabindex="-1"></a>  tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_perfect"</span>)))</span>
<span id="cb64-1001"><a href="#cb64-1001" aria-hidden="true" tabindex="-1"></a>  tmp_pval <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"18.*"</span>, <span class="st">"_per_pval"</span>, i)</span>
<span id="cb64-1002"><a href="#cb64-1002" aria-hidden="true" tabindex="-1"></a>  tmp_get_ord <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ord_perfect"</span>)))</span>
<span id="cb64-1003"><a href="#cb64-1003" aria-hidden="true" tabindex="-1"></a>  tmp_sim <span class="ot">&lt;-</span> <span class="fu">PERFect_sim</span>(<span class="at">X =</span> tmp_get, <span class="at">alpha =</span> <span class="fu">get</span>(tmp_pval), <span class="at">Order =</span> <span class="st">"NP"</span>, <span class="at">center =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1004"><a href="#cb64-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(tmp_sim<span class="sc">$</span>filtX)</span>
<span id="cb64-1005"><a href="#cb64-1005" aria-hidden="true" tabindex="-1"></a>  tmp_sim_ord <span class="ot">&lt;-</span> <span class="fu">PERFect_sim</span>(<span class="at">X =</span> tmp_get_ord, <span class="at">alpha =</span> <span class="fu">get</span>(tmp_pval), <span class="at">Order =</span> <span class="st">"NP"</span>, <span class="at">center =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1006"><a href="#cb64-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(tmp_sim_ord<span class="sc">$</span>filtX)</span>
<span id="cb64-1007"><a href="#cb64-1007" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-1008"><a href="#cb64-1008" aria-hidden="true" tabindex="-1"></a>  tmp_sim_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_perfect_sim"</span>))</span>
<span id="cb64-1009"><a href="#cb64-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_sim_name, tmp_sim)</span>
<span id="cb64-1010"><a href="#cb64-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1011"><a href="#cb64-1011" aria-hidden="true" tabindex="-1"></a>  tmp_sim_ord_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_ord_perfect_sim"</span>))</span>
<span id="cb64-1012"><a href="#cb64-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_sim_ord_name, tmp_sim_ord)</span>
<span id="cb64-1013"><a href="#cb64-1013" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-1014"><a href="#cb64-1014" aria-hidden="true" tabindex="-1"></a>  tmp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"files/filtering/perfect/rdata/"</span>)</span>
<span id="cb64-1015"><a href="#cb64-1015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(tmp_sim, <span class="fu">paste</span>(tmp_path, tmp_sim_name, <span class="st">".rds"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb64-1016"><a href="#cb64-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(tmp_sim_ord, <span class="fu">paste</span>(tmp_path, tmp_sim_ord_name, <span class="st">".rds"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb64-1017"><a href="#cb64-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1018"><a href="#cb64-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1019"><a href="#cb64-1019" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-1020"><a href="#cb64-1020" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1021"><a href="#cb64-1021" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">"_sim"</span>)</span>
<span id="cb64-1022"><a href="#cb64-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1023"><a href="#cb64-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1026"><a href="#cb64-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1027"><a href="#cb64-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1028"><a href="#cb64-1028" aria-hidden="true" tabindex="-1"></a><span class="do">## FOR </span><span class="al">TESTING</span></span>
<span id="cb64-1029"><a href="#cb64-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ssu18_ps_work_perfect_sim<span class="sc">$</span>filtX)</span>
<span id="cb64-1030"><a href="#cb64-1030" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ssu18_ps_work_ord_perfect_sim<span class="sc">$</span>filtX)</span>
<span id="cb64-1031"><a href="#cb64-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(its18_ps_work_perfect_sim<span class="sc">$</span>filtX)</span>
<span id="cb64-1032"><a href="#cb64-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(its18_ps_work_ord_perfect_sim<span class="sc">$</span>filtX)</span>
<span id="cb64-1033"><a href="#cb64-1033" aria-hidden="true" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb64-1034"><a href="#cb64-1034" aria-hidden="true" tabindex="-1"></a>tmp_obj <span class="ot">&lt;-</span> ssu18_ps_work_ord_perfect_sim</span>
<span id="cb64-1035"><a href="#cb64-1035" aria-hidden="true" tabindex="-1"></a>tmp_ps <span class="ot">&lt;-</span> ssu18_ps_work</span>
<span id="cb64-1036"><a href="#cb64-1036" aria-hidden="true" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb64-1037"><a href="#cb64-1037" aria-hidden="true" tabindex="-1"></a>tmp_filt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tmp_obj<span class="sc">$</span>filtX))</span>
<span id="cb64-1038"><a href="#cb64-1038" aria-hidden="true" tabindex="-1"></a>tmp_filt <span class="ot">&lt;-</span> tmp_filt <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-1039"><a href="#cb64-1039" aria-hidden="true" tabindex="-1"></a>tmp_pval <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_obj<span class="sc">$</span>pvals)</span>
<span id="cb64-1040"><a href="#cb64-1040" aria-hidden="true" tabindex="-1"></a>tmp_pval <span class="ot">&lt;-</span> tmp_pval <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-1041"><a href="#cb64-1041" aria-hidden="true" tabindex="-1"></a>tmp_org <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_ps)))</span>
<span id="cb64-1042"><a href="#cb64-1042" aria-hidden="true" tabindex="-1"></a>tmp_org <span class="ot">&lt;-</span> tmp_org <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-1043"><a href="#cb64-1043" aria-hidden="true" tabindex="-1"></a>tmp_com <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_pval, tmp_org, <span class="at">by =</span> <span class="st">"ID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1044"><a href="#cb64-1044" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_filt, <span class="at">by =</span> <span class="st">"ID"</span>)</span>
<span id="cb64-1045"><a href="#cb64-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tmp_com, <span class="st">"tmp_com.txt"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1046"><a href="#cb64-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1047"><a href="#cb64-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1050"><a href="#cb64-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1051"><a href="#cb64-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1052"><a href="#cb64-1052" aria-hidden="true" tabindex="-1"></a>ps_sim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work_perfect_sim"</span>, <span class="st">"ssu18_ps_work_ord_perfect_sim"</span>, </span>
<span id="cb64-1053"><a href="#cb64-1053" aria-hidden="true" tabindex="-1"></a>            <span class="st">"its18_ps_work_perfect_sim"</span>, <span class="st">"its18_ps_work_ord_perfect_sim"</span>, )</span>
<span id="cb64-1054"><a href="#cb64-1054" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ps_sim) {</span>
<span id="cb64-1055"><a href="#cb64-1055" aria-hidden="true" tabindex="-1"></a>  tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb64-1056"><a href="#cb64-1056" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> i</span>
<span id="cb64-1057"><a href="#cb64-1057" aria-hidden="true" tabindex="-1"></a>  tmp_get<span class="sc">$</span>info <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1058"><a href="#cb64-1058" aria-hidden="true" tabindex="-1"></a>  tmp_get<span class="sc">$</span>DFL <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1059"><a href="#cb64-1059" aria-hidden="true" tabindex="-1"></a>  tmp_get<span class="sc">$</span>est <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1060"><a href="#cb64-1060" aria-hidden="true" tabindex="-1"></a>  tmp_get<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1061"><a href="#cb64-1061" aria-hidden="true" tabindex="-1"></a>  tmp_get<span class="sc">$</span>hist <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1062"><a href="#cb64-1062" aria-hidden="true" tabindex="-1"></a>  tmp_get<span class="sc">$</span>pDFL <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1063"><a href="#cb64-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_get)</span>
<span id="cb64-1064"><a href="#cb64-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1065"><a href="#cb64-1065" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb64-1066"><a href="#cb64-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb64-1067"><a href="#cb64-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1068"><a href="#cb64-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1071"><a href="#cb64-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1072"><a href="#cb64-1072" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1073"><a href="#cb64-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb64-1074"><a href="#cb64-1074" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb64-1075"><a href="#cb64-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#Save some deets so we do not need to save large objects</span></span>
<span id="cb64-1076"><a href="#cb64-1076" aria-hidden="true" tabindex="-1"></a>ssu_default_num_asvs <span class="ot">&lt;-</span> <span class="fu">dim</span>(ssu18_ps_work_perfect_sim<span class="sc">$</span>filtX)[<span class="dv">2</span>]</span>
<span id="cb64-1077"><a href="#cb64-1077" aria-hidden="true" tabindex="-1"></a>ssu_ord_num_asvs <span class="ot">&lt;-</span> <span class="fu">dim</span>(ssu18_ps_work_ord_perfect_sim<span class="sc">$</span>filtX)[<span class="dv">2</span>]</span>
<span id="cb64-1078"><a href="#cb64-1078" aria-hidden="true" tabindex="-1"></a>its_default_num_asvs <span class="ot">&lt;-</span> <span class="fu">dim</span>(its18_ps_work_perfect_sim<span class="sc">$</span>filtX)[<span class="dv">2</span>]</span>
<span id="cb64-1079"><a href="#cb64-1079" aria-hidden="true" tabindex="-1"></a>its_ord_num_asvs <span class="ot">&lt;-</span> <span class="fu">dim</span>(its18_ps_work_ord_perfect_sim<span class="sc">$</span>filtX)[<span class="dv">2</span>]</span>
<span id="cb64-1080"><a href="#cb64-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1081"><a href="#cb64-1081" aria-hidden="true" tabindex="-1"></a>ssu_default_pvals <span class="ot">&lt;-</span> ssu18_ps_work_perfect_sim<span class="sc">$</span>pvals</span>
<span id="cb64-1082"><a href="#cb64-1082" aria-hidden="true" tabindex="-1"></a>ssu_ord_pvals <span class="ot">&lt;-</span> ssu18_ps_work_ord_perfect_sim<span class="sc">$</span>pvals</span>
<span id="cb64-1083"><a href="#cb64-1083" aria-hidden="true" tabindex="-1"></a>its_default_pvals <span class="ot">&lt;-</span> its18_ps_work_perfect_sim<span class="sc">$</span>pvals</span>
<span id="cb64-1084"><a href="#cb64-1084" aria-hidden="true" tabindex="-1"></a>its_ord_pvals <span class="ot">&lt;-</span> its18_ps_work_ord_perfect_sim<span class="sc">$</span>pvals</span>
<span id="cb64-1085"><a href="#cb64-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1086"><a href="#cb64-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1087"><a href="#cb64-1087" aria-hidden="true" tabindex="-1"></a>How many ASVs were retained after filtering? </span>
<span id="cb64-1088"><a href="#cb64-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1089"><a href="#cb64-1089" aria-hidden="true" tabindex="-1"></a>First the 16S rRNA data set. Default ordering resulted in </span>
<span id="cb64-1090"><a href="#cb64-1090" aria-hidden="true" tabindex="-1"></a>**`r ssu_default_num_asvs`** ASVs </span>
<span id="cb64-1091"><a href="#cb64-1091" aria-hidden="true" tabindex="-1"></a>and reordering the data resulted in </span>
<span id="cb64-1092"><a href="#cb64-1092" aria-hidden="true" tabindex="-1"></a>**`r ssu_ord_num_asvs`** ASVs.</span>
<span id="cb64-1093"><a href="#cb64-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1094"><a href="#cb64-1094" aria-hidden="true" tabindex="-1"></a>And then the ITS data set. Default ordering resulted in </span>
<span id="cb64-1095"><a href="#cb64-1095" aria-hidden="true" tabindex="-1"></a>**`r its_default_num_asvs`** ASVs </span>
<span id="cb64-1096"><a href="#cb64-1096" aria-hidden="true" tabindex="-1"></a>and reordering the data resulted in </span>
<span id="cb64-1097"><a href="#cb64-1097" aria-hidden="true" tabindex="-1"></a>**`r its_ord_num_asvs`** ASVs.</span>
<span id="cb64-1098"><a href="#cb64-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1099"><a href="#cb64-1099" aria-hidden="true" tabindex="-1"></a>For some reason, the package does not remove based on the p value cutoff that we set earlier (<span class="in">`0.05`</span>). So we need to filter out the ASVs that have a higher p-value than the cutoff.</span>
<span id="cb64-1100"><a href="#cb64-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1101"><a href="#cb64-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, results='hold', eval=TRUE, render=pander::pander}</span></span>
<span id="cb64-1102"><a href="#cb64-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total 16S rRNA ASVs with p-value less than"</span>, ssu_per_pval[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-1103"><a href="#cb64-1103" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> ssu_default_pvals</span>
<span id="cb64-1104"><a href="#cb64-1104" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_df)</span>
<span id="cb64-1105"><a href="#cb64-1105" aria-hidden="true" tabindex="-1"></a>pval_asv <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(tmp_df <span class="sc">&lt;=</span> ssu_per_pval))</span>
<span id="cb64-1106"><a href="#cb64-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"default order: ASVs before checking p value was"</span>, ssu_default_num_asvs, <span class="st">"and after was"</span>, pval_asv<span class="sc">$</span>count[<span class="dv">1</span>]), <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1107"><a href="#cb64-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1108"><a href="#cb64-1108" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> ssu_ord_pvals</span>
<span id="cb64-1109"><a href="#cb64-1109" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_df)</span>
<span id="cb64-1110"><a href="#cb64-1110" aria-hidden="true" tabindex="-1"></a>pval_asv_ord <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(tmp_df <span class="sc">&lt;=</span> ssu_per_pval))</span>
<span id="cb64-1111"><a href="#cb64-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"decreasing order: ASVs before checking p value was"</span>, ssu_ord_num_asvs, <span class="st">"and after was"</span>, pval_asv_ord<span class="sc">$</span>count[<span class="dv">1</span>]), <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1112"><a href="#cb64-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1113"><a href="#cb64-1113" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"--------------------------------------"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1114"><a href="#cb64-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1115"><a href="#cb64-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total ITS ASVs with p-value less than"</span>, its_per_pval[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb64-1116"><a href="#cb64-1116" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> its_default_pvals</span>
<span id="cb64-1117"><a href="#cb64-1117" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_df)</span>
<span id="cb64-1118"><a href="#cb64-1118" aria-hidden="true" tabindex="-1"></a>pval_asv <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(tmp_df <span class="sc">&lt;=</span> its_per_pval))</span>
<span id="cb64-1119"><a href="#cb64-1119" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"default order: ASVs before checking p-value was"</span>, its_default_num_asvs, <span class="st">"and after was"</span>, pval_asv<span class="sc">$</span>count[<span class="dv">1</span>]), <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1120"><a href="#cb64-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1121"><a href="#cb64-1121" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> its_ord_pvals</span>
<span id="cb64-1122"><a href="#cb64-1122" aria-hidden="true" tabindex="-1"></a>tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_df)</span>
<span id="cb64-1123"><a href="#cb64-1123" aria-hidden="true" tabindex="-1"></a>pval_asv_ord <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(tmp_df <span class="sc">&lt;=</span> its_per_pval))</span>
<span id="cb64-1124"><a href="#cb64-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"decreasing order: ASVs before checking p-value was"</span>, its_ord_num_asvs, <span class="st">"and after was"</span>, pval_asv_ord<span class="sc">$</span>count[<span class="dv">1</span>]), <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1125"><a href="#cb64-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1126"><a href="#cb64-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1127"><a href="#cb64-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1128"><a href="#cb64-1128" aria-hidden="true" tabindex="-1"></a>Now we can make phyloseq objects. Manual inspection of the results from <span class="in">`PERFect_sim`</span> for the 16S rRNA data indicated that using the **decreasing** order and filtering p-values less than `r ssu_per_pval` yielded in the best results. Manual inspection of the results from `PERFect_sim` for the ITS data indicated that using the **default** order and filtering p-values less than <span class="in">`r its_per_pval`</span> yielded in the best results. These approaches limited the number of ASVs found in only 1 or 2 samples. So first we filter out ASVs with p-values lower than the defined cutoff and then make the objects.</span>
<span id="cb64-1129"><a href="#cb64-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1132"><a href="#cb64-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1133"><a href="#cb64-1133" aria-hidden="true" tabindex="-1"></a><span class="co"># pvalue cutoffs set earlier</span></span>
<span id="cb64-1134"><a href="#cb64-1134" aria-hidden="true" tabindex="-1"></a>ssu_per_pval <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb64-1135"><a href="#cb64-1135" aria-hidden="true" tabindex="-1"></a>its_per_pval <span class="ot">&lt;-</span> <span class="fl">0.10</span></span>
<span id="cb64-1136"><a href="#cb64-1136" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose method</span></span>
<span id="cb64-1137"><a href="#cb64-1137" aria-hidden="true" tabindex="-1"></a>ssu_select <span class="ot">&lt;-</span> <span class="st">"_ord_perfect"</span></span>
<span id="cb64-1138"><a href="#cb64-1138" aria-hidden="true" tabindex="-1"></a>its_select <span class="ot">&lt;-</span> <span class="st">"_perfect"</span></span>
<span id="cb64-1139"><a href="#cb64-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1140"><a href="#cb64-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1141"><a href="#cb64-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1144"><a href="#cb64-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1145"><a href="#cb64-1145" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb64-1146"><a href="#cb64-1146" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> samp_ps_filt) {</span>
<span id="cb64-1147"><a href="#cb64-1147" aria-hidden="true" tabindex="-1"></a>  <span class="do">## select pval cutoff and method</span></span>
<span id="cb64-1148"><a href="#cb64-1148" aria-hidden="true" tabindex="-1"></a>    tmp_pval <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"18.*"</span>, <span class="st">"_per_pval"</span>, i)</span>
<span id="cb64-1149"><a href="#cb64-1149" aria-hidden="true" tabindex="-1"></a>    tmp_select <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"18.*"</span>, <span class="st">"_select"</span>, i)</span>
<span id="cb64-1150"><a href="#cb64-1150" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-1151"><a href="#cb64-1151" aria-hidden="true" tabindex="-1"></a>    tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="fu">get</span>(tmp_select))))</span>
<span id="cb64-1152"><a href="#cb64-1152" aria-hidden="true" tabindex="-1"></a>    tmp_get_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="fu">get</span>(tmp_select), <span class="st">"_sim"</span>)))</span>
<span id="cb64-1153"><a href="#cb64-1153" aria-hidden="true" tabindex="-1"></a>    tmp_filt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tmp_get_sim<span class="sc">$</span>filtX))</span>
<span id="cb64-1154"><a href="#cb64-1154" aria-hidden="true" tabindex="-1"></a>    tmp_filt <span class="ot">&lt;-</span> tmp_filt <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-1155"><a href="#cb64-1155" aria-hidden="true" tabindex="-1"></a>    tmp_tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tmp_get))</span>
<span id="cb64-1156"><a href="#cb64-1156" aria-hidden="true" tabindex="-1"></a>    tmp_tab <span class="ot">&lt;-</span> tmp_tab <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-1157"><a href="#cb64-1157" aria-hidden="true" tabindex="-1"></a>    tmp_pvals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_get_sim<span class="sc">$</span>pvals)</span>
<span id="cb64-1158"><a href="#cb64-1158" aria-hidden="true" tabindex="-1"></a>    tmp_pvals <span class="ot">&lt;-</span> tmp_pvals <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1159"><a href="#cb64-1159" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"pval"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb64-1160"><a href="#cb64-1160" aria-hidden="true" tabindex="-1"></a>    tmp_pvals <span class="ot">&lt;-</span> tmp_pvals <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pval <span class="sc">&lt;=</span> <span class="fu">get</span>(tmp_pval))</span>
<span id="cb64-1161"><a href="#cb64-1161" aria-hidden="true" tabindex="-1"></a>    tmp_merge <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_pvals, tmp_tab, <span class="at">by =</span> <span class="st">"ID"</span>)</span>
<span id="cb64-1162"><a href="#cb64-1162" aria-hidden="true" tabindex="-1"></a>    tmp_merge[, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1163"><a href="#cb64-1163" aria-hidden="true" tabindex="-1"></a>    tmp_merge <span class="ot">&lt;-</span> tmp_merge <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-1164"><a href="#cb64-1164" aria-hidden="true" tabindex="-1"></a>    tmp_tax <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tax_table</span>(<span class="fu">get</span>(i))) <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-1165"><a href="#cb64-1165" aria-hidden="true" tabindex="-1"></a>    tmp_tax <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_pvals, tmp_tax, <span class="at">by =</span> <span class="st">"ID"</span>)</span>
<span id="cb64-1166"><a href="#cb64-1166" aria-hidden="true" tabindex="-1"></a>    tmp_tax[, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1167"><a href="#cb64-1167" aria-hidden="true" tabindex="-1"></a>    tmp_tax <span class="ot">&lt;-</span> tmp_tax <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"ID"</span>)</span>
<span id="cb64-1168"><a href="#cb64-1168" aria-hidden="true" tabindex="-1"></a><span class="co"># Build PS object</span></span>
<span id="cb64-1169"><a href="#cb64-1169" aria-hidden="true" tabindex="-1"></a>    tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1170"><a href="#cb64-1170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">identical</span>(<span class="fu">row.names</span>(tmp_tax), <span class="fu">row.names</span>(tmp_merge))</span>
<span id="cb64-1171"><a href="#cb64-1171" aria-hidden="true" tabindex="-1"></a>    tmp_merge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tmp_merge))</span>
<span id="cb64-1172"><a href="#cb64-1172" aria-hidden="true" tabindex="-1"></a>    tmp_merge <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_merge)</span>
<span id="cb64-1173"><a href="#cb64-1173" aria-hidden="true" tabindex="-1"></a>    tmp_tax <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp_tax)</span>
<span id="cb64-1174"><a href="#cb64-1174" aria-hidden="true" tabindex="-1"></a>    tmp_ps <span class="ot">&lt;-</span> <span class="fu">phyloseq</span>(<span class="fu">otu_table</span>(tmp_merge, <span class="at">taxa_are_rows =</span> <span class="cn">FALSE</span>),</span>
<span id="cb64-1175"><a href="#cb64-1175" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">tax_table</span>(tmp_tax),</span>
<span id="cb64-1176"><a href="#cb64-1176" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">sample_data</span>(tmp_samp))</span>
<span id="cb64-1177"><a href="#cb64-1177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-1178"><a href="#cb64-1178" aria-hidden="true" tabindex="-1"></a>    tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1179"><a href="#cb64-1179" aria-hidden="true" tabindex="-1"></a>                           <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb64-1180"><a href="#cb64-1180" aria-hidden="true" tabindex="-1"></a>    tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps,</span>
<span id="cb64-1181"><a href="#cb64-1181" aria-hidden="true" tabindex="-1"></a>                               sample_data,</span>
<span id="cb64-1182"><a href="#cb64-1182" aria-hidden="true" tabindex="-1"></a>                               tmp_tree)</span>
<span id="cb64-1183"><a href="#cb64-1183" aria-hidden="true" tabindex="-1"></a>    tmp_ps_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_perf_filt"</span>))</span>
<span id="cb64-1184"><a href="#cb64-1184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(tmp_ps_name, tmp_ps)</span>
<span id="cb64-1185"><a href="#cb64-1185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1186"><a href="#cb64-1186" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb64-1187"><a href="#cb64-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1188"><a href="#cb64-1188" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect <span class="ot">&lt;-</span> ssu18_ps_work_perf_filt</span>
<span id="cb64-1189"><a href="#cb64-1189" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect <span class="ot">&lt;-</span> its18_ps_work_perf_filt</span>
<span id="cb64-1190"><a href="#cb64-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"_perf_filt"</span>))</span>
<span id="cb64-1191"><a href="#cb64-1191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1192"><a href="#cb64-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1195"><a href="#cb64-1195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1196"><a href="#cb64-1196" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1197"><a href="#cb64-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1198"><a href="#cb64-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"16S rRNA phyloseq object"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1199"><a href="#cb64-1199" aria-hidden="true" tabindex="-1"></a>ssu18_ps_perfect</span>
<span id="cb64-1200"><a href="#cb64-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"ITS phyloseq object"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-1201"><a href="#cb64-1201" aria-hidden="true" tabindex="-1"></a>its18_ps_perfect</span>
<span id="cb64-1202"><a href="#cb64-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1203"><a href="#cb64-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1204"><a href="#cb64-1204" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb64-1205"><a href="#cb64-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1206"><a href="#cb64-1206" aria-hidden="true" tabindex="-1"></a>How many reads and ASVs were removed following PERfect filtering?</span>
<span id="cb64-1207"><a href="#cb64-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1208"><a href="#cb64-1208" aria-hidden="true" tabindex="-1"></a>**16S rRNA**</span>
<span id="cb64-1209"><a href="#cb64-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1212"><a href="#cb64-1212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1213"><a href="#cb64-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1214"><a href="#cb64-1214" aria-hidden="true" tabindex="-1"></a><span class="do">## This code is gross. I spent hours trying to find a better</span></span>
<span id="cb64-1215"><a href="#cb64-1215" aria-hidden="true" tabindex="-1"></a><span class="do">## solution but failed :(</span></span>
<span id="cb64-1216"><a href="#cb64-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1217"><a href="#cb64-1217" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_ps_perfect"</span>)</span>
<span id="cb64-1218"><a href="#cb64-1218" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb64-1219"><a href="#cb64-1219" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total number of reads"</span>, </span>
<span id="cb64-1220"><a href="#cb64-1220" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of reads"</span>, </span>
<span id="cb64-1221"><a href="#cb64-1221" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of reads"</span>, </span>
<span id="cb64-1222"><a href="#cb64-1222" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of reads"</span>, </span>
<span id="cb64-1223"><a href="#cb64-1223" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of reads"</span>, </span>
<span id="cb64-1224"><a href="#cb64-1224" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total ASVs"</span>, </span>
<span id="cb64-1225"><a href="#cb64-1225" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of ASVs"</span>, </span>
<span id="cb64-1226"><a href="#cb64-1226" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of ASVs"</span>, </span>
<span id="cb64-1227"><a href="#cb64-1227" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of ASVs"</span>, </span>
<span id="cb64-1228"><a href="#cb64-1228" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of ASVs"</span>)</span>
<span id="cb64-1229"><a href="#cb64-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1230"><a href="#cb64-1230" aria-hidden="true" tabindex="-1"></a>tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1231"><a href="#cb64-1231" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1232"><a href="#cb64-1232" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1233"><a href="#cb64-1233" aria-hidden="true" tabindex="-1"></a>   tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_reads, tmp_get))</span>
<span id="cb64-1234"><a href="#cb64-1234" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1235"><a href="#cb64-1235" aria-hidden="true" tabindex="-1"></a>tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1236"><a href="#cb64-1236" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1237"><a href="#cb64-1237" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1238"><a href="#cb64-1238" aria-hidden="true" tabindex="-1"></a>   tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_read, tmp_get))</span>
<span id="cb64-1239"><a href="#cb64-1239" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1240"><a href="#cb64-1240" aria-hidden="true" tabindex="-1"></a>tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1241"><a href="#cb64-1241" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1242"><a href="#cb64-1242" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1243"><a href="#cb64-1243" aria-hidden="true" tabindex="-1"></a>   tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_read, tmp_get))</span>
<span id="cb64-1244"><a href="#cb64-1244" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1245"><a href="#cb64-1245" aria-hidden="true" tabindex="-1"></a>tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1246"><a href="#cb64-1246" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1247"><a href="#cb64-1247" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i))), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-1248"><a href="#cb64-1248" aria-hidden="true" tabindex="-1"></a>   tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_reads, tmp_get))</span>
<span id="cb64-1249"><a href="#cb64-1249" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1250"><a href="#cb64-1250" aria-hidden="true" tabindex="-1"></a>tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1251"><a href="#cb64-1251" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1252"><a href="#cb64-1252" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1253"><a href="#cb64-1253" aria-hidden="true" tabindex="-1"></a>   tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_median_reads, tmp_get))</span>
<span id="cb64-1254"><a href="#cb64-1254" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1255"><a href="#cb64-1255" aria-hidden="true" tabindex="-1"></a>tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1256"><a href="#cb64-1256" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1257"><a href="#cb64-1257" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-1258"><a href="#cb64-1258" aria-hidden="true" tabindex="-1"></a>   tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_asvs, tmp_get))</span>
<span id="cb64-1259"><a href="#cb64-1259" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1260"><a href="#cb64-1260" aria-hidden="true" tabindex="-1"></a>tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1261"><a href="#cb64-1261" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1262"><a href="#cb64-1262" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-1263"><a href="#cb64-1263" aria-hidden="true" tabindex="-1"></a>   tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_asvs, tmp_get))</span>
<span id="cb64-1264"><a href="#cb64-1264" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1265"><a href="#cb64-1265" aria-hidden="true" tabindex="-1"></a>tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1266"><a href="#cb64-1266" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1267"><a href="#cb64-1267" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-1268"><a href="#cb64-1268" aria-hidden="true" tabindex="-1"></a>   tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_asvs, tmp_get))</span>
<span id="cb64-1269"><a href="#cb64-1269" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1270"><a href="#cb64-1270" aria-hidden="true" tabindex="-1"></a>tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1271"><a href="#cb64-1271" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1272"><a href="#cb64-1272" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-1273"><a href="#cb64-1273" aria-hidden="true" tabindex="-1"></a>   tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_asvs, tmp_get))</span>
<span id="cb64-1274"><a href="#cb64-1274" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1275"><a href="#cb64-1275" aria-hidden="true" tabindex="-1"></a>tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1276"><a href="#cb64-1276" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1277"><a href="#cb64-1277" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed)</span>
<span id="cb64-1278"><a href="#cb64-1278" aria-hidden="true" tabindex="-1"></a>   tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_med_asvs, tmp_get))</span>
<span id="cb64-1279"><a href="#cb64-1279" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1280"><a href="#cb64-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1281"><a href="#cb64-1281" aria-hidden="true" tabindex="-1"></a>tmp_bind <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, <span class="fu">list</span>(</span>
<span id="cb64-1282"><a href="#cb64-1282" aria-hidden="true" tabindex="-1"></a>  tmp_total_reads, tmp_min_read, tmp_max_read, tmp_mean_reads, tmp_median_reads, </span>
<span id="cb64-1283"><a href="#cb64-1283" aria-hidden="true" tabindex="-1"></a>  tmp_total_asvs, tmp_min_asvs, tmp_max_asvs, tmp_mean_asvs, tmp_med_asvs)))</span>
<span id="cb64-1284"><a href="#cb64-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1285"><a href="#cb64-1285" aria-hidden="true" tabindex="-1"></a>ssu18_sum_perfect <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_bind) <span class="sc">%&gt;%</span></span>
<span id="cb64-1286"><a href="#cb64-1286" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Full data"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"PERfect filter"</span> <span class="ot">=</span> <span class="dv">3</span>)</span>
<span id="cb64-1287"><a href="#cb64-1287" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1288"><a href="#cb64-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1289"><a href="#cb64-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1290"><a href="#cb64-1290" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_perfect_filt_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-1291"><a href="#cb64-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1294"><a href="#cb64-1294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1295"><a href="#cb64-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1296"><a href="#cb64-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1297"><a href="#cb64-1297" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_sum_perfect</span>
<span id="cb64-1298"><a href="#cb64-1298" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-1299"><a href="#cb64-1299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-1300"><a href="#cb64-1300" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_perfect_filt_summary"</span>,</span>
<span id="cb64-1301"><a href="#cb64-1301" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-1302"><a href="#cb64-1302" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-1303"><a href="#cb64-1303" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-1304"><a href="#cb64-1304" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1305"><a href="#cb64-1305" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1306"><a href="#cb64-1306" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-1307"><a href="#cb64-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1308"><a href="#cb64-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1311"><a href="#cb64-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1312"><a href="#cb64-1312" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1313"><a href="#cb64-1313" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1314"><a href="#cb64-1314" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-1315"><a href="#cb64-1315" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-1316"><a href="#cb64-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1317"><a href="#cb64-1317" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-1318"><a href="#cb64-1318" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1319"><a href="#cb64-1319" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">150</span></span>
<span id="cb64-1320"><a href="#cb64-1320" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1321"><a href="#cb64-1321" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-1322"><a href="#cb64-1322" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-1323"><a href="#cb64-1323" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-1324"><a href="#cb64-1324" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-1325"><a href="#cb64-1325" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-1326"><a href="#cb64-1326" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-1327"><a href="#cb64-1327" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>)</span>
<span id="cb64-1328"><a href="#cb64-1328" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1329"><a href="#cb64-1329" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">10</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1330"><a href="#cb64-1330" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-1331"><a href="#cb64-1331" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1332"><a href="#cb64-1332" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1333"><a href="#cb64-1333" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1334"><a href="#cb64-1334" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-1335"><a href="#cb64-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1336"><a href="#cb64-1336" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-1337"><a href="#cb64-1337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1338"><a href="#cb64-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1339"><a href="#cb64-1339" aria-hidden="true" tabindex="-1"></a>**ITS**</span>
<span id="cb64-1340"><a href="#cb64-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1343"><a href="#cb64-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1344"><a href="#cb64-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1345"><a href="#cb64-1345" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1346"><a href="#cb64-1346" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_ps_perfect"</span>)</span>
<span id="cb64-1347"><a href="#cb64-1347" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb64-1348"><a href="#cb64-1348" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total number of reads"</span>, </span>
<span id="cb64-1349"><a href="#cb64-1349" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of reads"</span>, </span>
<span id="cb64-1350"><a href="#cb64-1350" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of reads"</span>, </span>
<span id="cb64-1351"><a href="#cb64-1351" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of reads"</span>, </span>
<span id="cb64-1352"><a href="#cb64-1352" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of reads"</span>, </span>
<span id="cb64-1353"><a href="#cb64-1353" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total ASVs"</span>, </span>
<span id="cb64-1354"><a href="#cb64-1354" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of ASVs"</span>, </span>
<span id="cb64-1355"><a href="#cb64-1355" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of ASVs"</span>, </span>
<span id="cb64-1356"><a href="#cb64-1356" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of ASVs"</span>, </span>
<span id="cb64-1357"><a href="#cb64-1357" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of ASVs"</span>)</span>
<span id="cb64-1358"><a href="#cb64-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1359"><a href="#cb64-1359" aria-hidden="true" tabindex="-1"></a>tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1360"><a href="#cb64-1360" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1361"><a href="#cb64-1361" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1362"><a href="#cb64-1362" aria-hidden="true" tabindex="-1"></a>   tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_reads, tmp_get))</span>
<span id="cb64-1363"><a href="#cb64-1363" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1364"><a href="#cb64-1364" aria-hidden="true" tabindex="-1"></a>tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1365"><a href="#cb64-1365" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1366"><a href="#cb64-1366" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1367"><a href="#cb64-1367" aria-hidden="true" tabindex="-1"></a>   tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_read, tmp_get))</span>
<span id="cb64-1368"><a href="#cb64-1368" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1369"><a href="#cb64-1369" aria-hidden="true" tabindex="-1"></a>tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1370"><a href="#cb64-1370" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1371"><a href="#cb64-1371" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1372"><a href="#cb64-1372" aria-hidden="true" tabindex="-1"></a>   tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_read, tmp_get))</span>
<span id="cb64-1373"><a href="#cb64-1373" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1374"><a href="#cb64-1374" aria-hidden="true" tabindex="-1"></a>tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1375"><a href="#cb64-1375" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1376"><a href="#cb64-1376" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i))), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-1377"><a href="#cb64-1377" aria-hidden="true" tabindex="-1"></a>   tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_reads, tmp_get))</span>
<span id="cb64-1378"><a href="#cb64-1378" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1379"><a href="#cb64-1379" aria-hidden="true" tabindex="-1"></a>tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1380"><a href="#cb64-1380" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1381"><a href="#cb64-1381" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1382"><a href="#cb64-1382" aria-hidden="true" tabindex="-1"></a>   tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_median_reads, tmp_get))</span>
<span id="cb64-1383"><a href="#cb64-1383" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1384"><a href="#cb64-1384" aria-hidden="true" tabindex="-1"></a>tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1385"><a href="#cb64-1385" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1386"><a href="#cb64-1386" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-1387"><a href="#cb64-1387" aria-hidden="true" tabindex="-1"></a>   tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_asvs, tmp_get))</span>
<span id="cb64-1388"><a href="#cb64-1388" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1389"><a href="#cb64-1389" aria-hidden="true" tabindex="-1"></a>tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1390"><a href="#cb64-1390" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1391"><a href="#cb64-1391" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-1392"><a href="#cb64-1392" aria-hidden="true" tabindex="-1"></a>   tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_asvs, tmp_get))</span>
<span id="cb64-1393"><a href="#cb64-1393" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1394"><a href="#cb64-1394" aria-hidden="true" tabindex="-1"></a>tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1395"><a href="#cb64-1395" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1396"><a href="#cb64-1396" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-1397"><a href="#cb64-1397" aria-hidden="true" tabindex="-1"></a>   tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_asvs, tmp_get))</span>
<span id="cb64-1398"><a href="#cb64-1398" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1399"><a href="#cb64-1399" aria-hidden="true" tabindex="-1"></a>tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1400"><a href="#cb64-1400" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1401"><a href="#cb64-1401" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-1402"><a href="#cb64-1402" aria-hidden="true" tabindex="-1"></a>   tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_asvs, tmp_get))</span>
<span id="cb64-1403"><a href="#cb64-1403" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1404"><a href="#cb64-1404" aria-hidden="true" tabindex="-1"></a>tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1405"><a href="#cb64-1405" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1406"><a href="#cb64-1406" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed)</span>
<span id="cb64-1407"><a href="#cb64-1407" aria-hidden="true" tabindex="-1"></a>   tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_med_asvs, tmp_get))</span>
<span id="cb64-1408"><a href="#cb64-1408" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1409"><a href="#cb64-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1410"><a href="#cb64-1410" aria-hidden="true" tabindex="-1"></a>tmp_bind <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, <span class="fu">list</span>(</span>
<span id="cb64-1411"><a href="#cb64-1411" aria-hidden="true" tabindex="-1"></a>  tmp_total_reads, tmp_min_read, tmp_max_read, tmp_mean_reads, tmp_median_reads, </span>
<span id="cb64-1412"><a href="#cb64-1412" aria-hidden="true" tabindex="-1"></a>  tmp_total_asvs, tmp_min_asvs, tmp_max_asvs, tmp_mean_asvs, tmp_med_asvs)))</span>
<span id="cb64-1413"><a href="#cb64-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1414"><a href="#cb64-1414" aria-hidden="true" tabindex="-1"></a>its18_sum_perfect <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_bind) <span class="sc">%&gt;%</span></span>
<span id="cb64-1415"><a href="#cb64-1415" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Full data"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"PERfect filter"</span> <span class="ot">=</span> <span class="dv">3</span>)</span>
<span id="cb64-1416"><a href="#cb64-1416" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1417"><a href="#cb64-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1418"><a href="#cb64-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1419"><a href="#cb64-1419" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_perfect_filt_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-1420"><a href="#cb64-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1423"><a href="#cb64-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1424"><a href="#cb64-1424" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1425"><a href="#cb64-1425" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1426"><a href="#cb64-1426" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_sum_perfect</span>
<span id="cb64-1427"><a href="#cb64-1427" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-1428"><a href="#cb64-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-1429"><a href="#cb64-1429" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_perfect_filt_summary"</span>,</span>
<span id="cb64-1430"><a href="#cb64-1430" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-1431"><a href="#cb64-1431" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-1432"><a href="#cb64-1432" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-1433"><a href="#cb64-1433" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1434"><a href="#cb64-1434" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1435"><a href="#cb64-1435" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-1436"><a href="#cb64-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1437"><a href="#cb64-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1440"><a href="#cb64-1440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1441"><a href="#cb64-1441" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1442"><a href="#cb64-1442" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1443"><a href="#cb64-1443" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-1444"><a href="#cb64-1444" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-1445"><a href="#cb64-1445" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1446"><a href="#cb64-1446" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-1447"><a href="#cb64-1447" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1448"><a href="#cb64-1448" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">150</span></span>
<span id="cb64-1449"><a href="#cb64-1449" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1450"><a href="#cb64-1450" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-1451"><a href="#cb64-1451" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-1452"><a href="#cb64-1452" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-1453"><a href="#cb64-1453" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-1454"><a href="#cb64-1454" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-1455"><a href="#cb64-1455" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-1456"><a href="#cb64-1456" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>)</span>
<span id="cb64-1457"><a href="#cb64-1457" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1458"><a href="#cb64-1458" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">10</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1459"><a href="#cb64-1459" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-1460"><a href="#cb64-1460" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1461"><a href="#cb64-1461" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1462"><a href="#cb64-1462" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1463"><a href="#cb64-1463" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-1464"><a href="#cb64-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1465"><a href="#cb64-1465" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-1466"><a href="#cb64-1466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1467"><a href="#cb64-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1468"><a href="#cb64-1468" aria-hidden="true" tabindex="-1"></a>Here is a summary table of total reads and ASVs on a per sample basis after filtering. </span>
<span id="cb64-1469"><a href="#cb64-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1470"><a href="#cb64-1470" aria-hidden="true" tabindex="-1"></a>**16S rRNA**</span>
<span id="cb64-1471"><a href="#cb64-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1474"><a href="#cb64-1474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1475"><a href="#cb64-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1476"><a href="#cb64-1476" aria-hidden="true" tabindex="-1"></a>tmp_read_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_sums</span>(ssu18_ps_perfect)) <span class="sc">%&gt;%</span></span>
<span id="cb64-1477"><a href="#cb64-1477" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-1478"><a href="#cb64-1478" aria-hidden="true" tabindex="-1"></a>tmp_asv_count <span class="ot">&lt;-</span> <span class="fu">estimate_richness</span>(ssu18_ps_perfect, <span class="at">split =</span> <span class="cn">TRUE</span>, <span class="at">measures =</span> <span class="st">"Observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1479"><a href="#cb64-1479" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-1480"><a href="#cb64-1480" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ssu18_ps_perfect))</span>
<span id="cb64-1481"><a href="#cb64-1481" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> tmp_samp_data[<span class="fu">order</span>(tmp_samp_data<span class="sc">$</span>PLOT, tmp_samp_data<span class="sc">$</span>TEMP),]</span>
<span id="cb64-1482"><a href="#cb64-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1483"><a href="#cb64-1483" aria-hidden="true" tabindex="-1"></a>tmp_join <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp_data, tmp_read_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1484"><a href="#cb64-1484" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_asv_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1485"><a href="#cb64-1485" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1486"><a href="#cb64-1486" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1487"><a href="#cb64-1487" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_asvs"</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb64-1488"><a href="#cb64-1488" aria-hidden="true" tabindex="-1"></a>tmp_join[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1489"><a href="#cb64-1489" aria-hidden="true" tabindex="-1"></a>ssu_perfect_samp_summary <span class="ot">&lt;-</span> tmp_join</span>
<span id="cb64-1490"><a href="#cb64-1490" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1491"><a href="#cb64-1491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1492"><a href="#cb64-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1493"><a href="#cb64-1493" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_perfect_samp_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-1494"><a href="#cb64-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1497"><a href="#cb64-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1498"><a href="#cb64-1498" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1499"><a href="#cb64-1499" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1500"><a href="#cb64-1500" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu_perfect_samp_summary</span>
<span id="cb64-1501"><a href="#cb64-1501" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-1502"><a href="#cb64-1502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-1503"><a href="#cb64-1503" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_perfect_samp_summary"</span>,</span>
<span id="cb64-1504"><a href="#cb64-1504" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-1505"><a href="#cb64-1505" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-1506"><a href="#cb64-1506" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-1507"><a href="#cb64-1507" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1508"><a href="#cb64-1508" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1509"><a href="#cb64-1509" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-1510"><a href="#cb64-1510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1511"><a href="#cb64-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1514"><a href="#cb64-1514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1515"><a href="#cb64-1515" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1516"><a href="#cb64-1516" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1517"><a href="#cb64-1517" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-1518"><a href="#cb64-1518" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-1519"><a href="#cb64-1519" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1520"><a href="#cb64-1520" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-1521"><a href="#cb64-1521" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1522"><a href="#cb64-1522" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-1523"><a href="#cb64-1523" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1524"><a href="#cb64-1524" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-1525"><a href="#cb64-1525" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb64-1526"><a href="#cb64-1526" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-1527"><a href="#cb64-1527" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-1528"><a href="#cb64-1528" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-1529"><a href="#cb64-1529" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-1530"><a href="#cb64-1530" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-1531"><a href="#cb64-1531" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1532"><a href="#cb64-1532" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1533"><a href="#cb64-1533" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-1534"><a href="#cb64-1534" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1535"><a href="#cb64-1535" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1536"><a href="#cb64-1536" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1537"><a href="#cb64-1537" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-1538"><a href="#cb64-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1539"><a href="#cb64-1539" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-1540"><a href="#cb64-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1541"><a href="#cb64-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1542"><a href="#cb64-1542" aria-hidden="true" tabindex="-1"></a>**ITS**</span>
<span id="cb64-1543"><a href="#cb64-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1546"><a href="#cb64-1546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1547"><a href="#cb64-1547" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1548"><a href="#cb64-1548" aria-hidden="true" tabindex="-1"></a>tmp_read_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_sums</span>(its18_ps_perfect)) <span class="sc">%&gt;%</span></span>
<span id="cb64-1549"><a href="#cb64-1549" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-1550"><a href="#cb64-1550" aria-hidden="true" tabindex="-1"></a>tmp_asv_count <span class="ot">&lt;-</span> <span class="fu">estimate_richness</span>(its18_ps_perfect, <span class="at">split =</span> <span class="cn">TRUE</span>, <span class="at">measures =</span> <span class="st">"Observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1551"><a href="#cb64-1551" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-1552"><a href="#cb64-1552" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(its18_ps_perfect))</span>
<span id="cb64-1553"><a href="#cb64-1553" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> tmp_samp_data[<span class="fu">order</span>(tmp_samp_data<span class="sc">$</span>PLOT, tmp_samp_data<span class="sc">$</span>TEMP),]</span>
<span id="cb64-1554"><a href="#cb64-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1555"><a href="#cb64-1555" aria-hidden="true" tabindex="-1"></a>tmp_join <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp_data, tmp_read_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1556"><a href="#cb64-1556" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_asv_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1557"><a href="#cb64-1557" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1558"><a href="#cb64-1558" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-1559"><a href="#cb64-1559" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_asvs"</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb64-1560"><a href="#cb64-1560" aria-hidden="true" tabindex="-1"></a>tmp_join[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1561"><a href="#cb64-1561" aria-hidden="true" tabindex="-1"></a>its_perfect_samp_summary <span class="ot">&lt;-</span> tmp_join</span>
<span id="cb64-1562"><a href="#cb64-1562" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1563"><a href="#cb64-1563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1564"><a href="#cb64-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1565"><a href="#cb64-1565" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_perfect_samp_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-1566"><a href="#cb64-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1569"><a href="#cb64-1569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1570"><a href="#cb64-1570" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1571"><a href="#cb64-1571" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1572"><a href="#cb64-1572" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its_perfect_samp_summary</span>
<span id="cb64-1573"><a href="#cb64-1573" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-1574"><a href="#cb64-1574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-1575"><a href="#cb64-1575" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_perfect_samp_summary"</span>,</span>
<span id="cb64-1576"><a href="#cb64-1576" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-1577"><a href="#cb64-1577" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-1578"><a href="#cb64-1578" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-1579"><a href="#cb64-1579" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1580"><a href="#cb64-1580" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1581"><a href="#cb64-1581" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-1582"><a href="#cb64-1582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1583"><a href="#cb64-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1586"><a href="#cb64-1586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1587"><a href="#cb64-1587" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1588"><a href="#cb64-1588" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1589"><a href="#cb64-1589" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-1590"><a href="#cb64-1590" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-1591"><a href="#cb64-1591" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1592"><a href="#cb64-1592" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-1593"><a href="#cb64-1593" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1594"><a href="#cb64-1594" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-1595"><a href="#cb64-1595" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1596"><a href="#cb64-1596" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-1597"><a href="#cb64-1597" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb64-1598"><a href="#cb64-1598" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-1599"><a href="#cb64-1599" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-1600"><a href="#cb64-1600" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-1601"><a href="#cb64-1601" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-1602"><a href="#cb64-1602" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-1603"><a href="#cb64-1603" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1604"><a href="#cb64-1604" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1605"><a href="#cb64-1605" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-1606"><a href="#cb64-1606" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1607"><a href="#cb64-1607" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1608"><a href="#cb64-1608" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1609"><a href="#cb64-1609" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-1610"><a href="#cb64-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1611"><a href="#cb64-1611" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-1612"><a href="#cb64-1612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1613"><a href="#cb64-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1614"><a href="#cb64-1614" aria-hidden="true" tabindex="-1"></a>And finally, save the PERfect filtered phyloseq objects.</span>
<span id="cb64-1615"><a href="#cb64-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1618"><a href="#cb64-1618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1619"><a href="#cb64-1619" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb64-1620"><a href="#cb64-1620" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_ps_perfect, <span class="st">"files/filtering/perfect/rdata/ssu18_ps_perfect.rds"</span>)</span>
<span id="cb64-1621"><a href="#cb64-1621" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_ps_perfect, <span class="st">"files/filtering/perfect/rdata/its18_ps_perfect.rds"</span>)</span>
<span id="cb64-1622"><a href="#cb64-1622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1623"><a href="#cb64-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1626"><a href="#cb64-1626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1627"><a href="#cb64-1627" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1628"><a href="#cb64-1628" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"page_build/filtering_wf.rdata"</span>)</span>
<span id="cb64-1629"><a href="#cb64-1629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1630"><a href="#cb64-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1631"><a href="#cb64-1631" aria-hidden="true" tabindex="-1"></a><span class="fu"># C. PIME Filtering</span></span>
<span id="cb64-1632"><a href="#cb64-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1633"><a href="#cb64-1633" aria-hidden="true" tabindex="-1"></a>The first step in the PIME process is to rarefy the data and then proceed with the filtering. Unlike the two previous workflows---which combined the analyses of the 16S rRNA and ITS data sets---here the two data sets will be analyzed separately because the PIME workflow is considerably more complicated.</span>
<span id="cb64-1634"><a href="#cb64-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1635"><a href="#cb64-1635" aria-hidden="true" tabindex="-1"></a><span class="fu">## 16S rRNA</span></span>
<span id="cb64-1636"><a href="#cb64-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1639"><a href="#cb64-1639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1640"><a href="#cb64-1640" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb64-1641"><a href="#cb64-1641" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial Load for PIME  ANALYSIS #1</span></span>
<span id="cb64-1642"><a href="#cb64-1642" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb64-1643"><a href="#cb64-1643" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">119</span>)</span>
<span id="cb64-1644"><a href="#cb64-1644" aria-hidden="true" tabindex="-1"></a>ssu18_ps_work <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/ssu18_ps_work.rds"</span>)</span>
<span id="cb64-1645"><a href="#cb64-1645" aria-hidden="true" tabindex="-1"></a>ssu18_samp_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/ssu18_samp_data.rds"</span>)</span>
<span id="cb64-1646"><a href="#cb64-1646" aria-hidden="true" tabindex="-1"></a>ssu18_ps_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"files/data-prep/rdata/ssu18_ps_amp.rds"</span>)</span>
<span id="cb64-1647"><a href="#cb64-1647" aria-hidden="true" tabindex="-1"></a>ssu18_ps_data_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(ssu18_ps_data), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1648"><a href="#cb64-1648" aria-hidden="true" tabindex="-1"></a>                           <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(ssu18_ps_data))</span>
<span id="cb64-1649"><a href="#cb64-1649" aria-hidden="true" tabindex="-1"></a>ssu18_ps_data <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(ssu18_ps_data, sample_data, ssu18_ps_data_tree)</span>
<span id="cb64-1650"><a href="#cb64-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1651"><a href="#cb64-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1652"><a href="#cb64-1652" aria-hidden="true" tabindex="-1"></a><span class="fu">### Setup</span></span>
<span id="cb64-1653"><a href="#cb64-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1654"><a href="#cb64-1654" aria-hidden="true" tabindex="-1"></a>First, choose a phyloseq object and a sample data frame</span>
<span id="cb64-1655"><a href="#cb64-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1658"><a href="#cb64-1658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1659"><a href="#cb64-1659" aria-hidden="true" tabindex="-1"></a>ssu18_pime_ds <span class="ot">&lt;-</span> ssu18_ps_work</span>
<span id="cb64-1660"><a href="#cb64-1660" aria-hidden="true" tabindex="-1"></a>ssu18_which_pime <span class="ot">&lt;-</span> <span class="st">"ssu18_pime_ds"</span></span>
<span id="cb64-1661"><a href="#cb64-1661" aria-hidden="true" tabindex="-1"></a>ssu18_pime_ds<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1662"><a href="#cb64-1662" aria-hidden="true" tabindex="-1"></a>ssu18_pime_ds</span>
<span id="cb64-1663"><a href="#cb64-1663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1664"><a href="#cb64-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1667"><a href="#cb64-1667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1668"><a href="#cb64-1668" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1669"><a href="#cb64-1669" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1670"><a href="#cb64-1670" aria-hidden="true" tabindex="-1"></a>tmp_ps <span class="ot">&lt;-</span> ssu18_ps_work</span>
<span id="cb64-1671"><a href="#cb64-1671" aria-hidden="true" tabindex="-1"></a>tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-1672"><a href="#cb64-1672" aria-hidden="true" tabindex="-1"></a>tmp_ps</span>
<span id="cb64-1673"><a href="#cb64-1673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1674"><a href="#cb64-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1677"><a href="#cb64-1677" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1678"><a href="#cb64-1678" aria-hidden="true" tabindex="-1"></a>ssu18_pime_sample_d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(<span class="fu">otu_table</span>(ssu18_pime_ds_full)))</span>
<span id="cb64-1679"><a href="#cb64-1679" aria-hidden="true" tabindex="-1"></a>ssu18_pime_sample_d <span class="ot">&lt;-</span> ssu18_pime_sample_d <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">total_reads =</span> <span class="dv">1</span>)</span>
<span id="cb64-1680"><a href="#cb64-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1681"><a href="#cb64-1681" aria-hidden="true" tabindex="-1"></a>ssu18_pime_ds <span class="ot">&lt;-</span> <span class="fu">rarefy_even_depth</span>(ssu18_pime_ds_full,</span>
<span id="cb64-1682"><a href="#cb64-1682" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sample.size =</span> <span class="fu">min</span>(ssu18_pime_sample_d<span class="sc">$</span>total_reads),</span>
<span id="cb64-1683"><a href="#cb64-1683" aria-hidden="true" tabindex="-1"></a>                               <span class="at">trimOTUs =</span> <span class="cn">TRUE</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1684"><a href="#cb64-1684" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rngseed =</span> <span class="dv">119</span>)</span>
<span id="cb64-1685"><a href="#cb64-1685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1686"><a href="#cb64-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1687"><a href="#cb64-1687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1688"><a href="#cb64-1688" aria-hidden="true" tabindex="-1"></a><span class="in">2741 OTUs were removed because they are no longer </span></span>
<span id="cb64-1689"><a href="#cb64-1689" aria-hidden="true" tabindex="-1"></a><span class="in">present in any sample after random subsampling</span></span>
<span id="cb64-1690"><a href="#cb64-1690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1691"><a href="#cb64-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1694"><a href="#cb64-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1695"><a href="#cb64-1695" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1696"><a href="#cb64-1696" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1697"><a href="#cb64-1697" aria-hidden="true" tabindex="-1"></a>ssu18_pime_ds</span>
<span id="cb64-1698"><a href="#cb64-1698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1699"><a href="#cb64-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1700"><a href="#cb64-1700" aria-hidden="true" tabindex="-1"></a>The first step in PIME is to define if the microbial community presents a high relative abundance of taxa with low prevalence, which is considered as noise in PIME analysis. This is calculated by random forests analysis and is the baseline noise detection.</span>
<span id="cb64-1701"><a href="#cb64-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1704"><a href="#cb64-1704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1705"><a href="#cb64-1705" aria-hidden="true" tabindex="-1"></a>ssu18_pime.oob.error <span class="ot">&lt;-</span> <span class="fu">pime.oob.error</span>(ssu18_pime_ds, <span class="st">"TEMP"</span>)</span>
<span id="cb64-1706"><a href="#cb64-1706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1707"><a href="#cb64-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1710"><a href="#cb64-1710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1711"><a href="#cb64-1711" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1712"><a href="#cb64-1712" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1713"><a href="#cb64-1713" aria-hidden="true" tabindex="-1"></a>ssu18_pime.oob.error</span>
<span id="cb64-1714"><a href="#cb64-1714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1715"><a href="#cb64-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1716"><a href="#cb64-1716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Split by Predictor Variable</span></span>
<span id="cb64-1717"><a href="#cb64-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1720"><a href="#cb64-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1721"><a href="#cb64-1721" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ssu18_pime_ds))</span>
<span id="cb64-1722"><a href="#cb64-1722" aria-hidden="true" tabindex="-1"></a>ssu18_per_variable_obj <span class="ot">&lt;-</span> <span class="fu">pime.split.by.variable</span>(ssu18_pime_ds, <span class="st">"TEMP"</span>)</span>
<span id="cb64-1723"><a href="#cb64-1723" aria-hidden="true" tabindex="-1"></a>ssu18_per_variable_obj</span>
<span id="cb64-1724"><a href="#cb64-1724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1725"><a href="#cb64-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1728"><a href="#cb64-1728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1729"><a href="#cb64-1729" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1730"><a href="#cb64-1730" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1731"><a href="#cb64-1731" aria-hidden="true" tabindex="-1"></a>ssu18_per_variable_obj</span>
<span id="cb64-1732"><a href="#cb64-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1733"><a href="#cb64-1733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1734"><a href="#cb64-1734" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate Prevalence Intervals</span></span>
<span id="cb64-1735"><a href="#cb64-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1736"><a href="#cb64-1736" aria-hidden="true" tabindex="-1"></a>Using the output of <span class="in">`pime.split.by.variable`</span>, we calculate the prevalence intervals with the function <span class="in">`pime.prevalence`</span>. This function estimates the highest prevalence possible (no empty ASV table), calculates prevalence for taxa, starting at 5 maximum prevalence possible (no empty ASV table or dropping samples). After prevalence calculation, each prevalence interval are merged.</span>
<span id="cb64-1737"><a href="#cb64-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1740"><a href="#cb64-1740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1741"><a href="#cb64-1741" aria-hidden="true" tabindex="-1"></a>ssu18_prevalences <span class="ot">&lt;-</span> <span class="fu">pime.prevalence</span>(ssu18_per_variable_obj)</span>
<span id="cb64-1742"><a href="#cb64-1742" aria-hidden="true" tabindex="-1"></a>ssu18_prevalences</span>
<span id="cb64-1743"><a href="#cb64-1743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1744"><a href="#cb64-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1745"><a href="#cb64-1745" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb64-1746"><a href="#cb64-1746" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;</span>Detailed results for all prevalences intervals  <span class="kw">&lt;/summary&gt;</span></span>
<span id="cb64-1747"><a href="#cb64-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1750"><a href="#cb64-1750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1751"><a href="#cb64-1751" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1752"><a href="#cb64-1752" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1753"><a href="#cb64-1753" aria-hidden="true" tabindex="-1"></a>ssu18_prevalences</span>
<span id="cb64-1754"><a href="#cb64-1754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1755"><a href="#cb64-1755" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb64-1756"><a href="#cb64-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1757"><a href="#cb64-1757" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate Best Prevalence</span></span>
<span id="cb64-1758"><a href="#cb64-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1759"><a href="#cb64-1759" aria-hidden="true" tabindex="-1"></a>Finally, we use the function <span class="in">`pime.best.prevalence`</span> to calculate the best prevalence. The function uses randomForest to build random forests trees for samples classification and variable importance computation. It performs classifications for each prevalence interval returned by <span class="in">`pime.prevalence`</span>. Variable importance is calculated, returning the Mean Decrease Accuracy (MDA), Mean Decrease Impurity (MDI), overall and by sample group, and taxonomy for each ASV. PIME keeps the top 30 variables with highest MDA each prevalence level.</span>
<span id="cb64-1760"><a href="#cb64-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1763"><a href="#cb64-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1764"><a href="#cb64-1764" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1911</span>)</span>
<span id="cb64-1765"><a href="#cb64-1765" aria-hidden="true" tabindex="-1"></a>ssu18_best.prev <span class="ot">&lt;-</span> <span class="fu">pime.best.prevalence</span>(ssu18_prevalences, <span class="st">"TEMP"</span>)</span>
<span id="cb64-1766"><a href="#cb64-1766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1767"><a href="#cb64-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1770"><a href="#cb64-1770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1771"><a href="#cb64-1771" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1772"><a href="#cb64-1772" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1773"><a href="#cb64-1773" aria-hidden="true" tabindex="-1"></a>ssu18_best.prev<span class="sc">$</span><span class="st">`</span><span class="at">OOB error</span><span class="st">`</span></span>
<span id="cb64-1774"><a href="#cb64-1774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1775"><a href="#cb64-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1778"><a href="#cb64-1778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1779"><a href="#cb64-1779" aria-hidden="true" tabindex="-1"></a>ssu18_what_is_best <span class="ot">&lt;-</span> ssu18_best.prev<span class="sc">$</span><span class="st">`</span><span class="at">OOB error</span><span class="st">`</span></span>
<span id="cb64-1780"><a href="#cb64-1780" aria-hidden="true" tabindex="-1"></a>ssu18_what_is_best[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ssu18_what_is_best[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], as.numeric)</span>
<span id="cb64-1781"><a href="#cb64-1781" aria-hidden="true" tabindex="-1"></a>ssu18_what_is_best <span class="ot">&lt;-</span> ssu18_what_is_best <span class="sc">%&gt;%</span></span>
<span id="cb64-1782"><a href="#cb64-1782" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"OOB_error_rate"</span> <span class="ot">=</span> <span class="st">"OOB error rate (%)"</span>)</span>
<span id="cb64-1783"><a href="#cb64-1783" aria-hidden="true" tabindex="-1"></a>ssu18_what_is_best<span class="sc">$</span>Interval <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(ssu18_what_is_best<span class="sc">$</span>Interval, <span class="st">"%"</span>, <span class="st">""</span>)</span>
<span id="cb64-1784"><a href="#cb64-1784" aria-hidden="true" tabindex="-1"></a>ssu18_best <span class="ot">&lt;-</span> <span class="fu">with</span>(ssu18_what_is_best, Interval[<span class="fu">which.min</span>(OOB_error_rate)])</span>
<span id="cb64-1785"><a href="#cb64-1785" aria-hidden="true" tabindex="-1"></a>ssu18_best <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"`"</span>, ssu18_best, <span class="st">"`"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-1786"><a href="#cb64-1786" aria-hidden="true" tabindex="-1"></a>ssu18_prev_choice <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"ssu18_best.prev$`Importance`$"</span>, ssu18_best, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-1787"><a href="#cb64-1787" aria-hidden="true" tabindex="-1"></a>ssu18_imp_best <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> (ssu18_prev_choice)))</span>
<span id="cb64-1788"><a href="#cb64-1788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1789"><a href="#cb64-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1790"><a href="#cb64-1790" aria-hidden="true" tabindex="-1"></a>Looks like the lowest OOB error rate (%) that retains the most ASVs is <span class="in">`r min(ssu18_what_is_best$OOB_error_rate)`</span>% from <span class="in">`r ssu18_best`</span>. We will use this interval.</span>
<span id="cb64-1791"><a href="#cb64-1791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1792"><a href="#cb64-1792" aria-hidden="true" tabindex="-1"></a><span class="fu">### Best Prevalence Summary</span></span>
<span id="cb64-1793"><a href="#cb64-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1796"><a href="#cb64-1796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1797"><a href="#cb64-1797" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1798"><a href="#cb64-1798" aria-hidden="true" tabindex="-1"></a>ssu18_imp_best[, <span class="dv">13</span><span class="sc">:</span><span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb64-1799"><a href="#cb64-1799" aria-hidden="true" tabindex="-1"></a>ssu18_imp_best <span class="ot">&lt;-</span> ssu18_imp_best <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"ASV_ID"</span> <span class="ot">=</span> <span class="st">"SequenceID"</span>)</span>
<span id="cb64-1800"><a href="#cb64-1800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1801"><a href="#cb64-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1802"><a href="#cb64-1802" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_pime_filt_top_asvs")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-1803"><a href="#cb64-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1806"><a href="#cb64-1806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1807"><a href="#cb64-1807" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1808"><a href="#cb64-1808" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1809"><a href="#cb64-1809" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_imp_best</span>
<span id="cb64-1810"><a href="#cb64-1810" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-1811"><a href="#cb64-1811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-1812"><a href="#cb64-1812" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_pime_filt_top_asvs"</span>,</span>
<span id="cb64-1813"><a href="#cb64-1813" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-1814"><a href="#cb64-1814" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-1815"><a href="#cb64-1815" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-1816"><a href="#cb64-1816" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1817"><a href="#cb64-1817" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1818"><a href="#cb64-1818" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-1819"><a href="#cb64-1819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1820"><a href="#cb64-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1823"><a href="#cb64-1823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1824"><a href="#cb64-1824" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1825"><a href="#cb64-1825" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1826"><a href="#cb64-1826" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_imp_best <span class="sc">%&gt;%</span></span>
<span id="cb64-1827"><a href="#cb64-1827" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Control"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Warm_3"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Warm_8"</span> <span class="ot">=</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-1828"><a href="#cb64-1828" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb64-1829"><a href="#cb64-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1830"><a href="#cb64-1830" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-1831"><a href="#cb64-1831" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-1832"><a href="#cb64-1832" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1833"><a href="#cb64-1833" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">4</span>),</span>
<span id="cb64-1834"><a href="#cb64-1834" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1835"><a href="#cb64-1835" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-1836"><a href="#cb64-1836" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1837"><a href="#cb64-1837" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-1838"><a href="#cb64-1838" aria-hidden="true" tabindex="-1"></a>    <span class="at">ASV_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"ASV ID"</span>, </span>
<span id="cb64-1839"><a href="#cb64-1839" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-1840"><a href="#cb64-1840" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-1841"><a href="#cb64-1841" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-1842"><a href="#cb64-1842" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-1843"><a href="#cb64-1843" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">100</span>),</span>
<span id="cb64-1844"><a href="#cb64-1844" aria-hidden="true" tabindex="-1"></a>    <span class="at">Kingdom =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1845"><a href="#cb64-1845" aria-hidden="true" tabindex="-1"></a>    <span class="at">Phylum =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-1846"><a href="#cb64-1846" aria-hidden="true" tabindex="-1"></a>    <span class="at">Class =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-1847"><a href="#cb64-1847" aria-hidden="true" tabindex="-1"></a>    <span class="at">Order =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-1848"><a href="#cb64-1848" aria-hidden="true" tabindex="-1"></a>    <span class="at">Family =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-1849"><a href="#cb64-1849" aria-hidden="true" tabindex="-1"></a>    <span class="at">Genus =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-1850"><a href="#cb64-1850" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-1851"><a href="#cb64-1851" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1852"><a href="#cb64-1852" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-1853"><a href="#cb64-1853" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1854"><a href="#cb64-1854" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-1855"><a href="#cb64-1855" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1856"><a href="#cb64-1856" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-1857"><a href="#cb64-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1858"><a href="#cb64-1858" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-1859"><a href="#cb64-1859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1860"><a href="#cb64-1860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1861"><a href="#cb64-1861" aria-hidden="true" tabindex="-1"></a>Here is a list of the top 30 ASVs.</span>
<span id="cb64-1862"><a href="#cb64-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1865"><a href="#cb64-1865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1866"><a href="#cb64-1866" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1867"><a href="#cb64-1867" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1868"><a href="#cb64-1868" aria-hidden="true" tabindex="-1"></a>ssu18_imp_best_t<span class="sc">$</span>ASV_ID</span>
<span id="cb64-1869"><a href="#cb64-1869" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1870"><a href="#cb64-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1871"><a href="#cb64-1871" aria-hidden="true" tabindex="-1"></a>Now we need to create a phyloseq object of ASVs at this cutoff (<span class="in">`r ssu18_best`</span>).</span>
<span id="cb64-1872"><a href="#cb64-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1875"><a href="#cb64-1875" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1876"><a href="#cb64-1876" aria-hidden="true" tabindex="-1"></a>ssu18_best_val <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(ssu18_best, <span class="st">"Prevalence "</span>, <span class="st">""</span>)</span>
<span id="cb64-1877"><a href="#cb64-1877" aria-hidden="true" tabindex="-1"></a>ssu18_best_val <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"ssu18_prevalences$"</span>, ssu18_best_val, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-1878"><a href="#cb64-1878" aria-hidden="true" tabindex="-1"></a>ssu18_prevalence_best <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> (ssu18_best_val)))</span>
<span id="cb64-1879"><a href="#cb64-1879" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_prevalence_best, <span class="st">"files/filtering/pime/rdata/ssu18_prevalence_best.rds"</span>)</span>
<span id="cb64-1880"><a href="#cb64-1880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1881"><a href="#cb64-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1882"><a href="#cb64-1882" aria-hidden="true" tabindex="-1"></a>And look at a summary of the phyloseq object.</span>
<span id="cb64-1883"><a href="#cb64-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1886"><a href="#cb64-1886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1887"><a href="#cb64-1887" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1888"><a href="#cb64-1888" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1889"><a href="#cb64-1889" aria-hidden="true" tabindex="-1"></a>ssu18_prevalence_best</span>
<span id="cb64-1890"><a href="#cb64-1890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1891"><a href="#cb64-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1894"><a href="#cb64-1894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1895"><a href="#cb64-1895" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1896"><a href="#cb64-1896" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1897"><a href="#cb64-1897" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_prevalence_best"</span>)</span>
<span id="cb64-1898"><a href="#cb64-1898" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb64-1899"><a href="#cb64-1899" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total number of reads"</span>, </span>
<span id="cb64-1900"><a href="#cb64-1900" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of reads"</span>, </span>
<span id="cb64-1901"><a href="#cb64-1901" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of reads"</span>, </span>
<span id="cb64-1902"><a href="#cb64-1902" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of reads"</span>, </span>
<span id="cb64-1903"><a href="#cb64-1903" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of reads"</span>, </span>
<span id="cb64-1904"><a href="#cb64-1904" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total ASVs"</span>, </span>
<span id="cb64-1905"><a href="#cb64-1905" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of ASVs"</span>, </span>
<span id="cb64-1906"><a href="#cb64-1906" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of ASVs"</span>, </span>
<span id="cb64-1907"><a href="#cb64-1907" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of ASVs"</span>, </span>
<span id="cb64-1908"><a href="#cb64-1908" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of ASVs"</span>)</span>
<span id="cb64-1909"><a href="#cb64-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1910"><a href="#cb64-1910" aria-hidden="true" tabindex="-1"></a>tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1911"><a href="#cb64-1911" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1912"><a href="#cb64-1912" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1913"><a href="#cb64-1913" aria-hidden="true" tabindex="-1"></a>   tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_reads, tmp_get))</span>
<span id="cb64-1914"><a href="#cb64-1914" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1915"><a href="#cb64-1915" aria-hidden="true" tabindex="-1"></a>tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1916"><a href="#cb64-1916" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1917"><a href="#cb64-1917" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1918"><a href="#cb64-1918" aria-hidden="true" tabindex="-1"></a>   tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_read, tmp_get))</span>
<span id="cb64-1919"><a href="#cb64-1919" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1920"><a href="#cb64-1920" aria-hidden="true" tabindex="-1"></a>tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1921"><a href="#cb64-1921" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1922"><a href="#cb64-1922" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1923"><a href="#cb64-1923" aria-hidden="true" tabindex="-1"></a>   tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_read, tmp_get))</span>
<span id="cb64-1924"><a href="#cb64-1924" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1925"><a href="#cb64-1925" aria-hidden="true" tabindex="-1"></a>tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1926"><a href="#cb64-1926" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1927"><a href="#cb64-1927" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i))), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-1928"><a href="#cb64-1928" aria-hidden="true" tabindex="-1"></a>   tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_reads, tmp_get))</span>
<span id="cb64-1929"><a href="#cb64-1929" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1930"><a href="#cb64-1930" aria-hidden="true" tabindex="-1"></a>tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1931"><a href="#cb64-1931" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1932"><a href="#cb64-1932" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-1933"><a href="#cb64-1933" aria-hidden="true" tabindex="-1"></a>   tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_median_reads, tmp_get))</span>
<span id="cb64-1934"><a href="#cb64-1934" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1935"><a href="#cb64-1935" aria-hidden="true" tabindex="-1"></a>tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1936"><a href="#cb64-1936" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1937"><a href="#cb64-1937" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-1938"><a href="#cb64-1938" aria-hidden="true" tabindex="-1"></a>   tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_asvs, tmp_get))</span>
<span id="cb64-1939"><a href="#cb64-1939" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1940"><a href="#cb64-1940" aria-hidden="true" tabindex="-1"></a>tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1941"><a href="#cb64-1941" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1942"><a href="#cb64-1942" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-1943"><a href="#cb64-1943" aria-hidden="true" tabindex="-1"></a>   tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_asvs, tmp_get))</span>
<span id="cb64-1944"><a href="#cb64-1944" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1945"><a href="#cb64-1945" aria-hidden="true" tabindex="-1"></a>tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1946"><a href="#cb64-1946" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1947"><a href="#cb64-1947" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-1948"><a href="#cb64-1948" aria-hidden="true" tabindex="-1"></a>   tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_asvs, tmp_get))</span>
<span id="cb64-1949"><a href="#cb64-1949" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1950"><a href="#cb64-1950" aria-hidden="true" tabindex="-1"></a>tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1951"><a href="#cb64-1951" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1952"><a href="#cb64-1952" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-1953"><a href="#cb64-1953" aria-hidden="true" tabindex="-1"></a>   tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_asvs, tmp_get))</span>
<span id="cb64-1954"><a href="#cb64-1954" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1955"><a href="#cb64-1955" aria-hidden="true" tabindex="-1"></a>tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-1956"><a href="#cb64-1956" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-1957"><a href="#cb64-1957" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed)</span>
<span id="cb64-1958"><a href="#cb64-1958" aria-hidden="true" tabindex="-1"></a>   tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_med_asvs, tmp_get))</span>
<span id="cb64-1959"><a href="#cb64-1959" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-1960"><a href="#cb64-1960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1961"><a href="#cb64-1961" aria-hidden="true" tabindex="-1"></a>tmp_bind <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, <span class="fu">list</span>(</span>
<span id="cb64-1962"><a href="#cb64-1962" aria-hidden="true" tabindex="-1"></a>  tmp_total_reads, tmp_min_read, tmp_max_read, tmp_mean_reads, tmp_median_reads, </span>
<span id="cb64-1963"><a href="#cb64-1963" aria-hidden="true" tabindex="-1"></a>  tmp_total_asvs, tmp_min_asvs, tmp_max_asvs, tmp_mean_asvs, tmp_med_asvs)))</span>
<span id="cb64-1964"><a href="#cb64-1964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1965"><a href="#cb64-1965" aria-hidden="true" tabindex="-1"></a>ssu18_sum_pime <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_bind) <span class="sc">%&gt;%</span></span>
<span id="cb64-1966"><a href="#cb64-1966" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Full data"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"PIME filter"</span> <span class="ot">=</span> <span class="dv">3</span>)</span>
<span id="cb64-1967"><a href="#cb64-1967" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-1968"><a href="#cb64-1968" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1969"><a href="#cb64-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1970"><a href="#cb64-1970" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_perfect_filt_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-1971"><a href="#cb64-1971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1974"><a href="#cb64-1974" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1975"><a href="#cb64-1975" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1976"><a href="#cb64-1976" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1977"><a href="#cb64-1977" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_sum_pime</span>
<span id="cb64-1978"><a href="#cb64-1978" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-1979"><a href="#cb64-1979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-1980"><a href="#cb64-1980" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_perfect_filt_summary"</span>,</span>
<span id="cb64-1981"><a href="#cb64-1981" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-1982"><a href="#cb64-1982" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-1983"><a href="#cb64-1983" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-1984"><a href="#cb64-1984" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-1985"><a href="#cb64-1985" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-1986"><a href="#cb64-1986" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-1987"><a href="#cb64-1987" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-1988"><a href="#cb64-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-1991"><a href="#cb64-1991" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-1992"><a href="#cb64-1992" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-1993"><a href="#cb64-1993" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-1994"><a href="#cb64-1994" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_sum_pime</span>
<span id="cb64-1995"><a href="#cb64-1995" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-1996"><a href="#cb64-1996" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-1997"><a href="#cb64-1997" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-1998"><a href="#cb64-1998" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-1999"><a href="#cb64-1999" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2000"><a href="#cb64-2000" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">150</span></span>
<span id="cb64-2001"><a href="#cb64-2001" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2002"><a href="#cb64-2002" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-2003"><a href="#cb64-2003" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-2004"><a href="#cb64-2004" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-2005"><a href="#cb64-2005" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-2006"><a href="#cb64-2006" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-2007"><a href="#cb64-2007" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-2008"><a href="#cb64-2008" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>)</span>
<span id="cb64-2009"><a href="#cb64-2009" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2010"><a href="#cb64-2010" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">10</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2011"><a href="#cb64-2011" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-2012"><a href="#cb64-2012" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2013"><a href="#cb64-2013" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2014"><a href="#cb64-2014" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2015"><a href="#cb64-2015" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-2016"><a href="#cb64-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2017"><a href="#cb64-2017" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-2018"><a href="#cb64-2018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2019"><a href="#cb64-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2020"><a href="#cb64-2020" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimate Error in Prediction</span></span>
<span id="cb64-2021"><a href="#cb64-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2022"><a href="#cb64-2022" aria-hidden="true" tabindex="-1"></a>Using  the function <span class="in">`pime.error.prediction`</span> we can estimate the error in prediction. For each prevalence interval, this function randomizes the samples labels into arbitrary groupings using <span class="in">`n`</span> random permutations, defined by the <span class="in">`bootstrap`</span> value. For each, randomized and prevalence filtered, data set the OOB error rate is calculated to estimate whether the original differences in groups of samples occur by chance. Results are in a list containing a table and a box plot summarizing the results.</span>
<span id="cb64-2023"><a href="#cb64-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2026"><a href="#cb64-2026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2027"><a href="#cb64-2027" aria-hidden="true" tabindex="-1"></a>ssu18_randomized <span class="ot">&lt;-</span> <span class="fu">pime.error.prediction</span>(ssu18_pime_ds, <span class="st">"TEMP"</span>,</span>
<span id="cb64-2028"><a href="#cb64-2028" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">bootstrap =</span> <span class="dv">100</span>, <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2029"><a href="#cb64-2029" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">max.prev =</span> <span class="dv">95</span>)</span>
<span id="cb64-2030"><a href="#cb64-2030" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2031"><a href="#cb64-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2034"><a href="#cb64-2034" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2035"><a href="#cb64-2035" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2036"><a href="#cb64-2036" aria-hidden="true" tabindex="-1"></a>ssu18_oob_error <span class="ot">&lt;-</span> ssu18_randomized<span class="sc">$</span><span class="st">`</span><span class="at">Results table</span><span class="st">`</span></span>
<span id="cb64-2037"><a href="#cb64-2037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2038"><a href="#cb64-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2039"><a href="#cb64-2039" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_pime_est_error")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2040"><a href="#cb64-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2043"><a href="#cb64-2043" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2044"><a href="#cb64-2044" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2045"><a href="#cb64-2045" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2046"><a href="#cb64-2046" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_oob_error</span>
<span id="cb64-2047"><a href="#cb64-2047" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-2048"><a href="#cb64-2048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-2049"><a href="#cb64-2049" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_pime_est_error"</span>,</span>
<span id="cb64-2050"><a href="#cb64-2050" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-2051"><a href="#cb64-2051" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-2052"><a href="#cb64-2052" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-2053"><a href="#cb64-2053" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2054"><a href="#cb64-2054" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2055"><a href="#cb64-2055" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-2056"><a href="#cb64-2056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2057"><a href="#cb64-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2060"><a href="#cb64-2060" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2061"><a href="#cb64-2061" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2062"><a href="#cb64-2062" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2063"><a href="#cb64-2063" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_oob_error  <span class="sc">%&gt;%</span> </span>
<span id="cb64-2064"><a href="#cb64-2064" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb64-2065"><a href="#cb64-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2066"><a href="#cb64-2066" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-2067"><a href="#cb64-2067" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-2068"><a href="#cb64-2068" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-2069"><a href="#cb64-2069" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">4</span>),</span>
<span id="cb64-2070"><a href="#cb64-2070" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2071"><a href="#cb64-2071" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">120</span></span>
<span id="cb64-2072"><a href="#cb64-2072" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2073"><a href="#cb64-2073" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2074"><a href="#cb64-2074" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-2075"><a href="#cb64-2075" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2076"><a href="#cb64-2076" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2077"><a href="#cb64-2077" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2078"><a href="#cb64-2078" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-2079"><a href="#cb64-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2080"><a href="#cb64-2080" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-2081"><a href="#cb64-2081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2082"><a href="#cb64-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2085"><a href="#cb64-2085" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2086"><a href="#cb64-2086" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2087"><a href="#cb64-2087" aria-hidden="true" tabindex="-1"></a>ssu18_randomized<span class="sc">$</span>Plot</span>
<span id="cb64-2088"><a href="#cb64-2088" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2089"><a href="#cb64-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2090"><a href="#cb64-2090" aria-hidden="true" tabindex="-1"></a>It is also possible to estimate the variation of OOB error for each prevalence interval filtering. This is done by running the random forests classification for <span class="in">`n`</span> times, determined by the <span class="in">`bootstrap`</span> value. The function will return a box plot figure and a table for each classification error.</span>
<span id="cb64-2091"><a href="#cb64-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2094"><a href="#cb64-2094" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2095"><a href="#cb64-2095" aria-hidden="true" tabindex="-1"></a>ssu18_replicated.oob.error <span class="ot">&lt;-</span> <span class="fu">pime.oob.replicate</span>(ssu18_prevalences, <span class="st">"TEMP"</span>,</span>
<span id="cb64-2096"><a href="#cb64-2096" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">bootstrap =</span> <span class="dv">100</span>, <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-2097"><a href="#cb64-2097" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2098"><a href="#cb64-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2101"><a href="#cb64-2101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2102"><a href="#cb64-2102" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2103"><a href="#cb64-2103" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2104"><a href="#cb64-2104" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb64-2105"><a href="#cb64-2105" aria-hidden="true" tabindex="-1"></a>ssu18_obb_orig <span class="ot">&lt;-</span> ssu18_replicated.oob.error<span class="sc">$</span>Plot</span>
<span id="cb64-2106"><a href="#cb64-2106" aria-hidden="true" tabindex="-1"></a>ssu18_obb_rand <span class="ot">&lt;-</span> ssu18_randomized<span class="sc">$</span>Plot</span>
<span id="cb64-2107"><a href="#cb64-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2108"><a href="#cb64-2108" aria-hidden="true" tabindex="-1"></a>ssu18_obb_orig <span class="ot">&lt;-</span> ssu18_obb_orig <span class="sc">+</span></span>
<span id="cb64-2109"><a href="#cb64-2109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-2110"><a href="#cb64-2110" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb64-2111"><a href="#cb64-2111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"OOB error Original data set"</span>)</span>
<span id="cb64-2112"><a href="#cb64-2112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2113"><a href="#cb64-2113" aria-hidden="true" tabindex="-1"></a>ssu18_obb_rand <span class="ot">&lt;-</span> ssu18_obb_rand  <span class="sc">+</span></span>
<span id="cb64-2114"><a href="#cb64-2114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"OOB error Randomized data set"</span>)</span>
<span id="cb64-2115"><a href="#cb64-2115" aria-hidden="true" tabindex="-1"></a>ssu18_obb_orig <span class="sc">/</span> ssu18_obb_rand</span>
<span id="cb64-2116"><a href="#cb64-2116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2117"><a href="#cb64-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2118"><a href="#cb64-2118" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_ssu("ssu_pime_obb_plot")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2119"><a href="#cb64-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2120"><a href="#cb64-2120" aria-hidden="true" tabindex="-1"></a>To obtain the confusion matrix from random forests classification use the following:</span>
<span id="cb64-2121"><a href="#cb64-2121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2124"><a href="#cb64-2124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2125"><a href="#cb64-2125" aria-hidden="true" tabindex="-1"></a>ssu18_prev_confuse <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"ssu18_best.prev$`Confusion`$"</span>, ssu18_best, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-2126"><a href="#cb64-2126" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> (ssu18_prev_confuse)))</span>
<span id="cb64-2127"><a href="#cb64-2127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2128"><a href="#cb64-2128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2129"><a href="#cb64-2129" aria-hidden="true" tabindex="-1"></a><span class="fu">### Save Phyloseq PIME objects</span></span>
<span id="cb64-2130"><a href="#cb64-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2133"><a href="#cb64-2133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2134"><a href="#cb64-2134" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime <span class="ot">&lt;-</span> ssu18_prevalence_best</span>
<span id="cb64-2135"><a href="#cb64-2135" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(ssu18_ps_pime), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2136"><a href="#cb64-2136" aria-hidden="true" tabindex="-1"></a>                           <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(ssu18_ps_pime))</span>
<span id="cb64-2137"><a href="#cb64-2137" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(ssu18_ps_pime,</span>
<span id="cb64-2138"><a href="#cb64-2138" aria-hidden="true" tabindex="-1"></a>                               sample_data,</span>
<span id="cb64-2139"><a href="#cb64-2139" aria-hidden="true" tabindex="-1"></a>                               ssu18_ps_pime_tree)</span>
<span id="cb64-2140"><a href="#cb64-2140" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_ps_pime, <span class="st">"files/filtering/pime/rdata/ssu18_ps_pime.rds"</span>)</span>
<span id="cb64-2141"><a href="#cb64-2141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2142"><a href="#cb64-2142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2143"><a href="#cb64-2143" aria-hidden="true" tabindex="-1"></a><span class="fu">### Split &amp; save by predictor variable</span></span>
<span id="cb64-2144"><a href="#cb64-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2147"><a href="#cb64-2147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2148"><a href="#cb64-2148" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ssu18_ps_pime))</span>
<span id="cb64-2149"><a href="#cb64-2149" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_split <span class="ot">&lt;-</span> <span class="fu">pime.split.by.variable</span>(ssu18_ps_pime, <span class="st">"TEMP"</span>)</span>
<span id="cb64-2150"><a href="#cb64-2150" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>, <span class="st">"files/filtering/pime/rdata/ssu18_ps_pime_0.rds"</span>)</span>
<span id="cb64-2151"><a href="#cb64-2151" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">3</span><span class="st">`</span>, <span class="st">"files/filtering/pime/rdata/ssu18_ps_pime_3.rds"</span>)</span>
<span id="cb64-2152"><a href="#cb64-2152" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">8</span><span class="st">`</span>, <span class="st">"files/filtering/pime/rdata/ssu18_ps_pime_8.rds"</span>)</span>
<span id="cb64-2153"><a href="#cb64-2153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2154"><a href="#cb64-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2157"><a href="#cb64-2157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2158"><a href="#cb64-2158" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2159"><a href="#cb64-2159" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2160"><a href="#cb64-2160" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_split</span>
<span id="cb64-2161"><a href="#cb64-2161" aria-hidden="true" tabindex="-1"></a><span class="co">#ssu18_ps_pime_split$`0`</span></span>
<span id="cb64-2162"><a href="#cb64-2162" aria-hidden="true" tabindex="-1"></a><span class="co">#ssu18_ps_pime_split$`3`</span></span>
<span id="cb64-2163"><a href="#cb64-2163" aria-hidden="true" tabindex="-1"></a><span class="co">#ssu18_ps_pime_split$`8`</span></span>
<span id="cb64-2164"><a href="#cb64-2164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2165"><a href="#cb64-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2168"><a href="#cb64-2168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2169"><a href="#cb64-2169" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2170"><a href="#cb64-2170" aria-hidden="true" tabindex="-1"></a>ssu18_pime_preval.tax <span class="ot">&lt;-</span> <span class="fu">tax_table</span>(ssu18_ps_pime)</span>
<span id="cb64-2171"><a href="#cb64-2171" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(ssu18_pime_preval.tax,</span>
<span id="cb64-2172"><a href="#cb64-2172" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="st">"files/filtering/pime/tables/ssu18_asv_PIME_tax_table.txt"</span>,</span>
<span id="cb64-2173"><a href="#cb64-2173" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-2174"><a href="#cb64-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2175"><a href="#cb64-2175" aria-hidden="true" tabindex="-1"></a>ssu18_pime_preval.asv <span class="ot">&lt;-</span> <span class="fu">otu_table</span>(<span class="fu">t</span>(ssu18_ps_pime))</span>
<span id="cb64-2176"><a href="#cb64-2176" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(ssu18_pime_preval.asv,</span>
<span id="cb64-2177"><a href="#cb64-2177" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="st">"files/filtering/pime/tables/ssu18_asv_PIME_otu_table.txt"</span>,</span>
<span id="cb64-2178"><a href="#cb64-2178" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-2179"><a href="#cb64-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2180"><a href="#cb64-2180" aria-hidden="true" tabindex="-1"></a>ssu18_pime_preval.samp <span class="ot">&lt;-</span> <span class="fu">sample_data</span>(ssu18_ps_pime)</span>
<span id="cb64-2181"><a href="#cb64-2181" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(ssu18_pime_preval.samp,</span>
<span id="cb64-2182"><a href="#cb64-2182" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="st">"files/filtering/pime/tables/ssu18_asv_PIME_sample_data.txt"</span>,</span>
<span id="cb64-2183"><a href="#cb64-2183" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-2184"><a href="#cb64-2184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2185"><a href="#cb64-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2186"><a href="#cb64-2186" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb64-2187"><a href="#cb64-2187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2188"><a href="#cb64-2188" aria-hidden="true" tabindex="-1"></a>You know the routine. How did filtering affect total reads and ASVs for each sample?</span>
<span id="cb64-2189"><a href="#cb64-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2192"><a href="#cb64-2192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2193"><a href="#cb64-2193" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2194"><a href="#cb64-2194" aria-hidden="true" tabindex="-1"></a>tmp_read_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_sums</span>(ssu18_ps_pime)) <span class="sc">%&gt;%</span></span>
<span id="cb64-2195"><a href="#cb64-2195" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-2196"><a href="#cb64-2196" aria-hidden="true" tabindex="-1"></a>tmp_asv_count <span class="ot">&lt;-</span> <span class="fu">estimate_richness</span>(ssu18_ps_pime, <span class="at">split =</span> <span class="cn">TRUE</span>, <span class="at">measures =</span> <span class="st">"Observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2197"><a href="#cb64-2197" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-2198"><a href="#cb64-2198" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(ssu18_ps_pime))</span>
<span id="cb64-2199"><a href="#cb64-2199" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> tmp_samp_data[<span class="fu">order</span>(tmp_samp_data<span class="sc">$</span>PLOT, tmp_samp_data<span class="sc">$</span>TEMP),]</span>
<span id="cb64-2200"><a href="#cb64-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2201"><a href="#cb64-2201" aria-hidden="true" tabindex="-1"></a>tmp_join <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp_data, tmp_read_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2202"><a href="#cb64-2202" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_asv_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2203"><a href="#cb64-2203" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2204"><a href="#cb64-2204" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2205"><a href="#cb64-2205" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_asvs"</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb64-2206"><a href="#cb64-2206" aria-hidden="true" tabindex="-1"></a>tmp_join[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-2207"><a href="#cb64-2207" aria-hidden="true" tabindex="-1"></a>ssu_pime_samp_summary <span class="ot">&lt;-</span> tmp_join</span>
<span id="cb64-2208"><a href="#cb64-2208" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-2209"><a href="#cb64-2209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2210"><a href="#cb64-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2211"><a href="#cb64-2211" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu_pime_samp_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2212"><a href="#cb64-2212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2215"><a href="#cb64-2215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2216"><a href="#cb64-2216" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2217"><a href="#cb64-2217" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2218"><a href="#cb64-2218" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu_pime_samp_summary</span>
<span id="cb64-2219"><a href="#cb64-2219" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-2220"><a href="#cb64-2220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-2221"><a href="#cb64-2221" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu_pime_samp_summary"</span>,</span>
<span id="cb64-2222"><a href="#cb64-2222" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-2223"><a href="#cb64-2223" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-2224"><a href="#cb64-2224" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-2225"><a href="#cb64-2225" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2226"><a href="#cb64-2226" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2227"><a href="#cb64-2227" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-2228"><a href="#cb64-2228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2229"><a href="#cb64-2229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2232"><a href="#cb64-2232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2233"><a href="#cb64-2233" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2234"><a href="#cb64-2234" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2235"><a href="#cb64-2235" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-2236"><a href="#cb64-2236" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-2237"><a href="#cb64-2237" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-2238"><a href="#cb64-2238" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-2239"><a href="#cb64-2239" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2240"><a href="#cb64-2240" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-2241"><a href="#cb64-2241" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2242"><a href="#cb64-2242" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-2243"><a href="#cb64-2243" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-2244"><a href="#cb64-2244" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-2245"><a href="#cb64-2245" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-2246"><a href="#cb64-2246" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-2247"><a href="#cb64-2247" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-2248"><a href="#cb64-2248" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-2249"><a href="#cb64-2249" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2250"><a href="#cb64-2250" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2251"><a href="#cb64-2251" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-2252"><a href="#cb64-2252" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2253"><a href="#cb64-2253" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2254"><a href="#cb64-2254" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2255"><a href="#cb64-2255" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-2256"><a href="#cb64-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2257"><a href="#cb64-2257" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-2258"><a href="#cb64-2258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2259"><a href="#cb64-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2260"><a href="#cb64-2260" aria-hidden="true" tabindex="-1"></a>And here is how the subsets changed through the PIME filtering process.</span>
<span id="cb64-2261"><a href="#cb64-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2264"><a href="#cb64-2264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2265"><a href="#cb64-2265" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2266"><a href="#cb64-2266" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2267"><a href="#cb64-2267" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_0 <span class="ot">&lt;-</span> ssu18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span></span>
<span id="cb64-2268"><a href="#cb64-2268" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_3 <span class="ot">&lt;-</span> ssu18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">3</span><span class="st">`</span></span>
<span id="cb64-2269"><a href="#cb64-2269" aria-hidden="true" tabindex="-1"></a>ssu18_ps_pime_8 <span class="ot">&lt;-</span> ssu18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">8</span><span class="st">`</span></span>
<span id="cb64-2270"><a href="#cb64-2270" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"FULL data set"</span>, <span class="st">"Rarefied data"</span>, <span class="st">"PIME filtered data"</span>,</span>
<span id="cb64-2271"><a href="#cb64-2271" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PIME (+0C)"</span>, <span class="st">"PIME (+3C)"</span>, <span class="st">"PIME (+8C)"</span>))</span>
<span id="cb64-2272"><a href="#cb64-2272" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ssu18_ps_work"</span>, <span class="st">"ssu18_pime_ds"</span>, <span class="st">"ssu18_ps_pime"</span>,</span>
<span id="cb64-2273"><a href="#cb64-2273" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ssu18_ps_pime_0"</span>, <span class="st">"ssu18_ps_pime_3"</span>, <span class="st">"ssu18_ps_pime_8"</span>)</span>
<span id="cb64-2274"><a href="#cb64-2274" aria-hidden="true" tabindex="-1"></a>tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2275"><a href="#cb64-2275" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2276"><a href="#cb64-2276" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">nsamples</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-2277"><a href="#cb64-2277" aria-hidden="true" tabindex="-1"></a>   tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_no_samp, tmp_get))</span>
<span id="cb64-2278"><a href="#cb64-2278" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2279"><a href="#cb64-2279" aria-hidden="true" tabindex="-1"></a>tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_no_samp)</span>
<span id="cb64-2280"><a href="#cb64-2280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2281"><a href="#cb64-2281" aria-hidden="true" tabindex="-1"></a>tmp_rc <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2282"><a href="#cb64-2282" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2283"><a href="#cb64-2283" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-2284"><a href="#cb64-2284" aria-hidden="true" tabindex="-1"></a>   tmp_rc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_rc, tmp_get))</span>
<span id="cb64-2285"><a href="#cb64-2285" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2286"><a href="#cb64-2286" aria-hidden="true" tabindex="-1"></a>tmp_rc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_rc)</span>
<span id="cb64-2287"><a href="#cb64-2287" aria-hidden="true" tabindex="-1"></a>tmp_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2288"><a href="#cb64-2288" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2289"><a href="#cb64-2289" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-2290"><a href="#cb64-2290" aria-hidden="true" tabindex="-1"></a>   tmp_asv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_asv, tmp_get))</span>
<span id="cb64-2291"><a href="#cb64-2291" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2292"><a href="#cb64-2292" aria-hidden="true" tabindex="-1"></a>tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_asv)</span>
<span id="cb64-2293"><a href="#cb64-2293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2294"><a href="#cb64-2294" aria-hidden="true" tabindex="-1"></a>ssu18_asv_pime_sum <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_no_samp) <span class="sc">%&gt;%</span></span>
<span id="cb64-2295"><a href="#cb64-2295" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_rc) <span class="sc">%&gt;%</span></span>
<span id="cb64-2296"><a href="#cb64-2296" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_asv) <span class="sc">%&gt;%</span></span>
<span id="cb64-2297"><a href="#cb64-2297" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Description"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"no. samples"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb64-2298"><a href="#cb64-2298" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total reads"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"total asvs"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb64-2299"><a href="#cb64-2299" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-2300"><a href="#cb64-2300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2301"><a href="#cb64-2301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2302"><a href="#cb64-2302" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_ssu("ssu18_asv_pime_sum")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2303"><a href="#cb64-2303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2306"><a href="#cb64-2306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2307"><a href="#cb64-2307" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2308"><a href="#cb64-2308" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2309"><a href="#cb64-2309" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> ssu18_asv_pime_sum</span>
<span id="cb64-2310"><a href="#cb64-2310" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-2311"><a href="#cb64-2311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-2312"><a href="#cb64-2312" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"ssu18_asv_pime_sum"</span>,</span>
<span id="cb64-2313"><a href="#cb64-2313" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-2314"><a href="#cb64-2314" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-2315"><a href="#cb64-2315" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-2316"><a href="#cb64-2316" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2317"><a href="#cb64-2317" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2318"><a href="#cb64-2318" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-2319"><a href="#cb64-2319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2320"><a href="#cb64-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2323"><a href="#cb64-2323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2324"><a href="#cb64-2324" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2325"><a href="#cb64-2325" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2326"><a href="#cb64-2326" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-2327"><a href="#cb64-2327" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-2328"><a href="#cb64-2328" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-2329"><a href="#cb64-2329" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-2330"><a href="#cb64-2330" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">FALSE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2331"><a href="#cb64-2331" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-2332"><a href="#cb64-2332" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2333"><a href="#cb64-2333" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-2334"><a href="#cb64-2334" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Description"</span>, </span>
<span id="cb64-2335"><a href="#cb64-2335" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-2336"><a href="#cb64-2336" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-2337"><a href="#cb64-2337" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-2338"><a href="#cb64-2338" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-2339"><a href="#cb64-2339" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-2340"><a href="#cb64-2340" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2341"><a href="#cb64-2341" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">6</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2342"><a href="#cb64-2342" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-2343"><a href="#cb64-2343" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2344"><a href="#cb64-2344" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2345"><a href="#cb64-2345" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2346"><a href="#cb64-2346" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-2347"><a href="#cb64-2347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2348"><a href="#cb64-2348" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-2349"><a href="#cb64-2349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2350"><a href="#cb64-2350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2351"><a href="#cb64-2351" aria-hidden="true" tabindex="-1"></a><span class="fu">## ITS</span></span>
<span id="cb64-2352"><a href="#cb64-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2353"><a href="#cb64-2353" aria-hidden="true" tabindex="-1"></a><span class="fu">### Setup</span></span>
<span id="cb64-2354"><a href="#cb64-2354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2355"><a href="#cb64-2355" aria-hidden="true" tabindex="-1"></a>First, choose a phyloseq object and a sample data frame</span>
<span id="cb64-2356"><a href="#cb64-2356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2359"><a href="#cb64-2359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2360"><a href="#cb64-2360" aria-hidden="true" tabindex="-1"></a>its18_pime_ds <span class="ot">&lt;-</span> its18_ps_work</span>
<span id="cb64-2361"><a href="#cb64-2361" aria-hidden="true" tabindex="-1"></a>its18_which_pime <span class="ot">&lt;-</span> <span class="st">"its18_pime_ds"</span></span>
<span id="cb64-2362"><a href="#cb64-2362" aria-hidden="true" tabindex="-1"></a>its18_pime_ds<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-2363"><a href="#cb64-2363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2364"><a href="#cb64-2364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2367"><a href="#cb64-2367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2368"><a href="#cb64-2368" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2369"><a href="#cb64-2369" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2370"><a href="#cb64-2370" aria-hidden="true" tabindex="-1"></a>its18_ps_work</span>
<span id="cb64-2371"><a href="#cb64-2371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2372"><a href="#cb64-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2375"><a href="#cb64-2375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2376"><a href="#cb64-2376" aria-hidden="true" tabindex="-1"></a>its18_pime_sample_d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(<span class="fu">otu_table</span>(its18_pime_ds_full)))</span>
<span id="cb64-2377"><a href="#cb64-2377" aria-hidden="true" tabindex="-1"></a>its18_pime_sample_d <span class="ot">&lt;-</span> its18_pime_sample_d <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">total_reads =</span> <span class="dv">1</span>)</span>
<span id="cb64-2378"><a href="#cb64-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2379"><a href="#cb64-2379" aria-hidden="true" tabindex="-1"></a>its18_pime_ds <span class="ot">&lt;-</span> <span class="fu">rarefy_even_depth</span>(its18_pime_ds_full,</span>
<span id="cb64-2380"><a href="#cb64-2380" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sample.size =</span> <span class="fu">min</span>(its18_pime_sample_d<span class="sc">$</span>total_reads),</span>
<span id="cb64-2381"><a href="#cb64-2381" aria-hidden="true" tabindex="-1"></a>                               <span class="at">trimOTUs =</span> <span class="cn">TRUE</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2382"><a href="#cb64-2382" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rngseed =</span> <span class="dv">119</span>)</span>
<span id="cb64-2383"><a href="#cb64-2383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2384"><a href="#cb64-2384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2385"><a href="#cb64-2385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2386"><a href="#cb64-2386" aria-hidden="true" tabindex="-1"></a><span class="in">298 OTUs were removed because they are no longer </span></span>
<span id="cb64-2387"><a href="#cb64-2387" aria-hidden="true" tabindex="-1"></a><span class="in">present in any sample after random subsampling</span></span>
<span id="cb64-2388"><a href="#cb64-2388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2389"><a href="#cb64-2389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2392"><a href="#cb64-2392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2393"><a href="#cb64-2393" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2394"><a href="#cb64-2394" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2395"><a href="#cb64-2395" aria-hidden="true" tabindex="-1"></a>its18_pime_ds</span>
<span id="cb64-2396"><a href="#cb64-2396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2397"><a href="#cb64-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2398"><a href="#cb64-2398" aria-hidden="true" tabindex="-1"></a>The first step in PIME is to define if the microbial community presents a high relative abundance of taxa with low prevalence, which is considered as noise in PIME analysis. This is calculated by random forests analysis and is the baseline noise detection.</span>
<span id="cb64-2399"><a href="#cb64-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2402"><a href="#cb64-2402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2403"><a href="#cb64-2403" aria-hidden="true" tabindex="-1"></a>its18_pime.oob.error <span class="ot">&lt;-</span> <span class="fu">pime.oob.error</span>(its18_pime_ds, <span class="st">"TEMP"</span>)</span>
<span id="cb64-2404"><a href="#cb64-2404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2405"><a href="#cb64-2405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2408"><a href="#cb64-2408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2409"><a href="#cb64-2409" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2410"><a href="#cb64-2410" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2411"><a href="#cb64-2411" aria-hidden="true" tabindex="-1"></a>its18_pime.oob.error</span>
<span id="cb64-2412"><a href="#cb64-2412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2413"><a href="#cb64-2413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2414"><a href="#cb64-2414" aria-hidden="true" tabindex="-1"></a><span class="fu">### Split by Predictor Variable</span></span>
<span id="cb64-2415"><a href="#cb64-2415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2418"><a href="#cb64-2418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2419"><a href="#cb64-2419" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(its18_pime_ds))</span>
<span id="cb64-2420"><a href="#cb64-2420" aria-hidden="true" tabindex="-1"></a>its18_per_variable_obj <span class="ot">&lt;-</span> <span class="fu">pime.split.by.variable</span>(its18_pime_ds, <span class="st">"TEMP"</span>)</span>
<span id="cb64-2421"><a href="#cb64-2421" aria-hidden="true" tabindex="-1"></a>its18_per_variable_obj</span>
<span id="cb64-2422"><a href="#cb64-2422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2423"><a href="#cb64-2423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2426"><a href="#cb64-2426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2427"><a href="#cb64-2427" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2428"><a href="#cb64-2428" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2429"><a href="#cb64-2429" aria-hidden="true" tabindex="-1"></a>its18_per_variable_obj</span>
<span id="cb64-2430"><a href="#cb64-2430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2431"><a href="#cb64-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2432"><a href="#cb64-2432" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate Prevalence Intervals</span></span>
<span id="cb64-2433"><a href="#cb64-2433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2434"><a href="#cb64-2434" aria-hidden="true" tabindex="-1"></a>Using the output of <span class="in">`pime.split.by.variable`</span>, we calculate the prevalence intervals with the function <span class="in">`pime.prevalence`</span>. This function estimates the highest prevalence possible (no empty ASV table), calculates prevalence for taxa, starting at 5 maximum prevalence possible (no empty ASV table or dropping samples). After prevalence calculation, each prevalence interval are merged.</span>
<span id="cb64-2435"><a href="#cb64-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2438"><a href="#cb64-2438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2439"><a href="#cb64-2439" aria-hidden="true" tabindex="-1"></a>its18_prevalences <span class="ot">&lt;-</span> <span class="fu">pime.prevalence</span>(its18_per_variable_obj)</span>
<span id="cb64-2440"><a href="#cb64-2440" aria-hidden="true" tabindex="-1"></a>its18_prevalences</span>
<span id="cb64-2441"><a href="#cb64-2441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2442"><a href="#cb64-2442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2443"><a href="#cb64-2443" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details</span> <span class="er">markdown</span><span class="ot">=</span><span class="st">"1"</span><span class="kw">&gt;</span></span>
<span id="cb64-2444"><a href="#cb64-2444" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;</span>Detailed results for all prevalences intervals  <span class="kw">&lt;/summary&gt;</span></span>
<span id="cb64-2445"><a href="#cb64-2445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2448"><a href="#cb64-2448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2449"><a href="#cb64-2449" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2450"><a href="#cb64-2450" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2451"><a href="#cb64-2451" aria-hidden="true" tabindex="-1"></a>its18_prevalences</span>
<span id="cb64-2452"><a href="#cb64-2452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2453"><a href="#cb64-2453" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb64-2454"><a href="#cb64-2454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2455"><a href="#cb64-2455" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate Best Prevalence</span></span>
<span id="cb64-2456"><a href="#cb64-2456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2457"><a href="#cb64-2457" aria-hidden="true" tabindex="-1"></a>Finally, we use the function <span class="in">`pime.best.prevalence`</span> to calculate the best prevalence. The function uses randomForest to build random forests trees for samples classification and variable importance computation. It performs classifications for each prevalence interval returned by <span class="in">`pime.prevalence`</span>. Variable importance is calculated, returning the Mean Decrease Accuracy (MDA), Mean Decrease Impurity (MDI), overall and by sample group, and taxonomy for each ASV. PIME keeps the top 30 variables with highest MDA each prevalence level.</span>
<span id="cb64-2458"><a href="#cb64-2458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2461"><a href="#cb64-2461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2462"><a href="#cb64-2462" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1911</span>)</span>
<span id="cb64-2463"><a href="#cb64-2463" aria-hidden="true" tabindex="-1"></a>its18_best.prev <span class="ot">&lt;-</span> <span class="fu">pime.best.prevalence</span>(its18_prevalences, <span class="st">"TEMP"</span>)</span>
<span id="cb64-2464"><a href="#cb64-2464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2465"><a href="#cb64-2465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2468"><a href="#cb64-2468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2469"><a href="#cb64-2469" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2470"><a href="#cb64-2470" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2471"><a href="#cb64-2471" aria-hidden="true" tabindex="-1"></a>its18_best.prev<span class="sc">$</span><span class="st">`</span><span class="at">OOB error</span><span class="st">`</span></span>
<span id="cb64-2472"><a href="#cb64-2472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2473"><a href="#cb64-2473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2476"><a href="#cb64-2476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2477"><a href="#cb64-2477" aria-hidden="true" tabindex="-1"></a>its18_what_is_best <span class="ot">&lt;-</span> its18_best.prev<span class="sc">$</span><span class="st">`</span><span class="at">OOB error</span><span class="st">`</span></span>
<span id="cb64-2478"><a href="#cb64-2478" aria-hidden="true" tabindex="-1"></a>its18_what_is_best[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(its18_what_is_best[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], as.numeric)</span>
<span id="cb64-2479"><a href="#cb64-2479" aria-hidden="true" tabindex="-1"></a>its18_what_is_best <span class="ot">&lt;-</span> its18_what_is_best <span class="sc">%&gt;%</span></span>
<span id="cb64-2480"><a href="#cb64-2480" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"OOB_error_rate"</span> <span class="ot">=</span> <span class="st">"OOB error rate (%)"</span>)</span>
<span id="cb64-2481"><a href="#cb64-2481" aria-hidden="true" tabindex="-1"></a>its18_what_is_best<span class="sc">$</span>Interval <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(its18_what_is_best<span class="sc">$</span>Interval, <span class="st">"%"</span>, <span class="st">""</span>)</span>
<span id="cb64-2482"><a href="#cb64-2482" aria-hidden="true" tabindex="-1"></a>its18_best <span class="ot">&lt;-</span> <span class="fu">with</span>(its18_what_is_best, Interval[<span class="fu">which.min</span>(OOB_error_rate)])</span>
<span id="cb64-2483"><a href="#cb64-2483" aria-hidden="true" tabindex="-1"></a>its18_best <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"`"</span>, its18_best, <span class="st">"`"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-2484"><a href="#cb64-2484" aria-hidden="true" tabindex="-1"></a>its18_prev_choice <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"its18_best.prev$`Importance`$"</span>, its18_best, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-2485"><a href="#cb64-2485" aria-hidden="true" tabindex="-1"></a>its18_imp_best <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> (its18_prev_choice)))</span>
<span id="cb64-2486"><a href="#cb64-2486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2487"><a href="#cb64-2487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2488"><a href="#cb64-2488" aria-hidden="true" tabindex="-1"></a>Looks like the lowest OOB error rate (%) that retains the most ASVs is <span class="in">`r min(its18_what_is_best$OOB_error_rate)`</span>% from <span class="in">`r its18_best`</span>. We will use this interval.</span>
<span id="cb64-2489"><a href="#cb64-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2490"><a href="#cb64-2490" aria-hidden="true" tabindex="-1"></a><span class="fu">### Best Prevalence Summary</span></span>
<span id="cb64-2491"><a href="#cb64-2491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2494"><a href="#cb64-2494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2495"><a href="#cb64-2495" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2496"><a href="#cb64-2496" aria-hidden="true" tabindex="-1"></a>its18_imp_best[, <span class="dv">13</span><span class="sc">:</span><span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb64-2497"><a href="#cb64-2497" aria-hidden="true" tabindex="-1"></a>its18_imp_best <span class="ot">&lt;-</span> its18_imp_best <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"ASV_ID"</span> <span class="ot">=</span> <span class="st">"SequenceID"</span>)</span>
<span id="cb64-2498"><a href="#cb64-2498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2499"><a href="#cb64-2499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2500"><a href="#cb64-2500" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_pime_filt_top_asvs")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2501"><a href="#cb64-2501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2504"><a href="#cb64-2504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2505"><a href="#cb64-2505" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2506"><a href="#cb64-2506" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2507"><a href="#cb64-2507" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_imp_best</span>
<span id="cb64-2508"><a href="#cb64-2508" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-2509"><a href="#cb64-2509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-2510"><a href="#cb64-2510" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_pime_filt_top_asvs"</span>,</span>
<span id="cb64-2511"><a href="#cb64-2511" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-2512"><a href="#cb64-2512" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-2513"><a href="#cb64-2513" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-2514"><a href="#cb64-2514" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2515"><a href="#cb64-2515" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2516"><a href="#cb64-2516" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-2517"><a href="#cb64-2517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2518"><a href="#cb64-2518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2519"><a href="#cb64-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2522"><a href="#cb64-2522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2523"><a href="#cb64-2523" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2524"><a href="#cb64-2524" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2525"><a href="#cb64-2525" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_imp_best <span class="sc">%&gt;%</span></span>
<span id="cb64-2526"><a href="#cb64-2526" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Control"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Warm_3"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Warm_8"</span> <span class="ot">=</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-2527"><a href="#cb64-2527" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb64-2528"><a href="#cb64-2528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2529"><a href="#cb64-2529" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-2530"><a href="#cb64-2530" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-2531"><a href="#cb64-2531" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-2532"><a href="#cb64-2532" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">4</span>),</span>
<span id="cb64-2533"><a href="#cb64-2533" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2534"><a href="#cb64-2534" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-2535"><a href="#cb64-2535" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2536"><a href="#cb64-2536" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-2537"><a href="#cb64-2537" aria-hidden="true" tabindex="-1"></a>    <span class="at">ASV_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"ASV ID"</span>, </span>
<span id="cb64-2538"><a href="#cb64-2538" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-2539"><a href="#cb64-2539" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-2540"><a href="#cb64-2540" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-2541"><a href="#cb64-2541" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-2542"><a href="#cb64-2542" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">100</span>),</span>
<span id="cb64-2543"><a href="#cb64-2543" aria-hidden="true" tabindex="-1"></a>    <span class="at">Kingdom =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-2544"><a href="#cb64-2544" aria-hidden="true" tabindex="-1"></a>    <span class="at">Phylum =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-2545"><a href="#cb64-2545" aria-hidden="true" tabindex="-1"></a>    <span class="at">Class =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-2546"><a href="#cb64-2546" aria-hidden="true" tabindex="-1"></a>    <span class="at">Order =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-2547"><a href="#cb64-2547" aria-hidden="true" tabindex="-1"></a>    <span class="at">Family =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb64-2548"><a href="#cb64-2548" aria-hidden="true" tabindex="-1"></a>    <span class="at">Genus =</span> <span class="fu">colDef</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-2549"><a href="#cb64-2549" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2550"><a href="#cb64-2550" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2551"><a href="#cb64-2551" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-2552"><a href="#cb64-2552" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2553"><a href="#cb64-2553" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2554"><a href="#cb64-2554" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2555"><a href="#cb64-2555" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-2556"><a href="#cb64-2556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2557"><a href="#cb64-2557" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-2558"><a href="#cb64-2558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2559"><a href="#cb64-2559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2562"><a href="#cb64-2562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2563"><a href="#cb64-2563" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2564"><a href="#cb64-2564" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2565"><a href="#cb64-2565" aria-hidden="true" tabindex="-1"></a>its18_imp_best_t<span class="sc">$</span>ASV_ID</span>
<span id="cb64-2566"><a href="#cb64-2566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2567"><a href="#cb64-2567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2568"><a href="#cb64-2568" aria-hidden="true" tabindex="-1"></a>Now we need to create a phyloseq object of ASVs at this cutoff (<span class="in">`r its18_best`</span>).</span>
<span id="cb64-2569"><a href="#cb64-2569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2572"><a href="#cb64-2572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2573"><a href="#cb64-2573" aria-hidden="true" tabindex="-1"></a>its18_best_val <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(its18_best, <span class="st">"Prevalence "</span>, <span class="st">""</span>)</span>
<span id="cb64-2574"><a href="#cb64-2574" aria-hidden="true" tabindex="-1"></a>its18_best_val <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"its18_prevalences$"</span>, its18_best_val, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-2575"><a href="#cb64-2575" aria-hidden="true" tabindex="-1"></a>its18_prevalence_best <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> (its18_best_val)))</span>
<span id="cb64-2576"><a href="#cb64-2576" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_prevalence_best, <span class="st">"files/filtering/pime/rdata/its18_asv_prevalence_best.rds"</span>)</span>
<span id="cb64-2577"><a href="#cb64-2577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2578"><a href="#cb64-2578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2579"><a href="#cb64-2579" aria-hidden="true" tabindex="-1"></a>And look at a summary of the data.</span>
<span id="cb64-2580"><a href="#cb64-2580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2583"><a href="#cb64-2583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2584"><a href="#cb64-2584" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2585"><a href="#cb64-2585" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2586"><a href="#cb64-2586" aria-hidden="true" tabindex="-1"></a>its18_prevalence_best</span>
<span id="cb64-2587"><a href="#cb64-2587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2588"><a href="#cb64-2588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2591"><a href="#cb64-2591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2592"><a href="#cb64-2592" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2593"><a href="#cb64-2593" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-2594"><a href="#cb64-2594" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_prevalence_best"</span>)</span>
<span id="cb64-2595"><a href="#cb64-2595" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb64-2596"><a href="#cb64-2596" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total number of reads"</span>, </span>
<span id="cb64-2597"><a href="#cb64-2597" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of reads"</span>, </span>
<span id="cb64-2598"><a href="#cb64-2598" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of reads"</span>, </span>
<span id="cb64-2599"><a href="#cb64-2599" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of reads"</span>, </span>
<span id="cb64-2600"><a href="#cb64-2600" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of reads"</span>, </span>
<span id="cb64-2601"><a href="#cb64-2601" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Total ASVs"</span>, </span>
<span id="cb64-2602"><a href="#cb64-2602" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Min. number of ASVs"</span>, </span>
<span id="cb64-2603"><a href="#cb64-2603" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Max. number of ASVs"</span>, </span>
<span id="cb64-2604"><a href="#cb64-2604" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Average number of ASVs"</span>, </span>
<span id="cb64-2605"><a href="#cb64-2605" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Median number of ASVs"</span>)</span>
<span id="cb64-2606"><a href="#cb64-2606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2607"><a href="#cb64-2607" aria-hidden="true" tabindex="-1"></a>tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2608"><a href="#cb64-2608" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2609"><a href="#cb64-2609" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-2610"><a href="#cb64-2610" aria-hidden="true" tabindex="-1"></a>   tmp_total_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_reads, tmp_get))</span>
<span id="cb64-2611"><a href="#cb64-2611" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2612"><a href="#cb64-2612" aria-hidden="true" tabindex="-1"></a>tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2613"><a href="#cb64-2613" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2614"><a href="#cb64-2614" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-2615"><a href="#cb64-2615" aria-hidden="true" tabindex="-1"></a>   tmp_min_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_read, tmp_get))</span>
<span id="cb64-2616"><a href="#cb64-2616" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2617"><a href="#cb64-2617" aria-hidden="true" tabindex="-1"></a>tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2618"><a href="#cb64-2618" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2619"><a href="#cb64-2619" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-2620"><a href="#cb64-2620" aria-hidden="true" tabindex="-1"></a>   tmp_max_read <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_read, tmp_get))</span>
<span id="cb64-2621"><a href="#cb64-2621" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2622"><a href="#cb64-2622" aria-hidden="true" tabindex="-1"></a>tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2623"><a href="#cb64-2623" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2624"><a href="#cb64-2624" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i))), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-2625"><a href="#cb64-2625" aria-hidden="true" tabindex="-1"></a>   tmp_mean_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_reads, tmp_get))</span>
<span id="cb64-2626"><a href="#cb64-2626" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2627"><a href="#cb64-2627" aria-hidden="true" tabindex="-1"></a>tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2628"><a href="#cb64-2628" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2629"><a href="#cb64-2629" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-2630"><a href="#cb64-2630" aria-hidden="true" tabindex="-1"></a>   tmp_median_reads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_median_reads, tmp_get))</span>
<span id="cb64-2631"><a href="#cb64-2631" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2632"><a href="#cb64-2632" aria-hidden="true" tabindex="-1"></a>tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2633"><a href="#cb64-2633" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2634"><a href="#cb64-2634" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-2635"><a href="#cb64-2635" aria-hidden="true" tabindex="-1"></a>   tmp_total_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_total_asvs, tmp_get))</span>
<span id="cb64-2636"><a href="#cb64-2636" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2637"><a href="#cb64-2637" aria-hidden="true" tabindex="-1"></a>tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2638"><a href="#cb64-2638" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2639"><a href="#cb64-2639" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-2640"><a href="#cb64-2640" aria-hidden="true" tabindex="-1"></a>   tmp_min_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_min_asvs, tmp_get))</span>
<span id="cb64-2641"><a href="#cb64-2641" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2642"><a href="#cb64-2642" aria-hidden="true" tabindex="-1"></a>tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2643"><a href="#cb64-2643" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2644"><a href="#cb64-2644" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>))</span>
<span id="cb64-2645"><a href="#cb64-2645" aria-hidden="true" tabindex="-1"></a>   tmp_max_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_max_asvs, tmp_get))</span>
<span id="cb64-2646"><a href="#cb64-2646" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2647"><a href="#cb64-2647" aria-hidden="true" tabindex="-1"></a>tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2648"><a href="#cb64-2648" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2649"><a href="#cb64-2649" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb64-2650"><a href="#cb64-2650" aria-hidden="true" tabindex="-1"></a>   tmp_mean_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_mean_asvs, tmp_get))</span>
<span id="cb64-2651"><a href="#cb64-2651" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2652"><a href="#cb64-2652" aria-hidden="true" tabindex="-1"></a>tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2653"><a href="#cb64-2653" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2654"><a href="#cb64-2654" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">richness</span>(<span class="fu">get</span>(i), <span class="at">index =</span> <span class="st">"observed"</span>)<span class="sc">$</span>observed)</span>
<span id="cb64-2655"><a href="#cb64-2655" aria-hidden="true" tabindex="-1"></a>   tmp_med_asvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_med_asvs, tmp_get))</span>
<span id="cb64-2656"><a href="#cb64-2656" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2657"><a href="#cb64-2657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2658"><a href="#cb64-2658" aria-hidden="true" tabindex="-1"></a>tmp_bind <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">do.call</span>(<span class="st">"rbind"</span>, <span class="fu">list</span>(</span>
<span id="cb64-2659"><a href="#cb64-2659" aria-hidden="true" tabindex="-1"></a>  tmp_total_reads, tmp_min_read, tmp_max_read, tmp_mean_reads, tmp_median_reads, </span>
<span id="cb64-2660"><a href="#cb64-2660" aria-hidden="true" tabindex="-1"></a>  tmp_total_asvs, tmp_min_asvs, tmp_max_asvs, tmp_mean_asvs, tmp_med_asvs)))</span>
<span id="cb64-2661"><a href="#cb64-2661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2662"><a href="#cb64-2662" aria-hidden="true" tabindex="-1"></a>its18_sum_pime <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_bind) <span class="sc">%&gt;%</span></span>
<span id="cb64-2663"><a href="#cb64-2663" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Metric"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Full data"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"PIME filter"</span> <span class="ot">=</span> <span class="dv">3</span>)</span>
<span id="cb64-2664"><a href="#cb64-2664" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-2665"><a href="#cb64-2665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2666"><a href="#cb64-2666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2667"><a href="#cb64-2667" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_perfect_filt_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2668"><a href="#cb64-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2671"><a href="#cb64-2671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2672"><a href="#cb64-2672" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2673"><a href="#cb64-2673" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2674"><a href="#cb64-2674" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_sum_pime</span>
<span id="cb64-2675"><a href="#cb64-2675" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-2676"><a href="#cb64-2676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-2677"><a href="#cb64-2677" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_perfect_filt_summary"</span>,</span>
<span id="cb64-2678"><a href="#cb64-2678" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-2679"><a href="#cb64-2679" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-2680"><a href="#cb64-2680" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-2681"><a href="#cb64-2681" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2682"><a href="#cb64-2682" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2683"><a href="#cb64-2683" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-2684"><a href="#cb64-2684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2685"><a href="#cb64-2685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2686"><a href="#cb64-2686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2689"><a href="#cb64-2689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2690"><a href="#cb64-2690" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2691"><a href="#cb64-2691" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2692"><a href="#cb64-2692" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_sum_pime</span>
<span id="cb64-2693"><a href="#cb64-2693" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-2694"><a href="#cb64-2694" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-2695"><a href="#cb64-2695" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-2696"><a href="#cb64-2696" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-2697"><a href="#cb64-2697" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2698"><a href="#cb64-2698" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">150</span></span>
<span id="cb64-2699"><a href="#cb64-2699" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2700"><a href="#cb64-2700" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-2701"><a href="#cb64-2701" aria-hidden="true" tabindex="-1"></a>    <span class="at">Metric =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metric"</span>, </span>
<span id="cb64-2702"><a href="#cb64-2702" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-2703"><a href="#cb64-2703" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-2704"><a href="#cb64-2704" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-2705"><a href="#cb64-2705" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-2706"><a href="#cb64-2706" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">200</span>)</span>
<span id="cb64-2707"><a href="#cb64-2707" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2708"><a href="#cb64-2708" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">10</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2709"><a href="#cb64-2709" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-2710"><a href="#cb64-2710" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2711"><a href="#cb64-2711" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2712"><a href="#cb64-2712" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2713"><a href="#cb64-2713" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-2714"><a href="#cb64-2714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2715"><a href="#cb64-2715" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-2716"><a href="#cb64-2716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2717"><a href="#cb64-2717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2718"><a href="#cb64-2718" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimate Error in Prediction</span></span>
<span id="cb64-2719"><a href="#cb64-2719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2720"><a href="#cb64-2720" aria-hidden="true" tabindex="-1"></a>Using  the function <span class="in">`pime.error.prediction`</span> we can estimate the error in prediction. For each prevalence interval, this function randomizes the samples labels into arbitrary groupings using <span class="in">`n`</span> random permutations, defined by the <span class="in">`bootstrap`</span> value. For each, randomized and prevalence filtered, data set the OOB error rate is calculated to estimate whether the original differences in groups of samples occur by chance. Results are in a list containing a table and a box plot summarizing the results.</span>
<span id="cb64-2721"><a href="#cb64-2721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2724"><a href="#cb64-2724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2725"><a href="#cb64-2725" aria-hidden="true" tabindex="-1"></a>its18_randomized <span class="ot">&lt;-</span> <span class="fu">pime.error.prediction</span>(its18_pime_ds, <span class="st">"TEMP"</span>,</span>
<span id="cb64-2726"><a href="#cb64-2726" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">bootstrap =</span> <span class="dv">100</span>, <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2727"><a href="#cb64-2727" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">max.prev =</span> <span class="dv">95</span>)</span>
<span id="cb64-2728"><a href="#cb64-2728" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2729"><a href="#cb64-2729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2732"><a href="#cb64-2732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2733"><a href="#cb64-2733" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2734"><a href="#cb64-2734" aria-hidden="true" tabindex="-1"></a>its18_oob_error <span class="ot">&lt;-</span> its18_randomized<span class="sc">$</span><span class="st">`</span><span class="at">Results table</span><span class="st">`</span></span>
<span id="cb64-2735"><a href="#cb64-2735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2736"><a href="#cb64-2736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2737"><a href="#cb64-2737" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_pime_est_error")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2738"><a href="#cb64-2738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2741"><a href="#cb64-2741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2742"><a href="#cb64-2742" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2743"><a href="#cb64-2743" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2744"><a href="#cb64-2744" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_oob_error</span>
<span id="cb64-2745"><a href="#cb64-2745" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-2746"><a href="#cb64-2746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-2747"><a href="#cb64-2747" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_pime_est_error"</span>,</span>
<span id="cb64-2748"><a href="#cb64-2748" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-2749"><a href="#cb64-2749" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-2750"><a href="#cb64-2750" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-2751"><a href="#cb64-2751" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2752"><a href="#cb64-2752" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2753"><a href="#cb64-2753" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-2754"><a href="#cb64-2754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2755"><a href="#cb64-2755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2758"><a href="#cb64-2758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2759"><a href="#cb64-2759" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2760"><a href="#cb64-2760" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2761"><a href="#cb64-2761" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_oob_error  <span class="sc">%&gt;%</span> </span>
<span id="cb64-2762"><a href="#cb64-2762" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb64-2763"><a href="#cb64-2763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2764"><a href="#cb64-2764" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-2765"><a href="#cb64-2765" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-2766"><a href="#cb64-2766" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-2767"><a href="#cb64-2767" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">4</span>),</span>
<span id="cb64-2768"><a href="#cb64-2768" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2769"><a href="#cb64-2769" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">120</span></span>
<span id="cb64-2770"><a href="#cb64-2770" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2771"><a href="#cb64-2771" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2772"><a href="#cb64-2772" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-2773"><a href="#cb64-2773" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2774"><a href="#cb64-2774" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2775"><a href="#cb64-2775" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2776"><a href="#cb64-2776" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-2777"><a href="#cb64-2777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2778"><a href="#cb64-2778" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-2779"><a href="#cb64-2779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2780"><a href="#cb64-2780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2783"><a href="#cb64-2783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2784"><a href="#cb64-2784" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2785"><a href="#cb64-2785" aria-hidden="true" tabindex="-1"></a>its18_randomized<span class="sc">$</span>Plot</span>
<span id="cb64-2786"><a href="#cb64-2786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2787"><a href="#cb64-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2788"><a href="#cb64-2788" aria-hidden="true" tabindex="-1"></a>It is also possible to estimate the variation of OOB error for each prevalence interval filtering. This is done by running the random forests classification for <span class="in">`n`</span> times, determined by the <span class="in">`bootstrap`</span> value. The function will return a box plot figure and a table for each classification error.</span>
<span id="cb64-2789"><a href="#cb64-2789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2792"><a href="#cb64-2792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2793"><a href="#cb64-2793" aria-hidden="true" tabindex="-1"></a>its18_replicated.oob.error <span class="ot">&lt;-</span> <span class="fu">pime.oob.replicate</span>(its18_prevalences, <span class="st">"TEMP"</span>,</span>
<span id="cb64-2794"><a href="#cb64-2794" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">bootstrap =</span> <span class="dv">100</span>, <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-2795"><a href="#cb64-2795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2796"><a href="#cb64-2796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2799"><a href="#cb64-2799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2800"><a href="#cb64-2800" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2801"><a href="#cb64-2801" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2802"><a href="#cb64-2802" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb64-2803"><a href="#cb64-2803" aria-hidden="true" tabindex="-1"></a>its18_obb_orig <span class="ot">&lt;-</span> its18_replicated.oob.error<span class="sc">$</span>Plot</span>
<span id="cb64-2804"><a href="#cb64-2804" aria-hidden="true" tabindex="-1"></a>its18_obb_rand <span class="ot">&lt;-</span> its18_randomized<span class="sc">$</span>Plot</span>
<span id="cb64-2805"><a href="#cb64-2805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2806"><a href="#cb64-2806" aria-hidden="true" tabindex="-1"></a>its18_obb_orig <span class="ot">&lt;-</span> its18_obb_orig <span class="sc">+</span></span>
<span id="cb64-2807"><a href="#cb64-2807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb64-2808"><a href="#cb64-2808" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb64-2809"><a href="#cb64-2809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"OOB error Original data set"</span>)</span>
<span id="cb64-2810"><a href="#cb64-2810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2811"><a href="#cb64-2811" aria-hidden="true" tabindex="-1"></a>its18_obb_rand <span class="ot">&lt;-</span> its18_obb_rand  <span class="sc">+</span></span>
<span id="cb64-2812"><a href="#cb64-2812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"OOB error Randomized data set"</span>)</span>
<span id="cb64-2813"><a href="#cb64-2813" aria-hidden="true" tabindex="-1"></a>its18_obb_orig <span class="sc">/</span> its18_obb_rand</span>
<span id="cb64-2814"><a href="#cb64-2814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2815"><a href="#cb64-2815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2816"><a href="#cb64-2816" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_fig_its("its_pime_obb_plot")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2817"><a href="#cb64-2817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2818"><a href="#cb64-2818" aria-hidden="true" tabindex="-1"></a>To obtain the confusion matrix from random forests classification use the following:</span>
<span id="cb64-2819"><a href="#cb64-2819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2822"><a href="#cb64-2822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2823"><a href="#cb64-2823" aria-hidden="true" tabindex="-1"></a>its18_prev_confuse <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"its18_best.prev$`Confusion`$"</span>, its18_best, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-2824"><a href="#cb64-2824" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> (its18_prev_confuse)))</span>
<span id="cb64-2825"><a href="#cb64-2825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2826"><a href="#cb64-2826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2827"><a href="#cb64-2827" aria-hidden="true" tabindex="-1"></a><span class="fu">### Save Phyloseq PIME objects</span></span>
<span id="cb64-2828"><a href="#cb64-2828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2831"><a href="#cb64-2831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2832"><a href="#cb64-2832" aria-hidden="true" tabindex="-1"></a>its18_ps_pime <span class="ot">&lt;-</span> its18_prevalence_best</span>
<span id="cb64-2833"><a href="#cb64-2833" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(its18_ps_pime), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2834"><a href="#cb64-2834" aria-hidden="true" tabindex="-1"></a>                           <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(its18_ps_pime))</span>
<span id="cb64-2835"><a href="#cb64-2835" aria-hidden="true" tabindex="-1"></a>its18_ps_pime <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(its18_ps_pime,</span>
<span id="cb64-2836"><a href="#cb64-2836" aria-hidden="true" tabindex="-1"></a>                               sample_data,</span>
<span id="cb64-2837"><a href="#cb64-2837" aria-hidden="true" tabindex="-1"></a>                               its18_ps_pime_tree)</span>
<span id="cb64-2838"><a href="#cb64-2838" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_ps_pime, <span class="st">"files/filtering/pime/rdata/its18_ps_pime.rds"</span>)</span>
<span id="cb64-2839"><a href="#cb64-2839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2840"><a href="#cb64-2840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2841"><a href="#cb64-2841" aria-hidden="true" tabindex="-1"></a><span class="fu">### Split &amp; save by predictor variable</span></span>
<span id="cb64-2842"><a href="#cb64-2842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2845"><a href="#cb64-2845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2846"><a href="#cb64-2846" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(its18_ps_pime))</span>
<span id="cb64-2847"><a href="#cb64-2847" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_split <span class="ot">&lt;-</span> <span class="fu">pime.split.by.variable</span>(its18_ps_pime, <span class="st">"TEMP"</span>)</span>
<span id="cb64-2848"><a href="#cb64-2848" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>, <span class="st">"files/filtering/pime/rdata/its18_ps_pime_0.rds"</span>)</span>
<span id="cb64-2849"><a href="#cb64-2849" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">3</span><span class="st">`</span>, <span class="st">"files/filtering/pime/rdata/its18_ps_pime_3.rds"</span>)</span>
<span id="cb64-2850"><a href="#cb64-2850" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(its18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">8</span><span class="st">`</span>, <span class="st">"files/filtering/pime/rdata/its18_ps_pime_8.rds"</span>)</span>
<span id="cb64-2851"><a href="#cb64-2851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2852"><a href="#cb64-2852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2855"><a href="#cb64-2855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2856"><a href="#cb64-2856" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2857"><a href="#cb64-2857" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2858"><a href="#cb64-2858" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_split</span>
<span id="cb64-2859"><a href="#cb64-2859" aria-hidden="true" tabindex="-1"></a><span class="co">#its18_ps_pime_split$`0`</span></span>
<span id="cb64-2860"><a href="#cb64-2860" aria-hidden="true" tabindex="-1"></a><span class="co">#its18_ps_pime_split$`4`</span></span>
<span id="cb64-2861"><a href="#cb64-2861" aria-hidden="true" tabindex="-1"></a><span class="co">#its18_ps_pime_split$`8`</span></span>
<span id="cb64-2862"><a href="#cb64-2862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2863"><a href="#cb64-2863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2866"><a href="#cb64-2866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2867"><a href="#cb64-2867" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2868"><a href="#cb64-2868" aria-hidden="true" tabindex="-1"></a>its18_pime_preval.tax <span class="ot">&lt;-</span> <span class="fu">tax_table</span>(its18_ps_pime)</span>
<span id="cb64-2869"><a href="#cb64-2869" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(its18_pime_preval.tax,</span>
<span id="cb64-2870"><a href="#cb64-2870" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="st">"files/filtering/pime/tables/its18_asv_PIME_tax_table.txt"</span>,</span>
<span id="cb64-2871"><a href="#cb64-2871" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-2872"><a href="#cb64-2872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2873"><a href="#cb64-2873" aria-hidden="true" tabindex="-1"></a>its18_pime_preval.asv <span class="ot">&lt;-</span> <span class="fu">otu_table</span>(<span class="fu">t</span>(its18_ps_pime))</span>
<span id="cb64-2874"><a href="#cb64-2874" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(its18_pime_preval.asv,</span>
<span id="cb64-2875"><a href="#cb64-2875" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="st">"files/filtering/pime/tables/its18_asv_PIME_otu_table.txt"</span>,</span>
<span id="cb64-2876"><a href="#cb64-2876" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-2877"><a href="#cb64-2877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2878"><a href="#cb64-2878" aria-hidden="true" tabindex="-1"></a>its18_pime_preval.samp <span class="ot">&lt;-</span> <span class="fu">sample_data</span>(its18_ps_pime)</span>
<span id="cb64-2879"><a href="#cb64-2879" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(its18_pime_preval.samp,</span>
<span id="cb64-2880"><a href="#cb64-2880" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="st">"files/filtering/pime/tables/its18_asv_PIME_sample_data.txt"</span>,</span>
<span id="cb64-2881"><a href="#cb64-2881" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-2882"><a href="#cb64-2882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2883"><a href="#cb64-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2884"><a href="#cb64-2884" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb64-2885"><a href="#cb64-2885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2886"><a href="#cb64-2886" aria-hidden="true" tabindex="-1"></a>The influence of filtering on total reads and ASVs for each sample. </span>
<span id="cb64-2887"><a href="#cb64-2887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2890"><a href="#cb64-2890" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2891"><a href="#cb64-2891" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2892"><a href="#cb64-2892" aria-hidden="true" tabindex="-1"></a>tmp_read_count <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_sums</span>(its18_ps_pime)) <span class="sc">%&gt;%</span></span>
<span id="cb64-2893"><a href="#cb64-2893" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-2894"><a href="#cb64-2894" aria-hidden="true" tabindex="-1"></a>tmp_asv_count <span class="ot">&lt;-</span> <span class="fu">estimate_richness</span>(its18_ps_pime, <span class="at">split =</span> <span class="cn">TRUE</span>, <span class="at">measures =</span> <span class="st">"Observed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2895"><a href="#cb64-2895" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SamName"</span>)</span>
<span id="cb64-2896"><a href="#cb64-2896" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(its18_ps_pime))</span>
<span id="cb64-2897"><a href="#cb64-2897" aria-hidden="true" tabindex="-1"></a>tmp_samp_data <span class="ot">&lt;-</span> tmp_samp_data[<span class="fu">order</span>(tmp_samp_data<span class="sc">$</span>PLOT, tmp_samp_data<span class="sc">$</span>TEMP),]</span>
<span id="cb64-2898"><a href="#cb64-2898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2899"><a href="#cb64-2899" aria-hidden="true" tabindex="-1"></a>tmp_join <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp_data, tmp_read_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2900"><a href="#cb64-2900" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_asv_count, <span class="at">by =</span> <span class="st">"SamName"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2901"><a href="#cb64-2901" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Sample_ID"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2902"><a href="#cb64-2902" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_reads"</span> <span class="ot">=</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2903"><a href="#cb64-2903" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_asvs"</span> <span class="ot">=</span> <span class="dv">8</span>)</span>
<span id="cb64-2904"><a href="#cb64-2904" aria-hidden="true" tabindex="-1"></a>tmp_join[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb64-2905"><a href="#cb64-2905" aria-hidden="true" tabindex="-1"></a>its_pime_samp_summary <span class="ot">&lt;-</span> tmp_join</span>
<span id="cb64-2906"><a href="#cb64-2906" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-2907"><a href="#cb64-2907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2908"><a href="#cb64-2908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2909"><a href="#cb64-2909" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its_pime_samp_summary")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-2910"><a href="#cb64-2910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2913"><a href="#cb64-2913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2914"><a href="#cb64-2914" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2915"><a href="#cb64-2915" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2916"><a href="#cb64-2916" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its_pime_samp_summary</span>
<span id="cb64-2917"><a href="#cb64-2917" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-2918"><a href="#cb64-2918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-2919"><a href="#cb64-2919" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its_pime_samp_summary"</span>,</span>
<span id="cb64-2920"><a href="#cb64-2920" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-2921"><a href="#cb64-2921" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-2922"><a href="#cb64-2922" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-2923"><a href="#cb64-2923" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2924"><a href="#cb64-2924" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2925"><a href="#cb64-2925" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-2926"><a href="#cb64-2926" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2927"><a href="#cb64-2927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2930"><a href="#cb64-2930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2931"><a href="#cb64-2931" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2932"><a href="#cb64-2932" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2933"><a href="#cb64-2933" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-2934"><a href="#cb64-2934" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-2935"><a href="#cb64-2935" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-2936"><a href="#cb64-2936" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-2937"><a href="#cb64-2937" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">TRUE</span>, <span class="at">sortable =</span> <span class="cn">TRUE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2938"><a href="#cb64-2938" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-2939"><a href="#cb64-2939" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2940"><a href="#cb64-2940" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-2941"><a href="#cb64-2941" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_ID =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sample_ID"</span>, </span>
<span id="cb64-2942"><a href="#cb64-2942" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-2943"><a href="#cb64-2943" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-2944"><a href="#cb64-2944" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-2945"><a href="#cb64-2945" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-2946"><a href="#cb64-2946" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-2947"><a href="#cb64-2947" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-2948"><a href="#cb64-2948" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">TRUE</span>, <span class="at">defaultPageSize =</span> <span class="dv">5</span>, <span class="at">showPagination =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-2949"><a href="#cb64-2949" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-2950"><a href="#cb64-2950" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2951"><a href="#cb64-2951" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-2952"><a href="#cb64-2952" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">TRUE</span>, <span class="at">fullWidth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-2953"><a href="#cb64-2953" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-2954"><a href="#cb64-2954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2955"><a href="#cb64-2955" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-2956"><a href="#cb64-2956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2957"><a href="#cb64-2957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2958"><a href="#cb64-2958" aria-hidden="true" tabindex="-1"></a>And here is how the subsets changed through the PIME filtering process.</span>
<span id="cb64-2959"><a href="#cb64-2959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2962"><a href="#cb64-2962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2963"><a href="#cb64-2963" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-2964"><a href="#cb64-2964" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-2965"><a href="#cb64-2965" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_0 <span class="ot">&lt;-</span> its18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">0</span><span class="st">`</span></span>
<span id="cb64-2966"><a href="#cb64-2966" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_3 <span class="ot">&lt;-</span> its18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">3</span><span class="st">`</span></span>
<span id="cb64-2967"><a href="#cb64-2967" aria-hidden="true" tabindex="-1"></a>its18_ps_pime_8 <span class="ot">&lt;-</span> its18_ps_pime_split<span class="sc">$</span><span class="st">`</span><span class="at">8</span><span class="st">`</span></span>
<span id="cb64-2968"><a href="#cb64-2968" aria-hidden="true" tabindex="-1"></a>tmp_objects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="st">"FULL data set"</span>, <span class="st">"Rarefied data"</span>, <span class="st">"PIME filtered data"</span>,</span>
<span id="cb64-2969"><a href="#cb64-2969" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PIME (+0C)"</span>, <span class="st">"PIME (+3C)"</span>, <span class="st">"PIME (+8C)"</span>))</span>
<span id="cb64-2970"><a href="#cb64-2970" aria-hidden="true" tabindex="-1"></a>tmp_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"its18_ps_work"</span>, <span class="st">"its18_pime_ds"</span>, <span class="st">"its18_ps_pime"</span>,</span>
<span id="cb64-2971"><a href="#cb64-2971" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"its18_ps_pime_0"</span>, <span class="st">"its18_ps_pime_3"</span>, <span class="st">"its18_ps_pime_8"</span>)</span>
<span id="cb64-2972"><a href="#cb64-2972" aria-hidden="true" tabindex="-1"></a>tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2973"><a href="#cb64-2973" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2974"><a href="#cb64-2974" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">nsamples</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-2975"><a href="#cb64-2975" aria-hidden="true" tabindex="-1"></a>   tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_no_samp, tmp_get))</span>
<span id="cb64-2976"><a href="#cb64-2976" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2977"><a href="#cb64-2977" aria-hidden="true" tabindex="-1"></a>tmp_no_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_no_samp)</span>
<span id="cb64-2978"><a href="#cb64-2978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2979"><a href="#cb64-2979" aria-hidden="true" tabindex="-1"></a>tmp_rc <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2980"><a href="#cb64-2980" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2981"><a href="#cb64-2981" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(<span class="fu">get</span>(i)))</span>
<span id="cb64-2982"><a href="#cb64-2982" aria-hidden="true" tabindex="-1"></a>   tmp_rc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_rc, tmp_get))</span>
<span id="cb64-2983"><a href="#cb64-2983" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2984"><a href="#cb64-2984" aria-hidden="true" tabindex="-1"></a>tmp_rc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_rc)</span>
<span id="cb64-2985"><a href="#cb64-2985" aria-hidden="true" tabindex="-1"></a>tmp_asv <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb64-2986"><a href="#cb64-2986" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tmp_samples) {</span>
<span id="cb64-2987"><a href="#cb64-2987" aria-hidden="true" tabindex="-1"></a>   tmp_get <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(<span class="fu">get</span>(i))</span>
<span id="cb64-2988"><a href="#cb64-2988" aria-hidden="true" tabindex="-1"></a>   tmp_asv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">append</span>(tmp_asv, tmp_get))</span>
<span id="cb64-2989"><a href="#cb64-2989" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-2990"><a href="#cb64-2990" aria-hidden="true" tabindex="-1"></a>tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_asv)</span>
<span id="cb64-2991"><a href="#cb64-2991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2992"><a href="#cb64-2992" aria-hidden="true" tabindex="-1"></a>its18_asv_pime_sum <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(tmp_objects, tmp_no_samp) <span class="sc">%&gt;%</span></span>
<span id="cb64-2993"><a href="#cb64-2993" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_rc) <span class="sc">%&gt;%</span></span>
<span id="cb64-2994"><a href="#cb64-2994" aria-hidden="true" tabindex="-1"></a>                      dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(., tmp_asv) <span class="sc">%&gt;%</span></span>
<span id="cb64-2995"><a href="#cb64-2995" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Description"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"no. samples"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb64-2996"><a href="#cb64-2996" aria-hidden="true" tabindex="-1"></a>                <span class="st">"total reads"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"total asvs"</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb64-2997"><a href="#cb64-2997" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb64-2998"><a href="#cb64-2998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-2999"><a href="#cb64-2999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3000"><a href="#cb64-3000" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;small&gt;</span><span class="in">`r caption_tab_its("its18_asv_pime_sum")`</span><span class="kw">&lt;/small&gt;</span></span>
<span id="cb64-3001"><a href="#cb64-3001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3004"><a href="#cb64-3004" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-3005"><a href="#cb64-3005" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-3006"><a href="#cb64-3006" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-3007"><a href="#cb64-3007" aria-hidden="true" tabindex="-1"></a>seq_table <span class="ot">&lt;-</span> its18_asv_pime_sum</span>
<span id="cb64-3008"><a href="#cb64-3008" aria-hidden="true" tabindex="-1"></a>seq_table <span class="sc">%&gt;%</span></span>
<span id="cb64-3009"><a href="#cb64-3009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download_this</span>(</span>
<span id="cb64-3010"><a href="#cb64-3010" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_name =</span> <span class="st">"its18_asv_pime_sum"</span>,</span>
<span id="cb64-3011"><a href="#cb64-3011" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_extension =</span> <span class="st">".csv"</span>,</span>
<span id="cb64-3012"><a href="#cb64-3012" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_label =</span> <span class="st">"Download data as csv file"</span>,</span>
<span id="cb64-3013"><a href="#cb64-3013" aria-hidden="true" tabindex="-1"></a>    <span class="at">button_type =</span> <span class="st">"default"</span>,</span>
<span id="cb64-3014"><a href="#cb64-3014" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv2 =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-3015"><a href="#cb64-3015" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_icon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-3016"><a href="#cb64-3016" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="st">"fa fa-save"</span>)</span>
<span id="cb64-3017"><a href="#cb64-3017" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-3018"><a href="#cb64-3018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3021"><a href="#cb64-3021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-3022"><a href="#cb64-3022" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-3023"><a href="#cb64-3023" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-3024"><a href="#cb64-3024" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(seq_table,</span>
<span id="cb64-3025"><a href="#cb64-3025" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(</span>
<span id="cb64-3026"><a href="#cb64-3026" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cf">function</span>(value) <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, value, <span class="at">fixed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-3027"><a href="#cb64-3027" aria-hidden="true" tabindex="-1"></a>    <span class="at">cell =</span> <span class="cf">function</span>(value) <span class="fu">format</span>(value, <span class="at">nsmall =</span> <span class="dv">0</span>),</span>
<span id="cb64-3028"><a href="#cb64-3028" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">filterable =</span> <span class="cn">FALSE</span>, <span class="at">sortable =</span> <span class="cn">FALSE</span>, <span class="at">resizable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-3029"><a href="#cb64-3029" aria-hidden="true" tabindex="-1"></a>    <span class="at">footerStyle =</span> <span class="fu">list</span>(<span class="at">fontWeight =</span> <span class="st">"bold"</span>), <span class="at">minWidth =</span> <span class="dv">100</span></span>
<span id="cb64-3030"><a href="#cb64-3030" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-3031"><a href="#cb64-3031" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb64-3032"><a href="#cb64-3032" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Description"</span>, </span>
<span id="cb64-3033"><a href="#cb64-3033" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sticky =</span> <span class="st">"left"</span>, </span>
<span id="cb64-3034"><a href="#cb64-3034" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>),</span>
<span id="cb64-3035"><a href="#cb64-3035" aria-hidden="true" tabindex="-1"></a>                       <span class="at">headerStyle =</span> <span class="fu">list</span>(<span class="at">borderRight =</span> <span class="st">"1px solid #eee"</span>), </span>
<span id="cb64-3036"><a href="#cb64-3036" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb64-3037"><a href="#cb64-3037" aria-hidden="true" tabindex="-1"></a>                       <span class="at">minWidth =</span> <span class="dv">150</span>)</span>
<span id="cb64-3038"><a href="#cb64-3038" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb64-3039"><a href="#cb64-3039" aria-hidden="true" tabindex="-1"></a>  <span class="at">searchable =</span> <span class="cn">FALSE</span>, <span class="at">defaultPageSize =</span> <span class="dv">6</span>, <span class="at">showPagination =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-3040"><a href="#cb64-3040" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="fu">nrow</span>(seq_table)), </span>
<span id="cb64-3041"><a href="#cb64-3041" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-3042"><a href="#cb64-3042" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>, <span class="at">striped =</span> <span class="cn">TRUE</span>, <span class="at">compact =</span> <span class="cn">TRUE</span>, </span>
<span id="cb64-3043"><a href="#cb64-3043" aria-hidden="true" tabindex="-1"></a>  <span class="at">wrap =</span> <span class="cn">FALSE</span>, <span class="at">showSortable =</span> <span class="cn">FALSE</span>, <span class="at">fullWidth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-3044"><a href="#cb64-3044" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="at">fontSize =</span> <span class="st">"0.8em"</span>)))</span>
<span id="cb64-3045"><a href="#cb64-3045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3046"><a href="#cb64-3046" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(seq_table)</span>
<span id="cb64-3047"><a href="#cb64-3047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-3048"><a href="#cb64-3048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3051"><a href="#cb64-3051" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-3052"><a href="#cb64-3052" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-3053"><a href="#cb64-3053" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"page_build/filtering_wf.rdata"</span>)</span>
<span id="cb64-3054"><a href="#cb64-3054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-3055"><a href="#cb64-3055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3058"><a href="#cb64-3058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-3059"><a href="#cb64-3059" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb64-3060"><a href="#cb64-3060" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-3061"><a href="#cb64-3061" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb64-3062"><a href="#cb64-3062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-3063"><a href="#cb64-3063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3064"><a href="#cb64-3064" aria-hidden="true" tabindex="-1"></a><span class="fu"># Workflow Output </span></span>
<span id="cb64-3065"><a href="#cb64-3065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3066"><a href="#cb64-3066" aria-hidden="true" tabindex="-1"></a>Data products generated in this workflow can be downloaded from figshare.</span>
<span id="cb64-3067"><a href="#cb64-3067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3068"><a href="#cb64-3068" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://widgets.figshare.com/articles/14701440/embed?show_title=1"</span> <span class="er">width</span><span class="ot">=</span><span class="st">"100%"</span> <span class="er">height</span><span class="ot">=</span><span class="st">"351"</span> <span class="er">allowfullscreen</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">"0"</span><span class="kw">&gt;&lt;/iframe&gt;</span></span>
<span id="cb64-3069"><a href="#cb64-3069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3070"><a href="#cb64-3070" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/br&gt;</span></span>
<span id="cb64-3071"><a href="#cb64-3071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3072"><a href="#cb64-3072" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"taxa.html"</span> <span class="er">class</span><span class="ot">=</span><span class="st">"btnnav button_round"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"float: right;"</span><span class="kw">&gt;</span>Next workflow:</span>
<span id="cb64-3073"><a href="#cb64-3073" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span> 4. Taxonomic Diversity<span class="kw">&lt;/a&gt;</span></span>
<span id="cb64-3074"><a href="#cb64-3074" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"data-prep.html"</span> <span class="er">class</span><span class="ot">=</span><span class="st">"btnnav button_round"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"float: left;"</span><span class="kw">&gt;</span>Previous workflow:</span>
<span id="cb64-3075"><a href="#cb64-3075" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span> 2. Data Set Preparation<span class="kw">&lt;/a&gt;&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb64-3076"><a href="#cb64-3076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3079"><a href="#cb64-3079" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-3080"><a href="#cb64-3080" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb64-3081"><a href="#cb64-3081" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb64-3082"><a href="#cb64-3082" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-3083"><a href="#cb64-3083" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-3084"><a href="#cb64-3084" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb64-3085"><a href="#cb64-3085" aria-hidden="true" tabindex="-1"></a><span class="do">### COmmon formatting scripts</span></span>
<span id="cb64-3086"><a href="#cb64-3086" aria-hidden="true" tabindex="-1"></a><span class="do">### </span><span class="al">NOTE</span><span class="do">: captioner.R must be read BEFORE captions_XYZ.R</span></span>
<span id="cb64-3087"><a href="#cb64-3087" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">file.path</span>(<span class="st">"assets"</span>, <span class="st">"functions.R"</span>))</span>
<span id="cb64-3088"><a href="#cb64-3088" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb64-3089"><a href="#cb64-3089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3090"><a href="#cb64-3090" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Source Code {.appendix}</span></span>
<span id="cb64-3091"><a href="#cb64-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3092"><a href="#cb64-3092" aria-hidden="true" tabindex="-1"></a>The source code for this page can be accessed on GitHub <span class="in">`r fa(name = "github")`</span> by <span class="co">[</span><span class="ot">clicking this link</span><span class="co">]</span>(<span class="in">`r source_code()`</span>). </span>
<span id="cb64-3093"><a href="#cb64-3093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3094"><a href="#cb64-3094" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data Availability {.appendix}</span></span>
<span id="cb64-3095"><a href="#cb64-3095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3096"><a href="#cb64-3096" aria-hidden="true" tabindex="-1"></a>Data generated in this workflow and the <span class="in">`Rdata`</span> file need to run the workflow can be accessed on figshare at <span class="co">[</span><span class="ot">10.25573/data.14701440</span><span class="co">](https://doi.org/10.25573/data.14701440)</span>.</span>
<span id="cb64-3097"><a href="#cb64-3097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3098"><a href="#cb64-3098" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Last updated on {.appendix}</span></span>
<span id="cb64-3099"><a href="#cb64-3099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3102"><a href="#cb64-3102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-3103"><a href="#cb64-3103" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb64-3104"><a href="#cb64-3104" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb64-3105"><a href="#cb64-3105" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span>
<span id="cb64-3106"><a href="#cb64-3106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">© Copyright 2022 <a href="https://metacrobe.github.io/">metacrobe</a> &amp; The SWELTR Project. Site constructed using <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>